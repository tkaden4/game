"use strict";(()=>{var lb=Object.create;var Mc=Object.defineProperty;var hb=Object.getOwnPropertyDescriptor;var ub=Object.getOwnPropertyNames;var cb=Object.getPrototypeOf,fb=Object.prototype.hasOwnProperty;var Gr=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),db=(e,t)=>{for(var r in t)Mc(e,r,{get:t[r],enumerable:!0})},pb=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of ub(t))!fb.call(e,n)&&n!==r&&Mc(e,n,{get:()=>t[n],enumerable:!(i=hb(t,n))||i.enumerable});return e};var Ei=(e,t,r)=>(r=e!=null?lb(cb(e)):{},pb(t||!e||!e.__esModule?Mc(r,"default",{value:e,enumerable:!0}):r,e));var Tg=Gr((uI,Fc)=>{"use strict";var _b=Object.prototype.hasOwnProperty,We="~";function No(){}Object.create&&(No.prototype=Object.create(null),new No().__proto__||(We=!1));function xb(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function yg(e,t,r,i,n){if(typeof r!="function")throw new TypeError("The listener must be a function");var s=new xb(r,i||e,n),a=We?We+t:t;return e._events[a]?e._events[a].fn?e._events[a]=[e._events[a],s]:e._events[a].push(s):(e._events[a]=s,e._eventsCount++),e}function Yl(e,t){--e._eventsCount===0?e._events=new No:delete e._events[t]}function De(){this._events=new No,this._eventsCount=0}De.prototype.eventNames=function(){var t=[],r,i;if(this._eventsCount===0)return t;for(i in r=this._events)_b.call(r,i)&&t.push(We?i.slice(1):i);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};De.prototype.listeners=function(t){var r=We?We+t:t,i=this._events[r];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,a=new Array(s);n<s;n++)a[n]=i[n].fn;return a};De.prototype.listenerCount=function(t){var r=We?We+t:t,i=this._events[r];return i?i.fn?1:i.length:0};De.prototype.emit=function(t,r,i,n,s,a){var c=We?We+t:t;if(!this._events[c])return!1;var f=this._events[c],p=arguments.length,l,h;if(f.fn){switch(f.once&&this.removeListener(t,f.fn,void 0,!0),p){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,r),!0;case 3:return f.fn.call(f.context,r,i),!0;case 4:return f.fn.call(f.context,r,i,n),!0;case 5:return f.fn.call(f.context,r,i,n,s),!0;case 6:return f.fn.call(f.context,r,i,n,s,a),!0}for(h=1,l=new Array(p-1);h<p;h++)l[h-1]=arguments[h];f.fn.apply(f.context,l)}else{var d=f.length,m;for(h=0;h<d;h++)switch(f[h].once&&this.removeListener(t,f[h].fn,void 0,!0),p){case 1:f[h].fn.call(f[h].context);break;case 2:f[h].fn.call(f[h].context,r);break;case 3:f[h].fn.call(f[h].context,r,i);break;case 4:f[h].fn.call(f[h].context,r,i,n);break;default:if(!l)for(m=1,l=new Array(p-1);m<p;m++)l[m-1]=arguments[m];f[h].fn.apply(f[h].context,l)}}return!0};De.prototype.on=function(t,r,i){return yg(this,t,r,i,!1)};De.prototype.once=function(t,r,i){return yg(this,t,r,i,!0)};De.prototype.removeListener=function(t,r,i,n){var s=We?We+t:t;if(!this._events[s])return this;if(!r)return Yl(this,s),this;var a=this._events[s];if(a.fn)a.fn===r&&(!n||a.once)&&(!i||a.context===i)&&Yl(this,s);else{for(var c=0,f=[],p=a.length;c<p;c++)(a[c].fn!==r||n&&!a[c].once||i&&a[c].context!==i)&&f.push(a[c]);f.length?this._events[s]=f.length===1?f[0]:f:Yl(this,s)}return this};De.prototype.removeAllListeners=function(t){var r;return t?(r=We?We+t:t,this._events[r]&&Yl(this,r)):(this._events=new No,this._eventsCount=0),this};De.prototype.off=De.prototype.removeListener;De.prototype.addListener=De.prototype.on;De.prefixed=We;De.EventEmitter=De;typeof Fc<"u"&&(Fc.exports=De)});var Ag=Gr((cI,Gc)=>{"use strict";Gc.exports=Kl;Gc.exports.default=Kl;function Kl(e,t,r){r=r||2;var i=t&&t.length,n=i?t[0]*r:e.length,s=wg(e,0,n,r,!0),a=[];if(!s||s.next===s.prev)return a;var c,f,p,l,h,d,m;if(i&&(s=wb(e,t,s,r)),e.length>80*r){c=p=e[0],f=l=e[1];for(var _=r;_<n;_+=r)h=e[_],d=e[_+1],h<c&&(c=h),d<f&&(f=d),h>p&&(p=h),d>l&&(l=d);m=Math.max(p-c,l-f),m=m!==0?32767/m:0}return Uo(s,a,r,c,f,m,0),a}function wg(e,t,r,i,n){var s,a;if(n===kc(e,t,r,i)>0)for(s=t;s<r;s+=i)a=Eg(s,e[s],e[s+1],a);else for(s=r-i;s>=t;s-=i)a=Eg(s,e[s],e[s+1],a);return a&&Zl(a,a.next)&&(Go(a),a=a.next),a}function Ln(e,t){if(!e)return e;t||(t=e);var r=e,i;do if(i=!1,!r.steiner&&(Zl(r,r.next)||re(r.prev,r,r.next)===0)){if(Go(r),r=t=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==t);return t}function Uo(e,t,r,i,n,s,a){if(e){!a&&s&&Rb(e,i,n,s);for(var c=e,f,p;e.prev!==e.next;){if(f=e.prev,p=e.next,s?yb(e,i,n,s):vb(e)){t.push(f.i/r|0),t.push(e.i/r|0),t.push(p.i/r|0),Go(e),e=p.next,c=p.next;continue}if(e=p,e===c){a?a===1?(e=Tb(Ln(e),t,r),Uo(e,t,r,i,n,s,2)):a===2&&Eb(e,t,r,i,n,s):Uo(Ln(e),t,r,i,n,s,1);break}}}}function vb(e){var t=e.prev,r=e,i=e.next;if(re(t,r,i)>=0)return!1;for(var n=t.x,s=r.x,a=i.x,c=t.y,f=r.y,p=i.y,l=n<s?n<a?n:a:s<a?s:a,h=c<f?c<p?c:p:f<p?f:p,d=n>s?n>a?n:a:s>a?s:a,m=c>f?c>p?c:p:f>p?f:p,_=i.next;_!==t;){if(_.x>=l&&_.x<=d&&_.y>=h&&_.y<=m&&ws(n,c,s,f,a,p,_.x,_.y)&&re(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function yb(e,t,r,i){var n=e.prev,s=e,a=e.next;if(re(n,s,a)>=0)return!1;for(var c=n.x,f=s.x,p=a.x,l=n.y,h=s.y,d=a.y,m=c<f?c<p?c:p:f<p?f:p,_=l<h?l<d?l:d:h<d?h:d,x=c>f?c>p?c:p:f>p?f:p,T=l>h?l>d?l:d:h>d?h:d,S=Nc(m,_,t,r,i),w=Nc(x,T,t,r,i),y=e.prevZ,E=e.nextZ;y&&y.z>=S&&E&&E.z<=w;){if(y.x>=m&&y.x<=x&&y.y>=_&&y.y<=T&&y!==n&&y!==a&&ws(c,l,f,h,p,d,y.x,y.y)&&re(y.prev,y,y.next)>=0||(y=y.prevZ,E.x>=m&&E.x<=x&&E.y>=_&&E.y<=T&&E!==n&&E!==a&&ws(c,l,f,h,p,d,E.x,E.y)&&re(E.prev,E,E.next)>=0))return!1;E=E.nextZ}for(;y&&y.z>=S;){if(y.x>=m&&y.x<=x&&y.y>=_&&y.y<=T&&y!==n&&y!==a&&ws(c,l,f,h,p,d,y.x,y.y)&&re(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;E&&E.z<=w;){if(E.x>=m&&E.x<=x&&E.y>=_&&E.y<=T&&E!==n&&E!==a&&ws(c,l,f,h,p,d,E.x,E.y)&&re(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function Tb(e,t,r){var i=e;do{var n=i.prev,s=i.next.next;!Zl(n,s)&&Sg(n,i,i.next,s)&&ko(n,s)&&ko(s,n)&&(t.push(n.i/r|0),t.push(i.i/r|0),t.push(s.i/r|0),Go(i),Go(i.next),i=e=s),i=i.next}while(i!==e);return Ln(i)}function Eb(e,t,r,i,n,s){var a=e;do{for(var c=a.next.next;c!==a.prev;){if(a.i!==c.i&&Mb(a,c)){var f=bg(a,c);a=Ln(a,a.next),f=Ln(f,f.next),Uo(a,t,r,i,n,s,0),Uo(f,t,r,i,n,s,0);return}c=c.next}a=a.next}while(a!==e)}function wb(e,t,r,i){var n=[],s,a,c,f,p;for(s=0,a=t.length;s<a;s++)c=t[s]*i,f=s<a-1?t[s+1]*i:e.length,p=wg(e,c,f,i,!1),p===p.next&&(p.steiner=!0),n.push(Pb(p));for(n.sort(Sb),s=0;s<n.length;s++)r=bb(n[s],r);return r}function Sb(e,t){return e.x-t.x}function bb(e,t){var r=Ab(e,t);if(!r)return t;var i=bg(r,e);return Ln(i,i.next),Ln(r,r.next)}function Ab(e,t){var r=t,i=e.x,n=e.y,s=-1/0,a;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){var c=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(c<=i&&c>s&&(s=c,a=r.x<r.next.x?r:r.next,c===i))return a}r=r.next}while(r!==t);if(!a)return null;var f=a,p=a.x,l=a.y,h=1/0,d;r=a;do i>=r.x&&r.x>=p&&i!==r.x&&ws(n<l?i:s,n,p,l,n<l?s:i,n,r.x,r.y)&&(d=Math.abs(n-r.y)/(i-r.x),ko(r,e)&&(d<h||d===h&&(r.x>a.x||r.x===a.x&&Cb(a,r)))&&(a=r,h=d)),r=r.next;while(r!==f);return a}function Cb(e,t){return re(e.prev,e,t.prev)<0&&re(t.next,e,e.next)<0}function Rb(e,t,r,i){var n=e;do n.z===0&&(n.z=Nc(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,Ib(n)}function Ib(e){var t,r,i,n,s,a,c,f,p=1;do{for(r=e,e=null,s=null,a=0;r;){for(a++,i=r,c=0,t=0;t<p&&(c++,i=i.nextZ,!!i);t++);for(f=p;c>0||f>0&&i;)c!==0&&(f===0||!i||r.z<=i.z)?(n=r,r=r.nextZ,c--):(n=i,i=i.nextZ,f--),s?s.nextZ=n:e=n,n.prevZ=s,s=n;r=i}s.nextZ=null,p*=2}while(a>1);return e}function Nc(e,t,r,i,n){return e=(e-r)*n|0,t=(t-i)*n|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function Pb(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function ws(e,t,r,i,n,s,a,c){return(n-a)*(t-c)>=(e-a)*(s-c)&&(e-a)*(i-c)>=(r-a)*(t-c)&&(r-a)*(s-c)>=(n-a)*(i-c)}function Mb(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!Bb(e,t)&&(ko(e,t)&&ko(t,e)&&Db(e,t)&&(re(e.prev,e,t.prev)||re(e,t.prev,t))||Zl(e,t)&&re(e.prev,e,e.next)>0&&re(t.prev,t,t.next)>0)}function re(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Zl(e,t){return e.x===t.x&&e.y===t.y}function Sg(e,t,r,i){var n=ql(re(e,t,r)),s=ql(re(e,t,i)),a=ql(re(r,i,e)),c=ql(re(r,i,t));return!!(n!==s&&a!==c||n===0&&jl(e,r,t)||s===0&&jl(e,i,t)||a===0&&jl(r,e,i)||c===0&&jl(r,t,i))}function jl(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function ql(e){return e>0?1:e<0?-1:0}function Bb(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&Sg(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function ko(e,t){return re(e.prev,e,e.next)<0?re(e,t,e.next)>=0&&re(e,e.prev,t)>=0:re(e,t,e.prev)<0||re(e,e.next,t)<0}function Db(e,t){var r=e,i=!1,n=(e.x+t.x)/2,s=(e.y+t.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&n<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e);return i}function bg(e,t){var r=new Uc(e.i,e.x,e.y),i=new Uc(t.i,t.x,t.y),n=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function Eg(e,t,r,i){var n=new Uc(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function Go(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Uc(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Kl.deviation=function(e,t,r,i){var n=t&&t.length,s=n?t[0]*r:e.length,a=Math.abs(kc(e,0,s,r));if(n)for(var c=0,f=t.length;c<f;c++){var p=t[c]*r,l=c<f-1?t[c+1]*r:e.length;a-=Math.abs(kc(e,p,l,r))}var h=0;for(c=0;c<i.length;c+=3){var d=i[c]*r,m=i[c+1]*r,_=i[c+2]*r;h+=Math.abs((e[d]-e[_])*(e[m+1]-e[d+1])-(e[d]-e[m])*(e[_+1]-e[d+1]))}return a===0&&h===0?0:Math.abs((h-a)/a)};function kc(e,t,r,i){for(var n=0,s=t,a=r-i;s<r;s+=i)n+=(e[a]-e[s])*(e[s+1]+e[a+1]),a=s;return n}Kl.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,n=0;n<e.length;n++){for(var s=0;s<e[n].length;s++)for(var a=0;a<t;a++)r.vertices.push(e[n][s][a]);n>0&&(i+=e[n-1].length,r.holes.push(i))}return r}});var Cg=Gr((Ss,bs)=>{(function(e){var t=typeof Ss=="object"&&Ss&&!Ss.nodeType&&Ss,r=typeof bs=="object"&&bs&&!bs.nodeType&&bs,i=typeof global=="object"&&global;(i.global===i||i.window===i||i.self===i)&&(e=i);var n,s=2147483647,a=36,c=1,f=26,p=38,l=700,h=72,d=128,m="-",_=/^xn--/,x=/[^\x20-\x7E]/,T=/[\x2E\u3002\uFF0E\uFF61]/g,S={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=a-c,y=Math.floor,E=String.fromCharCode,R;function C(Y){throw RangeError(S[Y])}function P(Y,Q){for(var ot=Y.length,xt=[];ot--;)xt[ot]=Q(Y[ot]);return xt}function M(Y,Q){var ot=Y.split("@"),xt="";ot.length>1&&(xt=ot[0]+"@",Y=ot[1]),Y=Y.replace(T,".");var Et=Y.split("."),Rt=P(Et,Q).join(".");return xt+Rt}function B(Y){for(var Q=[],ot=0,xt=Y.length,Et,Rt;ot<xt;)Et=Y.charCodeAt(ot++),Et>=55296&&Et<=56319&&ot<xt?(Rt=Y.charCodeAt(ot++),(Rt&64512)==56320?Q.push(((Et&1023)<<10)+(Rt&1023)+65536):(Q.push(Et),ot--)):Q.push(Et);return Q}function L(Y){return P(Y,function(Q){var ot="";return Q>65535&&(Q-=65536,ot+=E(Q>>>10&1023|55296),Q=56320|Q&1023),ot+=E(Q),ot}).join("")}function O(Y){return Y-48<10?Y-22:Y-65<26?Y-65:Y-97<26?Y-97:a}function H(Y,Q){return Y+22+75*(Y<26)-((Q!=0)<<5)}function N(Y,Q,ot){var xt=0;for(Y=ot?y(Y/l):Y>>1,Y+=y(Y/Q);Y>w*f>>1;xt+=a)Y=y(Y/w);return y(xt+(w+1)*Y/(Y+p))}function G(Y){var Q=[],ot=Y.length,xt,Et=0,Rt=d,Tt=h,Wt,Ot,te,ve,jt,Xt,Kt,Lt,Ut;for(Wt=Y.lastIndexOf(m),Wt<0&&(Wt=0),Ot=0;Ot<Wt;++Ot)Y.charCodeAt(Ot)>=128&&C("not-basic"),Q.push(Y.charCodeAt(Ot));for(te=Wt>0?Wt+1:0;te<ot;){for(ve=Et,jt=1,Xt=a;te>=ot&&C("invalid-input"),Kt=O(Y.charCodeAt(te++)),(Kt>=a||Kt>y((s-Et)/jt))&&C("overflow"),Et+=Kt*jt,Lt=Xt<=Tt?c:Xt>=Tt+f?f:Xt-Tt,!(Kt<Lt);Xt+=a)Ut=a-Lt,jt>y(s/Ut)&&C("overflow"),jt*=Ut;xt=Q.length+1,Tt=N(Et-ve,xt,ve==0),y(Et/xt)>s-Rt&&C("overflow"),Rt+=y(Et/xt),Et%=xt,Q.splice(Et++,0,Rt)}return L(Q)}function Z(Y){var Q,ot,xt,Et,Rt,Tt,Wt,Ot,te,ve,jt,Xt=[],Kt,Lt,Ut,Jr;for(Y=B(Y),Kt=Y.length,Q=d,ot=0,Rt=h,Tt=0;Tt<Kt;++Tt)jt=Y[Tt],jt<128&&Xt.push(E(jt));for(xt=Et=Xt.length,Et&&Xt.push(m);xt<Kt;){for(Wt=s,Tt=0;Tt<Kt;++Tt)jt=Y[Tt],jt>=Q&&jt<Wt&&(Wt=jt);for(Lt=xt+1,Wt-Q>y((s-ot)/Lt)&&C("overflow"),ot+=(Wt-Q)*Lt,Q=Wt,Tt=0;Tt<Kt;++Tt)if(jt=Y[Tt],jt<Q&&++ot>s&&C("overflow"),jt==Q){for(Ot=ot,te=a;ve=te<=Rt?c:te>=Rt+f?f:te-Rt,!(Ot<ve);te+=a)Jr=Ot-ve,Ut=a-ve,Xt.push(E(H(ve+Jr%Ut,0))),Ot=y(Jr/Ut);Xt.push(E(H(Ot,0))),Rt=N(ot,Lt,xt==Et),ot=0,++xt}++ot,++Q}return Xt.join("")}function q(Y){return M(Y,function(Q){return _.test(Q)?G(Q.slice(4).toLowerCase()):Q})}function it(Y){return M(Y,function(Q){return x.test(Q)?"xn--"+Z(Q):Q})}if(n={version:"1.3.2",ucs2:{decode:B,encode:L},decode:G,encode:Z,toASCII:it,toUnicode:q},typeof define=="function"&&typeof define.amd=="object"&&define.amd)define("punycode",function(){return n});else if(t&&r)if(bs.exports==t)r.exports=n;else for(R in n)n.hasOwnProperty(R)&&(t[R]=n[R]);else e.punycode=n})(Ss)});var Ig=Gr((fI,Rg)=>{"use strict";Rg.exports={isString:function(e){return typeof e=="string"},isObject:function(e){return typeof e=="object"&&e!==null},isNull:function(e){return e===null},isNullOrUndefined:function(e){return e==null}}});var Mg=Gr((dI,Pg)=>{"use strict";function Ob(e,t){return Object.prototype.hasOwnProperty.call(e,t)}Pg.exports=function(e,t,r,i){t=t||"&",r=r||"=";var n={};if(typeof e!="string"||e.length===0)return n;var s=/\+/g;e=e.split(t);var a=1e3;i&&typeof i.maxKeys=="number"&&(a=i.maxKeys);var c=e.length;a>0&&c>a&&(c=a);for(var f=0;f<c;++f){var p=e[f].replace(s,"%20"),l=p.indexOf(r),h,d,m,_;l>=0?(h=p.substr(0,l),d=p.substr(l+1)):(h=p,d=""),m=decodeURIComponent(h),_=decodeURIComponent(d),Ob(n,m)?Array.isArray(n[m])?n[m].push(_):n[m]=[n[m],_]:n[m]=_}return n}});var Dg=Gr((pI,Bg)=>{"use strict";var Ho=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};Bg.exports=function(e,t,r,i){return t=t||"&",r=r||"=",e===null&&(e=void 0),typeof e=="object"?Object.keys(e).map(function(n){var s=encodeURIComponent(Ho(n))+r;return Array.isArray(e[n])?e[n].map(function(a){return s+encodeURIComponent(Ho(a))}).join(t):s+encodeURIComponent(Ho(e[n]))}).join(t):i?encodeURIComponent(Ho(i))+r+encodeURIComponent(Ho(e)):""}});var Og=Gr(Vo=>{"use strict";Vo.decode=Vo.parse=Mg();Vo.encode=Vo.stringify=Dg()});var Ug=Gr(Cs=>{"use strict";var Lb=Cg(),ni=Ig();Cs.parse=Wo;Cs.resolve=zb;Cs.resolveObject=$b;Cs.format=Xb;Cs.Url=Br;function Br(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Fb=/^([a-z0-9.+-]+:)/i,Nb=/:[0-9]*$/,Ub=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,kb=["<",">",'"',"`"," ","\r",`
`,"	"],Gb=["{","}","|","\\","^","`"].concat(kb),Hc=["'"].concat(Gb),Lg=["%","/","?",";","#"].concat(Hc),Fg=["/","?","#"],Hb=255,Ng=/^[+a-z0-9A-Z_-]{0,63}$/,Vb=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Wb={javascript:!0,"javascript:":!0},Vc={javascript:!0,"javascript:":!0},As={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Wc=Og();function Wo(e,t,r){if(e&&ni.isObject(e)&&e instanceof Br)return e;var i=new Br;return i.parse(e,t,r),i}Br.prototype.parse=function(e,t,r){if(!ni.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),n=i!==-1&&i<e.indexOf("#")?"?":"#",s=e.split(n),a=/\\/g;s[0]=s[0].replace(a,"/"),e=s.join(n);var c=e;if(c=c.trim(),!r&&e.split("#").length===1){var f=Ub.exec(c);if(f)return this.path=c,this.href=c,this.pathname=f[1],f[2]?(this.search=f[2],t?this.query=Wc.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var p=Fb.exec(c);if(p){p=p[0];var l=p.toLowerCase();this.protocol=l,c=c.substr(p.length)}if(r||p||c.match(/^\/\/[^@\/]+@[^@\/]+/)){var h=c.substr(0,2)==="//";h&&!(p&&Vc[p])&&(c=c.substr(2),this.slashes=!0)}if(!Vc[p]&&(h||p&&!As[p])){for(var d=-1,m=0;m<Fg.length;m++){var _=c.indexOf(Fg[m]);_!==-1&&(d===-1||_<d)&&(d=_)}var x,T;d===-1?T=c.lastIndexOf("@"):T=c.lastIndexOf("@",d),T!==-1&&(x=c.slice(0,T),c=c.slice(T+1),this.auth=decodeURIComponent(x)),d=-1;for(var m=0;m<Lg.length;m++){var _=c.indexOf(Lg[m]);_!==-1&&(d===-1||_<d)&&(d=_)}d===-1&&(d=c.length),this.host=c.slice(0,d),c=c.slice(d),this.parseHost(),this.hostname=this.hostname||"";var S=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!S)for(var w=this.hostname.split(/\./),m=0,y=w.length;m<y;m++){var E=w[m];if(E&&!E.match(Ng)){for(var R="",C=0,P=E.length;C<P;C++)E.charCodeAt(C)>127?R+="x":R+=E[C];if(!R.match(Ng)){var M=w.slice(0,m),B=w.slice(m+1),L=E.match(Vb);L&&(M.push(L[1]),B.unshift(L[2])),B.length&&(c="/"+B.join(".")+c),this.hostname=M.join(".");break}}}this.hostname.length>Hb?this.hostname="":this.hostname=this.hostname.toLowerCase(),S||(this.hostname=Lb.toASCII(this.hostname));var O=this.port?":"+this.port:"",H=this.hostname||"";this.host=H+O,this.href+=this.host,S&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),c[0]!=="/"&&(c="/"+c))}if(!Wb[l])for(var m=0,y=Hc.length;m<y;m++){var N=Hc[m];if(c.indexOf(N)!==-1){var G=encodeURIComponent(N);G===N&&(G=escape(N)),c=c.split(N).join(G)}}var Z=c.indexOf("#");Z!==-1&&(this.hash=c.substr(Z),c=c.slice(0,Z));var q=c.indexOf("?");if(q!==-1?(this.search=c.substr(q),this.query=c.substr(q+1),t&&(this.query=Wc.parse(this.query)),c=c.slice(0,q)):t&&(this.search="",this.query={}),c&&(this.pathname=c),As[l]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var O=this.pathname||"",it=this.search||"";this.path=O+it}return this.href=this.format(),this};function Xb(e){return ni.isString(e)&&(e=Wo(e)),e instanceof Br?e.format():Br.prototype.format.call(e)}Br.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",i=this.hash||"",n=!1,s="";this.host?n=e+this.host:this.hostname&&(n=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&ni.isObject(this.query)&&Object.keys(this.query).length&&(s=Wc.stringify(this.query));var a=this.search||s&&"?"+s||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||As[t])&&n!==!1?(n="//"+(n||""),r&&r.charAt(0)!=="/"&&(r="/"+r)):n||(n=""),i&&i.charAt(0)!=="#"&&(i="#"+i),a&&a.charAt(0)!=="?"&&(a="?"+a),r=r.replace(/[?#]/g,function(c){return encodeURIComponent(c)}),a=a.replace("#","%23"),t+n+r+a+i};function zb(e,t){return Wo(e,!1,!0).resolve(t)}Br.prototype.resolve=function(e){return this.resolveObject(Wo(e,!1,!0)).format()};function $b(e,t){return e?Wo(e,!1,!0).resolveObject(t):t}Br.prototype.resolveObject=function(e){if(ni.isString(e)){var t=new Br;t.parse(e,!1,!0),e=t}for(var r=new Br,i=Object.keys(this),n=0;n<i.length;n++){var s=i[n];r[s]=this[s]}if(r.hash=e.hash,e.href==="")return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var a=Object.keys(e),c=0;c<a.length;c++){var f=a[c];f!=="protocol"&&(r[f]=e[f])}return As[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!As[e.protocol]){for(var p=Object.keys(e),l=0;l<p.length;l++){var h=p[l];r[h]=e[h]}return r.href=r.format(),r}if(r.protocol=e.protocol,!e.host&&!Vc[e.protocol]){for(var y=(e.pathname||"").split("/");y.length&&!(e.host=y.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),y[0]!==""&&y.unshift(""),y.length<2&&y.unshift(""),r.pathname=y.join("/")}else r.pathname=e.pathname;if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var d=r.pathname||"",m=r.search||"";r.path=d+m}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var _=r.pathname&&r.pathname.charAt(0)==="/",x=e.host||e.pathname&&e.pathname.charAt(0)==="/",T=x||_||r.host&&e.pathname,S=T,w=r.pathname&&r.pathname.split("/")||[],y=e.pathname&&e.pathname.split("/")||[],E=r.protocol&&!As[r.protocol];if(E&&(r.hostname="",r.port=null,r.host&&(w[0]===""?w[0]=r.host:w.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(y[0]===""?y[0]=e.host:y.unshift(e.host)),e.host=null),T=T&&(y[0]===""||w[0]==="")),x)r.host=e.host||e.host===""?e.host:r.host,r.hostname=e.hostname||e.hostname===""?e.hostname:r.hostname,r.search=e.search,r.query=e.query,w=y;else if(y.length)w||(w=[]),w.pop(),w=w.concat(y),r.search=e.search,r.query=e.query;else if(!ni.isNullOrUndefined(e.search)){if(E){r.hostname=r.host=w.shift();var R=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;R&&(r.auth=R.shift(),r.host=r.hostname=R.shift())}return r.search=e.search,r.query=e.query,(!ni.isNull(r.pathname)||!ni.isNull(r.search))&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!w.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var C=w.slice(-1)[0],P=(r.host||e.host||w.length>1)&&(C==="."||C==="..")||C==="",M=0,B=w.length;B>=0;B--)C=w[B],C==="."?w.splice(B,1):C===".."?(w.splice(B,1),M++):M&&(w.splice(B,1),M--);if(!T&&!S)for(;M--;M)w.unshift("..");T&&w[0]!==""&&(!w[0]||w[0].charAt(0)!=="/")&&w.unshift(""),P&&w.join("/").substr(-1)!=="/"&&w.push("");var L=w[0]===""||w[0]&&w[0].charAt(0)==="/";if(E){r.hostname=r.host=L?"":w.length?w.shift():"";var R=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;R&&(r.auth=R.shift(),r.host=r.hostname=R.shift())}return T=T||r.host&&w.length,T&&!L&&w.unshift(""),w.length?r.pathname=w.join("/"):(r.pathname=null,r.path=null),(!ni.isNull(r.pathname)||!ni.isNull(r.search))&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r};Br.prototype.parseHost=function(){var e=this.host,t=Nb.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}});var ou=Gr((Qa,Md)=>{(function(t,r){typeof Qa=="object"&&typeof Md=="object"?Md.exports=r():typeof define=="function"&&define.amd?define("Matter",[],r):typeof Qa=="object"?Qa.Matter=r():t.Matter=r()})(Qa,function(){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(i,n,s){r.o(i,n)||Object.defineProperty(i,n,{enumerable:!0,get:s})},r.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},r.t=function(i,n){if(n&1&&(i=r(i)),n&8||n&4&&typeof i=="object"&&i&&i.__esModule)return i;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:i}),n&2&&typeof i!="string")for(var a in i)r.d(s,a,function(c){return i[c]}.bind(null,a));return s},r.n=function(i){var n=i&&i.__esModule?function(){return i.default}:function(){return i};return r.d(n,"a",n),n},r.o=function(i,n){return Object.prototype.hasOwnProperty.call(i,n)},r.p="",r(r.s=20)}([function(e,t){var r={};e.exports=r,function(){r._baseDelta=1e3/60,r._nextId=0,r._seed=0,r._nowStartTime=+new Date,r._warnedOnce={},r._decomp=null,r.extend=function(n,s){var a,c,f;typeof s=="boolean"?(a=2,f=s):(a=1,f=!0);for(var p=a;p<arguments.length;p++){var l=arguments[p];if(l)for(var h in l)f&&l[h]&&l[h].constructor===Object&&(!n[h]||n[h].constructor===Object)?(n[h]=n[h]||{},r.extend(n[h],f,l[h])):n[h]=l[h]}return n},r.clone=function(n,s){return r.extend({},s,n)},r.keys=function(n){if(Object.keys)return Object.keys(n);var s=[];for(var a in n)s.push(a);return s},r.values=function(n){var s=[];if(Object.keys){for(var a=Object.keys(n),c=0;c<a.length;c++)s.push(n[a[c]]);return s}for(var f in n)s.push(n[f]);return s},r.get=function(n,s,a,c){s=s.split(".").slice(a,c);for(var f=0;f<s.length;f+=1)n=n[s[f]];return n},r.set=function(n,s,a,c,f){var p=s.split(".").slice(c,f);return r.get(n,s,0,-1)[p[p.length-1]]=a,a},r.shuffle=function(n){for(var s=n.length-1;s>0;s--){var a=Math.floor(r.random()*(s+1)),c=n[s];n[s]=n[a],n[a]=c}return n},r.choose=function(n){return n[Math.floor(r.random()*n.length)]},r.isElement=function(n){return typeof HTMLElement<"u"?n instanceof HTMLElement:!!(n&&n.nodeType&&n.nodeName)},r.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"},r.isFunction=function(n){return typeof n=="function"},r.isPlainObject=function(n){return typeof n=="object"&&n.constructor===Object},r.isString=function(n){return toString.call(n)==="[object String]"},r.clamp=function(n,s,a){return n<s?s:n>a?a:n},r.sign=function(n){return n<0?-1:1},r.now=function(){if(typeof window<"u"&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-r._nowStartTime},r.random=function(n,s){return n=typeof n<"u"?n:0,s=typeof s<"u"?s:1,n+i()*(s-n)};var i=function(){return r._seed=(r._seed*9301+49297)%233280,r._seed/233280};r.colorToNumber=function(n){return n=n.replace("#",""),n.length==3&&(n=n.charAt(0)+n.charAt(0)+n.charAt(1)+n.charAt(1)+n.charAt(2)+n.charAt(2)),parseInt(n,16)},r.logLevel=1,r.log=function(){console&&r.logLevel>0&&r.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.info=function(){console&&r.logLevel>0&&r.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.warn=function(){console&&r.logLevel>0&&r.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.warnOnce=function(){var n=Array.prototype.slice.call(arguments).join(" ");r._warnedOnce[n]||(r.warn(n),r._warnedOnce[n]=!0)},r.deprecated=function(n,s,a){n[s]=r.chain(function(){r.warnOnce("\u{1F505} deprecated \u{1F505}",a)},n[s])},r.nextId=function(){return r._nextId++},r.indexOf=function(n,s){if(n.indexOf)return n.indexOf(s);for(var a=0;a<n.length;a++)if(n[a]===s)return a;return-1},r.map=function(n,s){if(n.map)return n.map(s);for(var a=[],c=0;c<n.length;c+=1)a.push(s(n[c]));return a},r.topologicalSort=function(n){var s=[],a=[],c=[];for(var f in n)!a[f]&&!c[f]&&r._topologicalSort(f,a,c,n,s);return s},r._topologicalSort=function(n,s,a,c,f){var p=c[n]||[];a[n]=!0;for(var l=0;l<p.length;l+=1){var h=p[l];a[h]||s[h]||r._topologicalSort(h,s,a,c,f)}a[n]=!1,s[n]=!0,f.push(n)},r.chain=function(){for(var n=[],s=0;s<arguments.length;s+=1){var a=arguments[s];a._chained?n.push.apply(n,a._chained):n.push(a)}var c=function(){for(var f,p=new Array(arguments.length),l=0,h=arguments.length;l<h;l++)p[l]=arguments[l];for(l=0;l<n.length;l+=1){var d=n[l].apply(f,p);typeof d<"u"&&(f=d)}return f};return c._chained=n,c},r.chainPathBefore=function(n,s,a){return r.set(n,s,r.chain(a,r.get(n,s)))},r.chainPathAfter=function(n,s,a){return r.set(n,s,r.chain(r.get(n,s),a))},r.setDecomp=function(n){r._decomp=n},r.getDecomp=function(){var n=r._decomp;try{!n&&typeof window<"u"&&(n=window.decomp),!n&&typeof global<"u"&&(n=global.decomp)}catch{n=null}return n}}()},function(e,t){var r={};e.exports=r,function(){r.create=function(i){var n={min:{x:0,y:0},max:{x:0,y:0}};return i&&r.update(n,i),n},r.update=function(i,n,s){i.min.x=1/0,i.max.x=-1/0,i.min.y=1/0,i.max.y=-1/0;for(var a=0;a<n.length;a++){var c=n[a];c.x>i.max.x&&(i.max.x=c.x),c.x<i.min.x&&(i.min.x=c.x),c.y>i.max.y&&(i.max.y=c.y),c.y<i.min.y&&(i.min.y=c.y)}s&&(s.x>0?i.max.x+=s.x:i.min.x+=s.x,s.y>0?i.max.y+=s.y:i.min.y+=s.y)},r.contains=function(i,n){return n.x>=i.min.x&&n.x<=i.max.x&&n.y>=i.min.y&&n.y<=i.max.y},r.overlaps=function(i,n){return i.min.x<=n.max.x&&i.max.x>=n.min.x&&i.max.y>=n.min.y&&i.min.y<=n.max.y},r.translate=function(i,n){i.min.x+=n.x,i.max.x+=n.x,i.min.y+=n.y,i.max.y+=n.y},r.shift=function(i,n){var s=i.max.x-i.min.x,a=i.max.y-i.min.y;i.min.x=n.x,i.max.x=n.x+s,i.min.y=n.y,i.max.y=n.y+a}}()},function(e,t){var r={};e.exports=r,function(){r.create=function(i,n){return{x:i||0,y:n||0}},r.clone=function(i){return{x:i.x,y:i.y}},r.magnitude=function(i){return Math.sqrt(i.x*i.x+i.y*i.y)},r.magnitudeSquared=function(i){return i.x*i.x+i.y*i.y},r.rotate=function(i,n,s){var a=Math.cos(n),c=Math.sin(n);s||(s={});var f=i.x*a-i.y*c;return s.y=i.x*c+i.y*a,s.x=f,s},r.rotateAbout=function(i,n,s,a){var c=Math.cos(n),f=Math.sin(n);a||(a={});var p=s.x+((i.x-s.x)*c-(i.y-s.y)*f);return a.y=s.y+((i.x-s.x)*f+(i.y-s.y)*c),a.x=p,a},r.normalise=function(i){var n=r.magnitude(i);return n===0?{x:0,y:0}:{x:i.x/n,y:i.y/n}},r.dot=function(i,n){return i.x*n.x+i.y*n.y},r.cross=function(i,n){return i.x*n.y-i.y*n.x},r.cross3=function(i,n,s){return(n.x-i.x)*(s.y-i.y)-(n.y-i.y)*(s.x-i.x)},r.add=function(i,n,s){return s||(s={}),s.x=i.x+n.x,s.y=i.y+n.y,s},r.sub=function(i,n,s){return s||(s={}),s.x=i.x-n.x,s.y=i.y-n.y,s},r.mult=function(i,n){return{x:i.x*n,y:i.y*n}},r.div=function(i,n){return{x:i.x/n,y:i.y/n}},r.perp=function(i,n){return n=n===!0?-1:1,{x:n*-i.y,y:n*i.x}},r.neg=function(i){return{x:-i.x,y:-i.y}},r.angle=function(i,n){return Math.atan2(n.y-i.y,n.x-i.x)},r._temp=[r.create(),r.create(),r.create(),r.create(),r.create(),r.create()]}()},function(e,t,r){var i={};e.exports=i;var n=r(2),s=r(0);(function(){i.create=function(a,c){for(var f=[],p=0;p<a.length;p++){var l=a[p],h={x:l.x,y:l.y,index:p,body:c,isInternal:!1};f.push(h)}return f},i.fromPath=function(a,c){var f=/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/ig,p=[];return a.replace(f,function(l,h,d){p.push({x:parseFloat(h),y:parseFloat(d)})}),i.create(p,c)},i.centre=function(a){for(var c=i.area(a,!0),f={x:0,y:0},p,l,h,d=0;d<a.length;d++)h=(d+1)%a.length,p=n.cross(a[d],a[h]),l=n.mult(n.add(a[d],a[h]),p),f=n.add(f,l);return n.div(f,6*c)},i.mean=function(a){for(var c={x:0,y:0},f=0;f<a.length;f++)c.x+=a[f].x,c.y+=a[f].y;return n.div(c,a.length)},i.area=function(a,c){for(var f=0,p=a.length-1,l=0;l<a.length;l++)f+=(a[p].x-a[l].x)*(a[p].y+a[l].y),p=l;return c?f/2:Math.abs(f)/2},i.inertia=function(a,c){for(var f=0,p=0,l=a,h,d,m=0;m<l.length;m++)d=(m+1)%l.length,h=Math.abs(n.cross(l[d],l[m])),f+=h*(n.dot(l[d],l[d])+n.dot(l[d],l[m])+n.dot(l[m],l[m])),p+=h;return c/6*(f/p)},i.translate=function(a,c,f){f=typeof f<"u"?f:1;var p=a.length,l=c.x*f,h=c.y*f,d;for(d=0;d<p;d++)a[d].x+=l,a[d].y+=h;return a},i.rotate=function(a,c,f){if(c!==0){var p=Math.cos(c),l=Math.sin(c),h=f.x,d=f.y,m=a.length,_,x,T,S;for(S=0;S<m;S++)_=a[S],x=_.x-h,T=_.y-d,_.x=h+(x*p-T*l),_.y=d+(x*l+T*p);return a}},i.contains=function(a,c){for(var f=c.x,p=c.y,l=a.length,h=a[l-1],d,m=0;m<l;m++){if(d=a[m],(f-h.x)*(d.y-h.y)+(p-h.y)*(h.x-d.x)>0)return!1;h=d}return!0},i.scale=function(a,c,f,p){if(c===1&&f===1)return a;p=p||i.centre(a);for(var l,h,d=0;d<a.length;d++)l=a[d],h=n.sub(l,p),a[d].x=p.x+h.x*c,a[d].y=p.y+h.y*f;return a},i.chamfer=function(a,c,f,p,l){typeof c=="number"?c=[c]:c=c||[8],f=typeof f<"u"?f:-1,p=p||2,l=l||14;for(var h=[],d=0;d<a.length;d++){var m=a[d-1>=0?d-1:a.length-1],_=a[d],x=a[(d+1)%a.length],T=c[d<c.length?d:c.length-1];if(T===0){h.push(_);continue}var S=n.normalise({x:_.y-m.y,y:m.x-_.x}),w=n.normalise({x:x.y-_.y,y:_.x-x.x}),y=Math.sqrt(2*Math.pow(T,2)),E=n.mult(s.clone(S),T),R=n.normalise(n.mult(n.add(S,w),.5)),C=n.sub(_,n.mult(R,y)),P=f;f===-1&&(P=Math.pow(T,.32)*1.75),P=s.clamp(P,p,l),P%2===1&&(P+=1);for(var M=Math.acos(n.dot(S,w)),B=M/P,L=0;L<P;L++)h.push(n.add(n.rotate(E,B*L),C))}return h},i.clockwiseSort=function(a){var c=i.mean(a);return a.sort(function(f,p){return n.angle(c,f)-n.angle(c,p)}),a},i.isConvex=function(a){var c=0,f=a.length,p,l,h,d;if(f<3)return null;for(p=0;p<f;p++)if(l=(p+1)%f,h=(p+2)%f,d=(a[l].x-a[p].x)*(a[h].y-a[l].y),d-=(a[l].y-a[p].y)*(a[h].x-a[l].x),d<0?c|=1:d>0&&(c|=2),c===3)return!1;return c!==0?!0:null},i.hull=function(a){var c=[],f=[],p,l;for(a=a.slice(0),a.sort(function(h,d){var m=h.x-d.x;return m!==0?m:h.y-d.y}),l=0;l<a.length;l+=1){for(p=a[l];f.length>=2&&n.cross3(f[f.length-2],f[f.length-1],p)<=0;)f.pop();f.push(p)}for(l=a.length-1;l>=0;l-=1){for(p=a[l];c.length>=2&&n.cross3(c[c.length-2],c[c.length-1],p)<=0;)c.pop();c.push(p)}return c.pop(),f.pop(),c.concat(f)}})()},function(e,t,r){var i={};e.exports=i;var n=r(3),s=r(2),a=r(7),c=r(0),f=r(1),p=r(11);(function(){i._timeCorrection=!0,i._inertiaScale=4,i._nextCollidingGroupId=1,i._nextNonCollidingGroupId=-1,i._nextCategory=1,i._baseDelta=1e3/60,i.create=function(h){var d={id:c.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:n.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,deltaTime:16.666666666666668,_original:null},m=c.extend(d,h);return l(m,h),m},i.nextGroup=function(h){return h?i._nextNonCollidingGroupId--:i._nextCollidingGroupId++},i.nextCategory=function(){return i._nextCategory=i._nextCategory<<1,i._nextCategory};var l=function(h,d){d=d||{},i.set(h,{bounds:h.bounds||f.create(h.vertices),positionPrev:h.positionPrev||s.clone(h.position),anglePrev:h.anglePrev||h.angle,vertices:h.vertices,parts:h.parts||[h],isStatic:h.isStatic,isSleeping:h.isSleeping,parent:h.parent||h}),n.rotate(h.vertices,h.angle,h.position),p.rotate(h.axes,h.angle),f.update(h.bounds,h.vertices,h.velocity),i.set(h,{axes:d.axes||h.axes,area:d.area||h.area,mass:d.mass||h.mass,inertia:d.inertia||h.inertia});var m=h.isStatic?"#14151f":c.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),_=h.isStatic?"#555":"#ccc",x=h.isStatic&&h.render.fillStyle===null?1:0;h.render.fillStyle=h.render.fillStyle||m,h.render.strokeStyle=h.render.strokeStyle||_,h.render.lineWidth=h.render.lineWidth||x,h.render.sprite.xOffset+=-(h.bounds.min.x-h.position.x)/(h.bounds.max.x-h.bounds.min.x),h.render.sprite.yOffset+=-(h.bounds.min.y-h.position.y)/(h.bounds.max.y-h.bounds.min.y)};i.set=function(h,d,m){var _;typeof d=="string"&&(_=d,d={},d[_]=m);for(_ in d)if(Object.prototype.hasOwnProperty.call(d,_))switch(m=d[_],_){case"isStatic":i.setStatic(h,m);break;case"isSleeping":a.set(h,m);break;case"mass":i.setMass(h,m);break;case"density":i.setDensity(h,m);break;case"inertia":i.setInertia(h,m);break;case"vertices":i.setVertices(h,m);break;case"position":i.setPosition(h,m);break;case"angle":i.setAngle(h,m);break;case"velocity":i.setVelocity(h,m);break;case"angularVelocity":i.setAngularVelocity(h,m);break;case"speed":i.setSpeed(h,m);break;case"angularSpeed":i.setAngularSpeed(h,m);break;case"parts":i.setParts(h,m);break;case"centre":i.setCentre(h,m);break;default:h[_]=m}},i.setStatic=function(h,d){for(var m=0;m<h.parts.length;m++){var _=h.parts[m];_.isStatic=d,d?(_._original={restitution:_.restitution,friction:_.friction,mass:_.mass,inertia:_.inertia,density:_.density,inverseMass:_.inverseMass,inverseInertia:_.inverseInertia},_.restitution=0,_.friction=1,_.mass=_.inertia=_.density=1/0,_.inverseMass=_.inverseInertia=0,_.positionPrev.x=_.position.x,_.positionPrev.y=_.position.y,_.anglePrev=_.angle,_.angularVelocity=0,_.speed=0,_.angularSpeed=0,_.motion=0):_._original&&(_.restitution=_._original.restitution,_.friction=_._original.friction,_.mass=_._original.mass,_.inertia=_._original.inertia,_.density=_._original.density,_.inverseMass=_._original.inverseMass,_.inverseInertia=_._original.inverseInertia,_._original=null)}},i.setMass=function(h,d){var m=h.inertia/(h.mass/6);h.inertia=m*(d/6),h.inverseInertia=1/h.inertia,h.mass=d,h.inverseMass=1/h.mass,h.density=h.mass/h.area},i.setDensity=function(h,d){i.setMass(h,d*h.area),h.density=d},i.setInertia=function(h,d){h.inertia=d,h.inverseInertia=1/h.inertia},i.setVertices=function(h,d){d[0].body===h?h.vertices=d:h.vertices=n.create(d,h),h.axes=p.fromVertices(h.vertices),h.area=n.area(h.vertices),i.setMass(h,h.density*h.area);var m=n.centre(h.vertices);n.translate(h.vertices,m,-1),i.setInertia(h,i._inertiaScale*n.inertia(h.vertices,h.mass)),n.translate(h.vertices,h.position),f.update(h.bounds,h.vertices,h.velocity)},i.setParts=function(h,d,m){var _;for(d=d.slice(0),h.parts.length=0,h.parts.push(h),h.parent=h,_=0;_<d.length;_++){var x=d[_];x!==h&&(x.parent=h,h.parts.push(x))}if(h.parts.length!==1){if(m=typeof m<"u"?m:!0,m){var T=[];for(_=0;_<d.length;_++)T=T.concat(d[_].vertices);n.clockwiseSort(T);var S=n.hull(T),w=n.centre(S);i.setVertices(h,S),n.translate(h.vertices,w)}var y=i._totalProperties(h);h.area=y.area,h.parent=h,h.position.x=y.centre.x,h.position.y=y.centre.y,h.positionPrev.x=y.centre.x,h.positionPrev.y=y.centre.y,i.setMass(h,y.mass),i.setInertia(h,y.inertia),i.setPosition(h,y.centre)}},i.setCentre=function(h,d,m){m?(h.positionPrev.x+=d.x,h.positionPrev.y+=d.y,h.position.x+=d.x,h.position.y+=d.y):(h.positionPrev.x=d.x-(h.position.x-h.positionPrev.x),h.positionPrev.y=d.y-(h.position.y-h.positionPrev.y),h.position.x=d.x,h.position.y=d.y)},i.setPosition=function(h,d,m){var _=s.sub(d,h.position);m?(h.positionPrev.x=h.position.x,h.positionPrev.y=h.position.y,h.velocity.x=_.x,h.velocity.y=_.y,h.speed=s.magnitude(_)):(h.positionPrev.x+=_.x,h.positionPrev.y+=_.y);for(var x=0;x<h.parts.length;x++){var T=h.parts[x];T.position.x+=_.x,T.position.y+=_.y,n.translate(T.vertices,_),f.update(T.bounds,T.vertices,h.velocity)}},i.setAngle=function(h,d,m){var _=d-h.angle;m?(h.anglePrev=h.angle,h.angularVelocity=_,h.angularSpeed=Math.abs(_)):h.anglePrev+=_;for(var x=0;x<h.parts.length;x++){var T=h.parts[x];T.angle+=_,n.rotate(T.vertices,_,h.position),p.rotate(T.axes,_),f.update(T.bounds,T.vertices,h.velocity),x>0&&s.rotateAbout(T.position,_,h.position,T.position)}},i.setVelocity=function(h,d){var m=h.deltaTime/i._baseDelta;h.positionPrev.x=h.position.x-d.x*m,h.positionPrev.y=h.position.y-d.y*m,h.velocity.x=(h.position.x-h.positionPrev.x)/m,h.velocity.y=(h.position.y-h.positionPrev.y)/m,h.speed=s.magnitude(h.velocity)},i.getVelocity=function(h){var d=i._baseDelta/h.deltaTime;return{x:(h.position.x-h.positionPrev.x)*d,y:(h.position.y-h.positionPrev.y)*d}},i.getSpeed=function(h){return s.magnitude(i.getVelocity(h))},i.setSpeed=function(h,d){i.setVelocity(h,s.mult(s.normalise(i.getVelocity(h)),d))},i.setAngularVelocity=function(h,d){var m=h.deltaTime/i._baseDelta;h.anglePrev=h.angle-d*m,h.angularVelocity=(h.angle-h.anglePrev)/m,h.angularSpeed=Math.abs(h.angularVelocity)},i.getAngularVelocity=function(h){return(h.angle-h.anglePrev)*i._baseDelta/h.deltaTime},i.getAngularSpeed=function(h){return Math.abs(i.getAngularVelocity(h))},i.setAngularSpeed=function(h,d){i.setAngularVelocity(h,c.sign(i.getAngularVelocity(h))*d)},i.translate=function(h,d,m){i.setPosition(h,s.add(h.position,d),m)},i.rotate=function(h,d,m,_){if(!m)i.setAngle(h,h.angle+d,_);else{var x=Math.cos(d),T=Math.sin(d),S=h.position.x-m.x,w=h.position.y-m.y;i.setPosition(h,{x:m.x+(S*x-w*T),y:m.y+(S*T+w*x)},_),i.setAngle(h,h.angle+d,_)}},i.scale=function(h,d,m,_){var x=0,T=0;_=_||h.position;for(var S=0;S<h.parts.length;S++){var w=h.parts[S];n.scale(w.vertices,d,m,_),w.axes=p.fromVertices(w.vertices),w.area=n.area(w.vertices),i.setMass(w,h.density*w.area),n.translate(w.vertices,{x:-w.position.x,y:-w.position.y}),i.setInertia(w,i._inertiaScale*n.inertia(w.vertices,w.mass)),n.translate(w.vertices,{x:w.position.x,y:w.position.y}),S>0&&(x+=w.area,T+=w.inertia),w.position.x=_.x+(w.position.x-_.x)*d,w.position.y=_.y+(w.position.y-_.y)*m,f.update(w.bounds,w.vertices,h.velocity)}h.parts.length>1&&(h.area=x,h.isStatic||(i.setMass(h,h.density*x),i.setInertia(h,T))),h.circleRadius&&(d===m?h.circleRadius*=d:h.circleRadius=null)},i.update=function(h,d){d=(typeof d<"u"?d:1e3/60)*h.timeScale;var m=d*d,_=i._timeCorrection?d/(h.deltaTime||d):1,x=1-h.frictionAir*(d/c._baseDelta),T=(h.position.x-h.positionPrev.x)*_,S=(h.position.y-h.positionPrev.y)*_;h.velocity.x=T*x+h.force.x/h.mass*m,h.velocity.y=S*x+h.force.y/h.mass*m,h.positionPrev.x=h.position.x,h.positionPrev.y=h.position.y,h.position.x+=h.velocity.x,h.position.y+=h.velocity.y,h.deltaTime=d,h.angularVelocity=(h.angle-h.anglePrev)*x*_+h.torque/h.inertia*m,h.anglePrev=h.angle,h.angle+=h.angularVelocity;for(var w=0;w<h.parts.length;w++){var y=h.parts[w];n.translate(y.vertices,h.velocity),w>0&&(y.position.x+=h.velocity.x,y.position.y+=h.velocity.y),h.angularVelocity!==0&&(n.rotate(y.vertices,h.angularVelocity,h.position),p.rotate(y.axes,h.angularVelocity),w>0&&s.rotateAbout(y.position,h.angularVelocity,h.position,y.position)),f.update(y.bounds,y.vertices,h.velocity)}},i.updateVelocities=function(h){var d=i._baseDelta/h.deltaTime,m=h.velocity;m.x=(h.position.x-h.positionPrev.x)*d,m.y=(h.position.y-h.positionPrev.y)*d,h.speed=Math.sqrt(m.x*m.x+m.y*m.y),h.angularVelocity=(h.angle-h.anglePrev)*d,h.angularSpeed=Math.abs(h.angularVelocity)},i.applyForce=function(h,d,m){var _={x:d.x-h.position.x,y:d.y-h.position.y};h.force.x+=m.x,h.force.y+=m.y,h.torque+=_.x*m.y-_.y*m.x},i._totalProperties=function(h){for(var d={mass:0,area:0,inertia:0,centre:{x:0,y:0}},m=h.parts.length===1?0:1;m<h.parts.length;m++){var _=h.parts[m],x=_.mass!==1/0?_.mass:1;d.mass+=x,d.area+=_.area,d.inertia+=_.inertia,d.centre=s.add(d.centre,s.mult(_.position,x))}return d.centre=s.div(d.centre,d.mass),d}})()},function(e,t,r){var i={};e.exports=i;var n=r(0);(function(){i.on=function(s,a,c){for(var f=a.split(" "),p,l=0;l<f.length;l++)p=f[l],s.events=s.events||{},s.events[p]=s.events[p]||[],s.events[p].push(c);return c},i.off=function(s,a,c){if(!a){s.events={};return}typeof a=="function"&&(c=a,a=n.keys(s.events).join(" "));for(var f=a.split(" "),p=0;p<f.length;p++){var l=s.events[f[p]],h=[];if(c&&l)for(var d=0;d<l.length;d++)l[d]!==c&&h.push(l[d]);s.events[f[p]]=h}},i.trigger=function(s,a,c){var f,p,l,h,d=s.events;if(d&&n.keys(d).length>0){c||(c={}),f=a.split(" ");for(var m=0;m<f.length;m++)if(p=f[m],l=d[p],l){h=n.clone(c,!1),h.name=p,h.source=s;for(var _=0;_<l.length;_++)l[_].apply(s,[h])}}}})()},function(e,t,r){var i={};e.exports=i;var n=r(5),s=r(0),a=r(1),c=r(4);(function(){i.create=function(f){return s.extend({id:s.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},f)},i.setModified=function(f,p,l,h){if(f.isModified=p,p&&f.cache&&(f.cache.allBodies=null,f.cache.allConstraints=null,f.cache.allComposites=null),l&&f.parent&&i.setModified(f.parent,p,l,h),h)for(var d=0;d<f.composites.length;d++){var m=f.composites[d];i.setModified(m,p,l,h)}},i.add=function(f,p){var l=[].concat(p);n.trigger(f,"beforeAdd",{object:p});for(var h=0;h<l.length;h++){var d=l[h];switch(d.type){case"body":if(d.parent!==d){s.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}i.addBody(f,d);break;case"constraint":i.addConstraint(f,d);break;case"composite":i.addComposite(f,d);break;case"mouseConstraint":i.addConstraint(f,d.constraint);break}}return n.trigger(f,"afterAdd",{object:p}),f},i.remove=function(f,p,l){var h=[].concat(p);n.trigger(f,"beforeRemove",{object:p});for(var d=0;d<h.length;d++){var m=h[d];switch(m.type){case"body":i.removeBody(f,m,l);break;case"constraint":i.removeConstraint(f,m,l);break;case"composite":i.removeComposite(f,m,l);break;case"mouseConstraint":i.removeConstraint(f,m.constraint);break}}return n.trigger(f,"afterRemove",{object:p}),f},i.addComposite=function(f,p){return f.composites.push(p),p.parent=f,i.setModified(f,!0,!0,!1),f},i.removeComposite=function(f,p,l){var h=s.indexOf(f.composites,p);if(h!==-1&&i.removeCompositeAt(f,h),l)for(var d=0;d<f.composites.length;d++)i.removeComposite(f.composites[d],p,!0);return f},i.removeCompositeAt=function(f,p){return f.composites.splice(p,1),i.setModified(f,!0,!0,!1),f},i.addBody=function(f,p){return f.bodies.push(p),i.setModified(f,!0,!0,!1),f},i.removeBody=function(f,p,l){var h=s.indexOf(f.bodies,p);if(h!==-1&&i.removeBodyAt(f,h),l)for(var d=0;d<f.composites.length;d++)i.removeBody(f.composites[d],p,!0);return f},i.removeBodyAt=function(f,p){return f.bodies.splice(p,1),i.setModified(f,!0,!0,!1),f},i.addConstraint=function(f,p){return f.constraints.push(p),i.setModified(f,!0,!0,!1),f},i.removeConstraint=function(f,p,l){var h=s.indexOf(f.constraints,p);if(h!==-1&&i.removeConstraintAt(f,h),l)for(var d=0;d<f.composites.length;d++)i.removeConstraint(f.composites[d],p,!0);return f},i.removeConstraintAt=function(f,p){return f.constraints.splice(p,1),i.setModified(f,!0,!0,!1),f},i.clear=function(f,p,l){if(l)for(var h=0;h<f.composites.length;h++)i.clear(f.composites[h],p,!0);return p?f.bodies=f.bodies.filter(function(d){return d.isStatic}):f.bodies.length=0,f.constraints.length=0,f.composites.length=0,i.setModified(f,!0,!0,!1),f},i.allBodies=function(f){if(f.cache&&f.cache.allBodies)return f.cache.allBodies;for(var p=[].concat(f.bodies),l=0;l<f.composites.length;l++)p=p.concat(i.allBodies(f.composites[l]));return f.cache&&(f.cache.allBodies=p),p},i.allConstraints=function(f){if(f.cache&&f.cache.allConstraints)return f.cache.allConstraints;for(var p=[].concat(f.constraints),l=0;l<f.composites.length;l++)p=p.concat(i.allConstraints(f.composites[l]));return f.cache&&(f.cache.allConstraints=p),p},i.allComposites=function(f){if(f.cache&&f.cache.allComposites)return f.cache.allComposites;for(var p=[].concat(f.composites),l=0;l<f.composites.length;l++)p=p.concat(i.allComposites(f.composites[l]));return f.cache&&(f.cache.allComposites=p),p},i.get=function(f,p,l){var h,d;switch(l){case"body":h=i.allBodies(f);break;case"constraint":h=i.allConstraints(f);break;case"composite":h=i.allComposites(f).concat(f);break}return h?(d=h.filter(function(m){return m.id.toString()===p.toString()}),d.length===0?null:d[0]):null},i.move=function(f,p,l){return i.remove(f,p),i.add(l,p),f},i.rebase=function(f){for(var p=i.allBodies(f).concat(i.allConstraints(f)).concat(i.allComposites(f)),l=0;l<p.length;l++)p[l].id=s.nextId();return f},i.translate=function(f,p,l){for(var h=l?i.allBodies(f):f.bodies,d=0;d<h.length;d++)c.translate(h[d],p);return f},i.rotate=function(f,p,l,h){for(var d=Math.cos(p),m=Math.sin(p),_=h?i.allBodies(f):f.bodies,x=0;x<_.length;x++){var T=_[x],S=T.position.x-l.x,w=T.position.y-l.y;c.setPosition(T,{x:l.x+(S*d-w*m),y:l.y+(S*m+w*d)}),c.rotate(T,p)}return f},i.scale=function(f,p,l,h,d){for(var m=d?i.allBodies(f):f.bodies,_=0;_<m.length;_++){var x=m[_],T=x.position.x-h.x,S=x.position.y-h.y;c.setPosition(x,{x:h.x+T*p,y:h.y+S*l}),c.scale(x,p,l)}return f},i.bounds=function(f){for(var p=i.allBodies(f),l=[],h=0;h<p.length;h+=1){var d=p[h];l.push(d.bounds.min,d.bounds.max)}return a.create(l)}})()},function(e,t,r){var i={};e.exports=i;var n=r(4),s=r(5),a=r(0);(function(){i._motionWakeThreshold=.18,i._motionSleepThreshold=.08,i._minBias=.9,i.update=function(c,f){for(var p=f/a._baseDelta,l=i._motionSleepThreshold,h=0;h<c.length;h++){var d=c[h],m=n.getSpeed(d),_=n.getAngularSpeed(d),x=m*m+_*_;if(d.force.x!==0||d.force.y!==0){i.set(d,!1);continue}var T=Math.min(d.motion,x),S=Math.max(d.motion,x);d.motion=i._minBias*T+(1-i._minBias)*S,d.sleepThreshold>0&&d.motion<l?(d.sleepCounter+=1,d.sleepCounter>=d.sleepThreshold/p&&i.set(d,!0)):d.sleepCounter>0&&(d.sleepCounter-=1)}},i.afterCollisions=function(c){for(var f=i._motionSleepThreshold,p=0;p<c.length;p++){var l=c[p];if(l.isActive){var h=l.collision,d=h.bodyA.parent,m=h.bodyB.parent;if(!(d.isSleeping&&m.isSleeping||d.isStatic||m.isStatic)&&(d.isSleeping||m.isSleeping)){var _=d.isSleeping&&!d.isStatic?d:m,x=_===d?m:d;!_.isStatic&&x.motion>f&&i.set(_,!1)}}}},i.set=function(c,f){var p=c.isSleeping;f?(c.isSleeping=!0,c.sleepCounter=c.sleepThreshold,c.positionImpulse.x=0,c.positionImpulse.y=0,c.positionPrev.x=c.position.x,c.positionPrev.y=c.position.y,c.anglePrev=c.angle,c.speed=0,c.angularSpeed=0,c.motion=0,p||s.trigger(c,"sleepStart")):(c.isSleeping=!1,c.sleepCounter=0,p&&s.trigger(c,"sleepEnd"))}})()},function(e,t,r){var i={};e.exports=i;var n=r(3),s=r(9);(function(){var a=[],c={overlap:0,axis:null},f={overlap:0,axis:null};i.create=function(p,l){return{pair:null,collided:!1,bodyA:p,bodyB:l,parentA:p.parent,parentB:l.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[]}},i.collides=function(p,l,h){if(i._overlapAxes(c,p.vertices,l.vertices,p.axes),c.overlap<=0||(i._overlapAxes(f,l.vertices,p.vertices,l.axes),f.overlap<=0))return null;var d=h&&h.table[s.id(p,l)],m;d?m=d.collision:(m=i.create(p,l),m.collided=!0,m.bodyA=p.id<l.id?p:l,m.bodyB=p.id<l.id?l:p,m.parentA=m.bodyA.parent,m.parentB=m.bodyB.parent),p=m.bodyA,l=m.bodyB;var _;c.overlap<f.overlap?_=c:_=f;var x=m.normal,T=m.supports,S=_.axis,w=S.x,y=S.y;w*(l.position.x-p.position.x)+y*(l.position.y-p.position.y)<0?(x.x=w,x.y=y):(x.x=-w,x.y=-y),m.tangent.x=-x.y,m.tangent.y=x.x,m.depth=_.overlap,m.penetration.x=x.x*m.depth,m.penetration.y=x.y*m.depth;var E=i._findSupports(p,l,x,1),R=0;if(n.contains(p.vertices,E[0])&&(T[R++]=E[0]),n.contains(p.vertices,E[1])&&(T[R++]=E[1]),R<2){var C=i._findSupports(l,p,x,-1);n.contains(l.vertices,C[0])&&(T[R++]=C[0]),R<2&&n.contains(l.vertices,C[1])&&(T[R++]=C[1])}return R===0&&(T[R++]=E[0]),T.length=R,m},i._overlapAxes=function(p,l,h,d){var m=l.length,_=h.length,x=l[0].x,T=l[0].y,S=h[0].x,w=h[0].y,y=d.length,E=Number.MAX_VALUE,R=0,C,P,M,B,L,O;for(L=0;L<y;L++){var H=d[L],N=H.x,G=H.y,Z=x*N+T*G,q=S*N+w*G,it=Z,Y=q;for(O=1;O<m;O+=1)B=l[O].x*N+l[O].y*G,B>it?it=B:B<Z&&(Z=B);for(O=1;O<_;O+=1)B=h[O].x*N+h[O].y*G,B>Y?Y=B:B<q&&(q=B);if(P=it-q,M=Y-Z,C=P<M?P:M,C<E&&(E=C,R=L,C<=0))break}p.axis=d[R],p.overlap=E},i._projectToAxis=function(p,l,h){for(var d=l[0].x*h.x+l[0].y*h.y,m=d,_=1;_<l.length;_+=1){var x=l[_].x*h.x+l[_].y*h.y;x>m?m=x:x<d&&(d=x)}p.min=d,p.max=m},i._findSupports=function(p,l,h,d){var m=l.vertices,_=m.length,x=p.position.x,T=p.position.y,S=h.x*d,w=h.y*d,y=Number.MAX_VALUE,E,R,C,P,M;for(M=0;M<_;M+=1)R=m[M],P=S*(x-R.x)+w*(T-R.y),P<y&&(y=P,E=R);return C=m[(_+E.index-1)%_],y=S*(x-C.x)+w*(T-C.y),R=m[(E.index+1)%_],S*(x-R.x)+w*(T-R.y)<y?(a[0]=E,a[1]=R,a):(a[0]=E,a[1]=C,a)}})()},function(e,t,r){var i={};e.exports=i;var n=r(16);(function(){i.create=function(s,a){var c=s.bodyA,f=s.bodyB,p={id:i.id(c,f),bodyA:c,bodyB:f,collision:s,contacts:[],activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:c.isSensor||f.isSensor,timeCreated:a,timeUpdated:a,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return i.update(p,s,a),p},i.update=function(s,a,c){var f=s.contacts,p=a.supports,l=s.activeContacts,h=a.parentA,d=a.parentB,m=h.vertices.length;s.isActive=!0,s.timeUpdated=c,s.collision=a,s.separation=a.depth,s.inverseMass=h.inverseMass+d.inverseMass,s.friction=h.friction<d.friction?h.friction:d.friction,s.frictionStatic=h.frictionStatic>d.frictionStatic?h.frictionStatic:d.frictionStatic,s.restitution=h.restitution>d.restitution?h.restitution:d.restitution,s.slop=h.slop>d.slop?h.slop:d.slop,a.pair=s,l.length=0;for(var _=0;_<p.length;_++){var x=p[_],T=x.body===h?x.index:m+x.index,S=f[T];S?l.push(S):l.push(f[T]=n.create(x))}},i.setActive=function(s,a,c){a?(s.isActive=!0,s.timeUpdated=c):(s.isActive=!1,s.activeContacts.length=0)},i.id=function(s,a){return s.id<a.id?"A"+s.id+"B"+a.id:"A"+a.id+"B"+s.id}})()},function(e,t,r){var i={};e.exports=i;var n=r(3),s=r(2),a=r(7),c=r(1),f=r(11),p=r(0);(function(){i._warming=.4,i._torqueDampen=1,i._minLength=1e-6,i.create=function(l){var h=l;h.bodyA&&!h.pointA&&(h.pointA={x:0,y:0}),h.bodyB&&!h.pointB&&(h.pointB={x:0,y:0});var d=h.bodyA?s.add(h.bodyA.position,h.pointA):h.pointA,m=h.bodyB?s.add(h.bodyB.position,h.pointB):h.pointB,_=s.magnitude(s.sub(d,m));h.length=typeof h.length<"u"?h.length:_,h.id=h.id||p.nextId(),h.label=h.label||"Constraint",h.type="constraint",h.stiffness=h.stiffness||(h.length>0?1:.7),h.damping=h.damping||0,h.angularStiffness=h.angularStiffness||0,h.angleA=h.bodyA?h.bodyA.angle:h.angleA,h.angleB=h.bodyB?h.bodyB.angle:h.angleB,h.plugin={};var x={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return h.length===0&&h.stiffness>.1?(x.type="pin",x.anchors=!1):h.stiffness<.9&&(x.type="spring"),h.render=p.extend(x,h.render),h},i.preSolveAll=function(l){for(var h=0;h<l.length;h+=1){var d=l[h],m=d.constraintImpulse;d.isStatic||m.x===0&&m.y===0&&m.angle===0||(d.position.x+=m.x,d.position.y+=m.y,d.angle+=m.angle)}},i.solveAll=function(l,h){for(var d=p.clamp(h/p._baseDelta,0,1),m=0;m<l.length;m+=1){var _=l[m],x=!_.bodyA||_.bodyA&&_.bodyA.isStatic,T=!_.bodyB||_.bodyB&&_.bodyB.isStatic;(x||T)&&i.solve(l[m],d)}for(m=0;m<l.length;m+=1)_=l[m],x=!_.bodyA||_.bodyA&&_.bodyA.isStatic,T=!_.bodyB||_.bodyB&&_.bodyB.isStatic,!x&&!T&&i.solve(l[m],d)},i.solve=function(l,h){var d=l.bodyA,m=l.bodyB,_=l.pointA,x=l.pointB;if(!(!d&&!m)){d&&!d.isStatic&&(s.rotate(_,d.angle-l.angleA,_),l.angleA=d.angle),m&&!m.isStatic&&(s.rotate(x,m.angle-l.angleB,x),l.angleB=m.angle);var T=_,S=x;if(d&&(T=s.add(d.position,_)),m&&(S=s.add(m.position,x)),!(!T||!S)){var w=s.sub(T,S),y=s.magnitude(w);y<i._minLength&&(y=i._minLength);var E=(y-l.length)/y,R=l.stiffness>=1||l.length===0,C=R?l.stiffness*h:l.stiffness*h*h,P=l.damping*h,M=s.mult(w,E*C),B=(d?d.inverseMass:0)+(m?m.inverseMass:0),L=(d?d.inverseInertia:0)+(m?m.inverseInertia:0),O=B+L,H,N,G,Z,q;if(P>0){var it=s.create();G=s.div(w,y),q=s.sub(m&&s.sub(m.position,m.positionPrev)||it,d&&s.sub(d.position,d.positionPrev)||it),Z=s.dot(G,q)}d&&!d.isStatic&&(N=d.inverseMass/B,d.constraintImpulse.x-=M.x*N,d.constraintImpulse.y-=M.y*N,d.position.x-=M.x*N,d.position.y-=M.y*N,P>0&&(d.positionPrev.x-=P*G.x*Z*N,d.positionPrev.y-=P*G.y*Z*N),H=s.cross(_,M)/O*i._torqueDampen*d.inverseInertia*(1-l.angularStiffness),d.constraintImpulse.angle-=H,d.angle-=H),m&&!m.isStatic&&(N=m.inverseMass/B,m.constraintImpulse.x+=M.x*N,m.constraintImpulse.y+=M.y*N,m.position.x+=M.x*N,m.position.y+=M.y*N,P>0&&(m.positionPrev.x+=P*G.x*Z*N,m.positionPrev.y+=P*G.y*Z*N),H=s.cross(x,M)/O*i._torqueDampen*m.inverseInertia*(1-l.angularStiffness),m.constraintImpulse.angle+=H,m.angle+=H)}}},i.postSolveAll=function(l){for(var h=0;h<l.length;h++){var d=l[h],m=d.constraintImpulse;if(!(d.isStatic||m.x===0&&m.y===0&&m.angle===0)){a.set(d,!1);for(var _=0;_<d.parts.length;_++){var x=d.parts[_];n.translate(x.vertices,m),_>0&&(x.position.x+=m.x,x.position.y+=m.y),m.angle!==0&&(n.rotate(x.vertices,m.angle,d.position),f.rotate(x.axes,m.angle),_>0&&s.rotateAbout(x.position,m.angle,d.position,x.position)),c.update(x.bounds,x.vertices,d.velocity)}m.angle*=i._warming,m.x*=i._warming,m.y*=i._warming}}},i.pointAWorld=function(l){return{x:(l.bodyA?l.bodyA.position.x:0)+(l.pointA?l.pointA.x:0),y:(l.bodyA?l.bodyA.position.y:0)+(l.pointA?l.pointA.y:0)}},i.pointBWorld=function(l){return{x:(l.bodyB?l.bodyB.position.x:0)+(l.pointB?l.pointB.x:0),y:(l.bodyB?l.bodyB.position.y:0)+(l.pointB?l.pointB.y:0)}}})()},function(e,t,r){var i={};e.exports=i;var n=r(2),s=r(0);(function(){i.fromVertices=function(a){for(var c={},f=0;f<a.length;f++){var p=(f+1)%a.length,l=n.normalise({x:a[p].y-a[f].y,y:a[f].x-a[p].x}),h=l.y===0?1/0:l.x/l.y;h=h.toFixed(3).toString(),c[h]=l}return s.values(c)},i.rotate=function(a,c){if(c!==0)for(var f=Math.cos(c),p=Math.sin(c),l=0;l<a.length;l++){var h=a[l],d;d=h.x*f-h.y*p,h.y=h.x*p+h.y*f,h.x=d}}})()},function(e,t,r){var i={};e.exports=i;var n=r(3),s=r(0),a=r(4),c=r(1),f=r(2);(function(){i.rectangle=function(p,l,h,d,m){m=m||{};var _={label:"Rectangle Body",position:{x:p,y:l},vertices:n.fromPath("L 0 0 L "+h+" 0 L "+h+" "+d+" L 0 "+d)};if(m.chamfer){var x=m.chamfer;_.vertices=n.chamfer(_.vertices,x.radius,x.quality,x.qualityMin,x.qualityMax),delete m.chamfer}return a.create(s.extend({},_,m))},i.trapezoid=function(p,l,h,d,m,_){_=_||{},m*=.5;var x=(1-m*2)*h,T=h*m,S=T+x,w=S+T,y;m<.5?y="L 0 0 L "+T+" "+-d+" L "+S+" "+-d+" L "+w+" 0":y="L 0 0 L "+S+" "+-d+" L "+w+" 0";var E={label:"Trapezoid Body",position:{x:p,y:l},vertices:n.fromPath(y)};if(_.chamfer){var R=_.chamfer;E.vertices=n.chamfer(E.vertices,R.radius,R.quality,R.qualityMin,R.qualityMax),delete _.chamfer}return a.create(s.extend({},E,_))},i.circle=function(p,l,h,d,m){d=d||{};var _={label:"Circle Body",circleRadius:h};m=m||25;var x=Math.ceil(Math.max(10,Math.min(m,h)));return x%2===1&&(x+=1),i.polygon(p,l,x,h,s.extend({},_,d))},i.polygon=function(p,l,h,d,m){if(m=m||{},h<3)return i.circle(p,l,d,m);for(var _=2*Math.PI/h,x="",T=_*.5,S=0;S<h;S+=1){var w=T+S*_,y=Math.cos(w)*d,E=Math.sin(w)*d;x+="L "+y.toFixed(3)+" "+E.toFixed(3)+" "}var R={label:"Polygon Body",position:{x:p,y:l},vertices:n.fromPath(x)};if(m.chamfer){var C=m.chamfer;R.vertices=n.chamfer(R.vertices,C.radius,C.quality,C.qualityMin,C.qualityMax),delete m.chamfer}return a.create(s.extend({},R,m))},i.fromVertices=function(p,l,h,d,m,_,x,T){var S=s.getDecomp(),w,y,E,R,C,P,M,B,L,O,H;for(w=!!(S&&S.quickDecomp),d=d||{},E=[],m=typeof m<"u"?m:!1,_=typeof _<"u"?_:.01,x=typeof x<"u"?x:10,T=typeof T<"u"?T:.01,s.isArray(h[0])||(h=[h]),O=0;O<h.length;O+=1)if(P=h[O],R=n.isConvex(P),C=!R,C&&!w&&s.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),R||!w)R?P=n.clockwiseSort(P):P=n.hull(P),E.push({position:{x:p,y:l},vertices:P});else{var N=P.map(function(Tt){return[Tt.x,Tt.y]});S.makeCCW(N),_!==!1&&S.removeCollinearPoints(N,_),T!==!1&&S.removeDuplicatePoints&&S.removeDuplicatePoints(N,T);var G=S.quickDecomp(N);for(M=0;M<G.length;M++){var Z=G[M],q=Z.map(function(Tt){return{x:Tt[0],y:Tt[1]}});x>0&&n.area(q)<x||E.push({position:n.centre(q),vertices:q})}}for(M=0;M<E.length;M++)E[M]=a.create(s.extend(E[M],d));if(m){var it=5;for(M=0;M<E.length;M++){var Y=E[M];for(B=M+1;B<E.length;B++){var Q=E[B];if(c.overlaps(Y.bounds,Q.bounds)){var ot=Y.vertices,xt=Q.vertices;for(L=0;L<Y.vertices.length;L++)for(H=0;H<Q.vertices.length;H++){var Et=f.magnitudeSquared(f.sub(ot[(L+1)%ot.length],xt[H])),Rt=f.magnitudeSquared(f.sub(ot[L],xt[(H+1)%xt.length]));Et<it&&Rt<it&&(ot[L].isInternal=!0,xt[H].isInternal=!0)}}}}}return E.length>1?(y=a.create(s.extend({parts:E.slice(0)},d)),a.setPosition(y,{x:p,y:l}),y):E[0]}})()},function(e,t,r){var i={};e.exports=i;var n=r(0),s=r(8);(function(){i.create=function(a){var c={bodies:[],pairs:null};return n.extend(c,a)},i.setBodies=function(a,c){a.bodies=c.slice(0)},i.clear=function(a){a.bodies=[]},i.collisions=function(a){var c=[],f=a.pairs,p=a.bodies,l=p.length,h=i.canCollide,d=s.collides,m,_;for(p.sort(i._compareBoundsX),m=0;m<l;m++){var x=p[m],T=x.bounds,S=x.bounds.max.x,w=x.bounds.max.y,y=x.bounds.min.y,E=x.isStatic||x.isSleeping,R=x.parts.length,C=R===1;for(_=m+1;_<l;_++){var P=p[_],M=P.bounds;if(M.min.x>S)break;if(!(w<M.min.y||y>M.max.y)&&!(E&&(P.isStatic||P.isSleeping))&&h(x.collisionFilter,P.collisionFilter)){var B=P.parts.length;if(C&&B===1){var L=d(x,P,f);L&&c.push(L)}else for(var O=R>1?1:0,H=B>1?1:0,N=O;N<R;N++)for(var G=x.parts[N],T=G.bounds,Z=H;Z<B;Z++){var q=P.parts[Z],M=q.bounds;if(!(T.min.x>M.max.x||T.max.x<M.min.x||T.max.y<M.min.y||T.min.y>M.max.y)){var L=d(G,q,f);L&&c.push(L)}}}}}return c},i.canCollide=function(a,c){return a.group===c.group&&a.group!==0?a.group>0:(a.mask&c.category)!==0&&(c.mask&a.category)!==0},i._compareBoundsX=function(a,c){return a.bounds.min.x-c.bounds.min.x}})()},function(e,t,r){var i={};e.exports=i;var n=r(0);(function(){i.create=function(s){var a={};return s||n.log("Mouse.create: element was undefined, defaulting to document.body","warn"),a.element=s||document.body,a.absolute={x:0,y:0},a.position={x:0,y:0},a.mousedownPosition={x:0,y:0},a.mouseupPosition={x:0,y:0},a.offset={x:0,y:0},a.scale={x:1,y:1},a.wheelDelta=0,a.button=-1,a.pixelRatio=parseInt(a.element.getAttribute("data-pixel-ratio"),10)||1,a.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},a.mousemove=function(c){var f=i._getRelativeMousePosition(c,a.element,a.pixelRatio),p=c.changedTouches;p&&(a.button=0,c.preventDefault()),a.absolute.x=f.x,a.absolute.y=f.y,a.position.x=a.absolute.x*a.scale.x+a.offset.x,a.position.y=a.absolute.y*a.scale.y+a.offset.y,a.sourceEvents.mousemove=c},a.mousedown=function(c){var f=i._getRelativeMousePosition(c,a.element,a.pixelRatio),p=c.changedTouches;p?(a.button=0,c.preventDefault()):a.button=c.button,a.absolute.x=f.x,a.absolute.y=f.y,a.position.x=a.absolute.x*a.scale.x+a.offset.x,a.position.y=a.absolute.y*a.scale.y+a.offset.y,a.mousedownPosition.x=a.position.x,a.mousedownPosition.y=a.position.y,a.sourceEvents.mousedown=c},a.mouseup=function(c){var f=i._getRelativeMousePosition(c,a.element,a.pixelRatio),p=c.changedTouches;p&&c.preventDefault(),a.button=-1,a.absolute.x=f.x,a.absolute.y=f.y,a.position.x=a.absolute.x*a.scale.x+a.offset.x,a.position.y=a.absolute.y*a.scale.y+a.offset.y,a.mouseupPosition.x=a.position.x,a.mouseupPosition.y=a.position.y,a.sourceEvents.mouseup=c},a.mousewheel=function(c){a.wheelDelta=Math.max(-1,Math.min(1,c.wheelDelta||-c.detail)),c.preventDefault()},i.setElement(a,a.element),a},i.setElement=function(s,a){s.element=a,a.addEventListener("mousemove",s.mousemove),a.addEventListener("mousedown",s.mousedown),a.addEventListener("mouseup",s.mouseup),a.addEventListener("mousewheel",s.mousewheel),a.addEventListener("DOMMouseScroll",s.mousewheel),a.addEventListener("touchmove",s.mousemove),a.addEventListener("touchstart",s.mousedown),a.addEventListener("touchend",s.mouseup)},i.clearSourceEvents=function(s){s.sourceEvents.mousemove=null,s.sourceEvents.mousedown=null,s.sourceEvents.mouseup=null,s.sourceEvents.mousewheel=null,s.wheelDelta=0},i.setOffset=function(s,a){s.offset.x=a.x,s.offset.y=a.y,s.position.x=s.absolute.x*s.scale.x+s.offset.x,s.position.y=s.absolute.y*s.scale.y+s.offset.y},i.setScale=function(s,a){s.scale.x=a.x,s.scale.y=a.y,s.position.x=s.absolute.x*s.scale.x+s.offset.x,s.position.y=s.absolute.y*s.scale.y+s.offset.y},i._getRelativeMousePosition=function(s,a,c){var f=a.getBoundingClientRect(),p=document.documentElement||document.body.parentNode||document.body,l=window.pageXOffset!==void 0?window.pageXOffset:p.scrollLeft,h=window.pageYOffset!==void 0?window.pageYOffset:p.scrollTop,d=s.changedTouches,m,_;return d?(m=d[0].pageX-f.left-l,_=d[0].pageY-f.top-h):(m=s.pageX-f.left-l,_=s.pageY-f.top-h),{x:m/(a.clientWidth/(a.width||a.clientWidth)*c),y:_/(a.clientHeight/(a.height||a.clientHeight)*c)}}})()},function(e,t,r){var i={};e.exports=i;var n=r(0);(function(){i._registry={},i.register=function(s){if(i.isPlugin(s)||n.warn("Plugin.register:",i.toString(s),"does not implement all required fields."),s.name in i._registry){var a=i._registry[s.name],c=i.versionParse(s.version).number,f=i.versionParse(a.version).number;c>f?(n.warn("Plugin.register:",i.toString(a),"was upgraded to",i.toString(s)),i._registry[s.name]=s):c<f?n.warn("Plugin.register:",i.toString(a),"can not be downgraded to",i.toString(s)):s!==a&&n.warn("Plugin.register:",i.toString(s),"is already registered to different plugin object")}else i._registry[s.name]=s;return s},i.resolve=function(s){return i._registry[i.dependencyParse(s).name]},i.toString=function(s){return typeof s=="string"?s:(s.name||"anonymous")+"@"+(s.version||s.range||"0.0.0")},i.isPlugin=function(s){return s&&s.name&&s.version&&s.install},i.isUsed=function(s,a){return s.used.indexOf(a)>-1},i.isFor=function(s,a){var c=s.for&&i.dependencyParse(s.for);return!s.for||a.name===c.name&&i.versionSatisfies(a.version,c.range)},i.use=function(s,a){if(s.uses=(s.uses||[]).concat(a||[]),s.uses.length===0){n.warn("Plugin.use:",i.toString(s),"does not specify any dependencies to install.");return}for(var c=i.dependencies(s),f=n.topologicalSort(c),p=[],l=0;l<f.length;l+=1)if(f[l]!==s.name){var h=i.resolve(f[l]);if(!h){p.push("\u274C "+f[l]);continue}i.isUsed(s,h.name)||(i.isFor(h,s)||(n.warn("Plugin.use:",i.toString(h),"is for",h.for,"but installed on",i.toString(s)+"."),h._warned=!0),h.install?h.install(s):(n.warn("Plugin.use:",i.toString(h),"does not specify an install function."),h._warned=!0),h._warned?(p.push("\u{1F536} "+i.toString(h)),delete h._warned):p.push("\u2705 "+i.toString(h)),s.used.push(h.name))}p.length>0&&n.info(p.join("  "))},i.dependencies=function(s,a){var c=i.dependencyParse(s),f=c.name;if(a=a||{},!(f in a)){s=i.resolve(s)||s,a[f]=n.map(s.uses||[],function(l){i.isPlugin(l)&&i.register(l);var h=i.dependencyParse(l),d=i.resolve(l);return d&&!i.versionSatisfies(d.version,h.range)?(n.warn("Plugin.dependencies:",i.toString(d),"does not satisfy",i.toString(h),"used by",i.toString(c)+"."),d._warned=!0,s._warned=!0):d||(n.warn("Plugin.dependencies:",i.toString(l),"used by",i.toString(c),"could not be resolved."),s._warned=!0),h.name});for(var p=0;p<a[f].length;p+=1)i.dependencies(a[f][p],a);return a}},i.dependencyParse=function(s){if(n.isString(s)){var a=/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/;return a.test(s)||n.warn("Plugin.dependencyParse:",s,"is not a valid dependency string."),{name:s.split("@")[0],range:s.split("@")[1]||"*"}}return{name:s.name,range:s.range||s.version}},i.versionParse=function(s){var a=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;a.test(s)||n.warn("Plugin.versionParse:",s,"is not a valid version or range.");var c=a.exec(s),f=Number(c[4]),p=Number(c[5]),l=Number(c[6]);return{isRange:!!(c[1]||c[2]),version:c[3],range:s,operator:c[1]||c[2]||"",major:f,minor:p,patch:l,parts:[f,p,l],prerelease:c[7],number:f*1e8+p*1e4+l}},i.versionSatisfies=function(s,a){a=a||"*";var c=i.versionParse(a),f=i.versionParse(s);if(c.isRange){if(c.operator==="*"||s==="*")return!0;if(c.operator===">")return f.number>c.number;if(c.operator===">=")return f.number>=c.number;if(c.operator==="~")return f.major===c.major&&f.minor===c.minor&&f.patch>=c.patch;if(c.operator==="^")return c.major>0?f.major===c.major&&f.number>=c.number:c.minor>0?f.minor===c.minor&&f.patch>=c.patch:f.patch===c.patch}return s===a||s==="*"}})()},function(e,t){var r={};e.exports=r,function(){r.create=function(i){return{vertex:i,normalImpulse:0,tangentImpulse:0}}}()},function(e,t,r){var i={};e.exports=i;var n=r(7),s=r(18),a=r(13),c=r(19),f=r(5),p=r(6),l=r(10),h=r(0),d=r(4);(function(){i.create=function(m){m=m||{};var _={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0}},x=h.extend(_,m);return x.world=m.world||p.create({label:"World"}),x.pairs=m.pairs||c.create(),x.detector=m.detector||a.create(),x.grid={buckets:[]},x.world.gravity=x.gravity,x.broadphase=x.grid,x.metrics={},x},i.update=function(m,_){var x=h.now(),T=m.world,S=m.detector,w=m.pairs,y=m.timing,E=y.timestamp,R;_=typeof _<"u"?_:h._baseDelta,_*=y.timeScale,y.timestamp+=_,y.lastDelta=_;var C={timestamp:y.timestamp,delta:_};f.trigger(m,"beforeUpdate",C);var P=p.allBodies(T),M=p.allConstraints(T);for(T.isModified&&(a.setBodies(S,P),p.setModified(T,!1,!1,!0)),m.enableSleeping&&n.update(P,_),i._bodiesApplyGravity(P,m.gravity),_>0&&i._bodiesUpdate(P,_),l.preSolveAll(P),R=0;R<m.constraintIterations;R++)l.solveAll(M,_);l.postSolveAll(P),S.pairs=m.pairs;var B=a.collisions(S);c.update(w,B,E),m.enableSleeping&&n.afterCollisions(w.list),w.collisionStart.length>0&&f.trigger(m,"collisionStart",{pairs:w.collisionStart});var L=h.clamp(20/m.positionIterations,0,1);for(s.preSolvePosition(w.list),R=0;R<m.positionIterations;R++)s.solvePosition(w.list,_,L);for(s.postSolvePosition(P),l.preSolveAll(P),R=0;R<m.constraintIterations;R++)l.solveAll(M,_);for(l.postSolveAll(P),s.preSolveVelocity(w.list),R=0;R<m.velocityIterations;R++)s.solveVelocity(w.list,_);return i._bodiesUpdateVelocities(P),w.collisionActive.length>0&&f.trigger(m,"collisionActive",{pairs:w.collisionActive}),w.collisionEnd.length>0&&f.trigger(m,"collisionEnd",{pairs:w.collisionEnd}),i._bodiesClearForces(P),f.trigger(m,"afterUpdate",C),m.timing.lastElapsed=h.now()-x,m},i.merge=function(m,_){if(h.extend(m,_),_.world){m.world=_.world,i.clear(m);for(var x=p.allBodies(m.world),T=0;T<x.length;T++){var S=x[T];n.set(S,!1),S.id=h.nextId()}}},i.clear=function(m){c.clear(m.pairs),a.clear(m.detector)},i._bodiesClearForces=function(m){for(var _=m.length,x=0;x<_;x++){var T=m[x];T.force.x=0,T.force.y=0,T.torque=0}},i._bodiesApplyGravity=function(m,_){var x=typeof _.scale<"u"?_.scale:.001,T=m.length;if(!(_.x===0&&_.y===0||x===0))for(var S=0;S<T;S++){var w=m[S];w.isStatic||w.isSleeping||(w.force.y+=w.mass*_.y*x,w.force.x+=w.mass*_.x*x)}},i._bodiesUpdate=function(m,_){for(var x=m.length,T=0;T<x;T++){var S=m[T];S.isStatic||S.isSleeping||d.update(S,_)}},i._bodiesUpdateVelocities=function(m){for(var _=m.length,x=0;x<_;x++)d.updateVelocities(m[x])}})()},function(e,t,r){var i={};e.exports=i;var n=r(3),s=r(0),a=r(1);(function(){i._restingThresh=2,i._restingThreshTangent=Math.sqrt(6),i._positionDampen=.9,i._positionWarming=.8,i._frictionNormalMultiplier=5,i._frictionMaxStatic=Number.MAX_VALUE,i.preSolvePosition=function(c){var f,p,l,h=c.length;for(f=0;f<h;f++)p=c[f],p.isActive&&(l=p.activeContacts.length,p.collision.parentA.totalContacts+=l,p.collision.parentB.totalContacts+=l)},i.solvePosition=function(c,f,p){var l,h,d,m,_,x,T,S,w=i._positionDampen*(p||1),y=s.clamp(f/s._baseDelta,0,1),E=c.length;for(l=0;l<E;l++)h=c[l],!(!h.isActive||h.isSensor)&&(d=h.collision,m=d.parentA,_=d.parentB,x=d.normal,h.separation=x.x*(_.positionImpulse.x+d.penetration.x-m.positionImpulse.x)+x.y*(_.positionImpulse.y+d.penetration.y-m.positionImpulse.y));for(l=0;l<E;l++)h=c[l],!(!h.isActive||h.isSensor)&&(d=h.collision,m=d.parentA,_=d.parentB,x=d.normal,S=h.separation-h.slop*y,(m.isStatic||_.isStatic)&&(S*=2),m.isStatic||m.isSleeping||(T=w/m.totalContacts,m.positionImpulse.x+=x.x*S*T,m.positionImpulse.y+=x.y*S*T),_.isStatic||_.isSleeping||(T=w/_.totalContacts,_.positionImpulse.x-=x.x*S*T,_.positionImpulse.y-=x.y*S*T))},i.postSolvePosition=function(c){for(var f=i._positionWarming,p=c.length,l=n.translate,h=a.update,d=0;d<p;d++){var m=c[d],_=m.positionImpulse,x=_.x,T=_.y,S=m.velocity;if(m.totalContacts=0,x!==0||T!==0){for(var w=0;w<m.parts.length;w++){var y=m.parts[w];l(y.vertices,_),h(y.bounds,y.vertices,S),y.position.x+=x,y.position.y+=T}m.positionPrev.x+=x,m.positionPrev.y+=T,x*S.x+T*S.y<0?(_.x=0,_.y=0):(_.x*=f,_.y*=f)}}},i.preSolveVelocity=function(c){var f=c.length,p,l;for(p=0;p<f;p++){var h=c[p];if(!(!h.isActive||h.isSensor)){var d=h.activeContacts,m=d.length,_=h.collision,x=_.parentA,T=_.parentB,S=_.normal,w=_.tangent;for(l=0;l<m;l++){var y=d[l],E=y.vertex,R=y.normalImpulse,C=y.tangentImpulse;if(R!==0||C!==0){var P=S.x*R+w.x*C,M=S.y*R+w.y*C;x.isStatic||x.isSleeping||(x.positionPrev.x+=P*x.inverseMass,x.positionPrev.y+=M*x.inverseMass,x.anglePrev+=x.inverseInertia*((E.x-x.position.x)*M-(E.y-x.position.y)*P)),T.isStatic||T.isSleeping||(T.positionPrev.x-=P*T.inverseMass,T.positionPrev.y-=M*T.inverseMass,T.anglePrev-=T.inverseInertia*((E.x-T.position.x)*M-(E.y-T.position.y)*P))}}}}},i.solveVelocity=function(c,f){var p=f/s._baseDelta,l=p*p,h=l*p,d=-i._restingThresh*p,m=i._restingThreshTangent,_=i._frictionNormalMultiplier*p,x=i._frictionMaxStatic,T=c.length,S,w,y,E;for(y=0;y<T;y++){var R=c[y];if(!(!R.isActive||R.isSensor)){var C=R.collision,P=C.parentA,M=C.parentB,B=P.velocity,L=M.velocity,O=C.normal.x,H=C.normal.y,N=C.tangent.x,G=C.tangent.y,Z=R.activeContacts,q=Z.length,it=1/q,Y=P.inverseMass+M.inverseMass,Q=R.friction*R.frictionStatic*_;for(B.x=P.position.x-P.positionPrev.x,B.y=P.position.y-P.positionPrev.y,L.x=M.position.x-M.positionPrev.x,L.y=M.position.y-M.positionPrev.y,P.angularVelocity=P.angle-P.anglePrev,M.angularVelocity=M.angle-M.anglePrev,E=0;E<q;E++){var ot=Z[E],xt=ot.vertex,Et=xt.x-P.position.x,Rt=xt.y-P.position.y,Tt=xt.x-M.position.x,Wt=xt.y-M.position.y,Ot=B.x-Rt*P.angularVelocity,te=B.y+Et*P.angularVelocity,ve=L.x-Wt*M.angularVelocity,jt=L.y+Tt*M.angularVelocity,Xt=Ot-ve,Kt=te-jt,Lt=O*Xt+H*Kt,Ut=N*Xt+G*Kt,Jr=R.separation+Lt,Pe=Math.min(Jr,1);Pe=Jr<0?0:Pe;var bn=Pe*Q;Ut<-bn||Ut>bn?(w=Ut>0?Ut:-Ut,S=R.friction*(Ut>0?1:-1)*h,S<-w?S=-w:S>w&&(S=w)):(S=Ut,w=x);var ss=Et*H-Rt*O,ar=Tt*H-Wt*O,Ze=it/(Y+P.inverseInertia*ss*ss+M.inverseInertia*ar*ar),Qr=(1+R.restitution)*Lt*Ze;if(S*=Ze,Lt<d)ot.normalImpulse=0;else{var os=ot.normalImpulse;ot.normalImpulse+=Qr,ot.normalImpulse>0&&(ot.normalImpulse=0),Qr=ot.normalImpulse-os}if(Ut<-m||Ut>m)ot.tangentImpulse=0;else{var hu=ot.tangentImpulse;ot.tangentImpulse+=S,ot.tangentImpulse<-w&&(ot.tangentImpulse=-w),ot.tangentImpulse>w&&(ot.tangentImpulse=w),S=ot.tangentImpulse-hu}var ti=O*Qr+N*S,as=H*Qr+G*S;P.isStatic||P.isSleeping||(P.positionPrev.x+=ti*P.inverseMass,P.positionPrev.y+=as*P.inverseMass,P.anglePrev+=(Et*as-Rt*ti)*P.inverseInertia),M.isStatic||M.isSleeping||(M.positionPrev.x-=ti*M.inverseMass,M.positionPrev.y-=as*M.inverseMass,M.anglePrev-=(Tt*as-Wt*ti)*M.inverseInertia)}}}}})()},function(e,t,r){var i={};e.exports=i;var n=r(9),s=r(0);(function(){i.create=function(a){return s.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},a)},i.update=function(a,c,f){var p=a.list,l=p.length,h=a.table,d=c.length,m=a.collisionStart,_=a.collisionEnd,x=a.collisionActive,T,S,w,y;for(m.length=0,_.length=0,x.length=0,y=0;y<l;y++)p[y].confirmedActive=!1;for(y=0;y<d;y++)T=c[y],w=T.pair,w?(w.isActive?x.push(w):m.push(w),n.update(w,T,f),w.confirmedActive=!0):(w=n.create(T,f),h[w.id]=w,m.push(w),p.push(w));var E=[];for(l=p.length,y=0;y<l;y++)w=p[y],w.confirmedActive||(n.setActive(w,!1,f),_.push(w),!w.collision.bodyA.isSleeping&&!w.collision.bodyB.isSleeping&&E.push(y));for(y=0;y<E.length;y++)S=E[y]-y,w=p[S],p.splice(S,1),delete h[w.id]},i.clear=function(a){return a.table={},a.list.length=0,a.collisionStart.length=0,a.collisionActive.length=0,a.collisionEnd.length=0,a}})()},function(e,t,r){var i=e.exports=r(21);i.Axes=r(11),i.Bodies=r(12),i.Body=r(4),i.Bounds=r(1),i.Collision=r(8),i.Common=r(0),i.Composite=r(6),i.Composites=r(22),i.Constraint=r(10),i.Contact=r(16),i.Detector=r(13),i.Engine=r(17),i.Events=r(5),i.Grid=r(23),i.Mouse=r(14),i.MouseConstraint=r(24),i.Pair=r(9),i.Pairs=r(19),i.Plugin=r(15),i.Query=r(25),i.Render=r(26),i.Resolver=r(18),i.Runner=r(27),i.SAT=r(28),i.Sleeping=r(7),i.Svg=r(29),i.Vector=r(2),i.Vertices=r(3),i.World=r(30),i.Engine.run=i.Runner.run,i.Common.deprecated(i.Engine,"run","Engine.run \u27A4 use Matter.Runner.run(engine) instead")},function(e,t,r){var i={};e.exports=i;var n=r(15),s=r(0);(function(){i.name="matter-js",i.version="0.19.0",i.uses=[],i.used=[],i.use=function(){n.use(i,Array.prototype.slice.call(arguments))},i.before=function(a,c){return a=a.replace(/^Matter./,""),s.chainPathBefore(i,a,c)},i.after=function(a,c){return a=a.replace(/^Matter./,""),s.chainPathAfter(i,a,c)}})()},function(e,t,r){var i={};e.exports=i;var n=r(6),s=r(10),a=r(0),c=r(4),f=r(12),p=a.deprecated;(function(){i.stack=function(l,h,d,m,_,x,T){for(var S=n.create({label:"Stack"}),w=l,y=h,E,R=0,C=0;C<m;C++){for(var P=0,M=0;M<d;M++){var B=T(w,y,M,C,E,R);if(B){var L=B.bounds.max.y-B.bounds.min.y,O=B.bounds.max.x-B.bounds.min.x;L>P&&(P=L),c.translate(B,{x:O*.5,y:L*.5}),w=B.bounds.max.x+_,n.addBody(S,B),E=B,R+=1}else w+=_}y+=P+x,w=l}return S},i.chain=function(l,h,d,m,_,x){for(var T=l.bodies,S=1;S<T.length;S++){var w=T[S-1],y=T[S],E=w.bounds.max.y-w.bounds.min.y,R=w.bounds.max.x-w.bounds.min.x,C=y.bounds.max.y-y.bounds.min.y,P=y.bounds.max.x-y.bounds.min.x,M={bodyA:w,pointA:{x:R*h,y:E*d},bodyB:y,pointB:{x:P*m,y:C*_}},B=a.extend(M,x);n.addConstraint(l,s.create(B))}return l.label+=" Chain",l},i.mesh=function(l,h,d,m,_){var x=l.bodies,T,S,w,y,E;for(T=0;T<d;T++){for(S=1;S<h;S++)w=x[S-1+T*h],y=x[S+T*h],n.addConstraint(l,s.create(a.extend({bodyA:w,bodyB:y},_)));if(T>0)for(S=0;S<h;S++)w=x[S+(T-1)*h],y=x[S+T*h],n.addConstraint(l,s.create(a.extend({bodyA:w,bodyB:y},_))),m&&S>0&&(E=x[S-1+(T-1)*h],n.addConstraint(l,s.create(a.extend({bodyA:E,bodyB:y},_)))),m&&S<h-1&&(E=x[S+1+(T-1)*h],n.addConstraint(l,s.create(a.extend({bodyA:E,bodyB:y},_))))}return l.label+=" Mesh",l},i.pyramid=function(l,h,d,m,_,x,T){return i.stack(l,h,d,m,_,x,function(S,w,y,E,R,C){var P=Math.min(m,Math.ceil(d/2)),M=R?R.bounds.max.x-R.bounds.min.x:0;if(!(E>P)){E=P-E;var B=E,L=d-1-E;if(!(y<B||y>L)){C===1&&c.translate(R,{x:(y+(d%2===1?1:-1))*M,y:0});var O=R?y*M:0;return T(l+O+y*_,w,y,E,R,C)}}})},i.newtonsCradle=function(l,h,d,m,_){for(var x=n.create({label:"Newtons Cradle"}),T=0;T<d;T++){var S=1.9,w=f.circle(l+T*(m*S),h+_,m,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),y=s.create({pointA:{x:l+T*(m*S),y:h},bodyB:w});n.addBody(x,w),n.addConstraint(x,y)}return x},p(i,"newtonsCradle","Composites.newtonsCradle \u27A4 moved to newtonsCradle example"),i.car=function(l,h,d,m,_){var x=c.nextGroup(!0),T=20,S=-d*.5+T,w=d*.5-T,y=0,E=n.create({label:"Car"}),R=f.rectangle(l,h,d,m,{collisionFilter:{group:x},chamfer:{radius:m*.5},density:2e-4}),C=f.circle(l+S,h+y,_,{collisionFilter:{group:x},friction:.8}),P=f.circle(l+w,h+y,_,{collisionFilter:{group:x},friction:.8}),M=s.create({bodyB:R,pointB:{x:S,y},bodyA:C,stiffness:1,length:0}),B=s.create({bodyB:R,pointB:{x:w,y},bodyA:P,stiffness:1,length:0});return n.addBody(E,R),n.addBody(E,C),n.addBody(E,P),n.addConstraint(E,M),n.addConstraint(E,B),E},p(i,"car","Composites.car \u27A4 moved to car example"),i.softBody=function(l,h,d,m,_,x,T,S,w,y){w=a.extend({inertia:1/0},w),y=a.extend({stiffness:.2,render:{type:"line",anchors:!1}},y);var E=i.stack(l,h,d,m,_,x,function(R,C){return f.circle(R,C,S,w)});return i.mesh(E,d,m,T,y),E.label="Soft Body",E},p(i,"softBody","Composites.softBody \u27A4 moved to softBody and cloth examples")})()},function(e,t,r){var i={};e.exports=i;var n=r(9),s=r(0),a=s.deprecated;(function(){i.create=function(c){var f={buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return s.extend(f,c)},i.update=function(c,f,p,l){var h,d,m,_=p.world,x=c.buckets,T,S,w=!1;for(h=0;h<f.length;h++){var y=f[h];if(!(y.isSleeping&&!l)&&!(_.bounds&&(y.bounds.max.x<_.bounds.min.x||y.bounds.min.x>_.bounds.max.x||y.bounds.max.y<_.bounds.min.y||y.bounds.min.y>_.bounds.max.y))){var E=i._getRegion(c,y);if(!y.region||E.id!==y.region.id||l){(!y.region||l)&&(y.region=E);var R=i._regionUnion(E,y.region);for(d=R.startCol;d<=R.endCol;d++)for(m=R.startRow;m<=R.endRow;m++){S=i._getBucketId(d,m),T=x[S];var C=d>=E.startCol&&d<=E.endCol&&m>=E.startRow&&m<=E.endRow,P=d>=y.region.startCol&&d<=y.region.endCol&&m>=y.region.startRow&&m<=y.region.endRow;!C&&P&&P&&T&&i._bucketRemoveBody(c,T,y),(y.region===E||C&&!P||l)&&(T||(T=i._createBucket(x,S)),i._bucketAddBody(c,T,y))}y.region=E,w=!0}}}w&&(c.pairsList=i._createActivePairsList(c))},a(i,"update","Grid.update \u27A4 replaced by Matter.Detector"),i.clear=function(c){c.buckets={},c.pairs={},c.pairsList=[]},a(i,"clear","Grid.clear \u27A4 replaced by Matter.Detector"),i._regionUnion=function(c,f){var p=Math.min(c.startCol,f.startCol),l=Math.max(c.endCol,f.endCol),h=Math.min(c.startRow,f.startRow),d=Math.max(c.endRow,f.endRow);return i._createRegion(p,l,h,d)},i._getRegion=function(c,f){var p=f.bounds,l=Math.floor(p.min.x/c.bucketWidth),h=Math.floor(p.max.x/c.bucketWidth),d=Math.floor(p.min.y/c.bucketHeight),m=Math.floor(p.max.y/c.bucketHeight);return i._createRegion(l,h,d,m)},i._createRegion=function(c,f,p,l){return{id:c+","+f+","+p+","+l,startCol:c,endCol:f,startRow:p,endRow:l}},i._getBucketId=function(c,f){return"C"+c+"R"+f},i._createBucket=function(c,f){var p=c[f]=[];return p},i._bucketAddBody=function(c,f,p){var l=c.pairs,h=n.id,d=f.length,m;for(m=0;m<d;m++){var _=f[m];if(!(p.id===_.id||p.isStatic&&_.isStatic)){var x=h(p,_),T=l[x];T?T[2]+=1:l[x]=[p,_,1]}}f.push(p)},i._bucketRemoveBody=function(c,f,p){var l=c.pairs,h=n.id,d;f.splice(s.indexOf(f,p),1);var m=f.length;for(d=0;d<m;d++){var _=l[h(p,f[d])];_&&(_[2]-=1)}},i._createActivePairsList=function(c){var f,p=c.pairs,l=s.keys(p),h=l.length,d=[],m;for(m=0;m<h;m++)f=p[l[m]],f[2]>0?d.push(f):delete p[l[m]];return d}})()},function(e,t,r){var i={};e.exports=i;var n=r(3),s=r(7),a=r(14),c=r(5),f=r(13),p=r(10),l=r(6),h=r(0),d=r(1);(function(){i.create=function(m,_){var x=(m?m.mouse:null)||(_?_.mouse:null);x||(m&&m.render&&m.render.canvas?x=a.create(m.render.canvas):_&&_.element?x=a.create(_.element):(x=a.create(),h.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var T=p.create({label:"Mouse Constraint",pointA:x.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),S={type:"mouseConstraint",mouse:x,element:null,body:null,constraint:T,collisionFilter:{category:1,mask:4294967295,group:0}},w=h.extend(S,_);return c.on(m,"beforeUpdate",function(){var y=l.allBodies(m.world);i.update(w,y),i._triggerEvents(w)}),w},i.update=function(m,_){var x=m.mouse,T=m.constraint,S=m.body;if(x.button===0){if(T.bodyB)s.set(T.bodyB,!1),T.pointA=x.position;else for(var w=0;w<_.length;w++)if(S=_[w],d.contains(S.bounds,x.position)&&f.canCollide(S.collisionFilter,m.collisionFilter))for(var y=S.parts.length>1?1:0;y<S.parts.length;y++){var E=S.parts[y];if(n.contains(E.vertices,x.position)){T.pointA=x.position,T.bodyB=m.body=S,T.pointB={x:x.position.x-S.position.x,y:x.position.y-S.position.y},T.angleB=S.angle,s.set(S,!1),c.trigger(m,"startdrag",{mouse:x,body:S});break}}}else T.bodyB=m.body=null,T.pointB=null,S&&c.trigger(m,"enddrag",{mouse:x,body:S})},i._triggerEvents=function(m){var _=m.mouse,x=_.sourceEvents;x.mousemove&&c.trigger(m,"mousemove",{mouse:_}),x.mousedown&&c.trigger(m,"mousedown",{mouse:_}),x.mouseup&&c.trigger(m,"mouseup",{mouse:_}),a.clearSourceEvents(_)}})()},function(e,t,r){var i={};e.exports=i;var n=r(2),s=r(8),a=r(1),c=r(12),f=r(3);(function(){i.collides=function(p,l){for(var h=[],d=l.length,m=p.bounds,_=s.collides,x=a.overlaps,T=0;T<d;T++){var S=l[T],w=S.parts.length,y=w===1?0:1;if(x(S.bounds,m))for(var E=y;E<w;E++){var R=S.parts[E];if(x(R.bounds,m)){var C=_(R,p);if(C){h.push(C);break}}}}return h},i.ray=function(p,l,h,d){d=d||1e-100;for(var m=n.angle(l,h),_=n.magnitude(n.sub(l,h)),x=(h.x+l.x)*.5,T=(h.y+l.y)*.5,S=c.rectangle(x,T,_,d,{angle:m}),w=i.collides(S,p),y=0;y<w.length;y+=1){var E=w[y];E.body=E.bodyB=E.bodyA}return w},i.region=function(p,l,h){for(var d=[],m=0;m<p.length;m++){var _=p[m],x=a.overlaps(_.bounds,l);(x&&!h||!x&&h)&&d.push(_)}return d},i.point=function(p,l){for(var h=[],d=0;d<p.length;d++){var m=p[d];if(a.contains(m.bounds,l))for(var _=m.parts.length===1?0:1;_<m.parts.length;_++){var x=m.parts[_];if(a.contains(x.bounds,l)&&f.contains(x.vertices,l)){h.push(m);break}}}return h}})()},function(e,t,r){var i={};e.exports=i;var n=r(4),s=r(0),a=r(6),c=r(1),f=r(5),p=r(2),l=r(14);(function(){var h,d;typeof window<"u"&&(h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(y){window.setTimeout(function(){y(s.now())},1e3/60)},d=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),i._goodFps=30,i._goodDelta=1e3/60,i.create=function(y){var E={engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",hasBounds:!!y.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},R=s.extend(E,y);return R.canvas&&(R.canvas.width=R.options.width||R.canvas.width,R.canvas.height=R.options.height||R.canvas.height),R.mouse=y.mouse,R.engine=y.engine,R.canvas=R.canvas||x(R.options.width,R.options.height),R.context=R.canvas.getContext("2d"),R.textures={},R.bounds=R.bounds||{min:{x:0,y:0},max:{x:R.canvas.width,y:R.canvas.height}},R.controller=i,R.options.showBroadphase=!1,R.options.pixelRatio!==1&&i.setPixelRatio(R,R.options.pixelRatio),s.isElement(R.element)&&R.element.appendChild(R.canvas),R},i.run=function(y){(function E(R){y.frameRequestId=h(E),m(y,R),i.world(y,R),(y.options.showStats||y.options.showDebug)&&i.stats(y,y.context,R),(y.options.showPerformance||y.options.showDebug)&&i.performance(y,y.context,R)})()},i.stop=function(y){d(y.frameRequestId)},i.setPixelRatio=function(y,E){var R=y.options,C=y.canvas;E==="auto"&&(E=T(C)),R.pixelRatio=E,C.setAttribute("data-pixel-ratio",E),C.width=R.width*E,C.height=R.height*E,C.style.width=R.width+"px",C.style.height=R.height+"px"},i.lookAt=function(y,E,R,C){C=typeof C<"u"?C:!0,E=s.isArray(E)?E:[E],R=R||{x:0,y:0};for(var P={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},M=0;M<E.length;M+=1){var B=E[M],L=B.bounds?B.bounds.min:B.min||B.position||B,O=B.bounds?B.bounds.max:B.max||B.position||B;L&&O&&(L.x<P.min.x&&(P.min.x=L.x),O.x>P.max.x&&(P.max.x=O.x),L.y<P.min.y&&(P.min.y=L.y),O.y>P.max.y&&(P.max.y=O.y))}var H=P.max.x-P.min.x+2*R.x,N=P.max.y-P.min.y+2*R.y,G=y.canvas.height,Z=y.canvas.width,q=Z/G,it=H/N,Y=1,Q=1;it>q?Q=it/q:Y=q/it,y.options.hasBounds=!0,y.bounds.min.x=P.min.x,y.bounds.max.x=P.min.x+H*Y,y.bounds.min.y=P.min.y,y.bounds.max.y=P.min.y+N*Q,C&&(y.bounds.min.x+=H*.5-H*Y*.5,y.bounds.max.x+=H*.5-H*Y*.5,y.bounds.min.y+=N*.5-N*Q*.5,y.bounds.max.y+=N*.5-N*Q*.5),y.bounds.min.x-=R.x,y.bounds.max.x-=R.x,y.bounds.min.y-=R.y,y.bounds.max.y-=R.y,y.mouse&&(l.setScale(y.mouse,{x:(y.bounds.max.x-y.bounds.min.x)/y.canvas.width,y:(y.bounds.max.y-y.bounds.min.y)/y.canvas.height}),l.setOffset(y.mouse,y.bounds.min))},i.startViewTransform=function(y){var E=y.bounds.max.x-y.bounds.min.x,R=y.bounds.max.y-y.bounds.min.y,C=E/y.options.width,P=R/y.options.height;y.context.setTransform(y.options.pixelRatio/C,0,0,y.options.pixelRatio/P,0,0),y.context.translate(-y.bounds.min.x,-y.bounds.min.y)},i.endViewTransform=function(y){y.context.setTransform(y.options.pixelRatio,0,0,y.options.pixelRatio,0,0)},i.world=function(y,E){var R=s.now(),C=y.engine,P=C.world,M=y.canvas,B=y.context,L=y.options,O=y.timing,H=a.allBodies(P),N=a.allConstraints(P),G=L.wireframes?L.wireframeBackground:L.background,Z=[],q=[],it,Y={timestamp:C.timing.timestamp};if(f.trigger(y,"beforeRender",Y),y.currentBackground!==G&&w(y,G),B.globalCompositeOperation="source-in",B.fillStyle="transparent",B.fillRect(0,0,M.width,M.height),B.globalCompositeOperation="source-over",L.hasBounds){for(it=0;it<H.length;it++){var Q=H[it];c.overlaps(Q.bounds,y.bounds)&&Z.push(Q)}for(it=0;it<N.length;it++){var ot=N[it],xt=ot.bodyA,Et=ot.bodyB,Rt=ot.pointA,Tt=ot.pointB;xt&&(Rt=p.add(xt.position,ot.pointA)),Et&&(Tt=p.add(Et.position,ot.pointB)),!(!Rt||!Tt)&&(c.contains(y.bounds,Rt)||c.contains(y.bounds,Tt))&&q.push(ot)}i.startViewTransform(y),y.mouse&&(l.setScale(y.mouse,{x:(y.bounds.max.x-y.bounds.min.x)/y.options.width,y:(y.bounds.max.y-y.bounds.min.y)/y.options.height}),l.setOffset(y.mouse,y.bounds.min))}else q=N,Z=H,y.options.pixelRatio!==1&&y.context.setTransform(y.options.pixelRatio,0,0,y.options.pixelRatio,0,0);!L.wireframes||C.enableSleeping&&L.showSleeping?i.bodies(y,Z,B):(L.showConvexHulls&&i.bodyConvexHulls(y,Z,B),i.bodyWireframes(y,Z,B)),L.showBounds&&i.bodyBounds(y,Z,B),(L.showAxes||L.showAngleIndicator)&&i.bodyAxes(y,Z,B),L.showPositions&&i.bodyPositions(y,Z,B),L.showVelocity&&i.bodyVelocity(y,Z,B),L.showIds&&i.bodyIds(y,Z,B),L.showSeparations&&i.separations(y,C.pairs.list,B),L.showCollisions&&i.collisions(y,C.pairs.list,B),L.showVertexNumbers&&i.vertexNumbers(y,Z,B),L.showMousePosition&&i.mousePosition(y,y.mouse,B),i.constraints(q,B),L.hasBounds&&i.endViewTransform(y),f.trigger(y,"afterRender",Y),O.lastElapsed=s.now()-R},i.stats=function(y,E,R){for(var C=y.engine,P=C.world,M=a.allBodies(P),B=0,L=55,O=44,H=0,N=0,G=0;G<M.length;G+=1)B+=M[G].parts.length;var Z={Part:B,Body:M.length,Cons:a.allConstraints(P).length,Comp:a.allComposites(P).length,Pair:C.pairs.list.length};E.fillStyle="#0e0f19",E.fillRect(H,N,L*5.5,O),E.font="12px Arial",E.textBaseline="top",E.textAlign="right";for(var q in Z){var it=Z[q];E.fillStyle="#aaa",E.fillText(q,H+L,N+8),E.fillStyle="#eee",E.fillText(it,H+L,N+26),H+=L}},i.performance=function(y,E){var R=y.engine,C=y.timing,P=C.deltaHistory,M=C.elapsedHistory,B=C.timestampElapsedHistory,L=C.engineDeltaHistory,O=C.engineElapsedHistory,H=R.timing.lastDelta,N=_(P),G=_(M),Z=_(L),q=_(O),it=_(B),Y=it/N||0,Q=1e3/N||0,ot=4,xt=12,Et=60,Rt=34,Tt=10,Wt=69;E.fillStyle="#0e0f19",E.fillRect(0,50,xt*4+Et*5+22,Rt),i.status(E,Tt,Wt,Et,ot,P.length,Math.round(Q)+" fps",Q/i._goodFps,function(Ot){return P[Ot]/N-1}),i.status(E,Tt+xt+Et,Wt,Et,ot,L.length,H.toFixed(2)+" dt",i._goodDelta/H,function(Ot){return L[Ot]/Z-1}),i.status(E,Tt+(xt+Et)*2,Wt,Et,ot,O.length,q.toFixed(2)+" ut",1-q/i._goodFps,function(Ot){return O[Ot]/q-1}),i.status(E,Tt+(xt+Et)*3,Wt,Et,ot,M.length,G.toFixed(2)+" rt",1-G/i._goodFps,function(Ot){return M[Ot]/G-1}),i.status(E,Tt+(xt+Et)*4,Wt,Et,ot,B.length,Y.toFixed(2)+" x",Y*Y*Y,function(Ot){return(B[Ot]/P[Ot]/Y||0)-1})},i.status=function(y,E,R,C,P,M,B,L,O){y.strokeStyle="#888",y.fillStyle="#444",y.lineWidth=1,y.fillRect(E,R+7,C,1),y.beginPath(),y.moveTo(E,R+7-P*s.clamp(.4*O(0),-2,2));for(var H=0;H<C;H+=1)y.lineTo(E+H,R+7-(H<M?P*s.clamp(.4*O(H),-2,2):0));y.stroke(),y.fillStyle="hsl("+s.clamp(25+95*L,0,120)+",100%,60%)",y.fillRect(E,R-7,4,4),y.font="12px Arial",y.textBaseline="middle",y.textAlign="right",y.fillStyle="#eee",y.fillText(B,E+C,R-5)},i.constraints=function(y,E){for(var R=E,C=0;C<y.length;C++){var P=y[C];if(!(!P.render.visible||!P.pointA||!P.pointB)){var M=P.bodyA,B=P.bodyB,L,O;if(M?L=p.add(M.position,P.pointA):L=P.pointA,P.render.type==="pin")R.beginPath(),R.arc(L.x,L.y,3,0,2*Math.PI),R.closePath();else{if(B?O=p.add(B.position,P.pointB):O=P.pointB,R.beginPath(),R.moveTo(L.x,L.y),P.render.type==="spring")for(var H=p.sub(O,L),N=p.perp(p.normalise(H)),G=Math.ceil(s.clamp(P.length/5,12,20)),Z,q=1;q<G;q+=1)Z=q%2===0?1:-1,R.lineTo(L.x+H.x*(q/G)+N.x*Z*4,L.y+H.y*(q/G)+N.y*Z*4);R.lineTo(O.x,O.y)}P.render.lineWidth&&(R.lineWidth=P.render.lineWidth,R.strokeStyle=P.render.strokeStyle,R.stroke()),P.render.anchors&&(R.fillStyle=P.render.strokeStyle,R.beginPath(),R.arc(L.x,L.y,3,0,2*Math.PI),R.arc(O.x,O.y,3,0,2*Math.PI),R.closePath(),R.fill())}}},i.bodies=function(y,E,R){var C=R,P=y.engine,M=y.options,B=M.showInternalEdges||!M.wireframes,L,O,H,N;for(H=0;H<E.length;H++)if(L=E[H],!!L.render.visible){for(N=L.parts.length>1?1:0;N<L.parts.length;N++)if(O=L.parts[N],!!O.render.visible){if(M.showSleeping&&L.isSleeping?C.globalAlpha=.5*O.render.opacity:O.render.opacity!==1&&(C.globalAlpha=O.render.opacity),O.render.sprite&&O.render.sprite.texture&&!M.wireframes){var G=O.render.sprite,Z=S(y,G.texture);C.translate(O.position.x,O.position.y),C.rotate(O.angle),C.drawImage(Z,Z.width*-G.xOffset*G.xScale,Z.height*-G.yOffset*G.yScale,Z.width*G.xScale,Z.height*G.yScale),C.rotate(-O.angle),C.translate(-O.position.x,-O.position.y)}else{if(O.circleRadius)C.beginPath(),C.arc(O.position.x,O.position.y,O.circleRadius,0,2*Math.PI);else{C.beginPath(),C.moveTo(O.vertices[0].x,O.vertices[0].y);for(var q=1;q<O.vertices.length;q++)!O.vertices[q-1].isInternal||B?C.lineTo(O.vertices[q].x,O.vertices[q].y):C.moveTo(O.vertices[q].x,O.vertices[q].y),O.vertices[q].isInternal&&!B&&C.moveTo(O.vertices[(q+1)%O.vertices.length].x,O.vertices[(q+1)%O.vertices.length].y);C.lineTo(O.vertices[0].x,O.vertices[0].y),C.closePath()}M.wireframes?(C.lineWidth=1,C.strokeStyle="#bbb",C.stroke()):(C.fillStyle=O.render.fillStyle,O.render.lineWidth&&(C.lineWidth=O.render.lineWidth,C.strokeStyle=O.render.strokeStyle,C.stroke()),C.fill())}C.globalAlpha=1}}},i.bodyWireframes=function(y,E,R){var C=R,P=y.options.showInternalEdges,M,B,L,O,H;for(C.beginPath(),L=0;L<E.length;L++)if(M=E[L],!!M.render.visible)for(H=M.parts.length>1?1:0;H<M.parts.length;H++){for(B=M.parts[H],C.moveTo(B.vertices[0].x,B.vertices[0].y),O=1;O<B.vertices.length;O++)!B.vertices[O-1].isInternal||P?C.lineTo(B.vertices[O].x,B.vertices[O].y):C.moveTo(B.vertices[O].x,B.vertices[O].y),B.vertices[O].isInternal&&!P&&C.moveTo(B.vertices[(O+1)%B.vertices.length].x,B.vertices[(O+1)%B.vertices.length].y);C.lineTo(B.vertices[0].x,B.vertices[0].y)}C.lineWidth=1,C.strokeStyle="#bbb",C.stroke()},i.bodyConvexHulls=function(y,E,R){var C=R,P,M,B,L,O;for(C.beginPath(),B=0;B<E.length;B++)if(P=E[B],!(!P.render.visible||P.parts.length===1)){for(C.moveTo(P.vertices[0].x,P.vertices[0].y),L=1;L<P.vertices.length;L++)C.lineTo(P.vertices[L].x,P.vertices[L].y);C.lineTo(P.vertices[0].x,P.vertices[0].y)}C.lineWidth=1,C.strokeStyle="rgba(255,255,255,0.2)",C.stroke()},i.vertexNumbers=function(y,E,R){var C=R,P,M,B;for(P=0;P<E.length;P++){var L=E[P].parts;for(B=L.length>1?1:0;B<L.length;B++){var O=L[B];for(M=0;M<O.vertices.length;M++)C.fillStyle="rgba(255,255,255,0.2)",C.fillText(P+"_"+M,O.position.x+(O.vertices[M].x-O.position.x)*.8,O.position.y+(O.vertices[M].y-O.position.y)*.8)}}},i.mousePosition=function(y,E,R){var C=R;C.fillStyle="rgba(255,255,255,0.8)",C.fillText(E.position.x+"  "+E.position.y,E.position.x+5,E.position.y-5)},i.bodyBounds=function(y,E,R){var C=R,P=y.engine,M=y.options;C.beginPath();for(var B=0;B<E.length;B++){var L=E[B];if(L.render.visible)for(var O=E[B].parts,H=O.length>1?1:0;H<O.length;H++){var N=O[H];C.rect(N.bounds.min.x,N.bounds.min.y,N.bounds.max.x-N.bounds.min.x,N.bounds.max.y-N.bounds.min.y)}}M.wireframes?C.strokeStyle="rgba(255,255,255,0.08)":C.strokeStyle="rgba(0,0,0,0.1)",C.lineWidth=1,C.stroke()},i.bodyAxes=function(y,E,R){var C=R,P=y.engine,M=y.options,B,L,O,H;for(C.beginPath(),L=0;L<E.length;L++){var N=E[L],G=N.parts;if(N.render.visible)if(M.showAxes)for(O=G.length>1?1:0;O<G.length;O++)for(B=G[O],H=0;H<B.axes.length;H++){var Z=B.axes[H];C.moveTo(B.position.x,B.position.y),C.lineTo(B.position.x+Z.x*20,B.position.y+Z.y*20)}else for(O=G.length>1?1:0;O<G.length;O++)for(B=G[O],H=0;H<B.axes.length;H++)C.moveTo(B.position.x,B.position.y),C.lineTo((B.vertices[0].x+B.vertices[B.vertices.length-1].x)/2,(B.vertices[0].y+B.vertices[B.vertices.length-1].y)/2)}M.wireframes?(C.strokeStyle="indianred",C.lineWidth=1):(C.strokeStyle="rgba(255, 255, 255, 0.4)",C.globalCompositeOperation="overlay",C.lineWidth=2),C.stroke(),C.globalCompositeOperation="source-over"},i.bodyPositions=function(y,E,R){var C=R,P=y.engine,M=y.options,B,L,O,H;for(C.beginPath(),O=0;O<E.length;O++)if(B=E[O],!!B.render.visible)for(H=0;H<B.parts.length;H++)L=B.parts[H],C.arc(L.position.x,L.position.y,3,0,2*Math.PI,!1),C.closePath();for(M.wireframes?C.fillStyle="indianred":C.fillStyle="rgba(0,0,0,0.5)",C.fill(),C.beginPath(),O=0;O<E.length;O++)B=E[O],B.render.visible&&(C.arc(B.positionPrev.x,B.positionPrev.y,2,0,2*Math.PI,!1),C.closePath());C.fillStyle="rgba(255,165,0,0.8)",C.fill()},i.bodyVelocity=function(y,E,R){var C=R;C.beginPath();for(var P=0;P<E.length;P++){var M=E[P];if(M.render.visible){var B=n.getVelocity(M);C.moveTo(M.position.x,M.position.y),C.lineTo(M.position.x+B.x,M.position.y+B.y)}}C.lineWidth=3,C.strokeStyle="cornflowerblue",C.stroke()},i.bodyIds=function(y,E,R){var C=R,P,M;for(P=0;P<E.length;P++)if(E[P].render.visible){var B=E[P].parts;for(M=B.length>1?1:0;M<B.length;M++){var L=B[M];C.font="12px Arial",C.fillStyle="rgba(255,255,255,0.5)",C.fillText(L.id,L.position.x+10,L.position.y-10)}}},i.collisions=function(y,E,R){var C=R,P=y.options,M,B,L,O,H,N,G;for(C.beginPath(),N=0;N<E.length;N++)if(M=E[N],!!M.isActive)for(B=M.collision,G=0;G<M.activeContacts.length;G++){var Z=M.activeContacts[G],q=Z.vertex;C.rect(q.x-1.5,q.y-1.5,3.5,3.5)}for(P.wireframes?C.fillStyle="rgba(255,255,255,0.7)":C.fillStyle="orange",C.fill(),C.beginPath(),N=0;N<E.length;N++)if(M=E[N],!!M.isActive&&(B=M.collision,M.activeContacts.length>0)){var it=M.activeContacts[0].vertex.x,Y=M.activeContacts[0].vertex.y;M.activeContacts.length===2&&(it=(M.activeContacts[0].vertex.x+M.activeContacts[1].vertex.x)/2,Y=(M.activeContacts[0].vertex.y+M.activeContacts[1].vertex.y)/2),B.bodyB===B.supports[0].body||B.bodyA.isStatic===!0?C.moveTo(it-B.normal.x*8,Y-B.normal.y*8):C.moveTo(it+B.normal.x*8,Y+B.normal.y*8),C.lineTo(it,Y)}P.wireframes?C.strokeStyle="rgba(255,165,0,0.7)":C.strokeStyle="orange",C.lineWidth=1,C.stroke()},i.separations=function(y,E,R){var C=R,P=y.options,M,B,L,O,H,N,G;for(C.beginPath(),N=0;N<E.length;N++)if(M=E[N],!!M.isActive){B=M.collision,O=B.bodyA,H=B.bodyB;var Z=1;!H.isStatic&&!O.isStatic&&(Z=.5),H.isStatic&&(Z=0),C.moveTo(H.position.x,H.position.y),C.lineTo(H.position.x-B.penetration.x*Z,H.position.y-B.penetration.y*Z),Z=1,!H.isStatic&&!O.isStatic&&(Z=.5),O.isStatic&&(Z=0),C.moveTo(O.position.x,O.position.y),C.lineTo(O.position.x+B.penetration.x*Z,O.position.y+B.penetration.y*Z)}P.wireframes?C.strokeStyle="rgba(255,165,0,0.5)":C.strokeStyle="orange",C.stroke()},i.inspector=function(y,E){var R=y.engine,C=y.selected,P=y.render,M=P.options,B;if(M.hasBounds){var L=P.bounds.max.x-P.bounds.min.x,O=P.bounds.max.y-P.bounds.min.y,H=L/P.options.width,N=O/P.options.height;E.scale(1/H,1/N),E.translate(-P.bounds.min.x,-P.bounds.min.y)}for(var G=0;G<C.length;G++){var Z=C[G].data;switch(E.translate(.5,.5),E.lineWidth=1,E.strokeStyle="rgba(255,165,0,0.9)",E.setLineDash([1,2]),Z.type){case"body":B=Z.bounds,E.beginPath(),E.rect(Math.floor(B.min.x-3),Math.floor(B.min.y-3),Math.floor(B.max.x-B.min.x+6),Math.floor(B.max.y-B.min.y+6)),E.closePath(),E.stroke();break;case"constraint":var q=Z.pointA;Z.bodyA&&(q=Z.pointB),E.beginPath(),E.arc(q.x,q.y,10,0,2*Math.PI),E.closePath(),E.stroke();break}E.setLineDash([]),E.translate(-.5,-.5)}y.selectStart!==null&&(E.translate(.5,.5),E.lineWidth=1,E.strokeStyle="rgba(255,165,0,0.6)",E.fillStyle="rgba(255,165,0,0.1)",B=y.selectBounds,E.beginPath(),E.rect(Math.floor(B.min.x),Math.floor(B.min.y),Math.floor(B.max.x-B.min.x),Math.floor(B.max.y-B.min.y)),E.closePath(),E.stroke(),E.fill(),E.translate(-.5,-.5)),M.hasBounds&&E.setTransform(1,0,0,1,0,0)};var m=function(y,E){var R=y.engine,C=y.timing,P=C.historySize,M=R.timing.timestamp;C.delta=E-C.lastTime||i._goodDelta,C.lastTime=E,C.timestampElapsed=M-C.lastTimestamp||0,C.lastTimestamp=M,C.deltaHistory.unshift(C.delta),C.deltaHistory.length=Math.min(C.deltaHistory.length,P),C.engineDeltaHistory.unshift(R.timing.lastDelta),C.engineDeltaHistory.length=Math.min(C.engineDeltaHistory.length,P),C.timestampElapsedHistory.unshift(C.timestampElapsed),C.timestampElapsedHistory.length=Math.min(C.timestampElapsedHistory.length,P),C.engineElapsedHistory.unshift(R.timing.lastElapsed),C.engineElapsedHistory.length=Math.min(C.engineElapsedHistory.length,P),C.elapsedHistory.unshift(C.lastElapsed),C.elapsedHistory.length=Math.min(C.elapsedHistory.length,P)},_=function(y){for(var E=0,R=0;R<y.length;R+=1)E+=y[R];return E/y.length||0},x=function(y,E){var R=document.createElement("canvas");return R.width=y,R.height=E,R.oncontextmenu=function(){return!1},R.onselectstart=function(){return!1},R},T=function(y){var E=y.getContext("2d"),R=window.devicePixelRatio||1,C=E.webkitBackingStorePixelRatio||E.mozBackingStorePixelRatio||E.msBackingStorePixelRatio||E.oBackingStorePixelRatio||E.backingStorePixelRatio||1;return R/C},S=function(y,E){var R=y.textures[E];return R||(R=y.textures[E]=new Image,R.src=E,R)},w=function(y,E){var R=E;/(jpg|gif|png)$/.test(E)&&(R="url("+E+")"),y.canvas.style.background=R,y.canvas.style.backgroundSize="contain",y.currentBackground=E}})()},function(e,t,r){var i={};e.exports=i;var n=r(5),s=r(17),a=r(0);(function(){var c,f;if(typeof window<"u"&&(c=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,f=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),!c){var p;c=function(l){p=setTimeout(function(){l(a.now())},1e3/60)},f=function(){clearTimeout(p)}}i.create=function(l){var h={fps:60,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,frameRequestId:null,isFixed:!1,enabled:!0},d=a.extend(h,l);return d.delta=d.delta||1e3/d.fps,d.deltaMin=d.deltaMin||1e3/d.fps,d.deltaMax=d.deltaMax||1e3/(d.fps*.5),d.fps=1e3/d.delta,d},i.run=function(l,h){return typeof l.positionIterations<"u"&&(h=l,l=i.create()),function d(m){l.frameRequestId=c(d),m&&l.enabled&&i.tick(l,h,m)}(),l},i.tick=function(l,h,d){var m=h.timing,_;l.isFixed?_=l.delta:(_=d-l.timePrev||l.delta,l.timePrev=d,l.deltaHistory.push(_),l.deltaHistory=l.deltaHistory.slice(-l.deltaSampleSize),_=Math.min.apply(null,l.deltaHistory),_=_<l.deltaMin?l.deltaMin:_,_=_>l.deltaMax?l.deltaMax:_,l.delta=_);var x={timestamp:m.timestamp};n.trigger(l,"beforeTick",x),l.frameCounter+=1,d-l.counterTimestamp>=1e3&&(l.fps=l.frameCounter*((d-l.counterTimestamp)/1e3),l.counterTimestamp=d,l.frameCounter=0),n.trigger(l,"tick",x),n.trigger(l,"beforeUpdate",x),s.update(h,_),n.trigger(l,"afterUpdate",x),n.trigger(l,"afterTick",x)},i.stop=function(l){f(l.frameRequestId)},i.start=function(l,h){i.run(l,h)}})()},function(e,t,r){var i={};e.exports=i;var n=r(8),s=r(0),a=s.deprecated;(function(){i.collides=function(c,f){return n.collides(c,f)},a(i,"collides","SAT.collides \u27A4 replaced by Collision.collides")})()},function(e,t,r){var i={};e.exports=i;var n=r(1),s=r(0);(function(){i.pathToVertices=function(a,c){typeof window<"u"&&!("SVGPathSeg"in window)&&s.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var f,p,l,h,d,m,_,x,T,S,w=[],y,E,R=0,C=0,P=0;c=c||15;var M=function(L,O,H){var N=H%2===1&&H>1;if(!T||L!=T.x||O!=T.y){T&&N?(y=T.x,E=T.y):(y=0,E=0);var G={x:y+L,y:E+O};(N||!T)&&(T=G),w.push(G),C=y+L,P=E+O}},B=function(L){var O=L.pathSegTypeAsLetter.toUpperCase();if(O!=="Z"){switch(O){case"M":case"L":case"T":case"C":case"S":case"Q":C=L.x,P=L.y;break;case"H":C=L.x;break;case"V":P=L.y;break}M(C,P,L.pathSegType)}};for(i._svgPathToAbsolute(a),l=a.getTotalLength(),m=[],f=0;f<a.pathSegList.numberOfItems;f+=1)m.push(a.pathSegList.getItem(f));for(_=m.concat();R<l;){if(S=a.getPathSegAtLength(R),d=m[S],d!=x){for(;_.length&&_[0]!=d;)B(_.shift());x=d}switch(d.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":h=a.getPointAtLength(R),M(h.x,h.y,0);break}R+=c}for(f=0,p=_.length;f<p;++f)B(_[f]);return w},i._svgPathToAbsolute=function(a){for(var c,f,p,l,h,d,m=a.pathSegList,_=0,x=0,T=m.numberOfItems,S=0;S<T;++S){var w=m.getItem(S),y=w.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(y))"x"in w&&(_=w.x),"y"in w&&(x=w.y);else switch("x1"in w&&(p=_+w.x1),"x2"in w&&(h=_+w.x2),"y1"in w&&(l=x+w.y1),"y2"in w&&(d=x+w.y2),"x"in w&&(_+=w.x),"y"in w&&(x+=w.y),y){case"m":m.replaceItem(a.createSVGPathSegMovetoAbs(_,x),S);break;case"l":m.replaceItem(a.createSVGPathSegLinetoAbs(_,x),S);break;case"h":m.replaceItem(a.createSVGPathSegLinetoHorizontalAbs(_),S);break;case"v":m.replaceItem(a.createSVGPathSegLinetoVerticalAbs(x),S);break;case"c":m.replaceItem(a.createSVGPathSegCurvetoCubicAbs(_,x,p,l,h,d),S);break;case"s":m.replaceItem(a.createSVGPathSegCurvetoCubicSmoothAbs(_,x,h,d),S);break;case"q":m.replaceItem(a.createSVGPathSegCurvetoQuadraticAbs(_,x,p,l),S);break;case"t":m.replaceItem(a.createSVGPathSegCurvetoQuadraticSmoothAbs(_,x),S);break;case"a":m.replaceItem(a.createSVGPathSegArcAbs(_,x,w.r1,w.r2,w.angle,w.largeArcFlag,w.sweepFlag),S);break;case"z":case"Z":_=c,x=f;break}(y=="M"||y=="m")&&(c=_,f=x)}}})()},function(e,t,r){var i={};e.exports=i;var n=r(6),s=r(0);(function(){i.create=n.create,i.add=n.add,i.remove=n.remove,i.clear=n.clear,i.addComposite=n.addComposite,i.addBody=n.addBody,i.addConstraint=n.addConstraint})()}])})});var Bd=Gr((_o,tl)=>{(function(){var e,t="4.17.21",r=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",n="Expected a function",s="Invalid `variable` option passed into `_.template`",a="__lodash_hash_undefined__",c=500,f="__lodash_placeholder__",p=1,l=2,h=4,d=1,m=2,_=1,x=2,T=4,S=8,w=16,y=32,E=64,R=128,C=256,P=512,M=30,B="...",L=800,O=16,H=1,N=2,G=3,Z=1/0,q=9007199254740991,it=17976931348623157e292,Y=0/0,Q=4294967295,ot=Q-1,xt=Q>>>1,Et=[["ary",R],["bind",_],["bindKey",x],["curry",S],["curryRight",w],["flip",P],["partial",y],["partialRight",E],["rearg",C]],Rt="[object Arguments]",Tt="[object Array]",Wt="[object AsyncFunction]",Ot="[object Boolean]",te="[object Date]",ve="[object DOMException]",jt="[object Error]",Xt="[object Function]",Kt="[object GeneratorFunction]",Lt="[object Map]",Ut="[object Number]",Jr="[object Null]",Pe="[object Object]",bn="[object Promise]",ss="[object Proxy]",ar="[object RegExp]",Ze="[object Set]",Qr="[object String]",os="[object Symbol]",hu="[object Undefined]",ti="[object WeakMap]",as="[object WeakSet]",yo="[object ArrayBuffer]",ls="[object DataView]",uu="[object Float32Array]",cu="[object Float64Array]",fu="[object Int8Array]",du="[object Int16Array]",pu="[object Int32Array]",mu="[object Uint8Array]",gu="[object Uint8ClampedArray]",_u="[object Uint16Array]",xu="[object Uint32Array]",I0=/\b__p \+= '';/g,P0=/\b(__p \+=) '' \+/g,M0=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Od=/&(?:amp|lt|gt|quot|#39);/g,Ld=/[&<>"']/g,B0=RegExp(Od.source),D0=RegExp(Ld.source),O0=/<%-([\s\S]+?)%>/g,L0=/<%([\s\S]+?)%>/g,Fd=/<%=([\s\S]+?)%>/g,F0=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,N0=/^\w*$/,U0=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,vu=/[\\^$.*+?()[\]{}|]/g,k0=RegExp(vu.source),yu=/^\s+/,G0=/\s/,H0=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,V0=/\{\n\/\* \[wrapped with (.+)\] \*/,W0=/,? & /,X0=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,z0=/[()=,{}\[\]\/\s]/,$0=/\\(\\)?/g,Y0=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Nd=/\w*$/,j0=/^[-+]0x[0-9a-f]+$/i,q0=/^0b[01]+$/i,K0=/^\[object .+?Constructor\]$/,Z0=/^0o[0-7]+$/i,J0=/^(?:0|[1-9]\d*)$/,Q0=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,el=/($^)/,tv=/['\n\r\u2028\u2029\\]/g,rl="\\ud800-\\udfff",ev="\\u0300-\\u036f",rv="\\ufe20-\\ufe2f",iv="\\u20d0-\\u20ff",Ud=ev+rv+iv,kd="\\u2700-\\u27bf",Gd="a-z\\xdf-\\xf6\\xf8-\\xff",nv="\\xac\\xb1\\xd7\\xf7",sv="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ov="\\u2000-\\u206f",av=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Hd="A-Z\\xc0-\\xd6\\xd8-\\xde",Vd="\\ufe0e\\ufe0f",Wd=nv+sv+ov+av,Tu="['\u2019]",lv="["+rl+"]",Xd="["+Wd+"]",il="["+Ud+"]",zd="\\d+",hv="["+kd+"]",$d="["+Gd+"]",Yd="[^"+rl+Wd+zd+kd+Gd+Hd+"]",Eu="\\ud83c[\\udffb-\\udfff]",uv="(?:"+il+"|"+Eu+")",jd="[^"+rl+"]",wu="(?:\\ud83c[\\udde6-\\uddff]){2}",Su="[\\ud800-\\udbff][\\udc00-\\udfff]",hs="["+Hd+"]",qd="\\u200d",Kd="(?:"+$d+"|"+Yd+")",cv="(?:"+hs+"|"+Yd+")",Zd="(?:"+Tu+"(?:d|ll|m|re|s|t|ve))?",Jd="(?:"+Tu+"(?:D|LL|M|RE|S|T|VE))?",Qd=uv+"?",tp="["+Vd+"]?",fv="(?:"+qd+"(?:"+[jd,wu,Su].join("|")+")"+tp+Qd+")*",dv="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",pv="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ep=tp+Qd+fv,mv="(?:"+[hv,wu,Su].join("|")+")"+ep,gv="(?:"+[jd+il+"?",il,wu,Su,lv].join("|")+")",_v=RegExp(Tu,"g"),xv=RegExp(il,"g"),bu=RegExp(Eu+"(?="+Eu+")|"+gv+ep,"g"),vv=RegExp([hs+"?"+$d+"+"+Zd+"(?="+[Xd,hs,"$"].join("|")+")",cv+"+"+Jd+"(?="+[Xd,hs+Kd,"$"].join("|")+")",hs+"?"+Kd+"+"+Zd,hs+"+"+Jd,pv,dv,zd,mv].join("|"),"g"),yv=RegExp("["+qd+rl+Ud+Vd+"]"),Tv=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ev=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],wv=-1,Zt={};Zt[uu]=Zt[cu]=Zt[fu]=Zt[du]=Zt[pu]=Zt[mu]=Zt[gu]=Zt[_u]=Zt[xu]=!0,Zt[Rt]=Zt[Tt]=Zt[yo]=Zt[Ot]=Zt[ls]=Zt[te]=Zt[jt]=Zt[Xt]=Zt[Lt]=Zt[Ut]=Zt[Pe]=Zt[ar]=Zt[Ze]=Zt[Qr]=Zt[ti]=!1;var qt={};qt[Rt]=qt[Tt]=qt[yo]=qt[ls]=qt[Ot]=qt[te]=qt[uu]=qt[cu]=qt[fu]=qt[du]=qt[pu]=qt[Lt]=qt[Ut]=qt[Pe]=qt[ar]=qt[Ze]=qt[Qr]=qt[os]=qt[mu]=qt[gu]=qt[_u]=qt[xu]=!0,qt[jt]=qt[Xt]=qt[ti]=!1;var Sv={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},bv={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Av={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Cv={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Rv=parseFloat,Iv=parseInt,rp=typeof global=="object"&&global&&global.Object===Object&&global,Pv=typeof self=="object"&&self&&self.Object===Object&&self,ye=rp||Pv||Function("return this")(),Au=typeof _o=="object"&&_o&&!_o.nodeType&&_o,An=Au&&typeof tl=="object"&&tl&&!tl.nodeType&&tl,ip=An&&An.exports===Au,Cu=ip&&rp.process,Er=function(){try{var U=An&&An.require&&An.require("util").types;return U||Cu&&Cu.binding&&Cu.binding("util")}catch{}}(),np=Er&&Er.isArrayBuffer,sp=Er&&Er.isDate,op=Er&&Er.isMap,ap=Er&&Er.isRegExp,lp=Er&&Er.isSet,hp=Er&&Er.isTypedArray;function lr(U,z,V){switch(V.length){case 0:return U.call(z);case 1:return U.call(z,V[0]);case 2:return U.call(z,V[0],V[1]);case 3:return U.call(z,V[0],V[1],V[2])}return U.apply(z,V)}function Mv(U,z,V,at){for(var wt=-1,kt=U==null?0:U.length;++wt<kt;){var de=U[wt];z(at,de,V(de),U)}return at}function wr(U,z){for(var V=-1,at=U==null?0:U.length;++V<at&&z(U[V],V,U)!==!1;);return U}function Bv(U,z){for(var V=U==null?0:U.length;V--&&z(U[V],V,U)!==!1;);return U}function up(U,z){for(var V=-1,at=U==null?0:U.length;++V<at;)if(!z(U[V],V,U))return!1;return!0}function Vi(U,z){for(var V=-1,at=U==null?0:U.length,wt=0,kt=[];++V<at;){var de=U[V];z(de,V,U)&&(kt[wt++]=de)}return kt}function nl(U,z){var V=U==null?0:U.length;return!!V&&us(U,z,0)>-1}function Ru(U,z,V){for(var at=-1,wt=U==null?0:U.length;++at<wt;)if(V(z,U[at]))return!0;return!1}function Qt(U,z){for(var V=-1,at=U==null?0:U.length,wt=Array(at);++V<at;)wt[V]=z(U[V],V,U);return wt}function Wi(U,z){for(var V=-1,at=z.length,wt=U.length;++V<at;)U[wt+V]=z[V];return U}function Iu(U,z,V,at){var wt=-1,kt=U==null?0:U.length;for(at&&kt&&(V=U[++wt]);++wt<kt;)V=z(V,U[wt],wt,U);return V}function Dv(U,z,V,at){var wt=U==null?0:U.length;for(at&&wt&&(V=U[--wt]);wt--;)V=z(V,U[wt],wt,U);return V}function Pu(U,z){for(var V=-1,at=U==null?0:U.length;++V<at;)if(z(U[V],V,U))return!0;return!1}var Ov=Mu("length");function Lv(U){return U.split("")}function Fv(U){return U.match(X0)||[]}function cp(U,z,V){var at;return V(U,function(wt,kt,de){if(z(wt,kt,de))return at=kt,!1}),at}function sl(U,z,V,at){for(var wt=U.length,kt=V+(at?1:-1);at?kt--:++kt<wt;)if(z(U[kt],kt,U))return kt;return-1}function us(U,z,V){return z===z?jv(U,z,V):sl(U,fp,V)}function Nv(U,z,V,at){for(var wt=V-1,kt=U.length;++wt<kt;)if(at(U[wt],z))return wt;return-1}function fp(U){return U!==U}function dp(U,z){var V=U==null?0:U.length;return V?Du(U,z)/V:Y}function Mu(U){return function(z){return z==null?e:z[U]}}function Bu(U){return function(z){return U==null?e:U[z]}}function pp(U,z,V,at,wt){return wt(U,function(kt,de,$t){V=at?(at=!1,kt):z(V,kt,de,$t)}),V}function Uv(U,z){var V=U.length;for(U.sort(z);V--;)U[V]=U[V].value;return U}function Du(U,z){for(var V,at=-1,wt=U.length;++at<wt;){var kt=z(U[at]);kt!==e&&(V=V===e?kt:V+kt)}return V}function Ou(U,z){for(var V=-1,at=Array(U);++V<U;)at[V]=z(V);return at}function kv(U,z){return Qt(z,function(V){return[V,U[V]]})}function mp(U){return U&&U.slice(0,vp(U)+1).replace(yu,"")}function hr(U){return function(z){return U(z)}}function Lu(U,z){return Qt(z,function(V){return U[V]})}function To(U,z){return U.has(z)}function gp(U,z){for(var V=-1,at=U.length;++V<at&&us(z,U[V],0)>-1;);return V}function _p(U,z){for(var V=U.length;V--&&us(z,U[V],0)>-1;);return V}function Gv(U,z){for(var V=U.length,at=0;V--;)U[V]===z&&++at;return at}var Hv=Bu(Sv),Vv=Bu(bv);function Wv(U){return"\\"+Cv[U]}function Xv(U,z){return U==null?e:U[z]}function cs(U){return yv.test(U)}function zv(U){return Tv.test(U)}function $v(U){for(var z,V=[];!(z=U.next()).done;)V.push(z.value);return V}function Fu(U){var z=-1,V=Array(U.size);return U.forEach(function(at,wt){V[++z]=[wt,at]}),V}function xp(U,z){return function(V){return U(z(V))}}function Xi(U,z){for(var V=-1,at=U.length,wt=0,kt=[];++V<at;){var de=U[V];(de===z||de===f)&&(U[V]=f,kt[wt++]=V)}return kt}function ol(U){var z=-1,V=Array(U.size);return U.forEach(function(at){V[++z]=at}),V}function Yv(U){var z=-1,V=Array(U.size);return U.forEach(function(at){V[++z]=[at,at]}),V}function jv(U,z,V){for(var at=V-1,wt=U.length;++at<wt;)if(U[at]===z)return at;return-1}function qv(U,z,V){for(var at=V+1;at--;)if(U[at]===z)return at;return at}function fs(U){return cs(U)?Zv(U):Ov(U)}function Fr(U){return cs(U)?Jv(U):Lv(U)}function vp(U){for(var z=U.length;z--&&G0.test(U.charAt(z)););return z}var Kv=Bu(Av);function Zv(U){for(var z=bu.lastIndex=0;bu.test(U);)++z;return z}function Jv(U){return U.match(bu)||[]}function Qv(U){return U.match(vv)||[]}var ty=function U(z){z=z==null?ye:zi.defaults(ye.Object(),z,zi.pick(ye,Ev));var V=z.Array,at=z.Date,wt=z.Error,kt=z.Function,de=z.Math,$t=z.Object,Nu=z.RegExp,ey=z.String,Sr=z.TypeError,al=V.prototype,ry=kt.prototype,ds=$t.prototype,ll=z["__core-js_shared__"],hl=ry.toString,Vt=ds.hasOwnProperty,iy=0,yp=function(){var o=/[^.]+$/.exec(ll&&ll.keys&&ll.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),ul=ds.toString,ny=hl.call($t),sy=ye._,oy=Nu("^"+hl.call(Vt).replace(vu,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),cl=ip?z.Buffer:e,$i=z.Symbol,fl=z.Uint8Array,Tp=cl?cl.allocUnsafe:e,dl=xp($t.getPrototypeOf,$t),Ep=$t.create,wp=ds.propertyIsEnumerable,pl=al.splice,Sp=$i?$i.isConcatSpreadable:e,Eo=$i?$i.iterator:e,Cn=$i?$i.toStringTag:e,ml=function(){try{var o=Bn($t,"defineProperty");return o({},"",{}),o}catch{}}(),ay=z.clearTimeout!==ye.clearTimeout&&z.clearTimeout,ly=at&&at.now!==ye.Date.now&&at.now,hy=z.setTimeout!==ye.setTimeout&&z.setTimeout,gl=de.ceil,_l=de.floor,Uu=$t.getOwnPropertySymbols,uy=cl?cl.isBuffer:e,bp=z.isFinite,cy=al.join,fy=xp($t.keys,$t),pe=de.max,Me=de.min,dy=at.now,py=z.parseInt,Ap=de.random,my=al.reverse,ku=Bn(z,"DataView"),wo=Bn(z,"Map"),Gu=Bn(z,"Promise"),ps=Bn(z,"Set"),So=Bn(z,"WeakMap"),bo=Bn($t,"create"),xl=So&&new So,ms={},gy=Dn(ku),_y=Dn(wo),xy=Dn(Gu),vy=Dn(ps),yy=Dn(So),vl=$i?$i.prototype:e,Ao=vl?vl.valueOf:e,Cp=vl?vl.toString:e;function A(o){if(ne(o)&&!bt(o)&&!(o instanceof Mt)){if(o instanceof br)return o;if(Vt.call(o,"__wrapped__"))return Rm(o)}return new br(o)}var gs=function(){function o(){}return function(u){if(!ee(u))return{};if(Ep)return Ep(u);o.prototype=u;var g=new o;return o.prototype=e,g}}();function yl(){}function br(o,u){this.__wrapped__=o,this.__actions__=[],this.__chain__=!!u,this.__index__=0,this.__values__=e}A.templateSettings={escape:O0,evaluate:L0,interpolate:Fd,variable:"",imports:{_:A}},A.prototype=yl.prototype,A.prototype.constructor=A,br.prototype=gs(yl.prototype),br.prototype.constructor=br;function Mt(o){this.__wrapped__=o,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Q,this.__views__=[]}function Ty(){var o=new Mt(this.__wrapped__);return o.__actions__=Je(this.__actions__),o.__dir__=this.__dir__,o.__filtered__=this.__filtered__,o.__iteratees__=Je(this.__iteratees__),o.__takeCount__=this.__takeCount__,o.__views__=Je(this.__views__),o}function Ey(){if(this.__filtered__){var o=new Mt(this);o.__dir__=-1,o.__filtered__=!0}else o=this.clone(),o.__dir__*=-1;return o}function wy(){var o=this.__wrapped__.value(),u=this.__dir__,g=bt(o),v=u<0,b=g?o.length:0,I=L1(0,b,this.__views__),D=I.start,F=I.end,k=F-D,j=v?F:D-1,K=this.__iteratees__,tt=K.length,st=0,ut=Me(k,this.__takeCount__);if(!g||!v&&b==k&&ut==k)return Zp(o,this.__actions__);var vt=[];t:for(;k--&&st<ut;){j+=u;for(var Ct=-1,yt=o[j];++Ct<tt;){var Pt=K[Ct],Dt=Pt.iteratee,fr=Pt.type,He=Dt(yt);if(fr==N)yt=He;else if(!He){if(fr==H)continue t;break t}}vt[st++]=yt}return vt}Mt.prototype=gs(yl.prototype),Mt.prototype.constructor=Mt;function Rn(o){var u=-1,g=o==null?0:o.length;for(this.clear();++u<g;){var v=o[u];this.set(v[0],v[1])}}function Sy(){this.__data__=bo?bo(null):{},this.size=0}function by(o){var u=this.has(o)&&delete this.__data__[o];return this.size-=u?1:0,u}function Ay(o){var u=this.__data__;if(bo){var g=u[o];return g===a?e:g}return Vt.call(u,o)?u[o]:e}function Cy(o){var u=this.__data__;return bo?u[o]!==e:Vt.call(u,o)}function Ry(o,u){var g=this.__data__;return this.size+=this.has(o)?0:1,g[o]=bo&&u===e?a:u,this}Rn.prototype.clear=Sy,Rn.prototype.delete=by,Rn.prototype.get=Ay,Rn.prototype.has=Cy,Rn.prototype.set=Ry;function di(o){var u=-1,g=o==null?0:o.length;for(this.clear();++u<g;){var v=o[u];this.set(v[0],v[1])}}function Iy(){this.__data__=[],this.size=0}function Py(o){var u=this.__data__,g=Tl(u,o);if(g<0)return!1;var v=u.length-1;return g==v?u.pop():pl.call(u,g,1),--this.size,!0}function My(o){var u=this.__data__,g=Tl(u,o);return g<0?e:u[g][1]}function By(o){return Tl(this.__data__,o)>-1}function Dy(o,u){var g=this.__data__,v=Tl(g,o);return v<0?(++this.size,g.push([o,u])):g[v][1]=u,this}di.prototype.clear=Iy,di.prototype.delete=Py,di.prototype.get=My,di.prototype.has=By,di.prototype.set=Dy;function pi(o){var u=-1,g=o==null?0:o.length;for(this.clear();++u<g;){var v=o[u];this.set(v[0],v[1])}}function Oy(){this.size=0,this.__data__={hash:new Rn,map:new(wo||di),string:new Rn}}function Ly(o){var u=Dl(this,o).delete(o);return this.size-=u?1:0,u}function Fy(o){return Dl(this,o).get(o)}function Ny(o){return Dl(this,o).has(o)}function Uy(o,u){var g=Dl(this,o),v=g.size;return g.set(o,u),this.size+=g.size==v?0:1,this}pi.prototype.clear=Oy,pi.prototype.delete=Ly,pi.prototype.get=Fy,pi.prototype.has=Ny,pi.prototype.set=Uy;function In(o){var u=-1,g=o==null?0:o.length;for(this.__data__=new pi;++u<g;)this.add(o[u])}function ky(o){return this.__data__.set(o,a),this}function Gy(o){return this.__data__.has(o)}In.prototype.add=In.prototype.push=ky,In.prototype.has=Gy;function Nr(o){var u=this.__data__=new di(o);this.size=u.size}function Hy(){this.__data__=new di,this.size=0}function Vy(o){var u=this.__data__,g=u.delete(o);return this.size=u.size,g}function Wy(o){return this.__data__.get(o)}function Xy(o){return this.__data__.has(o)}function zy(o,u){var g=this.__data__;if(g instanceof di){var v=g.__data__;if(!wo||v.length<r-1)return v.push([o,u]),this.size=++g.size,this;g=this.__data__=new pi(v)}return g.set(o,u),this.size=g.size,this}Nr.prototype.clear=Hy,Nr.prototype.delete=Vy,Nr.prototype.get=Wy,Nr.prototype.has=Xy,Nr.prototype.set=zy;function Rp(o,u){var g=bt(o),v=!g&&On(o),b=!g&&!v&&Zi(o),I=!g&&!v&&!b&&ys(o),D=g||v||b||I,F=D?Ou(o.length,ey):[],k=F.length;for(var j in o)(u||Vt.call(o,j))&&!(D&&(j=="length"||b&&(j=="offset"||j=="parent")||I&&(j=="buffer"||j=="byteLength"||j=="byteOffset")||xi(j,k)))&&F.push(j);return F}function Ip(o){var u=o.length;return u?o[Zu(0,u-1)]:e}function $y(o,u){return Ol(Je(o),Pn(u,0,o.length))}function Yy(o){return Ol(Je(o))}function Hu(o,u,g){(g!==e&&!Ur(o[u],g)||g===e&&!(u in o))&&mi(o,u,g)}function Co(o,u,g){var v=o[u];(!(Vt.call(o,u)&&Ur(v,g))||g===e&&!(u in o))&&mi(o,u,g)}function Tl(o,u){for(var g=o.length;g--;)if(Ur(o[g][0],u))return g;return-1}function jy(o,u,g,v){return Yi(o,function(b,I,D){u(v,b,g(b),D)}),v}function Pp(o,u){return o&&ri(u,Te(u),o)}function qy(o,u){return o&&ri(u,tr(u),o)}function mi(o,u,g){u=="__proto__"&&ml?ml(o,u,{configurable:!0,enumerable:!0,value:g,writable:!0}):o[u]=g}function Vu(o,u){for(var g=-1,v=u.length,b=V(v),I=o==null;++g<v;)b[g]=I?e:Ec(o,u[g]);return b}function Pn(o,u,g){return o===o&&(g!==e&&(o=o<=g?o:g),u!==e&&(o=o>=u?o:u)),o}function Ar(o,u,g,v,b,I){var D,F=u&p,k=u&l,j=u&h;if(g&&(D=b?g(o,v,b,I):g(o)),D!==e)return D;if(!ee(o))return o;var K=bt(o);if(K){if(D=N1(o),!F)return Je(o,D)}else{var tt=Be(o),st=tt==Xt||tt==Kt;if(Zi(o))return tm(o,F);if(tt==Pe||tt==Rt||st&&!b){if(D=k||st?{}:vm(o),!F)return k?A1(o,qy(D,o)):b1(o,Pp(D,o))}else{if(!qt[tt])return b?o:{};D=U1(o,tt,F)}}I||(I=new Nr);var ut=I.get(o);if(ut)return ut;I.set(o,D),jm(o)?o.forEach(function(yt){D.add(Ar(yt,u,g,yt,o,I))}):$m(o)&&o.forEach(function(yt,Pt){D.set(Pt,Ar(yt,u,g,Pt,o,I))});var vt=j?k?lc:ac:k?tr:Te,Ct=K?e:vt(o);return wr(Ct||o,function(yt,Pt){Ct&&(Pt=yt,yt=o[Pt]),Co(D,Pt,Ar(yt,u,g,Pt,o,I))}),D}function Ky(o){var u=Te(o);return function(g){return Mp(g,o,u)}}function Mp(o,u,g){var v=g.length;if(o==null)return!v;for(o=$t(o);v--;){var b=g[v],I=u[b],D=o[b];if(D===e&&!(b in o)||!I(D))return!1}return!0}function Bp(o,u,g){if(typeof o!="function")throw new Sr(n);return Oo(function(){o.apply(e,g)},u)}function Ro(o,u,g,v){var b=-1,I=nl,D=!0,F=o.length,k=[],j=u.length;if(!F)return k;g&&(u=Qt(u,hr(g))),v?(I=Ru,D=!1):u.length>=r&&(I=To,D=!1,u=new In(u));t:for(;++b<F;){var K=o[b],tt=g==null?K:g(K);if(K=v||K!==0?K:0,D&&tt===tt){for(var st=j;st--;)if(u[st]===tt)continue t;k.push(K)}else I(u,tt,v)||k.push(K)}return k}var Yi=sm(ei),Dp=sm(Xu,!0);function Zy(o,u){var g=!0;return Yi(o,function(v,b,I){return g=!!u(v,b,I),g}),g}function El(o,u,g){for(var v=-1,b=o.length;++v<b;){var I=o[v],D=u(I);if(D!=null&&(F===e?D===D&&!cr(D):g(D,F)))var F=D,k=I}return k}function Jy(o,u,g,v){var b=o.length;for(g=At(g),g<0&&(g=-g>b?0:b+g),v=v===e||v>b?b:At(v),v<0&&(v+=b),v=g>v?0:Km(v);g<v;)o[g++]=u;return o}function Op(o,u){var g=[];return Yi(o,function(v,b,I){u(v,b,I)&&g.push(v)}),g}function Ae(o,u,g,v,b){var I=-1,D=o.length;for(g||(g=G1),b||(b=[]);++I<D;){var F=o[I];u>0&&g(F)?u>1?Ae(F,u-1,g,v,b):Wi(b,F):v||(b[b.length]=F)}return b}var Wu=om(),Lp=om(!0);function ei(o,u){return o&&Wu(o,u,Te)}function Xu(o,u){return o&&Lp(o,u,Te)}function wl(o,u){return Vi(u,function(g){return vi(o[g])})}function Mn(o,u){u=qi(u,o);for(var g=0,v=u.length;o!=null&&g<v;)o=o[ii(u[g++])];return g&&g==v?o:e}function Fp(o,u,g){var v=u(o);return bt(o)?v:Wi(v,g(o))}function ke(o){return o==null?o===e?hu:Jr:Cn&&Cn in $t(o)?O1(o):Y1(o)}function zu(o,u){return o>u}function Qy(o,u){return o!=null&&Vt.call(o,u)}function t1(o,u){return o!=null&&u in $t(o)}function e1(o,u,g){return o>=Me(u,g)&&o<pe(u,g)}function $u(o,u,g){for(var v=g?Ru:nl,b=o[0].length,I=o.length,D=I,F=V(I),k=1/0,j=[];D--;){var K=o[D];D&&u&&(K=Qt(K,hr(u))),k=Me(K.length,k),F[D]=!g&&(u||b>=120&&K.length>=120)?new In(D&&K):e}K=o[0];var tt=-1,st=F[0];t:for(;++tt<b&&j.length<k;){var ut=K[tt],vt=u?u(ut):ut;if(ut=g||ut!==0?ut:0,!(st?To(st,vt):v(j,vt,g))){for(D=I;--D;){var Ct=F[D];if(!(Ct?To(Ct,vt):v(o[D],vt,g)))continue t}st&&st.push(vt),j.push(ut)}}return j}function r1(o,u,g,v){return ei(o,function(b,I,D){u(v,g(b),I,D)}),v}function Io(o,u,g){u=qi(u,o),o=wm(o,u);var v=o==null?o:o[ii(Rr(u))];return v==null?e:lr(v,o,g)}function Np(o){return ne(o)&&ke(o)==Rt}function i1(o){return ne(o)&&ke(o)==yo}function n1(o){return ne(o)&&ke(o)==te}function Po(o,u,g,v,b){return o===u?!0:o==null||u==null||!ne(o)&&!ne(u)?o!==o&&u!==u:s1(o,u,g,v,Po,b)}function s1(o,u,g,v,b,I){var D=bt(o),F=bt(u),k=D?Tt:Be(o),j=F?Tt:Be(u);k=k==Rt?Pe:k,j=j==Rt?Pe:j;var K=k==Pe,tt=j==Pe,st=k==j;if(st&&Zi(o)){if(!Zi(u))return!1;D=!0,K=!1}if(st&&!K)return I||(I=new Nr),D||ys(o)?gm(o,u,g,v,b,I):B1(o,u,k,g,v,b,I);if(!(g&d)){var ut=K&&Vt.call(o,"__wrapped__"),vt=tt&&Vt.call(u,"__wrapped__");if(ut||vt){var Ct=ut?o.value():o,yt=vt?u.value():u;return I||(I=new Nr),b(Ct,yt,g,v,I)}}return st?(I||(I=new Nr),D1(o,u,g,v,b,I)):!1}function o1(o){return ne(o)&&Be(o)==Lt}function Yu(o,u,g,v){var b=g.length,I=b,D=!v;if(o==null)return!I;for(o=$t(o);b--;){var F=g[b];if(D&&F[2]?F[1]!==o[F[0]]:!(F[0]in o))return!1}for(;++b<I;){F=g[b];var k=F[0],j=o[k],K=F[1];if(D&&F[2]){if(j===e&&!(k in o))return!1}else{var tt=new Nr;if(v)var st=v(j,K,k,o,u,tt);if(!(st===e?Po(K,j,d|m,v,tt):st))return!1}}return!0}function Up(o){if(!ee(o)||V1(o))return!1;var u=vi(o)?oy:K0;return u.test(Dn(o))}function a1(o){return ne(o)&&ke(o)==ar}function l1(o){return ne(o)&&Be(o)==Ze}function h1(o){return ne(o)&&Gl(o.length)&&!!Zt[ke(o)]}function kp(o){return typeof o=="function"?o:o==null?er:typeof o=="object"?bt(o)?Vp(o[0],o[1]):Hp(o):ag(o)}function ju(o){if(!Do(o))return fy(o);var u=[];for(var g in $t(o))Vt.call(o,g)&&g!="constructor"&&u.push(g);return u}function u1(o){if(!ee(o))return $1(o);var u=Do(o),g=[];for(var v in o)v=="constructor"&&(u||!Vt.call(o,v))||g.push(v);return g}function qu(o,u){return o<u}function Gp(o,u){var g=-1,v=Qe(o)?V(o.length):[];return Yi(o,function(b,I,D){v[++g]=u(b,I,D)}),v}function Hp(o){var u=uc(o);return u.length==1&&u[0][2]?Tm(u[0][0],u[0][1]):function(g){return g===o||Yu(g,o,u)}}function Vp(o,u){return fc(o)&&ym(u)?Tm(ii(o),u):function(g){var v=Ec(g,o);return v===e&&v===u?wc(g,o):Po(u,v,d|m)}}function Sl(o,u,g,v,b){o!==u&&Wu(u,function(I,D){if(b||(b=new Nr),ee(I))c1(o,u,D,g,Sl,v,b);else{var F=v?v(pc(o,D),I,D+"",o,u,b):e;F===e&&(F=I),Hu(o,D,F)}},tr)}function c1(o,u,g,v,b,I,D){var F=pc(o,g),k=pc(u,g),j=D.get(k);if(j){Hu(o,g,j);return}var K=I?I(F,k,g+"",o,u,D):e,tt=K===e;if(tt){var st=bt(k),ut=!st&&Zi(k),vt=!st&&!ut&&ys(k);K=k,st||ut||vt?bt(F)?K=F:ae(F)?K=Je(F):ut?(tt=!1,K=tm(k,!0)):vt?(tt=!1,K=em(k,!0)):K=[]:Lo(k)||On(k)?(K=F,On(F)?K=Zm(F):(!ee(F)||vi(F))&&(K=vm(k))):tt=!1}tt&&(D.set(k,K),b(K,k,v,I,D),D.delete(k)),Hu(o,g,K)}function Wp(o,u){var g=o.length;if(g)return u+=u<0?g:0,xi(u,g)?o[u]:e}function Xp(o,u,g){u.length?u=Qt(u,function(I){return bt(I)?function(D){return Mn(D,I.length===1?I[0]:I)}:I}):u=[er];var v=-1;u=Qt(u,hr(gt()));var b=Gp(o,function(I,D,F){var k=Qt(u,function(j){return j(I)});return{criteria:k,index:++v,value:I}});return Uv(b,function(I,D){return S1(I,D,g)})}function f1(o,u){return zp(o,u,function(g,v){return wc(o,v)})}function zp(o,u,g){for(var v=-1,b=u.length,I={};++v<b;){var D=u[v],F=Mn(o,D);g(F,D)&&Mo(I,qi(D,o),F)}return I}function d1(o){return function(u){return Mn(u,o)}}function Ku(o,u,g,v){var b=v?Nv:us,I=-1,D=u.length,F=o;for(o===u&&(u=Je(u)),g&&(F=Qt(o,hr(g)));++I<D;)for(var k=0,j=u[I],K=g?g(j):j;(k=b(F,K,k,v))>-1;)F!==o&&pl.call(F,k,1),pl.call(o,k,1);return o}function $p(o,u){for(var g=o?u.length:0,v=g-1;g--;){var b=u[g];if(g==v||b!==I){var I=b;xi(b)?pl.call(o,b,1):tc(o,b)}}return o}function Zu(o,u){return o+_l(Ap()*(u-o+1))}function p1(o,u,g,v){for(var b=-1,I=pe(gl((u-o)/(g||1)),0),D=V(I);I--;)D[v?I:++b]=o,o+=g;return D}function Ju(o,u){var g="";if(!o||u<1||u>q)return g;do u%2&&(g+=o),u=_l(u/2),u&&(o+=o);while(u);return g}function It(o,u){return mc(Em(o,u,er),o+"")}function m1(o){return Ip(Ts(o))}function g1(o,u){var g=Ts(o);return Ol(g,Pn(u,0,g.length))}function Mo(o,u,g,v){if(!ee(o))return o;u=qi(u,o);for(var b=-1,I=u.length,D=I-1,F=o;F!=null&&++b<I;){var k=ii(u[b]),j=g;if(k==="__proto__"||k==="constructor"||k==="prototype")return o;if(b!=D){var K=F[k];j=v?v(K,k,F):e,j===e&&(j=ee(K)?K:xi(u[b+1])?[]:{})}Co(F,k,j),F=F[k]}return o}var Yp=xl?function(o,u){return xl.set(o,u),o}:er,_1=ml?function(o,u){return ml(o,"toString",{configurable:!0,enumerable:!1,value:bc(u),writable:!0})}:er;function x1(o){return Ol(Ts(o))}function Cr(o,u,g){var v=-1,b=o.length;u<0&&(u=-u>b?0:b+u),g=g>b?b:g,g<0&&(g+=b),b=u>g?0:g-u>>>0,u>>>=0;for(var I=V(b);++v<b;)I[v]=o[v+u];return I}function v1(o,u){var g;return Yi(o,function(v,b,I){return g=u(v,b,I),!g}),!!g}function bl(o,u,g){var v=0,b=o==null?v:o.length;if(typeof u=="number"&&u===u&&b<=xt){for(;v<b;){var I=v+b>>>1,D=o[I];D!==null&&!cr(D)&&(g?D<=u:D<u)?v=I+1:b=I}return b}return Qu(o,u,er,g)}function Qu(o,u,g,v){var b=0,I=o==null?0:o.length;if(I===0)return 0;u=g(u);for(var D=u!==u,F=u===null,k=cr(u),j=u===e;b<I;){var K=_l((b+I)/2),tt=g(o[K]),st=tt!==e,ut=tt===null,vt=tt===tt,Ct=cr(tt);if(D)var yt=v||vt;else j?yt=vt&&(v||st):F?yt=vt&&st&&(v||!ut):k?yt=vt&&st&&!ut&&(v||!Ct):ut||Ct?yt=!1:yt=v?tt<=u:tt<u;yt?b=K+1:I=K}return Me(I,ot)}function jp(o,u){for(var g=-1,v=o.length,b=0,I=[];++g<v;){var D=o[g],F=u?u(D):D;if(!g||!Ur(F,k)){var k=F;I[b++]=D===0?0:D}}return I}function qp(o){return typeof o=="number"?o:cr(o)?Y:+o}function ur(o){if(typeof o=="string")return o;if(bt(o))return Qt(o,ur)+"";if(cr(o))return Cp?Cp.call(o):"";var u=o+"";return u=="0"&&1/o==-Z?"-0":u}function ji(o,u,g){var v=-1,b=nl,I=o.length,D=!0,F=[],k=F;if(g)D=!1,b=Ru;else if(I>=r){var j=u?null:P1(o);if(j)return ol(j);D=!1,b=To,k=new In}else k=u?[]:F;t:for(;++v<I;){var K=o[v],tt=u?u(K):K;if(K=g||K!==0?K:0,D&&tt===tt){for(var st=k.length;st--;)if(k[st]===tt)continue t;u&&k.push(tt),F.push(K)}else b(k,tt,g)||(k!==F&&k.push(tt),F.push(K))}return F}function tc(o,u){return u=qi(u,o),o=wm(o,u),o==null||delete o[ii(Rr(u))]}function Kp(o,u,g,v){return Mo(o,u,g(Mn(o,u)),v)}function Al(o,u,g,v){for(var b=o.length,I=v?b:-1;(v?I--:++I<b)&&u(o[I],I,o););return g?Cr(o,v?0:I,v?I+1:b):Cr(o,v?I+1:0,v?b:I)}function Zp(o,u){var g=o;return g instanceof Mt&&(g=g.value()),Iu(u,function(v,b){return b.func.apply(b.thisArg,Wi([v],b.args))},g)}function ec(o,u,g){var v=o.length;if(v<2)return v?ji(o[0]):[];for(var b=-1,I=V(v);++b<v;)for(var D=o[b],F=-1;++F<v;)F!=b&&(I[b]=Ro(I[b]||D,o[F],u,g));return ji(Ae(I,1),u,g)}function Jp(o,u,g){for(var v=-1,b=o.length,I=u.length,D={};++v<b;){var F=v<I?u[v]:e;g(D,o[v],F)}return D}function rc(o){return ae(o)?o:[]}function ic(o){return typeof o=="function"?o:er}function qi(o,u){return bt(o)?o:fc(o,u)?[o]:Cm(Gt(o))}var y1=It;function Ki(o,u,g){var v=o.length;return g=g===e?v:g,!u&&g>=v?o:Cr(o,u,g)}var Qp=ay||function(o){return ye.clearTimeout(o)};function tm(o,u){if(u)return o.slice();var g=o.length,v=Tp?Tp(g):new o.constructor(g);return o.copy(v),v}function nc(o){var u=new o.constructor(o.byteLength);return new fl(u).set(new fl(o)),u}function T1(o,u){var g=u?nc(o.buffer):o.buffer;return new o.constructor(g,o.byteOffset,o.byteLength)}function E1(o){var u=new o.constructor(o.source,Nd.exec(o));return u.lastIndex=o.lastIndex,u}function w1(o){return Ao?$t(Ao.call(o)):{}}function em(o,u){var g=u?nc(o.buffer):o.buffer;return new o.constructor(g,o.byteOffset,o.length)}function rm(o,u){if(o!==u){var g=o!==e,v=o===null,b=o===o,I=cr(o),D=u!==e,F=u===null,k=u===u,j=cr(u);if(!F&&!j&&!I&&o>u||I&&D&&k&&!F&&!j||v&&D&&k||!g&&k||!b)return 1;if(!v&&!I&&!j&&o<u||j&&g&&b&&!v&&!I||F&&g&&b||!D&&b||!k)return-1}return 0}function S1(o,u,g){for(var v=-1,b=o.criteria,I=u.criteria,D=b.length,F=g.length;++v<D;){var k=rm(b[v],I[v]);if(k){if(v>=F)return k;var j=g[v];return k*(j=="desc"?-1:1)}}return o.index-u.index}function im(o,u,g,v){for(var b=-1,I=o.length,D=g.length,F=-1,k=u.length,j=pe(I-D,0),K=V(k+j),tt=!v;++F<k;)K[F]=u[F];for(;++b<D;)(tt||b<I)&&(K[g[b]]=o[b]);for(;j--;)K[F++]=o[b++];return K}function nm(o,u,g,v){for(var b=-1,I=o.length,D=-1,F=g.length,k=-1,j=u.length,K=pe(I-F,0),tt=V(K+j),st=!v;++b<K;)tt[b]=o[b];for(var ut=b;++k<j;)tt[ut+k]=u[k];for(;++D<F;)(st||b<I)&&(tt[ut+g[D]]=o[b++]);return tt}function Je(o,u){var g=-1,v=o.length;for(u||(u=V(v));++g<v;)u[g]=o[g];return u}function ri(o,u,g,v){var b=!g;g||(g={});for(var I=-1,D=u.length;++I<D;){var F=u[I],k=v?v(g[F],o[F],F,g,o):e;k===e&&(k=o[F]),b?mi(g,F,k):Co(g,F,k)}return g}function b1(o,u){return ri(o,cc(o),u)}function A1(o,u){return ri(o,_m(o),u)}function Cl(o,u){return function(g,v){var b=bt(g)?Mv:jy,I=u?u():{};return b(g,o,gt(v,2),I)}}function _s(o){return It(function(u,g){var v=-1,b=g.length,I=b>1?g[b-1]:e,D=b>2?g[2]:e;for(I=o.length>3&&typeof I=="function"?(b--,I):e,D&&Ge(g[0],g[1],D)&&(I=b<3?e:I,b=1),u=$t(u);++v<b;){var F=g[v];F&&o(u,F,v,I)}return u})}function sm(o,u){return function(g,v){if(g==null)return g;if(!Qe(g))return o(g,v);for(var b=g.length,I=u?b:-1,D=$t(g);(u?I--:++I<b)&&v(D[I],I,D)!==!1;);return g}}function om(o){return function(u,g,v){for(var b=-1,I=$t(u),D=v(u),F=D.length;F--;){var k=D[o?F:++b];if(g(I[k],k,I)===!1)break}return u}}function C1(o,u,g){var v=u&_,b=Bo(o);function I(){var D=this&&this!==ye&&this instanceof I?b:o;return D.apply(v?g:this,arguments)}return I}function am(o){return function(u){u=Gt(u);var g=cs(u)?Fr(u):e,v=g?g[0]:u.charAt(0),b=g?Ki(g,1).join(""):u.slice(1);return v[o]()+b}}function xs(o){return function(u){return Iu(sg(ng(u).replace(_v,"")),o,"")}}function Bo(o){return function(){var u=arguments;switch(u.length){case 0:return new o;case 1:return new o(u[0]);case 2:return new o(u[0],u[1]);case 3:return new o(u[0],u[1],u[2]);case 4:return new o(u[0],u[1],u[2],u[3]);case 5:return new o(u[0],u[1],u[2],u[3],u[4]);case 6:return new o(u[0],u[1],u[2],u[3],u[4],u[5]);case 7:return new o(u[0],u[1],u[2],u[3],u[4],u[5],u[6])}var g=gs(o.prototype),v=o.apply(g,u);return ee(v)?v:g}}function R1(o,u,g){var v=Bo(o);function b(){for(var I=arguments.length,D=V(I),F=I,k=vs(b);F--;)D[F]=arguments[F];var j=I<3&&D[0]!==k&&D[I-1]!==k?[]:Xi(D,k);if(I-=j.length,I<g)return fm(o,u,Rl,b.placeholder,e,D,j,e,e,g-I);var K=this&&this!==ye&&this instanceof b?v:o;return lr(K,this,D)}return b}function lm(o){return function(u,g,v){var b=$t(u);if(!Qe(u)){var I=gt(g,3);u=Te(u),g=function(F){return I(b[F],F,b)}}var D=o(u,g,v);return D>-1?b[I?u[D]:D]:e}}function hm(o){return _i(function(u){var g=u.length,v=g,b=br.prototype.thru;for(o&&u.reverse();v--;){var I=u[v];if(typeof I!="function")throw new Sr(n);if(b&&!D&&Bl(I)=="wrapper")var D=new br([],!0)}for(v=D?v:g;++v<g;){I=u[v];var F=Bl(I),k=F=="wrapper"?hc(I):e;k&&dc(k[0])&&k[1]==(R|S|y|C)&&!k[4].length&&k[9]==1?D=D[Bl(k[0])].apply(D,k[3]):D=I.length==1&&dc(I)?D[F]():D.thru(I)}return function(){var j=arguments,K=j[0];if(D&&j.length==1&&bt(K))return D.plant(K).value();for(var tt=0,st=g?u[tt].apply(this,j):K;++tt<g;)st=u[tt].call(this,st);return st}})}function Rl(o,u,g,v,b,I,D,F,k,j){var K=u&R,tt=u&_,st=u&x,ut=u&(S|w),vt=u&P,Ct=st?e:Bo(o);function yt(){for(var Pt=arguments.length,Dt=V(Pt),fr=Pt;fr--;)Dt[fr]=arguments[fr];if(ut)var He=vs(yt),dr=Gv(Dt,He);if(v&&(Dt=im(Dt,v,b,ut)),I&&(Dt=nm(Dt,I,D,ut)),Pt-=dr,ut&&Pt<j){var le=Xi(Dt,He);return fm(o,u,Rl,yt.placeholder,g,Dt,le,F,k,j-Pt)}var kr=tt?g:this,Ti=st?kr[o]:o;return Pt=Dt.length,F?Dt=j1(Dt,F):vt&&Pt>1&&Dt.reverse(),K&&k<Pt&&(Dt.length=k),this&&this!==ye&&this instanceof yt&&(Ti=Ct||Bo(Ti)),Ti.apply(kr,Dt)}return yt}function um(o,u){return function(g,v){return r1(g,o,u(v),{})}}function Il(o,u){return function(g,v){var b;if(g===e&&v===e)return u;if(g!==e&&(b=g),v!==e){if(b===e)return v;typeof g=="string"||typeof v=="string"?(g=ur(g),v=ur(v)):(g=qp(g),v=qp(v)),b=o(g,v)}return b}}function sc(o){return _i(function(u){return u=Qt(u,hr(gt())),It(function(g){var v=this;return o(u,function(b){return lr(b,v,g)})})})}function Pl(o,u){u=u===e?" ":ur(u);var g=u.length;if(g<2)return g?Ju(u,o):u;var v=Ju(u,gl(o/fs(u)));return cs(u)?Ki(Fr(v),0,o).join(""):v.slice(0,o)}function I1(o,u,g,v){var b=u&_,I=Bo(o);function D(){for(var F=-1,k=arguments.length,j=-1,K=v.length,tt=V(K+k),st=this&&this!==ye&&this instanceof D?I:o;++j<K;)tt[j]=v[j];for(;k--;)tt[j++]=arguments[++F];return lr(st,b?g:this,tt)}return D}function cm(o){return function(u,g,v){return v&&typeof v!="number"&&Ge(u,g,v)&&(g=v=e),u=yi(u),g===e?(g=u,u=0):g=yi(g),v=v===e?u<g?1:-1:yi(v),p1(u,g,v,o)}}function Ml(o){return function(u,g){return typeof u=="string"&&typeof g=="string"||(u=Ir(u),g=Ir(g)),o(u,g)}}function fm(o,u,g,v,b,I,D,F,k,j){var K=u&S,tt=K?D:e,st=K?e:D,ut=K?I:e,vt=K?e:I;u|=K?y:E,u&=~(K?E:y),u&T||(u&=~(_|x));var Ct=[o,u,b,ut,tt,vt,st,F,k,j],yt=g.apply(e,Ct);return dc(o)&&Sm(yt,Ct),yt.placeholder=v,bm(yt,o,u)}function oc(o){var u=de[o];return function(g,v){if(g=Ir(g),v=v==null?0:Me(At(v),292),v&&bp(g)){var b=(Gt(g)+"e").split("e"),I=u(b[0]+"e"+(+b[1]+v));return b=(Gt(I)+"e").split("e"),+(b[0]+"e"+(+b[1]-v))}return u(g)}}var P1=ps&&1/ol(new ps([,-0]))[1]==Z?function(o){return new ps(o)}:Rc;function dm(o){return function(u){var g=Be(u);return g==Lt?Fu(u):g==Ze?Yv(u):kv(u,o(u))}}function gi(o,u,g,v,b,I,D,F){var k=u&x;if(!k&&typeof o!="function")throw new Sr(n);var j=v?v.length:0;if(j||(u&=~(y|E),v=b=e),D=D===e?D:pe(At(D),0),F=F===e?F:At(F),j-=b?b.length:0,u&E){var K=v,tt=b;v=b=e}var st=k?e:hc(o),ut=[o,u,g,v,b,K,tt,I,D,F];if(st&&z1(ut,st),o=ut[0],u=ut[1],g=ut[2],v=ut[3],b=ut[4],F=ut[9]=ut[9]===e?k?0:o.length:pe(ut[9]-j,0),!F&&u&(S|w)&&(u&=~(S|w)),!u||u==_)var vt=C1(o,u,g);else u==S||u==w?vt=R1(o,u,F):(u==y||u==(_|y))&&!b.length?vt=I1(o,u,g,v):vt=Rl.apply(e,ut);var Ct=st?Yp:Sm;return bm(Ct(vt,ut),o,u)}function pm(o,u,g,v){return o===e||Ur(o,ds[g])&&!Vt.call(v,g)?u:o}function mm(o,u,g,v,b,I){return ee(o)&&ee(u)&&(I.set(u,o),Sl(o,u,e,mm,I),I.delete(u)),o}function M1(o){return Lo(o)?e:o}function gm(o,u,g,v,b,I){var D=g&d,F=o.length,k=u.length;if(F!=k&&!(D&&k>F))return!1;var j=I.get(o),K=I.get(u);if(j&&K)return j==u&&K==o;var tt=-1,st=!0,ut=g&m?new In:e;for(I.set(o,u),I.set(u,o);++tt<F;){var vt=o[tt],Ct=u[tt];if(v)var yt=D?v(Ct,vt,tt,u,o,I):v(vt,Ct,tt,o,u,I);if(yt!==e){if(yt)continue;st=!1;break}if(ut){if(!Pu(u,function(Pt,Dt){if(!To(ut,Dt)&&(vt===Pt||b(vt,Pt,g,v,I)))return ut.push(Dt)})){st=!1;break}}else if(!(vt===Ct||b(vt,Ct,g,v,I))){st=!1;break}}return I.delete(o),I.delete(u),st}function B1(o,u,g,v,b,I,D){switch(g){case ls:if(o.byteLength!=u.byteLength||o.byteOffset!=u.byteOffset)return!1;o=o.buffer,u=u.buffer;case yo:return!(o.byteLength!=u.byteLength||!I(new fl(o),new fl(u)));case Ot:case te:case Ut:return Ur(+o,+u);case jt:return o.name==u.name&&o.message==u.message;case ar:case Qr:return o==u+"";case Lt:var F=Fu;case Ze:var k=v&d;if(F||(F=ol),o.size!=u.size&&!k)return!1;var j=D.get(o);if(j)return j==u;v|=m,D.set(o,u);var K=gm(F(o),F(u),v,b,I,D);return D.delete(o),K;case os:if(Ao)return Ao.call(o)==Ao.call(u)}return!1}function D1(o,u,g,v,b,I){var D=g&d,F=ac(o),k=F.length,j=ac(u),K=j.length;if(k!=K&&!D)return!1;for(var tt=k;tt--;){var st=F[tt];if(!(D?st in u:Vt.call(u,st)))return!1}var ut=I.get(o),vt=I.get(u);if(ut&&vt)return ut==u&&vt==o;var Ct=!0;I.set(o,u),I.set(u,o);for(var yt=D;++tt<k;){st=F[tt];var Pt=o[st],Dt=u[st];if(v)var fr=D?v(Dt,Pt,st,u,o,I):v(Pt,Dt,st,o,u,I);if(!(fr===e?Pt===Dt||b(Pt,Dt,g,v,I):fr)){Ct=!1;break}yt||(yt=st=="constructor")}if(Ct&&!yt){var He=o.constructor,dr=u.constructor;He!=dr&&"constructor"in o&&"constructor"in u&&!(typeof He=="function"&&He instanceof He&&typeof dr=="function"&&dr instanceof dr)&&(Ct=!1)}return I.delete(o),I.delete(u),Ct}function _i(o){return mc(Em(o,e,Mm),o+"")}function ac(o){return Fp(o,Te,cc)}function lc(o){return Fp(o,tr,_m)}var hc=xl?function(o){return xl.get(o)}:Rc;function Bl(o){for(var u=o.name+"",g=ms[u],v=Vt.call(ms,u)?g.length:0;v--;){var b=g[v],I=b.func;if(I==null||I==o)return b.name}return u}function vs(o){var u=Vt.call(A,"placeholder")?A:o;return u.placeholder}function gt(){var o=A.iteratee||Ac;return o=o===Ac?kp:o,arguments.length?o(arguments[0],arguments[1]):o}function Dl(o,u){var g=o.__data__;return H1(u)?g[typeof u=="string"?"string":"hash"]:g.map}function uc(o){for(var u=Te(o),g=u.length;g--;){var v=u[g],b=o[v];u[g]=[v,b,ym(b)]}return u}function Bn(o,u){var g=Xv(o,u);return Up(g)?g:e}function O1(o){var u=Vt.call(o,Cn),g=o[Cn];try{o[Cn]=e;var v=!0}catch{}var b=ul.call(o);return v&&(u?o[Cn]=g:delete o[Cn]),b}var cc=Uu?function(o){return o==null?[]:(o=$t(o),Vi(Uu(o),function(u){return wp.call(o,u)}))}:Ic,_m=Uu?function(o){for(var u=[];o;)Wi(u,cc(o)),o=dl(o);return u}:Ic,Be=ke;(ku&&Be(new ku(new ArrayBuffer(1)))!=ls||wo&&Be(new wo)!=Lt||Gu&&Be(Gu.resolve())!=bn||ps&&Be(new ps)!=Ze||So&&Be(new So)!=ti)&&(Be=function(o){var u=ke(o),g=u==Pe?o.constructor:e,v=g?Dn(g):"";if(v)switch(v){case gy:return ls;case _y:return Lt;case xy:return bn;case vy:return Ze;case yy:return ti}return u});function L1(o,u,g){for(var v=-1,b=g.length;++v<b;){var I=g[v],D=I.size;switch(I.type){case"drop":o+=D;break;case"dropRight":u-=D;break;case"take":u=Me(u,o+D);break;case"takeRight":o=pe(o,u-D);break}}return{start:o,end:u}}function F1(o){var u=o.match(V0);return u?u[1].split(W0):[]}function xm(o,u,g){u=qi(u,o);for(var v=-1,b=u.length,I=!1;++v<b;){var D=ii(u[v]);if(!(I=o!=null&&g(o,D)))break;o=o[D]}return I||++v!=b?I:(b=o==null?0:o.length,!!b&&Gl(b)&&xi(D,b)&&(bt(o)||On(o)))}function N1(o){var u=o.length,g=new o.constructor(u);return u&&typeof o[0]=="string"&&Vt.call(o,"index")&&(g.index=o.index,g.input=o.input),g}function vm(o){return typeof o.constructor=="function"&&!Do(o)?gs(dl(o)):{}}function U1(o,u,g){var v=o.constructor;switch(u){case yo:return nc(o);case Ot:case te:return new v(+o);case ls:return T1(o,g);case uu:case cu:case fu:case du:case pu:case mu:case gu:case _u:case xu:return em(o,g);case Lt:return new v;case Ut:case Qr:return new v(o);case ar:return E1(o);case Ze:return new v;case os:return w1(o)}}function k1(o,u){var g=u.length;if(!g)return o;var v=g-1;return u[v]=(g>1?"& ":"")+u[v],u=u.join(g>2?", ":" "),o.replace(H0,`{
/* [wrapped with `+u+`] */
`)}function G1(o){return bt(o)||On(o)||!!(Sp&&o&&o[Sp])}function xi(o,u){var g=typeof o;return u=u??q,!!u&&(g=="number"||g!="symbol"&&J0.test(o))&&o>-1&&o%1==0&&o<u}function Ge(o,u,g){if(!ee(g))return!1;var v=typeof u;return(v=="number"?Qe(g)&&xi(u,g.length):v=="string"&&u in g)?Ur(g[u],o):!1}function fc(o,u){if(bt(o))return!1;var g=typeof o;return g=="number"||g=="symbol"||g=="boolean"||o==null||cr(o)?!0:N0.test(o)||!F0.test(o)||u!=null&&o in $t(u)}function H1(o){var u=typeof o;return u=="string"||u=="number"||u=="symbol"||u=="boolean"?o!=="__proto__":o===null}function dc(o){var u=Bl(o),g=A[u];if(typeof g!="function"||!(u in Mt.prototype))return!1;if(o===g)return!0;var v=hc(g);return!!v&&o===v[0]}function V1(o){return!!yp&&yp in o}var W1=ll?vi:Pc;function Do(o){var u=o&&o.constructor,g=typeof u=="function"&&u.prototype||ds;return o===g}function ym(o){return o===o&&!ee(o)}function Tm(o,u){return function(g){return g==null?!1:g[o]===u&&(u!==e||o in $t(g))}}function X1(o){var u=Ul(o,function(v){return g.size===c&&g.clear(),v}),g=u.cache;return u}function z1(o,u){var g=o[1],v=u[1],b=g|v,I=b<(_|x|R),D=v==R&&g==S||v==R&&g==C&&o[7].length<=u[8]||v==(R|C)&&u[7].length<=u[8]&&g==S;if(!(I||D))return o;v&_&&(o[2]=u[2],b|=g&_?0:T);var F=u[3];if(F){var k=o[3];o[3]=k?im(k,F,u[4]):F,o[4]=k?Xi(o[3],f):u[4]}return F=u[5],F&&(k=o[5],o[5]=k?nm(k,F,u[6]):F,o[6]=k?Xi(o[5],f):u[6]),F=u[7],F&&(o[7]=F),v&R&&(o[8]=o[8]==null?u[8]:Me(o[8],u[8])),o[9]==null&&(o[9]=u[9]),o[0]=u[0],o[1]=b,o}function $1(o){var u=[];if(o!=null)for(var g in $t(o))u.push(g);return u}function Y1(o){return ul.call(o)}function Em(o,u,g){return u=pe(u===e?o.length-1:u,0),function(){for(var v=arguments,b=-1,I=pe(v.length-u,0),D=V(I);++b<I;)D[b]=v[u+b];b=-1;for(var F=V(u+1);++b<u;)F[b]=v[b];return F[u]=g(D),lr(o,this,F)}}function wm(o,u){return u.length<2?o:Mn(o,Cr(u,0,-1))}function j1(o,u){for(var g=o.length,v=Me(u.length,g),b=Je(o);v--;){var I=u[v];o[v]=xi(I,g)?b[I]:e}return o}function pc(o,u){if(!(u==="constructor"&&typeof o[u]=="function")&&u!="__proto__")return o[u]}var Sm=Am(Yp),Oo=hy||function(o,u){return ye.setTimeout(o,u)},mc=Am(_1);function bm(o,u,g){var v=u+"";return mc(o,k1(v,q1(F1(v),g)))}function Am(o){var u=0,g=0;return function(){var v=dy(),b=O-(v-g);if(g=v,b>0){if(++u>=L)return arguments[0]}else u=0;return o.apply(e,arguments)}}function Ol(o,u){var g=-1,v=o.length,b=v-1;for(u=u===e?v:u;++g<u;){var I=Zu(g,b),D=o[I];o[I]=o[g],o[g]=D}return o.length=u,o}var Cm=X1(function(o){var u=[];return o.charCodeAt(0)===46&&u.push(""),o.replace(U0,function(g,v,b,I){u.push(b?I.replace($0,"$1"):v||g)}),u});function ii(o){if(typeof o=="string"||cr(o))return o;var u=o+"";return u=="0"&&1/o==-Z?"-0":u}function Dn(o){if(o!=null){try{return hl.call(o)}catch{}try{return o+""}catch{}}return""}function q1(o,u){return wr(Et,function(g){var v="_."+g[0];u&g[1]&&!nl(o,v)&&o.push(v)}),o.sort()}function Rm(o){if(o instanceof Mt)return o.clone();var u=new br(o.__wrapped__,o.__chain__);return u.__actions__=Je(o.__actions__),u.__index__=o.__index__,u.__values__=o.__values__,u}function K1(o,u,g){(g?Ge(o,u,g):u===e)?u=1:u=pe(At(u),0);var v=o==null?0:o.length;if(!v||u<1)return[];for(var b=0,I=0,D=V(gl(v/u));b<v;)D[I++]=Cr(o,b,b+=u);return D}function Z1(o){for(var u=-1,g=o==null?0:o.length,v=0,b=[];++u<g;){var I=o[u];I&&(b[v++]=I)}return b}function J1(){var o=arguments.length;if(!o)return[];for(var u=V(o-1),g=arguments[0],v=o;v--;)u[v-1]=arguments[v];return Wi(bt(g)?Je(g):[g],Ae(u,1))}var Q1=It(function(o,u){return ae(o)?Ro(o,Ae(u,1,ae,!0)):[]}),tT=It(function(o,u){var g=Rr(u);return ae(g)&&(g=e),ae(o)?Ro(o,Ae(u,1,ae,!0),gt(g,2)):[]}),eT=It(function(o,u){var g=Rr(u);return ae(g)&&(g=e),ae(o)?Ro(o,Ae(u,1,ae,!0),e,g):[]});function rT(o,u,g){var v=o==null?0:o.length;return v?(u=g||u===e?1:At(u),Cr(o,u<0?0:u,v)):[]}function iT(o,u,g){var v=o==null?0:o.length;return v?(u=g||u===e?1:At(u),u=v-u,Cr(o,0,u<0?0:u)):[]}function nT(o,u){return o&&o.length?Al(o,gt(u,3),!0,!0):[]}function sT(o,u){return o&&o.length?Al(o,gt(u,3),!0):[]}function oT(o,u,g,v){var b=o==null?0:o.length;return b?(g&&typeof g!="number"&&Ge(o,u,g)&&(g=0,v=b),Jy(o,u,g,v)):[]}function Im(o,u,g){var v=o==null?0:o.length;if(!v)return-1;var b=g==null?0:At(g);return b<0&&(b=pe(v+b,0)),sl(o,gt(u,3),b)}function Pm(o,u,g){var v=o==null?0:o.length;if(!v)return-1;var b=v-1;return g!==e&&(b=At(g),b=g<0?pe(v+b,0):Me(b,v-1)),sl(o,gt(u,3),b,!0)}function Mm(o){var u=o==null?0:o.length;return u?Ae(o,1):[]}function aT(o){var u=o==null?0:o.length;return u?Ae(o,Z):[]}function lT(o,u){var g=o==null?0:o.length;return g?(u=u===e?1:At(u),Ae(o,u)):[]}function hT(o){for(var u=-1,g=o==null?0:o.length,v={};++u<g;){var b=o[u];v[b[0]]=b[1]}return v}function Bm(o){return o&&o.length?o[0]:e}function uT(o,u,g){var v=o==null?0:o.length;if(!v)return-1;var b=g==null?0:At(g);return b<0&&(b=pe(v+b,0)),us(o,u,b)}function cT(o){var u=o==null?0:o.length;return u?Cr(o,0,-1):[]}var fT=It(function(o){var u=Qt(o,rc);return u.length&&u[0]===o[0]?$u(u):[]}),dT=It(function(o){var u=Rr(o),g=Qt(o,rc);return u===Rr(g)?u=e:g.pop(),g.length&&g[0]===o[0]?$u(g,gt(u,2)):[]}),pT=It(function(o){var u=Rr(o),g=Qt(o,rc);return u=typeof u=="function"?u:e,u&&g.pop(),g.length&&g[0]===o[0]?$u(g,e,u):[]});function mT(o,u){return o==null?"":cy.call(o,u)}function Rr(o){var u=o==null?0:o.length;return u?o[u-1]:e}function gT(o,u,g){var v=o==null?0:o.length;if(!v)return-1;var b=v;return g!==e&&(b=At(g),b=b<0?pe(v+b,0):Me(b,v-1)),u===u?qv(o,u,b):sl(o,fp,b,!0)}function _T(o,u){return o&&o.length?Wp(o,At(u)):e}var xT=It(Dm);function Dm(o,u){return o&&o.length&&u&&u.length?Ku(o,u):o}function vT(o,u,g){return o&&o.length&&u&&u.length?Ku(o,u,gt(g,2)):o}function yT(o,u,g){return o&&o.length&&u&&u.length?Ku(o,u,e,g):o}var TT=_i(function(o,u){var g=o==null?0:o.length,v=Vu(o,u);return $p(o,Qt(u,function(b){return xi(b,g)?+b:b}).sort(rm)),v});function ET(o,u){var g=[];if(!(o&&o.length))return g;var v=-1,b=[],I=o.length;for(u=gt(u,3);++v<I;){var D=o[v];u(D,v,o)&&(g.push(D),b.push(v))}return $p(o,b),g}function gc(o){return o==null?o:my.call(o)}function wT(o,u,g){var v=o==null?0:o.length;return v?(g&&typeof g!="number"&&Ge(o,u,g)?(u=0,g=v):(u=u==null?0:At(u),g=g===e?v:At(g)),Cr(o,u,g)):[]}function ST(o,u){return bl(o,u)}function bT(o,u,g){return Qu(o,u,gt(g,2))}function AT(o,u){var g=o==null?0:o.length;if(g){var v=bl(o,u);if(v<g&&Ur(o[v],u))return v}return-1}function CT(o,u){return bl(o,u,!0)}function RT(o,u,g){return Qu(o,u,gt(g,2),!0)}function IT(o,u){var g=o==null?0:o.length;if(g){var v=bl(o,u,!0)-1;if(Ur(o[v],u))return v}return-1}function PT(o){return o&&o.length?jp(o):[]}function MT(o,u){return o&&o.length?jp(o,gt(u,2)):[]}function BT(o){var u=o==null?0:o.length;return u?Cr(o,1,u):[]}function DT(o,u,g){return o&&o.length?(u=g||u===e?1:At(u),Cr(o,0,u<0?0:u)):[]}function OT(o,u,g){var v=o==null?0:o.length;return v?(u=g||u===e?1:At(u),u=v-u,Cr(o,u<0?0:u,v)):[]}function LT(o,u){return o&&o.length?Al(o,gt(u,3),!1,!0):[]}function FT(o,u){return o&&o.length?Al(o,gt(u,3)):[]}var NT=It(function(o){return ji(Ae(o,1,ae,!0))}),UT=It(function(o){var u=Rr(o);return ae(u)&&(u=e),ji(Ae(o,1,ae,!0),gt(u,2))}),kT=It(function(o){var u=Rr(o);return u=typeof u=="function"?u:e,ji(Ae(o,1,ae,!0),e,u)});function GT(o){return o&&o.length?ji(o):[]}function HT(o,u){return o&&o.length?ji(o,gt(u,2)):[]}function VT(o,u){return u=typeof u=="function"?u:e,o&&o.length?ji(o,e,u):[]}function _c(o){if(!(o&&o.length))return[];var u=0;return o=Vi(o,function(g){if(ae(g))return u=pe(g.length,u),!0}),Ou(u,function(g){return Qt(o,Mu(g))})}function Om(o,u){if(!(o&&o.length))return[];var g=_c(o);return u==null?g:Qt(g,function(v){return lr(u,e,v)})}var WT=It(function(o,u){return ae(o)?Ro(o,u):[]}),XT=It(function(o){return ec(Vi(o,ae))}),zT=It(function(o){var u=Rr(o);return ae(u)&&(u=e),ec(Vi(o,ae),gt(u,2))}),$T=It(function(o){var u=Rr(o);return u=typeof u=="function"?u:e,ec(Vi(o,ae),e,u)}),YT=It(_c);function jT(o,u){return Jp(o||[],u||[],Co)}function qT(o,u){return Jp(o||[],u||[],Mo)}var KT=It(function(o){var u=o.length,g=u>1?o[u-1]:e;return g=typeof g=="function"?(o.pop(),g):e,Om(o,g)});function Lm(o){var u=A(o);return u.__chain__=!0,u}function ZT(o,u){return u(o),o}function Ll(o,u){return u(o)}var JT=_i(function(o){var u=o.length,g=u?o[0]:0,v=this.__wrapped__,b=function(I){return Vu(I,o)};return u>1||this.__actions__.length||!(v instanceof Mt)||!xi(g)?this.thru(b):(v=v.slice(g,+g+(u?1:0)),v.__actions__.push({func:Ll,args:[b],thisArg:e}),new br(v,this.__chain__).thru(function(I){return u&&!I.length&&I.push(e),I}))});function QT(){return Lm(this)}function tE(){return new br(this.value(),this.__chain__)}function eE(){this.__values__===e&&(this.__values__=qm(this.value()));var o=this.__index__>=this.__values__.length,u=o?e:this.__values__[this.__index__++];return{done:o,value:u}}function rE(){return this}function iE(o){for(var u,g=this;g instanceof yl;){var v=Rm(g);v.__index__=0,v.__values__=e,u?b.__wrapped__=v:u=v;var b=v;g=g.__wrapped__}return b.__wrapped__=o,u}function nE(){var o=this.__wrapped__;if(o instanceof Mt){var u=o;return this.__actions__.length&&(u=new Mt(this)),u=u.reverse(),u.__actions__.push({func:Ll,args:[gc],thisArg:e}),new br(u,this.__chain__)}return this.thru(gc)}function sE(){return Zp(this.__wrapped__,this.__actions__)}var oE=Cl(function(o,u,g){Vt.call(o,g)?++o[g]:mi(o,g,1)});function aE(o,u,g){var v=bt(o)?up:Zy;return g&&Ge(o,u,g)&&(u=e),v(o,gt(u,3))}function lE(o,u){var g=bt(o)?Vi:Op;return g(o,gt(u,3))}var hE=lm(Im),uE=lm(Pm);function cE(o,u){return Ae(Fl(o,u),1)}function fE(o,u){return Ae(Fl(o,u),Z)}function dE(o,u,g){return g=g===e?1:At(g),Ae(Fl(o,u),g)}function Fm(o,u){var g=bt(o)?wr:Yi;return g(o,gt(u,3))}function Nm(o,u){var g=bt(o)?Bv:Dp;return g(o,gt(u,3))}var pE=Cl(function(o,u,g){Vt.call(o,g)?o[g].push(u):mi(o,g,[u])});function mE(o,u,g,v){o=Qe(o)?o:Ts(o),g=g&&!v?At(g):0;var b=o.length;return g<0&&(g=pe(b+g,0)),Hl(o)?g<=b&&o.indexOf(u,g)>-1:!!b&&us(o,u,g)>-1}var gE=It(function(o,u,g){var v=-1,b=typeof u=="function",I=Qe(o)?V(o.length):[];return Yi(o,function(D){I[++v]=b?lr(u,D,g):Io(D,u,g)}),I}),_E=Cl(function(o,u,g){mi(o,g,u)});function Fl(o,u){var g=bt(o)?Qt:Gp;return g(o,gt(u,3))}function xE(o,u,g,v){return o==null?[]:(bt(u)||(u=u==null?[]:[u]),g=v?e:g,bt(g)||(g=g==null?[]:[g]),Xp(o,u,g))}var vE=Cl(function(o,u,g){o[g?0:1].push(u)},function(){return[[],[]]});function yE(o,u,g){var v=bt(o)?Iu:pp,b=arguments.length<3;return v(o,gt(u,4),g,b,Yi)}function TE(o,u,g){var v=bt(o)?Dv:pp,b=arguments.length<3;return v(o,gt(u,4),g,b,Dp)}function EE(o,u){var g=bt(o)?Vi:Op;return g(o,kl(gt(u,3)))}function wE(o){var u=bt(o)?Ip:m1;return u(o)}function SE(o,u,g){(g?Ge(o,u,g):u===e)?u=1:u=At(u);var v=bt(o)?$y:g1;return v(o,u)}function bE(o){var u=bt(o)?Yy:x1;return u(o)}function AE(o){if(o==null)return 0;if(Qe(o))return Hl(o)?fs(o):o.length;var u=Be(o);return u==Lt||u==Ze?o.size:ju(o).length}function CE(o,u,g){var v=bt(o)?Pu:v1;return g&&Ge(o,u,g)&&(u=e),v(o,gt(u,3))}var RE=It(function(o,u){if(o==null)return[];var g=u.length;return g>1&&Ge(o,u[0],u[1])?u=[]:g>2&&Ge(u[0],u[1],u[2])&&(u=[u[0]]),Xp(o,Ae(u,1),[])}),Nl=ly||function(){return ye.Date.now()};function IE(o,u){if(typeof u!="function")throw new Sr(n);return o=At(o),function(){if(--o<1)return u.apply(this,arguments)}}function Um(o,u,g){return u=g?e:u,u=o&&u==null?o.length:u,gi(o,R,e,e,e,e,u)}function km(o,u){var g;if(typeof u!="function")throw new Sr(n);return o=At(o),function(){return--o>0&&(g=u.apply(this,arguments)),o<=1&&(u=e),g}}var xc=It(function(o,u,g){var v=_;if(g.length){var b=Xi(g,vs(xc));v|=y}return gi(o,v,u,g,b)}),Gm=It(function(o,u,g){var v=_|x;if(g.length){var b=Xi(g,vs(Gm));v|=y}return gi(u,v,o,g,b)});function Hm(o,u,g){u=g?e:u;var v=gi(o,S,e,e,e,e,e,u);return v.placeholder=Hm.placeholder,v}function Vm(o,u,g){u=g?e:u;var v=gi(o,w,e,e,e,e,e,u);return v.placeholder=Vm.placeholder,v}function Wm(o,u,g){var v,b,I,D,F,k,j=0,K=!1,tt=!1,st=!0;if(typeof o!="function")throw new Sr(n);u=Ir(u)||0,ee(g)&&(K=!!g.leading,tt="maxWait"in g,I=tt?pe(Ir(g.maxWait)||0,u):I,st="trailing"in g?!!g.trailing:st);function ut(le){var kr=v,Ti=b;return v=b=e,j=le,D=o.apply(Ti,kr),D}function vt(le){return j=le,F=Oo(Pt,u),K?ut(le):D}function Ct(le){var kr=le-k,Ti=le-j,lg=u-kr;return tt?Me(lg,I-Ti):lg}function yt(le){var kr=le-k,Ti=le-j;return k===e||kr>=u||kr<0||tt&&Ti>=I}function Pt(){var le=Nl();if(yt(le))return Dt(le);F=Oo(Pt,Ct(le))}function Dt(le){return F=e,st&&v?ut(le):(v=b=e,D)}function fr(){F!==e&&Qp(F),j=0,v=k=b=F=e}function He(){return F===e?D:Dt(Nl())}function dr(){var le=Nl(),kr=yt(le);if(v=arguments,b=this,k=le,kr){if(F===e)return vt(k);if(tt)return Qp(F),F=Oo(Pt,u),ut(k)}return F===e&&(F=Oo(Pt,u)),D}return dr.cancel=fr,dr.flush=He,dr}var PE=It(function(o,u){return Bp(o,1,u)}),ME=It(function(o,u,g){return Bp(o,Ir(u)||0,g)});function BE(o){return gi(o,P)}function Ul(o,u){if(typeof o!="function"||u!=null&&typeof u!="function")throw new Sr(n);var g=function(){var v=arguments,b=u?u.apply(this,v):v[0],I=g.cache;if(I.has(b))return I.get(b);var D=o.apply(this,v);return g.cache=I.set(b,D)||I,D};return g.cache=new(Ul.Cache||pi),g}Ul.Cache=pi;function kl(o){if(typeof o!="function")throw new Sr(n);return function(){var u=arguments;switch(u.length){case 0:return!o.call(this);case 1:return!o.call(this,u[0]);case 2:return!o.call(this,u[0],u[1]);case 3:return!o.call(this,u[0],u[1],u[2])}return!o.apply(this,u)}}function DE(o){return km(2,o)}var OE=y1(function(o,u){u=u.length==1&&bt(u[0])?Qt(u[0],hr(gt())):Qt(Ae(u,1),hr(gt()));var g=u.length;return It(function(v){for(var b=-1,I=Me(v.length,g);++b<I;)v[b]=u[b].call(this,v[b]);return lr(o,this,v)})}),vc=It(function(o,u){var g=Xi(u,vs(vc));return gi(o,y,e,u,g)}),Xm=It(function(o,u){var g=Xi(u,vs(Xm));return gi(o,E,e,u,g)}),LE=_i(function(o,u){return gi(o,C,e,e,e,u)});function FE(o,u){if(typeof o!="function")throw new Sr(n);return u=u===e?u:At(u),It(o,u)}function NE(o,u){if(typeof o!="function")throw new Sr(n);return u=u==null?0:pe(At(u),0),It(function(g){var v=g[u],b=Ki(g,0,u);return v&&Wi(b,v),lr(o,this,b)})}function UE(o,u,g){var v=!0,b=!0;if(typeof o!="function")throw new Sr(n);return ee(g)&&(v="leading"in g?!!g.leading:v,b="trailing"in g?!!g.trailing:b),Wm(o,u,{leading:v,maxWait:u,trailing:b})}function kE(o){return Um(o,1)}function GE(o,u){return vc(ic(u),o)}function HE(){if(!arguments.length)return[];var o=arguments[0];return bt(o)?o:[o]}function VE(o){return Ar(o,h)}function WE(o,u){return u=typeof u=="function"?u:e,Ar(o,h,u)}function XE(o){return Ar(o,p|h)}function zE(o,u){return u=typeof u=="function"?u:e,Ar(o,p|h,u)}function $E(o,u){return u==null||Mp(o,u,Te(u))}function Ur(o,u){return o===u||o!==o&&u!==u}var YE=Ml(zu),jE=Ml(function(o,u){return o>=u}),On=Np(function(){return arguments}())?Np:function(o){return ne(o)&&Vt.call(o,"callee")&&!wp.call(o,"callee")},bt=V.isArray,qE=np?hr(np):i1;function Qe(o){return o!=null&&Gl(o.length)&&!vi(o)}function ae(o){return ne(o)&&Qe(o)}function KE(o){return o===!0||o===!1||ne(o)&&ke(o)==Ot}var Zi=uy||Pc,ZE=sp?hr(sp):n1;function JE(o){return ne(o)&&o.nodeType===1&&!Lo(o)}function QE(o){if(o==null)return!0;if(Qe(o)&&(bt(o)||typeof o=="string"||typeof o.splice=="function"||Zi(o)||ys(o)||On(o)))return!o.length;var u=Be(o);if(u==Lt||u==Ze)return!o.size;if(Do(o))return!ju(o).length;for(var g in o)if(Vt.call(o,g))return!1;return!0}function tw(o,u){return Po(o,u)}function ew(o,u,g){g=typeof g=="function"?g:e;var v=g?g(o,u):e;return v===e?Po(o,u,e,g):!!v}function yc(o){if(!ne(o))return!1;var u=ke(o);return u==jt||u==ve||typeof o.message=="string"&&typeof o.name=="string"&&!Lo(o)}function rw(o){return typeof o=="number"&&bp(o)}function vi(o){if(!ee(o))return!1;var u=ke(o);return u==Xt||u==Kt||u==Wt||u==ss}function zm(o){return typeof o=="number"&&o==At(o)}function Gl(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=q}function ee(o){var u=typeof o;return o!=null&&(u=="object"||u=="function")}function ne(o){return o!=null&&typeof o=="object"}var $m=op?hr(op):o1;function iw(o,u){return o===u||Yu(o,u,uc(u))}function nw(o,u,g){return g=typeof g=="function"?g:e,Yu(o,u,uc(u),g)}function sw(o){return Ym(o)&&o!=+o}function ow(o){if(W1(o))throw new wt(i);return Up(o)}function aw(o){return o===null}function lw(o){return o==null}function Ym(o){return typeof o=="number"||ne(o)&&ke(o)==Ut}function Lo(o){if(!ne(o)||ke(o)!=Pe)return!1;var u=dl(o);if(u===null)return!0;var g=Vt.call(u,"constructor")&&u.constructor;return typeof g=="function"&&g instanceof g&&hl.call(g)==ny}var Tc=ap?hr(ap):a1;function hw(o){return zm(o)&&o>=-q&&o<=q}var jm=lp?hr(lp):l1;function Hl(o){return typeof o=="string"||!bt(o)&&ne(o)&&ke(o)==Qr}function cr(o){return typeof o=="symbol"||ne(o)&&ke(o)==os}var ys=hp?hr(hp):h1;function uw(o){return o===e}function cw(o){return ne(o)&&Be(o)==ti}function fw(o){return ne(o)&&ke(o)==as}var dw=Ml(qu),pw=Ml(function(o,u){return o<=u});function qm(o){if(!o)return[];if(Qe(o))return Hl(o)?Fr(o):Je(o);if(Eo&&o[Eo])return $v(o[Eo]());var u=Be(o),g=u==Lt?Fu:u==Ze?ol:Ts;return g(o)}function yi(o){if(!o)return o===0?o:0;if(o=Ir(o),o===Z||o===-Z){var u=o<0?-1:1;return u*it}return o===o?o:0}function At(o){var u=yi(o),g=u%1;return u===u?g?u-g:u:0}function Km(o){return o?Pn(At(o),0,Q):0}function Ir(o){if(typeof o=="number")return o;if(cr(o))return Y;if(ee(o)){var u=typeof o.valueOf=="function"?o.valueOf():o;o=ee(u)?u+"":u}if(typeof o!="string")return o===0?o:+o;o=mp(o);var g=q0.test(o);return g||Z0.test(o)?Iv(o.slice(2),g?2:8):j0.test(o)?Y:+o}function Zm(o){return ri(o,tr(o))}function mw(o){return o?Pn(At(o),-q,q):o===0?o:0}function Gt(o){return o==null?"":ur(o)}var gw=_s(function(o,u){if(Do(u)||Qe(u)){ri(u,Te(u),o);return}for(var g in u)Vt.call(u,g)&&Co(o,g,u[g])}),Jm=_s(function(o,u){ri(u,tr(u),o)}),Vl=_s(function(o,u,g,v){ri(u,tr(u),o,v)}),_w=_s(function(o,u,g,v){ri(u,Te(u),o,v)}),xw=_i(Vu);function vw(o,u){var g=gs(o);return u==null?g:Pp(g,u)}var yw=It(function(o,u){o=$t(o);var g=-1,v=u.length,b=v>2?u[2]:e;for(b&&Ge(u[0],u[1],b)&&(v=1);++g<v;)for(var I=u[g],D=tr(I),F=-1,k=D.length;++F<k;){var j=D[F],K=o[j];(K===e||Ur(K,ds[j])&&!Vt.call(o,j))&&(o[j]=I[j])}return o}),Tw=It(function(o){return o.push(e,mm),lr(Qm,e,o)});function Ew(o,u){return cp(o,gt(u,3),ei)}function ww(o,u){return cp(o,gt(u,3),Xu)}function Sw(o,u){return o==null?o:Wu(o,gt(u,3),tr)}function bw(o,u){return o==null?o:Lp(o,gt(u,3),tr)}function Aw(o,u){return o&&ei(o,gt(u,3))}function Cw(o,u){return o&&Xu(o,gt(u,3))}function Rw(o){return o==null?[]:wl(o,Te(o))}function Iw(o){return o==null?[]:wl(o,tr(o))}function Ec(o,u,g){var v=o==null?e:Mn(o,u);return v===e?g:v}function Pw(o,u){return o!=null&&xm(o,u,Qy)}function wc(o,u){return o!=null&&xm(o,u,t1)}var Mw=um(function(o,u,g){u!=null&&typeof u.toString!="function"&&(u=ul.call(u)),o[u]=g},bc(er)),Bw=um(function(o,u,g){u!=null&&typeof u.toString!="function"&&(u=ul.call(u)),Vt.call(o,u)?o[u].push(g):o[u]=[g]},gt),Dw=It(Io);function Te(o){return Qe(o)?Rp(o):ju(o)}function tr(o){return Qe(o)?Rp(o,!0):u1(o)}function Ow(o,u){var g={};return u=gt(u,3),ei(o,function(v,b,I){mi(g,u(v,b,I),v)}),g}function Lw(o,u){var g={};return u=gt(u,3),ei(o,function(v,b,I){mi(g,b,u(v,b,I))}),g}var Fw=_s(function(o,u,g){Sl(o,u,g)}),Qm=_s(function(o,u,g,v){Sl(o,u,g,v)}),Nw=_i(function(o,u){var g={};if(o==null)return g;var v=!1;u=Qt(u,function(I){return I=qi(I,o),v||(v=I.length>1),I}),ri(o,lc(o),g),v&&(g=Ar(g,p|l|h,M1));for(var b=u.length;b--;)tc(g,u[b]);return g});function Uw(o,u){return tg(o,kl(gt(u)))}var kw=_i(function(o,u){return o==null?{}:f1(o,u)});function tg(o,u){if(o==null)return{};var g=Qt(lc(o),function(v){return[v]});return u=gt(u),zp(o,g,function(v,b){return u(v,b[0])})}function Gw(o,u,g){u=qi(u,o);var v=-1,b=u.length;for(b||(b=1,o=e);++v<b;){var I=o==null?e:o[ii(u[v])];I===e&&(v=b,I=g),o=vi(I)?I.call(o):I}return o}function Hw(o,u,g){return o==null?o:Mo(o,u,g)}function Vw(o,u,g,v){return v=typeof v=="function"?v:e,o==null?o:Mo(o,u,g,v)}var eg=dm(Te),rg=dm(tr);function Ww(o,u,g){var v=bt(o),b=v||Zi(o)||ys(o);if(u=gt(u,4),g==null){var I=o&&o.constructor;b?g=v?new I:[]:ee(o)?g=vi(I)?gs(dl(o)):{}:g={}}return(b?wr:ei)(o,function(D,F,k){return u(g,D,F,k)}),g}function Xw(o,u){return o==null?!0:tc(o,u)}function zw(o,u,g){return o==null?o:Kp(o,u,ic(g))}function $w(o,u,g,v){return v=typeof v=="function"?v:e,o==null?o:Kp(o,u,ic(g),v)}function Ts(o){return o==null?[]:Lu(o,Te(o))}function Yw(o){return o==null?[]:Lu(o,tr(o))}function jw(o,u,g){return g===e&&(g=u,u=e),g!==e&&(g=Ir(g),g=g===g?g:0),u!==e&&(u=Ir(u),u=u===u?u:0),Pn(Ir(o),u,g)}function qw(o,u,g){return u=yi(u),g===e?(g=u,u=0):g=yi(g),o=Ir(o),e1(o,u,g)}function Kw(o,u,g){if(g&&typeof g!="boolean"&&Ge(o,u,g)&&(u=g=e),g===e&&(typeof u=="boolean"?(g=u,u=e):typeof o=="boolean"&&(g=o,o=e)),o===e&&u===e?(o=0,u=1):(o=yi(o),u===e?(u=o,o=0):u=yi(u)),o>u){var v=o;o=u,u=v}if(g||o%1||u%1){var b=Ap();return Me(o+b*(u-o+Rv("1e-"+((b+"").length-1))),u)}return Zu(o,u)}var Zw=xs(function(o,u,g){return u=u.toLowerCase(),o+(g?ig(u):u)});function ig(o){return Sc(Gt(o).toLowerCase())}function ng(o){return o=Gt(o),o&&o.replace(Q0,Hv).replace(xv,"")}function Jw(o,u,g){o=Gt(o),u=ur(u);var v=o.length;g=g===e?v:Pn(At(g),0,v);var b=g;return g-=u.length,g>=0&&o.slice(g,b)==u}function Qw(o){return o=Gt(o),o&&D0.test(o)?o.replace(Ld,Vv):o}function tS(o){return o=Gt(o),o&&k0.test(o)?o.replace(vu,"\\$&"):o}var eS=xs(function(o,u,g){return o+(g?"-":"")+u.toLowerCase()}),rS=xs(function(o,u,g){return o+(g?" ":"")+u.toLowerCase()}),iS=am("toLowerCase");function nS(o,u,g){o=Gt(o),u=At(u);var v=u?fs(o):0;if(!u||v>=u)return o;var b=(u-v)/2;return Pl(_l(b),g)+o+Pl(gl(b),g)}function sS(o,u,g){o=Gt(o),u=At(u);var v=u?fs(o):0;return u&&v<u?o+Pl(u-v,g):o}function oS(o,u,g){o=Gt(o),u=At(u);var v=u?fs(o):0;return u&&v<u?Pl(u-v,g)+o:o}function aS(o,u,g){return g||u==null?u=0:u&&(u=+u),py(Gt(o).replace(yu,""),u||0)}function lS(o,u,g){return(g?Ge(o,u,g):u===e)?u=1:u=At(u),Ju(Gt(o),u)}function hS(){var o=arguments,u=Gt(o[0]);return o.length<3?u:u.replace(o[1],o[2])}var uS=xs(function(o,u,g){return o+(g?"_":"")+u.toLowerCase()});function cS(o,u,g){return g&&typeof g!="number"&&Ge(o,u,g)&&(u=g=e),g=g===e?Q:g>>>0,g?(o=Gt(o),o&&(typeof u=="string"||u!=null&&!Tc(u))&&(u=ur(u),!u&&cs(o))?Ki(Fr(o),0,g):o.split(u,g)):[]}var fS=xs(function(o,u,g){return o+(g?" ":"")+Sc(u)});function dS(o,u,g){return o=Gt(o),g=g==null?0:Pn(At(g),0,o.length),u=ur(u),o.slice(g,g+u.length)==u}function pS(o,u,g){var v=A.templateSettings;g&&Ge(o,u,g)&&(u=e),o=Gt(o),u=Vl({},u,v,pm);var b=Vl({},u.imports,v.imports,pm),I=Te(b),D=Lu(b,I),F,k,j=0,K=u.interpolate||el,tt="__p += '",st=Nu((u.escape||el).source+"|"+K.source+"|"+(K===Fd?Y0:el).source+"|"+(u.evaluate||el).source+"|$","g"),ut="//# sourceURL="+(Vt.call(u,"sourceURL")?(u.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++wv+"]")+`
`;o.replace(st,function(yt,Pt,Dt,fr,He,dr){return Dt||(Dt=fr),tt+=o.slice(j,dr).replace(tv,Wv),Pt&&(F=!0,tt+=`' +
__e(`+Pt+`) +
'`),He&&(k=!0,tt+=`';
`+He+`;
__p += '`),Dt&&(tt+=`' +
((__t = (`+Dt+`)) == null ? '' : __t) +
'`),j=dr+yt.length,yt}),tt+=`';
`;var vt=Vt.call(u,"variable")&&u.variable;if(!vt)tt=`with (obj) {
`+tt+`
}
`;else if(z0.test(vt))throw new wt(s);tt=(k?tt.replace(I0,""):tt).replace(P0,"$1").replace(M0,"$1;"),tt="function("+(vt||"obj")+`) {
`+(vt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(F?", __e = _.escape":"")+(k?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+tt+`return __p
}`;var Ct=og(function(){return kt(I,ut+"return "+tt).apply(e,D)});if(Ct.source=tt,yc(Ct))throw Ct;return Ct}function mS(o){return Gt(o).toLowerCase()}function gS(o){return Gt(o).toUpperCase()}function _S(o,u,g){if(o=Gt(o),o&&(g||u===e))return mp(o);if(!o||!(u=ur(u)))return o;var v=Fr(o),b=Fr(u),I=gp(v,b),D=_p(v,b)+1;return Ki(v,I,D).join("")}function xS(o,u,g){if(o=Gt(o),o&&(g||u===e))return o.slice(0,vp(o)+1);if(!o||!(u=ur(u)))return o;var v=Fr(o),b=_p(v,Fr(u))+1;return Ki(v,0,b).join("")}function vS(o,u,g){if(o=Gt(o),o&&(g||u===e))return o.replace(yu,"");if(!o||!(u=ur(u)))return o;var v=Fr(o),b=gp(v,Fr(u));return Ki(v,b).join("")}function yS(o,u){var g=M,v=B;if(ee(u)){var b="separator"in u?u.separator:b;g="length"in u?At(u.length):g,v="omission"in u?ur(u.omission):v}o=Gt(o);var I=o.length;if(cs(o)){var D=Fr(o);I=D.length}if(g>=I)return o;var F=g-fs(v);if(F<1)return v;var k=D?Ki(D,0,F).join(""):o.slice(0,F);if(b===e)return k+v;if(D&&(F+=k.length-F),Tc(b)){if(o.slice(F).search(b)){var j,K=k;for(b.global||(b=Nu(b.source,Gt(Nd.exec(b))+"g")),b.lastIndex=0;j=b.exec(K);)var tt=j.index;k=k.slice(0,tt===e?F:tt)}}else if(o.indexOf(ur(b),F)!=F){var st=k.lastIndexOf(b);st>-1&&(k=k.slice(0,st))}return k+v}function TS(o){return o=Gt(o),o&&B0.test(o)?o.replace(Od,Kv):o}var ES=xs(function(o,u,g){return o+(g?" ":"")+u.toUpperCase()}),Sc=am("toUpperCase");function sg(o,u,g){return o=Gt(o),u=g?e:u,u===e?zv(o)?Qv(o):Fv(o):o.match(u)||[]}var og=It(function(o,u){try{return lr(o,e,u)}catch(g){return yc(g)?g:new wt(g)}}),wS=_i(function(o,u){return wr(u,function(g){g=ii(g),mi(o,g,xc(o[g],o))}),o});function SS(o){var u=o==null?0:o.length,g=gt();return o=u?Qt(o,function(v){if(typeof v[1]!="function")throw new Sr(n);return[g(v[0]),v[1]]}):[],It(function(v){for(var b=-1;++b<u;){var I=o[b];if(lr(I[0],this,v))return lr(I[1],this,v)}})}function bS(o){return Ky(Ar(o,p))}function bc(o){return function(){return o}}function AS(o,u){return o==null||o!==o?u:o}var CS=hm(),RS=hm(!0);function er(o){return o}function Ac(o){return kp(typeof o=="function"?o:Ar(o,p))}function IS(o){return Hp(Ar(o,p))}function PS(o,u){return Vp(o,Ar(u,p))}var MS=It(function(o,u){return function(g){return Io(g,o,u)}}),BS=It(function(o,u){return function(g){return Io(o,g,u)}});function Cc(o,u,g){var v=Te(u),b=wl(u,v);g==null&&!(ee(u)&&(b.length||!v.length))&&(g=u,u=o,o=this,b=wl(u,Te(u)));var I=!(ee(g)&&"chain"in g)||!!g.chain,D=vi(o);return wr(b,function(F){var k=u[F];o[F]=k,D&&(o.prototype[F]=function(){var j=this.__chain__;if(I||j){var K=o(this.__wrapped__),tt=K.__actions__=Je(this.__actions__);return tt.push({func:k,args:arguments,thisArg:o}),K.__chain__=j,K}return k.apply(o,Wi([this.value()],arguments))})}),o}function DS(){return ye._===this&&(ye._=sy),this}function Rc(){}function OS(o){return o=At(o),It(function(u){return Wp(u,o)})}var LS=sc(Qt),FS=sc(up),NS=sc(Pu);function ag(o){return fc(o)?Mu(ii(o)):d1(o)}function US(o){return function(u){return o==null?e:Mn(o,u)}}var kS=cm(),GS=cm(!0);function Ic(){return[]}function Pc(){return!1}function HS(){return{}}function VS(){return""}function WS(){return!0}function XS(o,u){if(o=At(o),o<1||o>q)return[];var g=Q,v=Me(o,Q);u=gt(u),o-=Q;for(var b=Ou(v,u);++g<o;)u(g);return b}function zS(o){return bt(o)?Qt(o,ii):cr(o)?[o]:Je(Cm(Gt(o)))}function $S(o){var u=++iy;return Gt(o)+u}var YS=Il(function(o,u){return o+u},0),jS=oc("ceil"),qS=Il(function(o,u){return o/u},1),KS=oc("floor");function ZS(o){return o&&o.length?El(o,er,zu):e}function JS(o,u){return o&&o.length?El(o,gt(u,2),zu):e}function QS(o){return dp(o,er)}function tb(o,u){return dp(o,gt(u,2))}function eb(o){return o&&o.length?El(o,er,qu):e}function rb(o,u){return o&&o.length?El(o,gt(u,2),qu):e}var ib=Il(function(o,u){return o*u},1),nb=oc("round"),sb=Il(function(o,u){return o-u},0);function ob(o){return o&&o.length?Du(o,er):0}function ab(o,u){return o&&o.length?Du(o,gt(u,2)):0}return A.after=IE,A.ary=Um,A.assign=gw,A.assignIn=Jm,A.assignInWith=Vl,A.assignWith=_w,A.at=xw,A.before=km,A.bind=xc,A.bindAll=wS,A.bindKey=Gm,A.castArray=HE,A.chain=Lm,A.chunk=K1,A.compact=Z1,A.concat=J1,A.cond=SS,A.conforms=bS,A.constant=bc,A.countBy=oE,A.create=vw,A.curry=Hm,A.curryRight=Vm,A.debounce=Wm,A.defaults=yw,A.defaultsDeep=Tw,A.defer=PE,A.delay=ME,A.difference=Q1,A.differenceBy=tT,A.differenceWith=eT,A.drop=rT,A.dropRight=iT,A.dropRightWhile=nT,A.dropWhile=sT,A.fill=oT,A.filter=lE,A.flatMap=cE,A.flatMapDeep=fE,A.flatMapDepth=dE,A.flatten=Mm,A.flattenDeep=aT,A.flattenDepth=lT,A.flip=BE,A.flow=CS,A.flowRight=RS,A.fromPairs=hT,A.functions=Rw,A.functionsIn=Iw,A.groupBy=pE,A.initial=cT,A.intersection=fT,A.intersectionBy=dT,A.intersectionWith=pT,A.invert=Mw,A.invertBy=Bw,A.invokeMap=gE,A.iteratee=Ac,A.keyBy=_E,A.keys=Te,A.keysIn=tr,A.map=Fl,A.mapKeys=Ow,A.mapValues=Lw,A.matches=IS,A.matchesProperty=PS,A.memoize=Ul,A.merge=Fw,A.mergeWith=Qm,A.method=MS,A.methodOf=BS,A.mixin=Cc,A.negate=kl,A.nthArg=OS,A.omit=Nw,A.omitBy=Uw,A.once=DE,A.orderBy=xE,A.over=LS,A.overArgs=OE,A.overEvery=FS,A.overSome=NS,A.partial=vc,A.partialRight=Xm,A.partition=vE,A.pick=kw,A.pickBy=tg,A.property=ag,A.propertyOf=US,A.pull=xT,A.pullAll=Dm,A.pullAllBy=vT,A.pullAllWith=yT,A.pullAt=TT,A.range=kS,A.rangeRight=GS,A.rearg=LE,A.reject=EE,A.remove=ET,A.rest=FE,A.reverse=gc,A.sampleSize=SE,A.set=Hw,A.setWith=Vw,A.shuffle=bE,A.slice=wT,A.sortBy=RE,A.sortedUniq=PT,A.sortedUniqBy=MT,A.split=cS,A.spread=NE,A.tail=BT,A.take=DT,A.takeRight=OT,A.takeRightWhile=LT,A.takeWhile=FT,A.tap=ZT,A.throttle=UE,A.thru=Ll,A.toArray=qm,A.toPairs=eg,A.toPairsIn=rg,A.toPath=zS,A.toPlainObject=Zm,A.transform=Ww,A.unary=kE,A.union=NT,A.unionBy=UT,A.unionWith=kT,A.uniq=GT,A.uniqBy=HT,A.uniqWith=VT,A.unset=Xw,A.unzip=_c,A.unzipWith=Om,A.update=zw,A.updateWith=$w,A.values=Ts,A.valuesIn=Yw,A.without=WT,A.words=sg,A.wrap=GE,A.xor=XT,A.xorBy=zT,A.xorWith=$T,A.zip=YT,A.zipObject=jT,A.zipObjectDeep=qT,A.zipWith=KT,A.entries=eg,A.entriesIn=rg,A.extend=Jm,A.extendWith=Vl,Cc(A,A),A.add=YS,A.attempt=og,A.camelCase=Zw,A.capitalize=ig,A.ceil=jS,A.clamp=jw,A.clone=VE,A.cloneDeep=XE,A.cloneDeepWith=zE,A.cloneWith=WE,A.conformsTo=$E,A.deburr=ng,A.defaultTo=AS,A.divide=qS,A.endsWith=Jw,A.eq=Ur,A.escape=Qw,A.escapeRegExp=tS,A.every=aE,A.find=hE,A.findIndex=Im,A.findKey=Ew,A.findLast=uE,A.findLastIndex=Pm,A.findLastKey=ww,A.floor=KS,A.forEach=Fm,A.forEachRight=Nm,A.forIn=Sw,A.forInRight=bw,A.forOwn=Aw,A.forOwnRight=Cw,A.get=Ec,A.gt=YE,A.gte=jE,A.has=Pw,A.hasIn=wc,A.head=Bm,A.identity=er,A.includes=mE,A.indexOf=uT,A.inRange=qw,A.invoke=Dw,A.isArguments=On,A.isArray=bt,A.isArrayBuffer=qE,A.isArrayLike=Qe,A.isArrayLikeObject=ae,A.isBoolean=KE,A.isBuffer=Zi,A.isDate=ZE,A.isElement=JE,A.isEmpty=QE,A.isEqual=tw,A.isEqualWith=ew,A.isError=yc,A.isFinite=rw,A.isFunction=vi,A.isInteger=zm,A.isLength=Gl,A.isMap=$m,A.isMatch=iw,A.isMatchWith=nw,A.isNaN=sw,A.isNative=ow,A.isNil=lw,A.isNull=aw,A.isNumber=Ym,A.isObject=ee,A.isObjectLike=ne,A.isPlainObject=Lo,A.isRegExp=Tc,A.isSafeInteger=hw,A.isSet=jm,A.isString=Hl,A.isSymbol=cr,A.isTypedArray=ys,A.isUndefined=uw,A.isWeakMap=cw,A.isWeakSet=fw,A.join=mT,A.kebabCase=eS,A.last=Rr,A.lastIndexOf=gT,A.lowerCase=rS,A.lowerFirst=iS,A.lt=dw,A.lte=pw,A.max=ZS,A.maxBy=JS,A.mean=QS,A.meanBy=tb,A.min=eb,A.minBy=rb,A.stubArray=Ic,A.stubFalse=Pc,A.stubObject=HS,A.stubString=VS,A.stubTrue=WS,A.multiply=ib,A.nth=_T,A.noConflict=DS,A.noop=Rc,A.now=Nl,A.pad=nS,A.padEnd=sS,A.padStart=oS,A.parseInt=aS,A.random=Kw,A.reduce=yE,A.reduceRight=TE,A.repeat=lS,A.replace=hS,A.result=Gw,A.round=nb,A.runInContext=U,A.sample=wE,A.size=AE,A.snakeCase=uS,A.some=CE,A.sortedIndex=ST,A.sortedIndexBy=bT,A.sortedIndexOf=AT,A.sortedLastIndex=CT,A.sortedLastIndexBy=RT,A.sortedLastIndexOf=IT,A.startCase=fS,A.startsWith=dS,A.subtract=sb,A.sum=ob,A.sumBy=ab,A.template=pS,A.times=XS,A.toFinite=yi,A.toInteger=At,A.toLength=Km,A.toLower=mS,A.toNumber=Ir,A.toSafeInteger=mw,A.toString=Gt,A.toUpper=gS,A.trim=_S,A.trimEnd=xS,A.trimStart=vS,A.truncate=yS,A.unescape=TS,A.uniqueId=$S,A.upperCase=ES,A.upperFirst=Sc,A.each=Fm,A.eachRight=Nm,A.first=Bm,Cc(A,function(){var o={};return ei(A,function(u,g){Vt.call(A.prototype,g)||(o[g]=u)}),o}(),{chain:!1}),A.VERSION=t,wr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(o){A[o].placeholder=A}),wr(["drop","take"],function(o,u){Mt.prototype[o]=function(g){g=g===e?1:pe(At(g),0);var v=this.__filtered__&&!u?new Mt(this):this.clone();return v.__filtered__?v.__takeCount__=Me(g,v.__takeCount__):v.__views__.push({size:Me(g,Q),type:o+(v.__dir__<0?"Right":"")}),v},Mt.prototype[o+"Right"]=function(g){return this.reverse()[o](g).reverse()}}),wr(["filter","map","takeWhile"],function(o,u){var g=u+1,v=g==H||g==G;Mt.prototype[o]=function(b){var I=this.clone();return I.__iteratees__.push({iteratee:gt(b,3),type:g}),I.__filtered__=I.__filtered__||v,I}}),wr(["head","last"],function(o,u){var g="take"+(u?"Right":"");Mt.prototype[o]=function(){return this[g](1).value()[0]}}),wr(["initial","tail"],function(o,u){var g="drop"+(u?"":"Right");Mt.prototype[o]=function(){return this.__filtered__?new Mt(this):this[g](1)}}),Mt.prototype.compact=function(){return this.filter(er)},Mt.prototype.find=function(o){return this.filter(o).head()},Mt.prototype.findLast=function(o){return this.reverse().find(o)},Mt.prototype.invokeMap=It(function(o,u){return typeof o=="function"?new Mt(this):this.map(function(g){return Io(g,o,u)})}),Mt.prototype.reject=function(o){return this.filter(kl(gt(o)))},Mt.prototype.slice=function(o,u){o=At(o);var g=this;return g.__filtered__&&(o>0||u<0)?new Mt(g):(o<0?g=g.takeRight(-o):o&&(g=g.drop(o)),u!==e&&(u=At(u),g=u<0?g.dropRight(-u):g.take(u-o)),g)},Mt.prototype.takeRightWhile=function(o){return this.reverse().takeWhile(o).reverse()},Mt.prototype.toArray=function(){return this.take(Q)},ei(Mt.prototype,function(o,u){var g=/^(?:filter|find|map|reject)|While$/.test(u),v=/^(?:head|last)$/.test(u),b=A[v?"take"+(u=="last"?"Right":""):u],I=v||/^find/.test(u);b&&(A.prototype[u]=function(){var D=this.__wrapped__,F=v?[1]:arguments,k=D instanceof Mt,j=F[0],K=k||bt(D),tt=function(Pt){var Dt=b.apply(A,Wi([Pt],F));return v&&st?Dt[0]:Dt};K&&g&&typeof j=="function"&&j.length!=1&&(k=K=!1);var st=this.__chain__,ut=!!this.__actions__.length,vt=I&&!st,Ct=k&&!ut;if(!I&&K){D=Ct?D:new Mt(this);var yt=o.apply(D,F);return yt.__actions__.push({func:Ll,args:[tt],thisArg:e}),new br(yt,st)}return vt&&Ct?o.apply(this,F):(yt=this.thru(tt),vt?v?yt.value()[0]:yt.value():yt)})}),wr(["pop","push","shift","sort","splice","unshift"],function(o){var u=al[o],g=/^(?:push|sort|unshift)$/.test(o)?"tap":"thru",v=/^(?:pop|shift)$/.test(o);A.prototype[o]=function(){var b=arguments;if(v&&!this.__chain__){var I=this.value();return u.apply(bt(I)?I:[],b)}return this[g](function(D){return u.apply(bt(D)?D:[],b)})}}),ei(Mt.prototype,function(o,u){var g=A[u];if(g){var v=g.name+"";Vt.call(ms,v)||(ms[v]=[]),ms[v].push({name:u,func:g})}}),ms[Rl(e,x).name]=[{name:"wrapper",func:e}],Mt.prototype.clone=Ty,Mt.prototype.reverse=Ey,Mt.prototype.value=wy,A.prototype.at=JT,A.prototype.chain=QT,A.prototype.commit=tE,A.prototype.next=eE,A.prototype.plant=iE,A.prototype.reverse=nE,A.prototype.toJSON=A.prototype.valueOf=A.prototype.value=sE,A.prototype.first=A.prototype.head,Eo&&(A.prototype[Eo]=rE),A},zi=ty();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(ye._=zi,define(function(){return zi})):An?((An.exports=zi)._=zi,Au._=zi):ye._=zi}).call(_o)});var C0=Gr(au=>{(function(){"use strict";var e=function(){this.init()};e.prototype={init:function(){var l=this||t;return l._counter=1e3,l._html5AudioPool=[],l.html5PoolSize=10,l._codecs={},l._howls=[],l._muted=!1,l._volume=1,l._canPlayEvent="canplaythrough",l._navigator=typeof window<"u"&&window.navigator?window.navigator:null,l.masterGain=null,l.noAudio=!1,l.usingWebAudio=!0,l.autoSuspend=!0,l.ctx=null,l.autoUnlock=!0,l._setup(),l},volume:function(l){var h=this||t;if(l=parseFloat(l),h.ctx||p(),typeof l<"u"&&l>=0&&l<=1){if(h._volume=l,h._muted)return h;h.usingWebAudio&&h.masterGain.gain.setValueAtTime(l,t.ctx.currentTime);for(var d=0;d<h._howls.length;d++)if(!h._howls[d]._webAudio)for(var m=h._howls[d]._getSoundIds(),_=0;_<m.length;_++){var x=h._howls[d]._soundById(m[_]);x&&x._node&&(x._node.volume=x._volume*l)}return h}return h._volume},mute:function(l){var h=this||t;h.ctx||p(),h._muted=l,h.usingWebAudio&&h.masterGain.gain.setValueAtTime(l?0:h._volume,t.ctx.currentTime);for(var d=0;d<h._howls.length;d++)if(!h._howls[d]._webAudio)for(var m=h._howls[d]._getSoundIds(),_=0;_<m.length;_++){var x=h._howls[d]._soundById(m[_]);x&&x._node&&(x._node.muted=l?!0:x._muted)}return h},stop:function(){for(var l=this||t,h=0;h<l._howls.length;h++)l._howls[h].stop();return l},unload:function(){for(var l=this||t,h=l._howls.length-1;h>=0;h--)l._howls[h].unload();return l.usingWebAudio&&l.ctx&&typeof l.ctx.close<"u"&&(l.ctx.close(),l.ctx=null,p()),l},codecs:function(l){return(this||t)._codecs[l.replace(/^x-/,"")]},_setup:function(){var l=this||t;if(l.state=l.ctx&&l.ctx.state||"suspended",l._autoSuspend(),!l.usingWebAudio)if(typeof Audio<"u")try{var h=new Audio;typeof h.oncanplaythrough>"u"&&(l._canPlayEvent="canplay")}catch{l.noAudio=!0}else l.noAudio=!0;try{var h=new Audio;h.muted&&(l.noAudio=!0)}catch{}return l.noAudio||l._setupCodecs(),l},_setupCodecs:function(){var l=this||t,h=null;try{h=typeof Audio<"u"?new Audio:null}catch{return l}if(!h||typeof h.canPlayType!="function")return l;var d=h.canPlayType("audio/mpeg;").replace(/^no$/,""),m=l._navigator?l._navigator.userAgent:"",_=m.match(/OPR\/([0-6].)/g),x=_&&parseInt(_[0].split("/")[1],10)<33,T=m.indexOf("Safari")!==-1&&m.indexOf("Chrome")===-1,S=m.match(/Version\/(.*?) /),w=T&&S&&parseInt(S[1],10)<15;return l._codecs={mp3:!!(!x&&(d||h.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!d,opus:!!h.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!h.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!h.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(h.canPlayType('audio/wav; codecs="1"')||h.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!h.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!h.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(h.canPlayType("audio/x-m4a;")||h.canPlayType("audio/m4a;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(h.canPlayType("audio/x-m4b;")||h.canPlayType("audio/m4b;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(h.canPlayType("audio/x-mp4;")||h.canPlayType("audio/mp4;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!w&&h.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!w&&h.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!h.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(h.canPlayType("audio/x-flac;")||h.canPlayType("audio/flac;")).replace(/^no$/,"")},l},_unlockAudio:function(){var l=this||t;if(!(l._audioUnlocked||!l.ctx)){l._audioUnlocked=!1,l.autoUnlock=!1,!l._mobileUnloaded&&l.ctx.sampleRate!==44100&&(l._mobileUnloaded=!0,l.unload()),l._scratchBuffer=l.ctx.createBuffer(1,1,22050);var h=function(d){for(;l._html5AudioPool.length<l.html5PoolSize;)try{var m=new Audio;m._unlocked=!0,l._releaseHtml5Audio(m)}catch{l.noAudio=!0;break}for(var _=0;_<l._howls.length;_++)if(!l._howls[_]._webAudio)for(var x=l._howls[_]._getSoundIds(),T=0;T<x.length;T++){var S=l._howls[_]._soundById(x[T]);S&&S._node&&!S._node._unlocked&&(S._node._unlocked=!0,S._node.load())}l._autoResume();var w=l.ctx.createBufferSource();w.buffer=l._scratchBuffer,w.connect(l.ctx.destination),typeof w.start>"u"?w.noteOn(0):w.start(0),typeof l.ctx.resume=="function"&&l.ctx.resume(),w.onended=function(){w.disconnect(0),l._audioUnlocked=!0,document.removeEventListener("touchstart",h,!0),document.removeEventListener("touchend",h,!0),document.removeEventListener("click",h,!0),document.removeEventListener("keydown",h,!0);for(var y=0;y<l._howls.length;y++)l._howls[y]._emit("unlock")}};return document.addEventListener("touchstart",h,!0),document.addEventListener("touchend",h,!0),document.addEventListener("click",h,!0),document.addEventListener("keydown",h,!0),l}},_obtainHtml5Audio:function(){var l=this||t;if(l._html5AudioPool.length)return l._html5AudioPool.pop();var h=new Audio().play();return h&&typeof Promise<"u"&&(h instanceof Promise||typeof h.then=="function")&&h.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(l){var h=this||t;return l._unlocked&&h._html5AudioPool.push(l),h},_autoSuspend:function(){var l=this;if(!(!l.autoSuspend||!l.ctx||typeof l.ctx.suspend>"u"||!t.usingWebAudio)){for(var h=0;h<l._howls.length;h++)if(l._howls[h]._webAudio){for(var d=0;d<l._howls[h]._sounds.length;d++)if(!l._howls[h]._sounds[d]._paused)return l}return l._suspendTimer&&clearTimeout(l._suspendTimer),l._suspendTimer=setTimeout(function(){if(l.autoSuspend){l._suspendTimer=null,l.state="suspending";var m=function(){l.state="suspended",l._resumeAfterSuspend&&(delete l._resumeAfterSuspend,l._autoResume())};l.ctx.suspend().then(m,m)}},3e4),l}},_autoResume:function(){var l=this;if(!(!l.ctx||typeof l.ctx.resume>"u"||!t.usingWebAudio))return l.state==="running"&&l.ctx.state!=="interrupted"&&l._suspendTimer?(clearTimeout(l._suspendTimer),l._suspendTimer=null):l.state==="suspended"||l.state==="running"&&l.ctx.state==="interrupted"?(l.ctx.resume().then(function(){l.state="running";for(var h=0;h<l._howls.length;h++)l._howls[h]._emit("resume")}),l._suspendTimer&&(clearTimeout(l._suspendTimer),l._suspendTimer=null)):l.state==="suspending"&&(l._resumeAfterSuspend=!0),l}};var t=new e,r=function(l){var h=this;if(!l.src||l.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}h.init(l)};r.prototype={init:function(l){var h=this;return t.ctx||p(),h._autoplay=l.autoplay||!1,h._format=typeof l.format!="string"?l.format:[l.format],h._html5=l.html5||!1,h._muted=l.mute||!1,h._loop=l.loop||!1,h._pool=l.pool||5,h._preload=typeof l.preload=="boolean"||l.preload==="metadata"?l.preload:!0,h._rate=l.rate||1,h._sprite=l.sprite||{},h._src=typeof l.src!="string"?l.src:[l.src],h._volume=l.volume!==void 0?l.volume:1,h._xhr={method:l.xhr&&l.xhr.method?l.xhr.method:"GET",headers:l.xhr&&l.xhr.headers?l.xhr.headers:null,withCredentials:l.xhr&&l.xhr.withCredentials?l.xhr.withCredentials:!1},h._duration=0,h._state="unloaded",h._sounds=[],h._endTimers={},h._queue=[],h._playLock=!1,h._onend=l.onend?[{fn:l.onend}]:[],h._onfade=l.onfade?[{fn:l.onfade}]:[],h._onload=l.onload?[{fn:l.onload}]:[],h._onloaderror=l.onloaderror?[{fn:l.onloaderror}]:[],h._onplayerror=l.onplayerror?[{fn:l.onplayerror}]:[],h._onpause=l.onpause?[{fn:l.onpause}]:[],h._onplay=l.onplay?[{fn:l.onplay}]:[],h._onstop=l.onstop?[{fn:l.onstop}]:[],h._onmute=l.onmute?[{fn:l.onmute}]:[],h._onvolume=l.onvolume?[{fn:l.onvolume}]:[],h._onrate=l.onrate?[{fn:l.onrate}]:[],h._onseek=l.onseek?[{fn:l.onseek}]:[],h._onunlock=l.onunlock?[{fn:l.onunlock}]:[],h._onresume=[],h._webAudio=t.usingWebAudio&&!h._html5,typeof t.ctx<"u"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(h),h._autoplay&&h._queue.push({event:"play",action:function(){h.play()}}),h._preload&&h._preload!=="none"&&h.load(),h},load:function(){var l=this,h=null;if(t.noAudio){l._emit("loaderror",null,"No audio support.");return}typeof l._src=="string"&&(l._src=[l._src]);for(var d=0;d<l._src.length;d++){var m,_;if(l._format&&l._format[d])m=l._format[d];else{if(_=l._src[d],typeof _!="string"){l._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}m=/^data:audio\/([^;,]+);/i.exec(_),m||(m=/\.([^.]+)$/.exec(_.split("?",1)[0])),m&&(m=m[1].toLowerCase())}if(m||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),m&&t.codecs(m)){h=l._src[d];break}}if(!h){l._emit("loaderror",null,"No codec support for selected audio sources.");return}return l._src=h,l._state="loading",window.location.protocol==="https:"&&h.slice(0,5)==="http:"&&(l._html5=!0,l._webAudio=!1),new i(l),l._webAudio&&s(l),l},play:function(l,h){var d=this,m=null;if(typeof l=="number")m=l,l=null;else{if(typeof l=="string"&&d._state==="loaded"&&!d._sprite[l])return null;if(typeof l>"u"&&(l="__default",!d._playLock)){for(var _=0,x=0;x<d._sounds.length;x++)d._sounds[x]._paused&&!d._sounds[x]._ended&&(_++,m=d._sounds[x]._id);_===1?l=null:m=null}}var T=m?d._soundById(m):d._inactiveSound();if(!T)return null;if(m&&!l&&(l=T._sprite||"__default"),d._state!=="loaded"){T._sprite=l,T._ended=!1;var S=T._id;return d._queue.push({event:"play",action:function(){d.play(S)}}),S}if(m&&!T._paused)return h||d._loadQueue("play"),T._id;d._webAudio&&t._autoResume();var w=Math.max(0,T._seek>0?T._seek:d._sprite[l][0]/1e3),y=Math.max(0,(d._sprite[l][0]+d._sprite[l][1])/1e3-w),E=y*1e3/Math.abs(T._rate),R=d._sprite[l][0]/1e3,C=(d._sprite[l][0]+d._sprite[l][1])/1e3;T._sprite=l,T._ended=!1;var P=function(){T._paused=!1,T._seek=w,T._start=R,T._stop=C,T._loop=!!(T._loop||d._sprite[l][2])};if(w>=C){d._ended(T);return}var M=T._node;if(d._webAudio){var B=function(){d._playLock=!1,P(),d._refreshBuffer(T);var N=T._muted||d._muted?0:T._volume;M.gain.setValueAtTime(N,t.ctx.currentTime),T._playStart=t.ctx.currentTime,typeof M.bufferSource.start>"u"?T._loop?M.bufferSource.noteGrainOn(0,w,86400):M.bufferSource.noteGrainOn(0,w,y):T._loop?M.bufferSource.start(0,w,86400):M.bufferSource.start(0,w,y),E!==1/0&&(d._endTimers[T._id]=setTimeout(d._ended.bind(d,T),E)),h||setTimeout(function(){d._emit("play",T._id),d._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?B():(d._playLock=!0,d.once("resume",B),d._clearTimer(T._id))}else{var L=function(){M.currentTime=w,M.muted=T._muted||d._muted||t._muted||M.muted,M.volume=T._volume*t.volume(),M.playbackRate=T._rate;try{var N=M.play();if(N&&typeof Promise<"u"&&(N instanceof Promise||typeof N.then=="function")?(d._playLock=!0,P(),N.then(function(){d._playLock=!1,M._unlocked=!0,h?d._loadQueue():d._emit("play",T._id)}).catch(function(){d._playLock=!1,d._emit("playerror",T._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),T._ended=!0,T._paused=!0})):h||(d._playLock=!1,P(),d._emit("play",T._id)),M.playbackRate=T._rate,M.paused){d._emit("playerror",T._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}l!=="__default"||T._loop?d._endTimers[T._id]=setTimeout(d._ended.bind(d,T),E):(d._endTimers[T._id]=function(){d._ended(T),M.removeEventListener("ended",d._endTimers[T._id],!1)},M.addEventListener("ended",d._endTimers[T._id],!1))}catch(G){d._emit("playerror",T._id,G)}};M.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(M.src=d._src,M.load());var O=window&&window.ejecta||!M.readyState&&t._navigator.isCocoonJS;if(M.readyState>=3||O)L();else{d._playLock=!0,d._state="loading";var H=function(){d._state="loaded",L(),M.removeEventListener(t._canPlayEvent,H,!1)};M.addEventListener(t._canPlayEvent,H,!1),d._clearTimer(T._id)}}return T._id},pause:function(l){var h=this;if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"pause",action:function(){h.pause(l)}}),h;for(var d=h._getSoundIds(l),m=0;m<d.length;m++){h._clearTimer(d[m]);var _=h._soundById(d[m]);if(_&&!_._paused&&(_._seek=h.seek(d[m]),_._rateSeek=0,_._paused=!0,h._stopFade(d[m]),_._node))if(h._webAudio){if(!_._node.bufferSource)continue;typeof _._node.bufferSource.stop>"u"?_._node.bufferSource.noteOff(0):_._node.bufferSource.stop(0),h._cleanBuffer(_._node)}else(!isNaN(_._node.duration)||_._node.duration===1/0)&&_._node.pause();arguments[1]||h._emit("pause",_?_._id:null)}return h},stop:function(l,h){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"stop",action:function(){d.stop(l)}}),d;for(var m=d._getSoundIds(l),_=0;_<m.length;_++){d._clearTimer(m[_]);var x=d._soundById(m[_]);x&&(x._seek=x._start||0,x._rateSeek=0,x._paused=!0,x._ended=!0,d._stopFade(m[_]),x._node&&(d._webAudio?x._node.bufferSource&&(typeof x._node.bufferSource.stop>"u"?x._node.bufferSource.noteOff(0):x._node.bufferSource.stop(0),d._cleanBuffer(x._node)):(!isNaN(x._node.duration)||x._node.duration===1/0)&&(x._node.currentTime=x._start||0,x._node.pause(),x._node.duration===1/0&&d._clearSound(x._node))),h||d._emit("stop",x._id))}return d},mute:function(l,h){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"mute",action:function(){d.mute(l,h)}}),d;if(typeof h>"u")if(typeof l=="boolean")d._muted=l;else return d._muted;for(var m=d._getSoundIds(h),_=0;_<m.length;_++){var x=d._soundById(m[_]);x&&(x._muted=l,x._interval&&d._stopFade(x._id),d._webAudio&&x._node?x._node.gain.setValueAtTime(l?0:x._volume,t.ctx.currentTime):x._node&&(x._node.muted=t._muted?!0:l),d._emit("mute",x._id))}return d},volume:function(){var l=this,h=arguments,d,m;if(h.length===0)return l._volume;if(h.length===1||h.length===2&&typeof h[1]>"u"){var _=l._getSoundIds(),x=_.indexOf(h[0]);x>=0?m=parseInt(h[0],10):d=parseFloat(h[0])}else h.length>=2&&(d=parseFloat(h[0]),m=parseInt(h[1],10));var T;if(typeof d<"u"&&d>=0&&d<=1){if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"volume",action:function(){l.volume.apply(l,h)}}),l;typeof m>"u"&&(l._volume=d),m=l._getSoundIds(m);for(var S=0;S<m.length;S++)T=l._soundById(m[S]),T&&(T._volume=d,h[2]||l._stopFade(m[S]),l._webAudio&&T._node&&!T._muted?T._node.gain.setValueAtTime(d,t.ctx.currentTime):T._node&&!T._muted&&(T._node.volume=d*t.volume()),l._emit("volume",T._id))}else return T=m?l._soundById(m):l._sounds[0],T?T._volume:0;return l},fade:function(l,h,d,m){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"fade",action:function(){_.fade(l,h,d,m)}}),_;l=Math.min(Math.max(0,parseFloat(l)),1),h=Math.min(Math.max(0,parseFloat(h)),1),d=parseFloat(d),_.volume(l,m);for(var x=_._getSoundIds(m),T=0;T<x.length;T++){var S=_._soundById(x[T]);if(S){if(m||_._stopFade(x[T]),_._webAudio&&!S._muted){var w=t.ctx.currentTime,y=w+d/1e3;S._volume=l,S._node.gain.setValueAtTime(l,w),S._node.gain.linearRampToValueAtTime(h,y)}_._startFadeInterval(S,l,h,d,x[T],typeof m>"u")}}return _},_startFadeInterval:function(l,h,d,m,_,x){var T=this,S=h,w=d-h,y=Math.abs(w/.01),E=Math.max(4,y>0?m/y:m),R=Date.now();l._fadeTo=d,l._interval=setInterval(function(){var C=(Date.now()-R)/m;R=Date.now(),S+=w*C,S=Math.round(S*100)/100,w<0?S=Math.max(d,S):S=Math.min(d,S),T._webAudio?l._volume=S:T.volume(S,l._id,!0),x&&(T._volume=S),(d<h&&S<=d||d>h&&S>=d)&&(clearInterval(l._interval),l._interval=null,l._fadeTo=null,T.volume(d,l._id),T._emit("fade",l._id))},E)},_stopFade:function(l){var h=this,d=h._soundById(l);return d&&d._interval&&(h._webAudio&&d._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(d._interval),d._interval=null,h.volume(d._fadeTo,l),d._fadeTo=null,h._emit("fade",l)),h},loop:function(){var l=this,h=arguments,d,m,_;if(h.length===0)return l._loop;if(h.length===1)if(typeof h[0]=="boolean")d=h[0],l._loop=d;else return _=l._soundById(parseInt(h[0],10)),_?_._loop:!1;else h.length===2&&(d=h[0],m=parseInt(h[1],10));for(var x=l._getSoundIds(m),T=0;T<x.length;T++)_=l._soundById(x[T]),_&&(_._loop=d,l._webAudio&&_._node&&_._node.bufferSource&&(_._node.bufferSource.loop=d,d&&(_._node.bufferSource.loopStart=_._start||0,_._node.bufferSource.loopEnd=_._stop,l.playing(x[T])&&(l.pause(x[T],!0),l.play(x[T],!0)))));return l},rate:function(){var l=this,h=arguments,d,m;if(h.length===0)m=l._sounds[0]._id;else if(h.length===1){var _=l._getSoundIds(),x=_.indexOf(h[0]);x>=0?m=parseInt(h[0],10):d=parseFloat(h[0])}else h.length===2&&(d=parseFloat(h[0]),m=parseInt(h[1],10));var T;if(typeof d=="number"){if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"rate",action:function(){l.rate.apply(l,h)}}),l;typeof m>"u"&&(l._rate=d),m=l._getSoundIds(m);for(var S=0;S<m.length;S++)if(T=l._soundById(m[S]),T){l.playing(m[S])&&(T._rateSeek=l.seek(m[S]),T._playStart=l._webAudio?t.ctx.currentTime:T._playStart),T._rate=d,l._webAudio&&T._node&&T._node.bufferSource?T._node.bufferSource.playbackRate.setValueAtTime(d,t.ctx.currentTime):T._node&&(T._node.playbackRate=d);var w=l.seek(m[S]),y=(l._sprite[T._sprite][0]+l._sprite[T._sprite][1])/1e3-w,E=y*1e3/Math.abs(T._rate);(l._endTimers[m[S]]||!T._paused)&&(l._clearTimer(m[S]),l._endTimers[m[S]]=setTimeout(l._ended.bind(l,T),E)),l._emit("rate",T._id)}}else return T=l._soundById(m),T?T._rate:l._rate;return l},seek:function(){var l=this,h=arguments,d,m;if(h.length===0)l._sounds.length&&(m=l._sounds[0]._id);else if(h.length===1){var _=l._getSoundIds(),x=_.indexOf(h[0]);x>=0?m=parseInt(h[0],10):l._sounds.length&&(m=l._sounds[0]._id,d=parseFloat(h[0]))}else h.length===2&&(d=parseFloat(h[0]),m=parseInt(h[1],10));if(typeof m>"u")return 0;if(typeof d=="number"&&(l._state!=="loaded"||l._playLock))return l._queue.push({event:"seek",action:function(){l.seek.apply(l,h)}}),l;var T=l._soundById(m);if(T)if(typeof d=="number"&&d>=0){var S=l.playing(m);S&&l.pause(m,!0),T._seek=d,T._ended=!1,l._clearTimer(m),!l._webAudio&&T._node&&!isNaN(T._node.duration)&&(T._node.currentTime=d);var w=function(){S&&l.play(m,!0),l._emit("seek",m)};if(S&&!l._webAudio){var y=function(){l._playLock?setTimeout(y,0):w()};setTimeout(y,0)}else w()}else if(l._webAudio){var E=l.playing(m)?t.ctx.currentTime-T._playStart:0,R=T._rateSeek?T._rateSeek-T._seek:0;return T._seek+(R+E*Math.abs(T._rate))}else return T._node.currentTime;return l},playing:function(l){var h=this;if(typeof l=="number"){var d=h._soundById(l);return d?!d._paused:!1}for(var m=0;m<h._sounds.length;m++)if(!h._sounds[m]._paused)return!0;return!1},duration:function(l){var h=this,d=h._duration,m=h._soundById(l);return m&&(d=h._sprite[m._sprite][1]/1e3),d},state:function(){return this._state},unload:function(){for(var l=this,h=l._sounds,d=0;d<h.length;d++)h[d]._paused||l.stop(h[d]._id),l._webAudio||(l._clearSound(h[d]._node),h[d]._node.removeEventListener("error",h[d]._errorFn,!1),h[d]._node.removeEventListener(t._canPlayEvent,h[d]._loadFn,!1),h[d]._node.removeEventListener("ended",h[d]._endFn,!1),t._releaseHtml5Audio(h[d]._node)),delete h[d]._node,l._clearTimer(h[d]._id);var m=t._howls.indexOf(l);m>=0&&t._howls.splice(m,1);var _=!0;for(d=0;d<t._howls.length;d++)if(t._howls[d]._src===l._src||l._src.indexOf(t._howls[d]._src)>=0){_=!1;break}return n&&_&&delete n[l._src],t.noAudio=!1,l._state="unloaded",l._sounds=[],l=null,null},on:function(l,h,d,m){var _=this,x=_["_on"+l];return typeof h=="function"&&x.push(m?{id:d,fn:h,once:m}:{id:d,fn:h}),_},off:function(l,h,d){var m=this,_=m["_on"+l],x=0;if(typeof h=="number"&&(d=h,h=null),h||d)for(x=0;x<_.length;x++){var T=d===_[x].id;if(h===_[x].fn&&T||!h&&T){_.splice(x,1);break}}else if(l)m["_on"+l]=[];else{var S=Object.keys(m);for(x=0;x<S.length;x++)S[x].indexOf("_on")===0&&Array.isArray(m[S[x]])&&(m[S[x]]=[])}return m},once:function(l,h,d){var m=this;return m.on(l,h,d,1),m},_emit:function(l,h,d){for(var m=this,_=m["_on"+l],x=_.length-1;x>=0;x--)(!_[x].id||_[x].id===h||l==="load")&&(setTimeout(function(T){T.call(this,h,d)}.bind(m,_[x].fn),0),_[x].once&&m.off(l,_[x].fn,_[x].id));return m._loadQueue(l),m},_loadQueue:function(l){var h=this;if(h._queue.length>0){var d=h._queue[0];d.event===l&&(h._queue.shift(),h._loadQueue()),l||d.action()}return h},_ended:function(l){var h=this,d=l._sprite;if(!h._webAudio&&l._node&&!l._node.paused&&!l._node.ended&&l._node.currentTime<l._stop)return setTimeout(h._ended.bind(h,l),100),h;var m=!!(l._loop||h._sprite[d][2]);if(h._emit("end",l._id),!h._webAudio&&m&&h.stop(l._id,!0).play(l._id),h._webAudio&&m){h._emit("play",l._id),l._seek=l._start||0,l._rateSeek=0,l._playStart=t.ctx.currentTime;var _=(l._stop-l._start)*1e3/Math.abs(l._rate);h._endTimers[l._id]=setTimeout(h._ended.bind(h,l),_)}return h._webAudio&&!m&&(l._paused=!0,l._ended=!0,l._seek=l._start||0,l._rateSeek=0,h._clearTimer(l._id),h._cleanBuffer(l._node),t._autoSuspend()),!h._webAudio&&!m&&h.stop(l._id,!0),h},_clearTimer:function(l){var h=this;if(h._endTimers[l]){if(typeof h._endTimers[l]!="function")clearTimeout(h._endTimers[l]);else{var d=h._soundById(l);d&&d._node&&d._node.removeEventListener("ended",h._endTimers[l],!1)}delete h._endTimers[l]}return h},_soundById:function(l){for(var h=this,d=0;d<h._sounds.length;d++)if(l===h._sounds[d]._id)return h._sounds[d];return null},_inactiveSound:function(){var l=this;l._drain();for(var h=0;h<l._sounds.length;h++)if(l._sounds[h]._ended)return l._sounds[h].reset();return new i(l)},_drain:function(){var l=this,h=l._pool,d=0,m=0;if(!(l._sounds.length<h)){for(m=0;m<l._sounds.length;m++)l._sounds[m]._ended&&d++;for(m=l._sounds.length-1;m>=0;m--){if(d<=h)return;l._sounds[m]._ended&&(l._webAudio&&l._sounds[m]._node&&l._sounds[m]._node.disconnect(0),l._sounds.splice(m,1),d--)}}},_getSoundIds:function(l){var h=this;if(typeof l>"u"){for(var d=[],m=0;m<h._sounds.length;m++)d.push(h._sounds[m]._id);return d}else return[l]},_refreshBuffer:function(l){var h=this;return l._node.bufferSource=t.ctx.createBufferSource(),l._node.bufferSource.buffer=n[h._src],l._panner?l._node.bufferSource.connect(l._panner):l._node.bufferSource.connect(l._node),l._node.bufferSource.loop=l._loop,l._loop&&(l._node.bufferSource.loopStart=l._start||0,l._node.bufferSource.loopEnd=l._stop||0),l._node.bufferSource.playbackRate.setValueAtTime(l._rate,t.ctx.currentTime),h},_cleanBuffer:function(l){var h=this,d=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(t._scratchBuffer&&l.bufferSource&&(l.bufferSource.onended=null,l.bufferSource.disconnect(0),d))try{l.bufferSource.buffer=t._scratchBuffer}catch{}return l.bufferSource=null,h},_clearSound:function(l){var h=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);h||(l.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(l){this._parent=l,this.init()};i.prototype={init:function(){var l=this,h=l._parent;return l._muted=h._muted,l._loop=h._loop,l._volume=h._volume,l._rate=h._rate,l._seek=0,l._paused=!0,l._ended=!0,l._sprite="__default",l._id=++t._counter,h._sounds.push(l),l.create(),l},create:function(){var l=this,h=l._parent,d=t._muted||l._muted||l._parent._muted?0:l._volume;return h._webAudio?(l._node=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),l._node.gain.setValueAtTime(d,t.ctx.currentTime),l._node.paused=!0,l._node.connect(t.masterGain)):t.noAudio||(l._node=t._obtainHtml5Audio(),l._errorFn=l._errorListener.bind(l),l._node.addEventListener("error",l._errorFn,!1),l._loadFn=l._loadListener.bind(l),l._node.addEventListener(t._canPlayEvent,l._loadFn,!1),l._endFn=l._endListener.bind(l),l._node.addEventListener("ended",l._endFn,!1),l._node.src=h._src,l._node.preload=h._preload===!0?"auto":h._preload,l._node.volume=d*t.volume(),l._node.load()),l},reset:function(){var l=this,h=l._parent;return l._muted=h._muted,l._loop=h._loop,l._volume=h._volume,l._rate=h._rate,l._seek=0,l._rateSeek=0,l._paused=!0,l._ended=!0,l._sprite="__default",l._id=++t._counter,l},_errorListener:function(){var l=this;l._parent._emit("loaderror",l._id,l._node.error?l._node.error.code:0),l._node.removeEventListener("error",l._errorFn,!1)},_loadListener:function(){var l=this,h=l._parent;h._duration=Math.ceil(l._node.duration*10)/10,Object.keys(h._sprite).length===0&&(h._sprite={__default:[0,h._duration*1e3]}),h._state!=="loaded"&&(h._state="loaded",h._emit("load"),h._loadQueue()),l._node.removeEventListener(t._canPlayEvent,l._loadFn,!1)},_endListener:function(){var l=this,h=l._parent;h._duration===1/0&&(h._duration=Math.ceil(l._node.duration*10)/10,h._sprite.__default[1]===1/0&&(h._sprite.__default[1]=h._duration*1e3),h._ended(l)),l._node.removeEventListener("ended",l._endFn,!1)}};var n={},s=function(l){var h=l._src;if(n[h]){l._duration=n[h].duration,f(l);return}if(/^data:[^;]+;base64,/.test(h)){for(var d=atob(h.split(",")[1]),m=new Uint8Array(d.length),_=0;_<d.length;++_)m[_]=d.charCodeAt(_);c(m.buffer,l)}else{var x=new XMLHttpRequest;x.open(l._xhr.method,h,!0),x.withCredentials=l._xhr.withCredentials,x.responseType="arraybuffer",l._xhr.headers&&Object.keys(l._xhr.headers).forEach(function(T){x.setRequestHeader(T,l._xhr.headers[T])}),x.onload=function(){var T=(x.status+"")[0];if(T!=="0"&&T!=="2"&&T!=="3"){l._emit("loaderror",null,"Failed loading audio file with status: "+x.status+".");return}c(x.response,l)},x.onerror=function(){l._webAudio&&(l._html5=!0,l._webAudio=!1,l._sounds=[],delete n[h],l.load())},a(x)}},a=function(l){try{l.send()}catch{l.onerror()}},c=function(l,h){var d=function(){h._emit("loaderror",null,"Decoding audio data failed.")},m=function(_){_&&h._sounds.length>0?(n[h._src]=_,f(h,_)):d()};typeof Promise<"u"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(l).then(m).catch(d):t.ctx.decodeAudioData(l,m,d)},f=function(l,h){h&&!l._duration&&(l._duration=h.duration),Object.keys(l._sprite).length===0&&(l._sprite={__default:[0,l._duration*1e3]}),l._state!=="loaded"&&(l._state="loaded",l._emit("load"),l._loadQueue())},p=function(){if(t.usingWebAudio){try{typeof AudioContext<"u"?t.ctx=new AudioContext:typeof webkitAudioContext<"u"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var l=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),h=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),d=h?parseInt(h[1],10):null;if(l&&d&&d<9){var m=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!m&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:t,Howl:r}}),typeof au<"u"&&(au.Howler=t,au.Howl=r),typeof global<"u"?(global.HowlerGlobal=e,global.Howler=t,global.Howl=r,global.Sound=i):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=t,window.Howl=r,window.Sound=i)})();(function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var r=this;if(!r.ctx||!r.ctx.listener)return r;for(var i=r._howls.length-1;i>=0;i--)r._howls[i].stereo(t);return r},HowlerGlobal.prototype.pos=function(t,r,i){var n=this;if(!n.ctx||!n.ctx.listener)return n;if(r=typeof r!="number"?n._pos[1]:r,i=typeof i!="number"?n._pos[2]:i,typeof t=="number")n._pos=[t,r,i],typeof n.ctx.listener.positionX<"u"?(n.ctx.listener.positionX.setTargetAtTime(n._pos[0],Howler.ctx.currentTime,.1),n.ctx.listener.positionY.setTargetAtTime(n._pos[1],Howler.ctx.currentTime,.1),n.ctx.listener.positionZ.setTargetAtTime(n._pos[2],Howler.ctx.currentTime,.1)):n.ctx.listener.setPosition(n._pos[0],n._pos[1],n._pos[2]);else return n._pos;return n},HowlerGlobal.prototype.orientation=function(t,r,i,n,s,a){var c=this;if(!c.ctx||!c.ctx.listener)return c;var f=c._orientation;if(r=typeof r!="number"?f[1]:r,i=typeof i!="number"?f[2]:i,n=typeof n!="number"?f[3]:n,s=typeof s!="number"?f[4]:s,a=typeof a!="number"?f[5]:a,typeof t=="number")c._orientation=[t,r,i,n,s,a],typeof c.ctx.listener.forwardX<"u"?(c.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),c.ctx.listener.forwardY.setTargetAtTime(r,Howler.ctx.currentTime,.1),c.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),c.ctx.listener.upX.setTargetAtTime(n,Howler.ctx.currentTime,.1),c.ctx.listener.upY.setTargetAtTime(s,Howler.ctx.currentTime,.1),c.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):c.ctx.listener.setOrientation(t,r,i,n,s,a);else return f;return c},Howl.prototype.init=function(t){return function(r){var i=this;return i._orientation=r.orientation||[1,0,0],i._stereo=r.stereo||null,i._pos=r.pos||null,i._pannerAttr={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:360,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:360,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:0,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:"inverse",maxDistance:typeof r.maxDistance<"u"?r.maxDistance:1e4,panningModel:typeof r.panningModel<"u"?r.panningModel:"HRTF",refDistance:typeof r.refDistance<"u"?r.refDistance:1,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:1},i._onstereo=r.onstereo?[{fn:r.onstereo}]:[],i._onpos=r.onpos?[{fn:r.onpos}]:[],i._onorientation=r.onorientation?[{fn:r.onorientation}]:[],t.call(this,r)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,r){var i=this;if(!i._webAudio)return i;if(i._state!=="loaded")return i._queue.push({event:"stereo",action:function(){i.stereo(t,r)}}),i;var n=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof r>"u")if(typeof t=="number")i._stereo=t,i._pos=[t,0,0];else return i._stereo;for(var s=i._getSoundIds(r),a=0;a<s.length;a++){var c=i._soundById(s[a]);if(c)if(typeof t=="number")c._stereo=t,c._pos=[t,0,0],c._node&&(c._pannerAttr.panningModel="equalpower",(!c._panner||!c._panner.pan)&&e(c,n),n==="spatial"?typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):c._panner.setPosition(t,0,0):c._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),i._emit("stereo",c._id);else return c._stereo}return i},Howl.prototype.pos=function(t,r,i,n){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"pos",action:function(){s.pos(t,r,i,n)}}),s;if(r=typeof r!="number"?0:r,i=typeof i!="number"?-.5:i,typeof n>"u")if(typeof t=="number")s._pos=[t,r,i];else return s._pos;for(var a=s._getSoundIds(n),c=0;c<a.length;c++){var f=s._soundById(a[c]);if(f)if(typeof t=="number")f._pos=[t,r,i],f._node&&((!f._panner||f._panner.pan)&&e(f,"spatial"),typeof f._panner.positionX<"u"?(f._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),f._panner.positionY.setValueAtTime(r,Howler.ctx.currentTime),f._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):f._panner.setPosition(t,r,i)),s._emit("pos",f._id);else return f._pos}return s},Howl.prototype.orientation=function(t,r,i,n){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"orientation",action:function(){s.orientation(t,r,i,n)}}),s;if(r=typeof r!="number"?s._orientation[1]:r,i=typeof i!="number"?s._orientation[2]:i,typeof n>"u")if(typeof t=="number")s._orientation=[t,r,i];else return s._orientation;for(var a=s._getSoundIds(n),c=0;c<a.length;c++){var f=s._soundById(a[c]);if(f)if(typeof t=="number")f._orientation=[t,r,i],f._node&&(f._panner||(f._pos||(f._pos=s._pos||[0,0,-.5]),e(f,"spatial")),typeof f._panner.orientationX<"u"?(f._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),f._panner.orientationY.setValueAtTime(r,Howler.ctx.currentTime),f._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):f._panner.setOrientation(t,r,i)),s._emit("orientation",f._id);else return f._orientation}return s},Howl.prototype.pannerAttr=function(){var t=this,r=arguments,i,n,s;if(!t._webAudio)return t;if(r.length===0)return t._pannerAttr;if(r.length===1)if(typeof r[0]=="object")i=r[0],typeof n>"u"&&(i.pannerAttr||(i.pannerAttr={coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,panningModel:i.panningModel}),t._pannerAttr={coneInnerAngle:typeof i.pannerAttr.coneInnerAngle<"u"?i.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof i.pannerAttr.coneOuterAngle<"u"?i.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof i.pannerAttr.coneOuterGain<"u"?i.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof i.pannerAttr.distanceModel<"u"?i.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof i.pannerAttr.maxDistance<"u"?i.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof i.pannerAttr.refDistance<"u"?i.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof i.pannerAttr.rolloffFactor<"u"?i.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof i.pannerAttr.panningModel<"u"?i.pannerAttr.panningModel:t._panningModel});else return s=t._soundById(parseInt(r[0],10)),s?s._pannerAttr:t._pannerAttr;else r.length===2&&(i=r[0],n=parseInt(r[1],10));for(var a=t._getSoundIds(n),c=0;c<a.length;c++)if(s=t._soundById(a[c]),s){var f=s._pannerAttr;f={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:f.coneInnerAngle,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:f.coneOuterAngle,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:f.coneOuterGain,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:f.distanceModel,maxDistance:typeof i.maxDistance<"u"?i.maxDistance:f.maxDistance,refDistance:typeof i.refDistance<"u"?i.refDistance:f.refDistance,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:f.rolloffFactor,panningModel:typeof i.panningModel<"u"?i.panningModel:f.panningModel};var p=s._panner;p?(p.coneInnerAngle=f.coneInnerAngle,p.coneOuterAngle=f.coneOuterAngle,p.coneOuterGain=f.coneOuterGain,p.distanceModel=f.distanceModel,p.maxDistance=f.maxDistance,p.refDistance=f.refDistance,p.rolloffFactor=f.rolloffFactor,p.panningModel=f.panningModel):(s._pos||(s._pos=t._pos||[0,0,-.5]),e(s,"spatial"))}return t},Sound.prototype.init=function(t){return function(){var r=this,i=r._parent;r._orientation=i._orientation,r._stereo=i._stereo,r._pos=i._pos,r._pannerAttr=i._pannerAttr,t.call(this),r._stereo?i.stereo(r._stereo):r._pos&&i.pos(r._pos[0],r._pos[1],r._pos[2],r._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var r=this,i=r._parent;return r._orientation=i._orientation,r._stereo=i._stereo,r._pos=i._pos,r._pannerAttr=i._pannerAttr,r._stereo?i.stereo(r._stereo):r._pos?i.pos(r._pos[0],r._pos[1],r._pos[2],r._id):r._panner&&(r._panner.disconnect(0),r._panner=void 0,i._refreshBuffer(r)),t.call(this)}}(Sound.prototype.reset);var e=function(t,r){r=r||"spatial",r==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()});var pr=(e=>(e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2",e))(pr||{}),Bc=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.WEBGL=1]="WEBGL",e[e.CANVAS=2]="CANVAS",e))(Bc||{}),Wl=(e=>(e[e.COLOR=16384]="COLOR",e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL",e))(Wl||{}),dt=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR",e))(dt||{}),rr=(e=>(e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e))(rr||{}),et=(e=>(e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.RG=33319]="RG",e[e.RED=6403]="RED",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e))(et||{}),wi=(e=>(e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e))(wi||{}),lt=(e=>(e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.BYTE=5120]="BYTE",e[e.SHORT=5122]="SHORT",e[e.INT=5124]="INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.HALF_FLOAT=36193]="HALF_FLOAT",e))(lt||{}),Xl=(e=>(e[e.FLOAT=0]="FLOAT",e[e.INT=1]="INT",e[e.UINT=2]="UINT",e))(Xl||{}),Pr=(e=>(e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR",e))(Pr||{}),mr=(e=>(e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e))(mr||{}),Ce=(e=>(e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON",e[e.ON_MANUAL=3]="ON_MANUAL",e))(Ce||{}),fe=(e=>(e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",e))(fe||{}),gr=(e=>(e[e.NO=0]="NO",e[e.YES=1]="YES",e[e.AUTO=2]="AUTO",e[e.BLEND=0]="BLEND",e[e.CLEAR=1]="CLEAR",e[e.BLIT=2]="BLIT",e))(gr||{}),zl=(e=>(e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL",e))(zl||{}),Ve=(e=>(e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp",e))(Ve||{}),se=(e=>(e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE",e[e.COLOR=4]="COLOR",e))(se||{});var Ft=(e=>(e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH",e))(Ft||{}),ir=(e=>(e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e))(ir||{});var Dc={createCanvas:(e,t)=>{let r=document.createElement("canvas");return r.width=e,r.height=t,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>new DOMParser().parseFromString(e,"text/xml")};var X={ADAPTER:Dc,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Oc=/iPhone/i,hg=/iPod/i,ug=/iPad/i,cg=/\biOS-universal(?:.+)Mac\b/i,Lc=/\bAndroid(?:.+)Mobile\b/i,fg=/Android/i,Es=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,$l=/Silk/i,Si=/Windows Phone/i,dg=/\bWindows(?:.+)ARM\b/i,pg=/BlackBerry/i,mg=/BB10/i,gg=/Opera Mini/i,_g=/\b(CriOS|Chrome)(?:.+)Mobile/i,xg=/Mobile(?:.+)Firefox\b/i,vg=function(e){return typeof e<"u"&&e.platform==="MacIntel"&&typeof e.maxTouchPoints=="number"&&e.maxTouchPoints>1&&typeof MSStream>"u"};function mb(e){return function(t){return t.test(e)}}function Fo(e){var t={userAgent:"",platform:"",maxTouchPoints:0};!e&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof e=="string"?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0});var r=t.userAgent,i=r.split("[FBAN");typeof i[1]<"u"&&(r=i[0]),i=r.split("Twitter"),typeof i[1]<"u"&&(r=i[0]);var n=mb(r),s={apple:{phone:n(Oc)&&!n(Si),ipod:n(hg),tablet:!n(Oc)&&(n(ug)||vg(t))&&!n(Si),universal:n(cg),device:(n(Oc)||n(hg)||n(ug)||n(cg)||vg(t))&&!n(Si)},amazon:{phone:n(Es),tablet:!n(Es)&&n($l),device:n(Es)||n($l)},android:{phone:!n(Si)&&n(Es)||!n(Si)&&n(Lc),tablet:!n(Si)&&!n(Es)&&!n(Lc)&&(n($l)||n(fg)),device:!n(Si)&&(n(Es)||n($l)||n(Lc)||n(fg))||n(/\bokhttp\b/i)},windows:{phone:n(Si),tablet:n(dg),device:n(Si)||n(dg)},other:{blackberry:n(pg),blackberry10:n(mg),opera:n(gg),firefox:n(xg),chrome:n(_g),device:n(pg)||n(mg)||n(gg)||n(xg)||n(_g)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}var gb=Fo.default??Fo,Mr=gb(globalThis.navigator);var rt={};db(rt,{BaseTextureCache:()=>Xe,BoundingBox:()=>Ps,CanvasRenderTarget:()=>ih,DATA_URI:()=>eh,EventEmitter:()=>tn.default,ProgramCache:()=>qo,TextureCache:()=>we,clearTextureCache:()=>d_,correctBlendMode:()=>n_,createIndicesForQuads:()=>l_,decomposeDataUri:()=>__,deprecation:()=>_t,destroyTextureCache:()=>f_,determineCrossOrigin:()=>oh,earcut:()=>x_.default,getBufferType:()=>Ji,getCanvasBoundingBox:()=>nh,getResolutionOfUrl:()=>Ko,hex2rgb:()=>t_,hex2string:()=>e_,interleaveTypedArrays:()=>h_,isMobile:()=>Mr,isPow2:()=>Yo,isWebGLSupported:()=>Ql,log2:()=>jo,nextPow2:()=>Qi,path:()=>Xc,premultiplyBlendMode:()=>$o,premultiplyRgba:()=>s_,premultiplyTint:()=>o_,premultiplyTintToRgba:()=>a_,removeItems:()=>rh,rgb2hex:()=>i_,sayHello:()=>Hg,sign:()=>u_,skipHello:()=>Gg,string2hex:()=>r_,trimCanvas:()=>g_,uid:()=>si,url:()=>Jl});X.RETINA_PREFIX=/@([0-9\.]+)x/;X.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var tn=Ei(Tg(),1),x_=Ei(Ag(),1);var Rs=Ei(Ug(),1),Jl={parse:Rs.parse,format:Rs.format,resolve:Rs.resolve};function Hr(e){if(typeof e!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(e)}`)}function Xo(e){return e.split("?")[0].split("#")[0]}function Yb(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function jb(e,t,r){return e.replace(new RegExp(Yb(t),"g"),r)}function qb(e,t){let r="",i=0,n=-1,s=0,a=-1;for(let c=0;c<=e.length;++c){if(c<e.length)a=e.charCodeAt(c);else{if(a===47)break;a=47}if(a===47){if(!(n===c-1||s===1))if(n!==c-1&&s===2){if(r.length<2||i!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){let f=r.lastIndexOf("/");if(f!==r.length-1){f===-1?(r="",i=0):(r=r.slice(0,f),i=r.length-1-r.lastIndexOf("/")),n=c,s=0;continue}}else if(r.length===2||r.length===1){r="",i=0,n=c,s=0;continue}}t&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+=`/${e.slice(n+1,c)}`:r=e.slice(n+1,c),i=c-n-1;n=c,s=0}else a===46&&s!==-1?++s:s=-1}return r}var Xc={toPosix(e){return jb(e,"\\","/")},isUrl(e){return/^https?:/.test(this.toPosix(e))},isDataUrl(e){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e)},hasProtocol(e){return/^[^/:]+:\//.test(this.toPosix(e))},getProtocol(e){Hr(e),e=this.toPosix(e);let t="",r=/^file:\/\/\//.exec(e),i=/^[^/:]+:\/\//.exec(e),n=/^[^/:]+:\//.exec(e);if(r||i||n){let s=r?.[0]||i?.[0]||n?.[0];t=s,e=e.slice(s.length)}return t},toAbsolute(e,t,r){if(this.isDataUrl(e))return e;let i=Xo(this.toPosix(t??X.ADAPTER.getBaseUrl())),n=Xo(this.toPosix(r??this.rootname(i)));return Hr(e),e=this.toPosix(e),e.startsWith("/")?Xc.join(n,e.slice(1)):this.isAbsolute(e)?e:this.join(i,e)},normalize(e){if(e=this.toPosix(e),Hr(e),e.length===0)return".";let t="",r=e.startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));let i=e.endsWith("/");return e=qb(e,!1),e.length>0&&i&&(e+="/"),r?`/${e}`:t+e},isAbsolute(e){return Hr(e),e=this.toPosix(e),this.hasProtocol(e)?!0:e.startsWith("/")},join(...e){if(e.length===0)return".";let t;for(let r=0;r<e.length;++r){let i=e[r];if(Hr(i),i.length>0)if(t===void 0)t=i;else{let n=e[r-1]??"";this.extname(n)?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(e){if(Hr(e),e.length===0)return".";e=this.toPosix(e);let t=e.charCodeAt(0),r=t===47,i=-1,n=!0,s=this.getProtocol(e),a=e;e=e.slice(s.length);for(let c=e.length-1;c>=1;--c)if(t=e.charCodeAt(c),t===47){if(!n){i=c;break}}else n=!1;return i===-1?r?"/":this.isUrl(a)?s+e:s:r&&i===1?"//":s+e.slice(0,i)},rootname(e){Hr(e),e=this.toPosix(e);let t="";if(e.startsWith("/")?t="/":t=this.getProtocol(e),this.isUrl(e)){let r=e.indexOf("/",t.length);r!==-1?t=e.slice(0,r):t=e,t.endsWith("/")||(t+="/")}return t},basename(e,t){Hr(e),t&&Hr(t),e=Xo(this.toPosix(e));let r=0,i=-1,n=!0,s;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let a=t.length-1,c=-1;for(s=e.length-1;s>=0;--s){let f=e.charCodeAt(s);if(f===47){if(!n){r=s+1;break}}else c===-1&&(n=!1,c=s+1),a>=0&&(f===t.charCodeAt(a)?--a===-1&&(i=s):(a=-1,i=c))}return r===i?i=c:i===-1&&(i=e.length),e.slice(r,i)}for(s=e.length-1;s>=0;--s)if(e.charCodeAt(s)===47){if(!n){r=s+1;break}}else i===-1&&(n=!1,i=s+1);return i===-1?"":e.slice(r,i)},extname(e){Hr(e),e=Xo(this.toPosix(e));let t=-1,r=0,i=-1,n=!0,s=0;for(let a=e.length-1;a>=0;--a){let c=e.charCodeAt(a);if(c===47){if(!n){r=a+1;break}continue}i===-1&&(n=!1,i=a+1),c===46?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===r+1?"":e.slice(t,i)},parse(e){Hr(e);let t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;e=Xo(this.toPosix(e));let r=e.charCodeAt(0),i=this.isAbsolute(e),n,s="";t.root=this.rootname(e),i||this.hasProtocol(e)?n=1:n=0;let a=-1,c=0,f=-1,p=!0,l=e.length-1,h=0;for(;l>=n;--l){if(r=e.charCodeAt(l),r===47){if(!p){c=l+1;break}continue}f===-1&&(p=!1,f=l+1),r===46?a===-1?a=l:h!==1&&(h=1):a!==-1&&(h=-1)}return a===-1||f===-1||h===0||h===1&&a===f-1&&a===c+1?f!==-1&&(c===0&&i?t.base=t.name=e.slice(1,f):t.base=t.name=e.slice(c,f)):(c===0&&i?(t.name=e.slice(1,a),t.base=e.slice(1,f)):(t.name=e.slice(c,a),t.base=e.slice(c,f)),t.ext=e.slice(a,f)),t.dir=this.dirname(e),s&&(t.dir=s+t.dir),t},sep:"/",delimiter:":"};var kg={};function _t(e,t,r=3){if(kg[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`):(i=i.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${e}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`),console.warn(i))),kg[t]=!0}function Gg(){_t("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function Hg(){_t("7.0.0",`sayHello is deprecated, please use Renderer's "hello" option`)}var zc;function Ql(){return typeof zc>"u"&&(zc=function(){let t={stencil:!0,failIfMajorPerformanceCaveat:X.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!X.ADAPTER.getWebGLRenderingContext())return!1;let r=X.ADAPTER.createCanvas(),i=r.getContext("webgl",t)||r.getContext("experimental-webgl",t),n=!!i?.getContextAttributes()?.stencil;if(i){let s=i.getExtension("WEBGL_lose_context");s&&s.loseContext()}return i=null,n}catch{return!1}}()),zc}var Kb={grad:.9,turn:360,rad:360/(2*Math.PI)},bi=function(e){return typeof e=="string"?e.length>0:typeof e=="number"},Ee=function(e,t,r){return t===void 0&&(t=0),r===void 0&&(r=Math.pow(10,t)),Math.round(r*e)/r+0},Dr=function(e,t,r){return t===void 0&&(t=0),r===void 0&&(r=1),e>r?r:e>t?e:t},qg=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},Vg=function(e){return{r:Dr(e.r,0,255),g:Dr(e.g,0,255),b:Dr(e.b,0,255),a:Dr(e.a)}},$c=function(e){return{r:Ee(e.r),g:Ee(e.g),b:Ee(e.b),a:Ee(e.a,3)}},Zb=/^#([0-9a-f]{3,8})$/i,th=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},Kg=function(e){var t=e.r,r=e.g,i=e.b,n=e.a,s=Math.max(t,r,i),a=s-Math.min(t,r,i),c=a?s===t?(r-i)/a:s===r?2+(i-t)/a:4+(t-r)/a:0;return{h:60*(c<0?c+6:c),s:s?a/s*100:0,v:s/255*100,a:n}},Zg=function(e){var t=e.h,r=e.s,i=e.v,n=e.a;t=t/360*6,r/=100,i/=100;var s=Math.floor(t),a=i*(1-r),c=i*(1-(t-s)*r),f=i*(1-(1-t+s)*r),p=s%6;return{r:255*[i,c,a,a,f,i][p],g:255*[f,i,i,c,a,a][p],b:255*[a,a,f,i,i,c][p],a:n}},Wg=function(e){return{h:qg(e.h),s:Dr(e.s,0,100),l:Dr(e.l,0,100),a:Dr(e.a)}},Xg=function(e){return{h:Ee(e.h),s:Ee(e.s),l:Ee(e.l),a:Ee(e.a,3)}},zg=function(e){return Zg((r=(t=e).s,{h:t.h,s:(r*=((i=t.l)<50?i:100-i)/100)>0?2*r/(i+r)*100:0,v:i+r,a:t.a}));var t,r,i},zo=function(e){return{h:(t=Kg(e)).h,s:(n=(200-(r=t.s))*(i=t.v)/100)>0&&n<200?r*i/100/(n<=100?n:200-n)*100:0,l:n/2,a:t.a};var t,r,i,n},Jb=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Qb=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,tA=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,eA=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,qc={string:[[function(e){var t=Zb.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:e.length===4?Ee(parseInt(e[3]+e[3],16)/255,2):1}:e.length===6||e.length===8?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:e.length===8?Ee(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=tA.exec(e)||eA.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:Vg({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=Jb.exec(e)||Qb.exec(e);if(!t)return null;var r,i,n=Wg({h:(r=t[1],i=t[2],i===void 0&&(i="deg"),Number(r)*(Kb[i]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return zg(n)},"hsl"]],object:[[function(e){var t=e.r,r=e.g,i=e.b,n=e.a,s=n===void 0?1:n;return bi(t)&&bi(r)&&bi(i)?Vg({r:Number(t),g:Number(r),b:Number(i),a:Number(s)}):null},"rgb"],[function(e){var t=e.h,r=e.s,i=e.l,n=e.a,s=n===void 0?1:n;if(!bi(t)||!bi(r)||!bi(i))return null;var a=Wg({h:Number(t),s:Number(r),l:Number(i),a:Number(s)});return zg(a)},"hsl"],[function(e){var t=e.h,r=e.s,i=e.v,n=e.a,s=n===void 0?1:n;if(!bi(t)||!bi(r)||!bi(i))return null;var a=function(c){return{h:qg(c.h),s:Dr(c.s,0,100),v:Dr(c.v,0,100),a:Dr(c.a)}}({h:Number(t),s:Number(r),v:Number(i),a:Number(s)});return Zg(a)},"hsv"]]},$g=function(e,t){for(var r=0;r<t.length;r++){var i=t[r][0](e);if(i)return[i,t[r][1]]}return[null,void 0]},rA=function(e){return typeof e=="string"?$g(e.trim(),qc.string):typeof e=="object"&&e!==null?$g(e,qc.object):[null,void 0]};var Yc=function(e,t){var r=zo(e);return{h:r.h,s:Dr(r.s+100*t,0,100),l:r.l,a:r.a}},jc=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},Yg=function(e,t){var r=zo(e);return{h:r.h,s:r.s,l:Dr(r.l+100*t,0,100),a:r.a}},Kc=function(){function e(t){this.parsed=rA(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return this.parsed!==null},e.prototype.brightness=function(){return Ee(jc(this.rgba),2)},e.prototype.isDark=function(){return jc(this.rgba)<.5},e.prototype.isLight=function(){return jc(this.rgba)>=.5},e.prototype.toHex=function(){return t=$c(this.rgba),r=t.r,i=t.g,n=t.b,a=(s=t.a)<1?th(Ee(255*s)):"","#"+th(r)+th(i)+th(n)+a;var t,r,i,n,s,a},e.prototype.toRgb=function(){return $c(this.rgba)},e.prototype.toRgbString=function(){return t=$c(this.rgba),r=t.r,i=t.g,n=t.b,(s=t.a)<1?"rgba("+r+", "+i+", "+n+", "+s+")":"rgb("+r+", "+i+", "+n+")";var t,r,i,n,s},e.prototype.toHsl=function(){return Xg(zo(this.rgba))},e.prototype.toHslString=function(){return t=Xg(zo(this.rgba)),r=t.h,i=t.s,n=t.l,(s=t.a)<1?"hsla("+r+", "+i+"%, "+n+"%, "+s+")":"hsl("+r+", "+i+"%, "+n+"%)";var t,r,i,n,s},e.prototype.toHsv=function(){return t=Kg(this.rgba),{h:Ee(t.h),s:Ee(t.s),v:Ee(t.v),a:Ee(t.a,3)};var t},e.prototype.invert=function(){return Vr({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},e.prototype.saturate=function(t){return t===void 0&&(t=.1),Vr(Yc(this.rgba,t))},e.prototype.desaturate=function(t){return t===void 0&&(t=.1),Vr(Yc(this.rgba,-t))},e.prototype.grayscale=function(){return Vr(Yc(this.rgba,-1))},e.prototype.lighten=function(t){return t===void 0&&(t=.1),Vr(Yg(this.rgba,t))},e.prototype.darken=function(t){return t===void 0&&(t=.1),Vr(Yg(this.rgba,-t))},e.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},e.prototype.alpha=function(t){return typeof t=="number"?Vr({r:(r=this.rgba).r,g:r.g,b:r.b,a:t}):Ee(this.rgba.a,3);var r},e.prototype.hue=function(t){var r=zo(this.rgba);return typeof t=="number"?Vr({h:t,s:r.s,l:r.l,a:r.a}):Ee(r.h)},e.prototype.isEqual=function(t){return this.toHex()===Vr(t).toHex()},e}(),Vr=function(e){return e instanceof Kc?e:new Kc(e)},jg=[],Jg=function(e){e.forEach(function(t){jg.indexOf(t)<0&&(t(Kc,qc),jg.push(t))})};function Qg(e,t){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var n in r)i[r[n]]=n;var s={};e.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var c,f,p=i[this.toHex()];if(p)return p;if(a?.closest){var l=this.toRgb(),h=1/0,d="black";if(!s.length)for(var m in r)s[m]=new e(r[m]).toRgb();for(var _ in r){var x=(c=l,f=s[_],Math.pow(c.r-f.r,2)+Math.pow(c.g-f.g,2)+Math.pow(c.b-f.b,2));x<h&&(h=x,d=_)}return d}},t.string.push([function(a){var c=a.toLowerCase(),f=c==="transparent"?"#0000":r[c];return f?new e(f).toRgb():null},"name"])}Jg([Qg]);var Is=class{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Is)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,t){let r=typeof e;if(r!==typeof t)return!1;if(r==="number"||r==="string"||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length!==t.length?!1:e.every((n,s)=>n===t[s]);if(e!==null&&t!==null){let n=Object.keys(e),s=Object.keys(t);return n.length!==s.length?!1:n.every(a=>e[a]===t[a])}return e===t}toRgba(){let[e,t,r,i]=this._components;return{r:e,g:t,b:r,a:i}}toRgb(){let[e,t,r]=this._components;return{r:e,g:t,b:r}}toRgbaString(){let[e,t,r]=this.toUint8RgbArray();return`rgba(${e},${t},${r},${this.alpha})`}toUint8RgbArray(e){let[t,r,i]=this._components;return e=e??[],e[0]=Math.round(t*255),e[1]=Math.round(r*255),e[2]=Math.round(i*255),e}toRgbArray(e){e=e??[];let[t,r,i]=this._components;return e[0]=t,e[1]=r,e[2]=i,e}toNumber(){return this._int}toLittleEndianNumber(){let e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){let[t,r,i,n]=Is.temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=r,this._components[2]*=i,this._components[3]*=n,this.refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e){if(e===1)return(e*255<<24)+this._int;if(e===0)return 0;let t=this._int>>16&255,r=this._int>>8&255,i=this._int&255;return t=t*e+.5|0,r=r*e+.5|0,i=i*e+.5|0,(e*255<<24)+(t<<16)+(r<<8)+i}toHex(){let e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){let t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(e){return this._components[3]=e,this}round(e){let[t,r,i]=this._components;return this._components.set([Math.min(255,t/e*e),Math.min(255,r/e*e),Math.min(255,i/e*e)]),this.refreshInt(),this._value=null,this}toArray(e){e=e??[];let[t,r,i,n]=this._components;return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e}normalize(e){let t;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){let r=e;t=[(r>>16&255)/255,(r>>8&255)/255,(r&255)/255,1]}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4&&e.every(r=>r<=1&&r>=0)){let[r,i,n,s=1]=e;t=[r,i,n,s]}else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4){let[r,i,n,s=255]=e;t=[r/255,i/255,n/255,s/255]}else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){let i=Is.HEX_PATTERN.exec(e);i&&(e=`#${i[2]}`)}let r=Vr(e);if(r.isValid()){let{r:i,g:n,b:s,a}=r.rgba;t=[i/255,n/255,s/255,a]}}if(t)this._components.set(t),this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._components.forEach((i,n)=>this._components[n]=Math.min(Math.max(i,0),1));let[e,t,r]=this._components;this._int=(e*255<<16)+(t*255<<8)+(r*255|0)}},mt=Is;mt.shared=new Is;mt.temp=new Is;mt.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;function t_(e,t=[]){return _t("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),mt.shared.setValue(e).toRgbArray(t)}function e_(e){return _t("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),mt.shared.setValue(e).toHex()}function r_(e){return _t("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),mt.shared.setValue(e).toNumber()}function i_(e){return _t("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),mt.shared.setValue(e).toNumber()}function iA(){let e=[],t=[];for(let i=0;i<32;i++)e[i]=i,t[i]=i;e[dt.NORMAL_NPM]=dt.NORMAL,e[dt.ADD_NPM]=dt.ADD,e[dt.SCREEN_NPM]=dt.SCREEN,t[dt.NORMAL]=dt.NORMAL_NPM,t[dt.ADD]=dt.ADD_NPM,t[dt.SCREEN]=dt.SCREEN_NPM;let r=[];return r.push(t),r.push(e),r}var $o=iA();function n_(e,t){return $o[t?1:0][e]}function s_(e,t,r,i=!0){return _t("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),mt.shared.setValue(e).premultiply(t,i).toArray(r??new Float32Array(4))}function o_(e,t){return _t("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),mt.shared.setValue(e).toPremultiplied(t)}function a_(e,t,r,i=!0){return _t("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),mt.shared.setValue(e).premultiply(t,i).toArray(r??new Float32Array(4))}var eh=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function l_(e,t=null){let r=e*6;if(t=t||new Uint16Array(r),t.length!==r)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${r}`);for(let i=0,n=0;i<r;i+=6,n+=4)t[i+0]=n+0,t[i+1]=n+1,t[i+2]=n+2,t[i+3]=n+0,t[i+4]=n+2,t[i+5]=n+3;return t}function Ji(e){if(e.BYTES_PER_ELEMENT===4)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(e.BYTES_PER_ELEMENT===2){if(e instanceof Uint16Array)return"Uint16Array"}else if(e.BYTES_PER_ELEMENT===1&&e instanceof Uint8Array)return"Uint8Array";return null}var nA={Float32Array,Uint32Array,Int32Array,Uint8Array};function h_(e,t){let r=0,i=0,n={};for(let f=0;f<e.length;f++)i+=t[f],r+=e[f].length;let s=new ArrayBuffer(r*4),a=null,c=0;for(let f=0;f<e.length;f++){let p=t[f],l=e[f],h=Ji(l);n[h]||(n[h]=new nA[h](s)),a=n[h];for(let d=0;d<l.length;d++){let m=(d/p|0)*i+c,_=d%p;a[m+_]=l[d]}c+=p}return new Float32Array(s)}function Qi(e){return e+=e===0?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1}function Yo(e){return!(e&e-1)&&!!e}function jo(e){let t=(e>65535?1:0)<<4;e>>>=t;let r=(e>255?1:0)<<3;return e>>>=r,t|=r,r=(e>15?1:0)<<2,e>>>=r,t|=r,r=(e>3?1:0)<<1,e>>>=r,t|=r,t|e>>1}function rh(e,t,r){let i=e.length,n;if(t>=i||r===0)return;r=t+r>i?i-t:r;let s=i-r;for(n=t;n<s;++n)e[n]=e[n+r];e.length=s}function u_(e){return e===0?0:e<0?-1:1}var sA=0;function si(){return++sA}var c_=class{constructor(e,t,r,i){this.left=e,this.top=t,this.right=r,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}},Ps=c_;Ps.EMPTY=new c_(0,0,0,0);var qo={},we=Object.create(null),Xe=Object.create(null);function f_(){let e;for(e in we)we[e].destroy();for(e in Xe)Xe[e].destroy()}function d_(){let e;for(e in we)delete we[e];for(e in Xe)delete Xe[e]}var ih=class{constructor(t,r,i){this._canvas=X.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||X.RESOLUTION,this.resize(t,r)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,r){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(r*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}};function p_(e,t,r){for(let i=0,n=4*r*t;i<t;++i,n+=4)if(e[n+3]!==0)return!1;return!0}function m_(e,t,r,i,n){let s=4*t;for(let a=i,c=i*s+4*r;a<=n;++a,c+=s)if(e[c+3]!==0)return!1;return!0}function nh(e){let{width:t,height:r}=e,i=e.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");let s=i.getImageData(0,0,t,r).data,a=0,c=0,f=t-1,p=r-1;for(;c<r&&p_(s,t,c);)++c;if(c===r)return Ps.EMPTY;for(;p_(s,t,p);)--p;for(;m_(s,t,a,c,p);)++a;for(;m_(s,t,f,c,p);)--f;return++f,++p,new Ps(a,c,f,p)}function g_(e){let t=nh(e),{width:r,height:i}=t,n=null;if(!t.isEmpty()){let s=e.getContext("2d");if(s===null)throw new TypeError("Failed to get canvas 2D context");n=s.getImageData(t.left,t.top,r,i)}return{width:r,height:i,data:n}}function __(e){let t=eh.exec(e);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]}}var sh;function oh(e,t=globalThis.location){if(e.startsWith("data:"))return"";t=t||globalThis.location,sh||(sh=document.createElement("a")),sh.href=e;let r=Jl.parse(sh.href),i=!r.port&&t.port===""||r.port===t.port;return r.hostname!==t.hostname||!i||r.protocol!==t.protocol?"anonymous":""}function Ko(e,t=1){let r=X.RETINA_PREFIX?.exec(e);return r?parseFloat(r[1]):t}var $=(e=>(e.Renderer="renderer",e.Application="application",e.RendererSystem="renderer-webgl-system",e.RendererPlugin="renderer-webgl-plugin",e.CanvasRendererSystem="renderer-canvas-system",e.CanvasRendererPlugin="renderer-canvas-plugin",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e))($||{}),Zc=e=>{if(typeof e=="function"||typeof e=="object"&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");e={...typeof e.extension!="object"?{type:e.extension}:e.extension,ref:e}}if(typeof e=="object")e={...e};else throw new Error("Invalid extension type");return typeof e.type=="string"&&(e.type=[e.type]),e},v_=(e,t)=>Zc(e).priority??t,J={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...e){return e.map(Zc).forEach(t=>{t.type.forEach(r=>this._removeHandlers[r]?.(t))}),this},add(...e){return e.map(Zc).forEach(t=>{t.type.forEach(r=>{let i=this._addHandlers,n=this._queue;i[r]?i[r](t):(n[r]=n[r]||[],n[r].push(t))})}),this},handle(e,t,r){let i=this._addHandlers,n=this._removeHandlers;if(i[e]||n[e])throw new Error(`Extension type ${e} already has a handler`);i[e]=t,n[e]=r;let s=this._queue;return s[e]&&(s[e].forEach(a=>t(a)),delete s[e]),this},handleByMap(e,t){return this.handle(e,r=>{t[r.name]=r.ref},r=>{delete t[r.name]})},handleByList(e,t,r=-1){return this.handle(e,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((n,s)=>v_(s,r)-v_(n,r)))},i=>{let n=t.indexOf(i.ref);n!==-1&&t.splice(n,1)})}};var en=class{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}};var oA=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function aA(e){let t="";for(let r=0;r<e;++r)r>0&&(t+=`
else `),r<e-1&&(t+=`if(test == ${r}.0){}`);return t}function ah(e,t){if(e===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");let r=t.createShader(t.FRAGMENT_SHADER);for(;;){let i=oA.replace(/%forloop%/gi,aA(e));if(t.shaderSource(r,i),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))e=e/2|0;else break}return e}var Jc=0,Qc=1,tf=2,ef=3,rf=4,nf=5,me=class{constructor(){this.data=0,this.blendMode=dt.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Jc)}set blend(t){!!(this.data&1<<Jc)!==t&&(this.data^=1<<Jc)}get offsets(){return!!(this.data&1<<Qc)}set offsets(t){!!(this.data&1<<Qc)!==t&&(this.data^=1<<Qc)}get culling(){return!!(this.data&1<<tf)}set culling(t){!!(this.data&1<<tf)!==t&&(this.data^=1<<tf)}get depthTest(){return!!(this.data&1<<ef)}set depthTest(t){!!(this.data&1<<ef)!==t&&(this.data^=1<<ef)}get depthMask(){return!!(this.data&1<<nf)}set depthMask(t){!!(this.data&1<<nf)!==t&&(this.data^=1<<nf)}get clockwiseFrontFace(){return!!(this.data&1<<rf)}set clockwiseFrontFace(t){!!(this.data&1<<rf)!==t&&(this.data^=1<<rf)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==dt.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){let t=new me;return t.depthTest=!1,t.blend=!0,t}};var Ms=[];function Bs(e,t){if(!e)return null;let r="";if(typeof e=="string"){let i=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);i&&(r=i[1].toLowerCase())}for(let i=Ms.length-1;i>=0;--i){let n=Ms[i];if(n.test&&n.test(e,r))return new n(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}var he=class{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,r,i,n,s,a,c,f){if(arguments.length>8)throw new Error("max arguments reached");let{name:p,items:l}=this;this._aliasCount++;for(let h=0,d=l.length;h<d;h++)l[h][p](t,r,i,n,s,a,c,f);return l===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){let r=this.items.indexOf(t);return r!==-1&&(this.ensureNonAliasedItems(),this.items.splice(r,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}};Object.defineProperties(he.prototype,{dispatch:{value:he.prototype.emit},run:{value:he.prototype.emit}});var _r=class{constructor(t=0,r=0){this._width=t,this._height=r,this.destroyed=!1,this.internal=!1,this.onResize=new he("setRealSize"),this.onUpdate=new he("update"),this.onError=new he("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,r){(t!==this._width||r!==this._height)&&(this._width=t,this._height=r,this.onResize.emit(t,r))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,r,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,r){return!1}};var nr=class extends _r{constructor(t,r){let{width:i,height:n}=r||{};if(!i||!n)throw new Error("BufferResource width or height invalid");super(i,n),this.data=t}upload(t,r,i){let n=t.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===fe.UNPACK);let s=r.realWidth,a=r.realHeight;return i.width===s&&i.height===a?n.texSubImage2D(r.target,0,0,0,s,a,r.format,i.type,this.data):(i.width=s,i.height=a,n.texImage2D(r.target,0,i.internalFormat,s,a,0,r.format,i.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}};var lA={scaleMode:Pr.NEAREST,format:et.RGBA,alphaMode:fe.NPM},Ds=class extends tn.default{constructor(e=null,t=null){super(),t=Object.assign({},Ds.defaultOptions,t);let{alphaMode:r,mipmap:i,anisotropicLevel:n,scaleMode:s,width:a,height:c,wrapMode:f,format:p,type:l,target:h,resolution:d,resourceOptions:m}=t;e&&!(e instanceof _r)&&(e=Bs(e,m),e.internal=!0),this.resolution=d||X.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((c||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=n,this._wrapMode=f,this._scaleMode=s,this.format=p,this.type=l,this.target=h,this.alphaMode=r,this.uid=si(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&c>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let r;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,r=!0),r&&this.dirtyStyleId++,this}setSize(e,t,r){return r=r||this.resolution,this.setRealSize(e*r,t*r,r)}setRealSize(e,t,r){return this.resolution=r||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Yo(this.realWidth)&&Yo(this.realHeight)}setResolution(e){let t=this.resolution;return t===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Xe[this.cacheId],delete we[this.cacheId],this.cacheId=null),this.dispose(),Ds.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,t,r=X.STRICT_TEXTURE_CACHE){let i=typeof e=="string",n=null;if(i)n=e;else{if(!e._pixiId){let a=t?.pixiIdPrefix||"pixiid";e._pixiId=`${a}_${si()}`}n=e._pixiId}let s=Xe[n];if(i&&r&&!s)throw new Error(`The cacheId "${n}" does not exist in BaseTextureCache.`);return s||(s=new Ds(e,t),s.cacheId=n,Ds.addToCache(s,n)),s}static fromBuffer(e,t,r,i){e=e||new Float32Array(t*r*4);let n=new nr(e,{width:t,height:r}),s=e instanceof Float32Array?lt.FLOAT:lt.UNSIGNED_BYTE;return new Ds(n,Object.assign({},lA,i||{width:t,height:r,type:s}))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),Xe[t]&&Xe[t]!==e&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),Xe[t]=e)}static removeFromCache(e){if(typeof e=="string"){let t=Xe[e];if(t){let r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete Xe[e],t}}else if(e?.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)delete Xe[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}},ht=Ds;ht.defaultOptions={mipmap:Ce.POW2,anisotropicLevel:0,scaleMode:Pr.LINEAR,wrapMode:mr.CLAMP,alphaMode:fe.UNPACK,target:wi.TEXTURE_2D,format:et.RGBA,type:lt.UNSIGNED_BYTE};ht._globalBatch=0;var rn=class{constructor(){this.texArray=null,this.blend=0,this.type=rr.TRIANGLES,this.start=0,this.size=0,this.data=null}};var hA=0,Ht=class{constructor(t,r=!0,i=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=r,this.id=hA++,this.disposeRunner=new he("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?ir.ELEMENT_ARRAY_BUFFER:ir.ARRAY_BUFFER}get index(){return this.type===ir.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new Ht(t)}};var nn=class{constructor(t,r=0,i=!1,n=lt.FLOAT,s,a,c,f=1){this.buffer=t,this.size=r,this.normalized=i,this.type=n,this.stride=s,this.start=a,this.instance=c,this.divisor=f}destroy(){this.buffer=null}static from(t,r,i,n,s){return new nn(t,r,i,n,s)}};var uA={Float32Array,Uint32Array,Int32Array,Uint8Array};function y_(e,t){let r=0,i=0,n={};for(let f=0;f<e.length;f++)i+=t[f],r+=e[f].length;let s=new ArrayBuffer(r*4),a=null,c=0;for(let f=0;f<e.length;f++){let p=t[f],l=e[f],h=Ji(l);n[h]||(n[h]=new uA[h](s)),a=n[h];for(let d=0;d<l.length;d++){let m=(d/p|0)*i+c,_=d%p;a[m+_]=l[d]}c+=p}return new Float32Array(s)}var T_={5126:4,5123:2,5121:1},cA=0,fA={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Oe=class{constructor(t=[],r={}){this.buffers=t,this.indexBuffer=null,this.attributes=r,this.glVertexArrayObjects={},this.id=cA++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new he("disposeGeometry"),this.refCount=0}addAttribute(t,r,i=0,n=!1,s,a,c,f=!1){if(!r)throw new Error("You must pass a buffer when creating an attribute");r instanceof Ht||(r instanceof Array&&(r=new Float32Array(r)),r=new Ht(r));let p=t.split("|");if(p.length>1){for(let h=0;h<p.length;h++)this.addAttribute(p[h],r,i,n,s);return this}let l=this.buffers.indexOf(r);return l===-1&&(this.buffers.push(r),l=this.buffers.length-1),this.attributes[t]=new nn(l,i,n,s,a,c,f),this.instanced=this.instanced||f,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Ht||(t instanceof Array&&(t=new Uint16Array(t)),t=new Ht(t)),t.type=ir.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;let t=[],r=[],i=new Ht,n;for(n in this.attributes){let s=this.attributes[n],a=this.buffers[s.buffer];t.push(a.data),r.push(s.size*T_[s.type]/4),s.buffer=0}for(i.data=y_(t,r),n=0;n<this.buffers.length;n++)this.buffers[n]!==this.indexBuffer&&this.buffers[n].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(let t in this.attributes){let r=this.attributes[t];return this.buffers[r.buffer].data.length/(r.stride/4||r.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){let t=new Oe;for(let r=0;r<this.buffers.length;r++)t.buffers[r]=new Ht(this.buffers[r].data.slice(0));for(let r in this.attributes){let i=this.attributes[r];t.attributes[r]=new nn(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=ir.ELEMENT_ARRAY_BUFFER),t}static merge(t){let r=new Oe,i=[],n=[],s=[],a;for(let c=0;c<t.length;c++){a=t[c];for(let f=0;f<a.buffers.length;f++)n[f]=n[f]||0,n[f]+=a.buffers[f].data.length,s[f]=0}for(let c=0;c<a.buffers.length;c++)i[c]=new fA[Ji(a.buffers[c].data)](n[c]),r.buffers[c]=new Ht(i[c]);for(let c=0;c<t.length;c++){a=t[c];for(let f=0;f<a.buffers.length;f++)i[f].set(a.buffers[f].data,s[f]),s[f]+=a.buffers[f].data.length}if(r.attributes=a.attributes,a.indexBuffer){r.indexBuffer=r.buffers[a.buffers.indexOf(a.indexBuffer)],r.indexBuffer.type=ir.ELEMENT_ARRAY_BUFFER;let c=0,f=0,p=0,l=0;for(let h=0;h<a.buffers.length;h++)if(a.buffers[h]!==a.indexBuffer){l=h;break}for(let h in a.attributes){let d=a.attributes[h];(d.buffer|0)===l&&(f+=d.size*T_[d.type]/4)}for(let h=0;h<t.length;h++){let d=t[h].indexBuffer.data;for(let m=0;m<d.length;m++)r.indexBuffer.data[m+p]+=c;c+=t[h].buffers[l].data.length/f,p+=d.length}}return r}};var Fn=class extends Oe{constructor(t=!1){super(),this._buffer=new Ht(null,t,!1),this._indexBuffer=new Ht(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,lt.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,lt.FLOAT).addAttribute("aColor",this._buffer,4,!0,lt.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,lt.FLOAT).addIndex(this._indexBuffer)}};var sn=Math.PI*2,sf=180/Math.PI,of=Math.PI/180,Yt=(e=>(e[e.POLY=0]="POLY",e[e.RECT=1]="RECT",e[e.CIRC=2]="CIRC",e[e.ELIP=3]="ELIP",e[e.RREC=4]="RREC",e))(Yt||{});var pt=class{constructor(t=0,r=0){this.x=0,this.y=0,this.x=t,this.y=r}clone(){return new pt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,r=t){return this.x=t,this.y=r,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}};var lh=[new pt,new pt,new pt,new pt],ct=class{constructor(t=0,r=0,i=0,n=0){this.x=Number(t),this.y=Number(r),this.width=Number(i),this.height=Number(n),this.type=Yt.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new ct(0,0,0,0)}clone(){return new ct(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,r){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&r>=this.y&&r<this.y+this.height}intersects(t,r){if(!r){let M=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=M)return!1;let L=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>L}let i=this.left,n=this.right,s=this.top,a=this.bottom;if(n<=i||a<=s)return!1;let c=lh[0].set(t.left,t.top),f=lh[1].set(t.left,t.bottom),p=lh[2].set(t.right,t.top),l=lh[3].set(t.right,t.bottom);if(p.x<=c.x||f.y<=c.y)return!1;let h=Math.sign(r.a*r.d-r.b*r.c);if(h===0||(r.apply(c,c),r.apply(f,f),r.apply(p,p),r.apply(l,l),Math.max(c.x,f.x,p.x,l.x)<=i||Math.min(c.x,f.x,p.x,l.x)>=n||Math.max(c.y,f.y,p.y,l.y)<=s||Math.min(c.y,f.y,p.y,l.y)>=a))return!1;let d=h*(f.y-c.y),m=h*(c.x-f.x),_=d*i+m*s,x=d*n+m*s,T=d*i+m*a,S=d*n+m*a;if(Math.max(_,x,T,S)<=d*c.x+m*c.y||Math.min(_,x,T,S)>=d*l.x+m*l.y)return!1;let w=h*(c.y-p.y),y=h*(p.x-c.x),E=w*i+y*s,R=w*n+y*s,C=w*i+y*a,P=w*n+y*a;return!(Math.max(E,R,C,P)<=w*c.x+y*c.y||Math.min(E,R,C,P)>=w*l.x+y*l.y)}pad(t=0,r=t){return this.x-=t,this.y-=r,this.width+=t*2,this.height+=r*2,this}fit(t){let r=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),n=Math.max(this.y,t.y),s=Math.min(this.y+this.height,t.y+t.height);return this.x=r,this.width=Math.max(i-r,0),this.y=n,this.height=Math.max(s-n,0),this}ceil(t=1,r=.001){let i=Math.ceil((this.x+this.width-r)*t)/t,n=Math.ceil((this.y+this.height-r)*t)/t;return this.x=Math.floor((this.x+r)*t)/t,this.y=Math.floor((this.y+r)*t)/t,this.width=i-this.x,this.height=n-this.y,this}enlarge(t){let r=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),s=Math.max(this.y+this.height,t.y+t.height);return this.x=r,this.width=i-r,this.y=n,this.height=s-n,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};var Nn=class{constructor(t=0,r=0,i=0){this.x=t,this.y=r,this.radius=i,this.type=Yt.CIRC}clone(){return new Nn(this.x,this.y,this.radius)}contains(t,r){if(this.radius<=0)return!1;let i=this.radius*this.radius,n=this.x-t,s=this.y-r;return n*=n,s*=s,n+s<=i}getBounds(){return new ct(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}};var Un=class{constructor(t=0,r=0,i=0,n=0){this.x=t,this.y=r,this.width=i,this.height=n,this.type=Yt.ELIP}clone(){return new Un(this.x,this.y,this.width,this.height)}contains(t,r){if(this.width<=0||this.height<=0)return!1;let i=(t-this.x)/this.width,n=(r-this.y)/this.height;return i*=i,n*=n,i+n<=1}getBounds(){return new ct(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};var Wr=class{constructor(...t){let r=Array.isArray(t[0])?t[0]:t;if(typeof r[0]!="number"){let i=[];for(let n=0,s=r.length;n<s;n++)i.push(r[n].x,r[n].y);r=i}this.points=r,this.type=Yt.POLY,this.closeStroke=!0}clone(){let t=this.points.slice(),r=new Wr(t);return r.closeStroke=this.closeStroke,r}contains(t,r){let i=!1,n=this.points.length/2;for(let s=0,a=n-1;s<n;a=s++){let c=this.points[s*2],f=this.points[s*2+1],p=this.points[a*2],l=this.points[a*2+1];f>r!=l>r&&t<(p-c)*((r-f)/(l-f))+c&&(i=!i)}return i}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,r)=>`${t}, ${r}`,"")}]`}};var kn=class{constructor(t=0,r=0,i=0,n=0,s=20){this.x=t,this.y=r,this.width=i,this.height=n,this.radius=s,this.type=Yt.RREC}clone(){return new kn(this.x,this.y,this.width,this.height,this.radius)}contains(t,r){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){let i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+i&&r<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let n=t-(this.x+i),s=r-(this.y+i),a=i*i;if(n*n+s*s<=a||(n=t-(this.x+this.width-i),n*n+s*s<=a)||(s=r-(this.y+this.height-i),n*n+s*s<=a)||(n=t-(this.x+i),n*n+s*s<=a))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}};var St=class{constructor(t=1,r=0,i=0,n=1,s=0,a=0){this.array=null,this.a=t,this.b=r,this.c=i,this.d=n,this.tx=s,this.ty=a}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,r,i,n,s,a){return this.a=t,this.b=r,this.c=i,this.d=n,this.tx=s,this.ty=a,this}toArray(t,r){this.array||(this.array=new Float32Array(9));let i=r||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,r){r=r||new pt;let i=t.x,n=t.y;return r.x=this.a*i+this.c*n+this.tx,r.y=this.b*i+this.d*n+this.ty,r}applyInverse(t,r){r=r||new pt;let i=1/(this.a*this.d+this.c*-this.b),n=t.x,s=t.y;return r.x=this.d*i*n+-this.c*i*s+(this.ty*this.c-this.tx*this.d)*i,r.y=this.a*i*s+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,r}translate(t,r){return this.tx+=t,this.ty+=r,this}scale(t,r){return this.a*=t,this.d*=r,this.c*=t,this.b*=r,this.tx*=t,this.ty*=r,this}rotate(t){let r=Math.cos(t),i=Math.sin(t),n=this.a,s=this.c,a=this.tx;return this.a=n*r-this.b*i,this.b=n*i+this.b*r,this.c=s*r-this.d*i,this.d=s*i+this.d*r,this.tx=a*r-this.ty*i,this.ty=a*i+this.ty*r,this}append(t){let r=this.a,i=this.b,n=this.c,s=this.d;return this.a=t.a*r+t.b*n,this.b=t.a*i+t.b*s,this.c=t.c*r+t.d*n,this.d=t.c*i+t.d*s,this.tx=t.tx*r+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*s+this.ty,this}setTransform(t,r,i,n,s,a,c,f,p){return this.a=Math.cos(c+p)*s,this.b=Math.sin(c+p)*s,this.c=-Math.sin(c-f)*a,this.d=Math.cos(c-f)*a,this.tx=t-(i*this.a+n*this.c),this.ty=r-(i*this.b+n*this.d),this}prepend(t){let r=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){let i=this.a,n=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=r*t.a+this.ty*t.c+t.tx,this.ty=r*t.b+this.ty*t.d+t.ty,this}decompose(t){let r=this.a,i=this.b,n=this.c,s=this.d,a=t.pivot,c=-Math.atan2(-n,s),f=Math.atan2(i,r),p=Math.abs(c+f);return p<1e-5||Math.abs(sn-p)<1e-5?(t.rotation=f,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=c,t.skew.y=f),t.scale.x=Math.sqrt(r*r+i*i),t.scale.y=Math.sqrt(n*n+s*s),t.position.x=this.tx+(a.x*r+a.y*n),t.position.y=this.ty+(a.x*i+a.y*s),t}invert(){let t=this.a,r=this.b,i=this.c,n=this.d,s=this.tx,a=t*n-r*i;return this.a=n/a,this.b=-r/a,this.c=-i/a,this.d=t/a,this.tx=(i*this.ty-n*s)/a,this.ty=-(t*this.ty-r*s)/a,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){let t=new St;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new St}static get TEMP_MATRIX(){return new St}};var Gn=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Hn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Vn=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Wn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],af=[],E_=[],hh=Math.sign;function dA(){for(let e=0;e<16;e++){let t=[];af.push(t);for(let r=0;r<16;r++){let i=hh(Gn[e]*Gn[r]+Vn[e]*Hn[r]),n=hh(Hn[e]*Gn[r]+Wn[e]*Hn[r]),s=hh(Gn[e]*Vn[r]+Vn[e]*Wn[r]),a=hh(Hn[e]*Vn[r]+Wn[e]*Wn[r]);for(let c=0;c<16;c++)if(Gn[c]===i&&Hn[c]===n&&Vn[c]===s&&Wn[c]===a){t.push(c);break}}}for(let e=0;e<16;e++){let t=new St;t.set(Gn[e],Hn[e],Vn[e],Wn[e],0,0),E_.push(t)}}dA();var Jt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:e=>Gn[e],uY:e=>Hn[e],vX:e=>Vn[e],vY:e=>Wn[e],inv:e=>e&8?e&15:-e&7,add:(e,t)=>af[e][t],sub:(e,t)=>af[e][Jt.inv(t)],rotate180:e=>e^4,isVertical:e=>(e&3)===2,byDirection:(e,t)=>Math.abs(e)*2<=Math.abs(t)?t>=0?Jt.S:Jt.N:Math.abs(t)*2<=Math.abs(e)?e>0?Jt.E:Jt.W:t>0?e>0?Jt.SE:Jt.SW:e>0?Jt.NE:Jt.NW,matrixAppendRotationInv:(e,t,r=0,i=0)=>{let n=E_[Jt.inv(t)];n.tx=r,n.ty=i,e.append(n)}};var sr=class{constructor(t,r,i=0,n=0){this._x=i,this._y=n,this.cb=t,this.scope=r}clone(t=this.cb,r=this.scope){return new sr(t,r,this._x,this._y)}set(t=0,r=t){return(this._x!==t||this._y!==r)&&(this._x=t,this._y=r,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}};var w_=class{constructor(){this.worldTransform=new St,this.localTransform=new St,this.position=new sr(this.onChange,this,0,0),this.scale=new sr(this.onChange,this,1,1),this.pivot=new sr(this.onChange,this,0,0),this.skew=new sr(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){let e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(e){let t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){let r=e.worldTransform,i=this.worldTransform;i.a=t.a*r.a+t.b*r.c,i.b=t.a*r.b+t.b*r.d,i.c=t.c*r.a+t.d*r.c,i.d=t.c*r.b+t.d*r.d,i.tx=t.tx*r.a+t.ty*r.c+r.tx,i.ty=t.tx*r.b+t.ty*r.d+r.ty,this._parentID=e._worldID,this._worldID++}}setFromMatrix(e){e.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())}},Xn=w_;Xn.IDENTITY=new w_;var S_=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`;var b_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function uh(e,t,r){let i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}function lf(e){let t=new Array(e);for(let r=0;r<t.length;r++)t[r]=!1;return t}function Zo(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return lf(2*t);case"bvec3":return lf(3*t);case"bvec4":return lf(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var oi=[{test:e=>e.type==="float"&&e.size===1&&!e.isArray,code:e=>`
            if(uv["${e}"] !== ud["${e}"].value)
            {
                ud["${e}"].value = uv["${e}"]
                gl.uniform1f(ud["${e}"].location, uv["${e}"])
            }
            `},{test:(e,t)=>(e.type==="sampler2D"||e.type==="samplerCube"||e.type==="sampler2DArray")&&e.size===1&&!e.isArray&&(t==null||t.castToBaseTexture!==void 0),code:e=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${e}"], t);

            if(ud["${e}"].value !== t)
            {
                ud["${e}"].value = t;
                gl.uniform1i(ud["${e}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(e,t)=>e.type==="mat3"&&e.size===1&&!e.isArray&&t.a!==void 0,code:e=>`
            gl.uniformMatrix3fv(ud["${e}"].location, false, uv["${e}"].toArray(true));
            `,codeUbo:e=>`
                var ${e}_matrix = uv.${e}.toArray(true);

                data[offset] = ${e}_matrix[0];
                data[offset+1] = ${e}_matrix[1];
                data[offset+2] = ${e}_matrix[2];
        
                data[offset + 4] = ${e}_matrix[3];
                data[offset + 5] = ${e}_matrix[4];
                data[offset + 6] = ${e}_matrix[5];
        
                data[offset + 8] = ${e}_matrix[6];
                data[offset + 9] = ${e}_matrix[7];
                data[offset + 10] = ${e}_matrix[8];
            `},{test:(e,t)=>e.type==="vec2"&&e.size===1&&!e.isArray&&t.x!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${e}"].location, v.x, v.y);
                }`,codeUbo:e=>`
                v = uv.${e};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:e=>e.type==="vec2"&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${e}"].location, v[0], v[1]);
                }
            `},{test:(e,t)=>e.type==="vec4"&&e.size===1&&!e.isArray&&t.width!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${e}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(e,t)=>e.type==="vec4"&&e.size===1&&!e.isArray&&t.red!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${e}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(e,t)=>e.type==="vec3"&&e.size===1&&!e.isArray&&t.red!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${e}"].location, v.red, v.green, v.blue)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:e=>e.type==="vec4"&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${e}"].location, v[0], v[1], v[2], v[3])
                }`}];var pA={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},mA={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function hf(e,t){let r=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(let i in e.uniforms){let n=t[i];if(!n){e.uniforms[i]?.group&&(e.uniforms[i].ubo?r.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):r.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}let s=e.uniforms[i],a=!1;for(let c=0;c<oi.length;c++)if(oi[c].test(n,s)){r.push(oi[c].code(i,s)),a=!0;break}if(!a){let f=(n.size===1&&!n.isArray?pA:mA)[n.type].replace("location",`ud["${i}"].location`);r.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${f};`)}}return new Function("ud","uv","renderer","syncData",r.join(`
`))}var A_={},ch=A_;function fh(){if(ch===A_||ch?.isContextLost()){let e=X.ADAPTER.createCanvas(),t;X.PREFER_ENV>=pr.WEBGL2&&(t=e.getContext("webgl2",{})),t||(t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),ch=t}return ch}var dh;function uf(){if(!dh){dh=Ve.MEDIUM;let e=fh();e&&e.getShaderPrecisionFormat&&(dh=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision?Ve.HIGH:Ve.MEDIUM)}return dh}function C_(e,t){let r=e.getShaderSource(t).split(`
`).map((p,l)=>`${l}: ${p}`),i=e.getShaderInfoLog(t),n=i.split(`
`),s={},a=n.map(p=>parseFloat(p.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(p=>p&&!s[p]?(s[p]=!0,!0):!1),c=[""];a.forEach(p=>{r[p-1]=`%c${r[p-1]}%c`,c.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});let f=r.join(`
`);c[0]=f,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...c),console.groupEnd()}function cf(e,t,r,i){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(r,e.COMPILE_STATUS)||C_(e,r),e.getShaderParameter(i,e.COMPILE_STATUS)||C_(e,i),console.error("PixiJS Error: Could not initialize shader."),e.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(t)))}var gA={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Jo(e){return gA[e]}var ph=null,R_={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Qo(e,t){if(!ph){let r=Object.keys(R_);ph={};for(let i=0;i<r.length;++i){let n=r[i];ph[e[n]]=R_[n]}}return ph[t]}function mh(e,t,r){if(e.substring(0,9)!=="precision"){let i=t;return t===Ve.HIGH&&r!==Ve.HIGH&&(i=Ve.MEDIUM),`precision ${i} float;
${e}`}else if(r!==Ve.HIGH&&e.substring(0,15)==="precision highp")return e.replace("precision highp","precision mediump");return e}var ta;function gh(){if(typeof ta=="boolean")return ta;try{ta=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{ta=!1}return ta}var _A=0,_h={},Os=class{constructor(e,t,r="pixi-shader",i={}){this.extra={},this.id=_A++,this.vertexSrc=e||Os.defaultVertexSrc,this.fragmentSrc=t||Os.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(r=r.replace(/\s+/g,"-"),_h[r]?(_h[r]++,r+=`-${_h[r]}`):_h[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${r}
${this.fragmentSrc}`,this.vertexSrc=mh(this.vertexSrc,Os.defaultVertexPrecision,Ve.HIGH),this.fragmentSrc=mh(this.fragmentSrc,Os.defaultFragmentPrecision,uf())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return b_}static get defaultFragmentSrc(){return S_}static from(e,t,r){let i=e+t,n=qo[i];return n||(qo[i]=n=new Os(e,t,r)),n}},Se=Os;Se.defaultVertexPrecision=Ve.HIGH;Se.defaultFragmentPrecision=Mr.apple.device?Ve.HIGH:Ve.MEDIUM;var xA=0,ge=class{constructor(t,r,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=xA++,this.static=!!r,this.ubo=!!i,t instanceof Ht?(this.buffer=t,this.buffer.type=ir.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Ht(new Float32Array(1)),this.buffer.type=ir.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,r,i){if(!this.ubo)this.uniforms[t]=new ge(r,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,r,i){return new ge(t,r,i)}static uboFrom(t,r){return new ge(t,r??!0,!0)}};var _e=class{constructor(t,r){this.uniformBindCount=0,this.program=t,r?r instanceof ge?this.uniformGroup=r:this.uniformGroup=new ge(r):this.uniformGroup=new ge({}),this.disposeRunner=new he("disposeShader")}checkUniformExists(t,r){if(r.uniforms[t])return!0;for(let i in r.uniforms){let n=r.uniforms[i];if(n.group&&this.checkUniformExists(t,n))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,r,i){let n=Se.from(t,r);return new _e(n,i)}};var ea=class{constructor(t,r){if(this.vertexSrc=t,this.fragTemplate=r,this.programCache={},this.defaultGroupCache={},!r.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!r.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){let i=new Int32Array(t);for(let s=0;s<t;s++)i[s]=s;this.defaultGroupCache[t]=ge.from({uSamplers:i},!0);let n=this.fragTemplate;n=n.replace(/%count%/gi,`${t}`),n=n.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Se(this.vertexSrc,n)}let r={tint:new Float32Array([1,1,1,1]),translationMatrix:new St,default:this.defaultGroupCache[t]};return new _e(this.programCache[t],r)}generateSampleSrc(t){let r="";r+=`
`,r+=`
`;for(let i=0;i<t;i++)i>0&&(r+=`
else `),i<t-1&&(r+=`if(vTextureId < ${i}.5)`),r+=`
{`,r+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,r+=`
}`;return r+=`
`,r+=`
`,r}};var on=class{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}};function I_(){return!Mr.apple.device}function P_(e){let t=!0,r=X.ADAPTER.getNavigator();if(Mr.tablet||Mr.phone){if(Mr.apple.device){let i=r.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(t=!1)}if(Mr.android.device){let i=r.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(t=!1)}}return t?e:4}var Xr=class{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}};var M_=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`;var B_=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;var zr=class extends Xr{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=Fn,this.vertexSize=6,this.state=me.for2d(),this.size=zr.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??P_(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??I_(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return _t("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return B_}static get defaultFragmentTemplate(){return M_}setShaderGenerator({vertex:e=zr.defaultVertexSrc,fragment:t=zr.defaultFragmentTemplate}={}){this.shaderGenerator=new ea(e,t)}contextChange(){let e=this.renderer.gl;X.PREFER_ENV===pr.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),zr.defaultMaxTextures),this.maxTextures=ah(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){let{_drawCallPool:e,_textureArrayPool:t}=zr,r=this.size/4,i=Math.floor(r/this.maxTextures)+1;for(;e.length<r;)e.push(new rn);for(;t.length<i;)t.push(new on);for(let n=0;n<this.maxTextures;n++)this._tempBoundTextures[n]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){let{_bufferedTextures:e,maxTextures:t}=this,r=zr._textureArrayPool,i=this.renderer.batch,n=this._tempBoundTextures,s=this.renderer.textureGC.count,a=++ht._globalBatch,c=0,f=r[0],p=0;i.copyBoundTextures(n,t);for(let l=0;l<this._bufferSize;++l){let h=e[l];e[l]=null,h._batchEnabled!==a&&(f.count>=t&&(i.boundArray(f,n,a,t),this.buildDrawCalls(f,p,l),p=l,f=r[++c],++a),h._batchEnabled=a,h.touched=s,f.elements[f.count++]=h)}f.count>0&&(i.boundArray(f,n,a,t),this.buildDrawCalls(f,p,this._bufferSize),++c,++a);for(let l=0;l<n.length;l++)n[l]=null;ht._globalBatch=a}buildDrawCalls(e,t,r){let{_bufferedElements:i,_attributeBuffer:n,_indexBuffer:s,vertexSize:a}=this,c=zr._drawCallPool,f=this._dcIndex,p=this._aIndex,l=this._iIndex,h=c[f];h.start=this._iIndex,h.texArray=e;for(let d=t;d<r;++d){let m=i[d],_=m._texture.baseTexture,x=$o[_.alphaMode?1:0][m.blendMode];i[d]=null,t<d&&h.blend!==x&&(h.size=l-h.start,t=d,h=c[++f],h.texArray=e,h.start=l),this.packInterleavedGeometry(m,n,s,p,l),p+=m.vertexData.length/2*a,l+=m.indices.length,h.blend=x}t<r&&(h.size=l-h.start,++f),this._dcIndex=f,this._aIndex=p,this._iIndex=l}bindAndClearTexArray(e){let t=this.renderer.texture;for(let r=0;r<e.count;r++)t.bind(e.elements[r],e.ids[r]),e.elements[r]=null;e.count=0}updateGeometry(){let{_packedGeometries:e,_attributeBuffer:t,_indexBuffer:r}=this;zr.canUploadSameBuffer?(e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){let e=this._dcIndex,{gl:t,state:r}=this.renderer,i=zr._drawCallPool,n=null;for(let s=0;s<e;s++){let{texArray:a,type:c,size:f,start:p,blend:l}=i[s];n!==a&&(n=a,this.bindAndClearTexArray(a)),this.state.blendMode=l,r.set(this.state),t.drawElements(c,f,t.UNSIGNED_SHORT,p*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),zr.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){let t=Qi(Math.ceil(e/8)),r=jo(t),i=t*8;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new en(i*this.vertexSize*4)),n}getIndexBuffer(e){let t=Qi(Math.ceil(e/12)),r=jo(t),i=t*12;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n}packInterleavedGeometry(e,t,r,i,n){let{uint32View:s,float32View:a}=t,c=i/this.vertexSize,f=e.uvs,p=e.indices,l=e.vertexData,h=e._texture.baseTexture._batchLocation,d=Math.min(e.worldAlpha,1),m=mt.shared.setValue(e._tintRGB).toPremultiplied(d);for(let _=0;_<l.length;_+=2)a[i++]=l[_],a[i++]=l[_+1],a[i++]=f[_],a[i++]=f[_+1],s[i++]=m,a[i++]=h;for(let _=0;_<p.length;_++)r[n++]=c+p[_]}},xr=zr;xr.defaultBatchSize=4096;xr.extension={name:"batch",type:$.RendererPlugin};xr._drawCallPool=[];xr._textureArrayPool=[];J.add(xr);var D_=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`;var O_=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;var ra=class extends _e{constructor(e,t,r){let i=Se.from(e||ra.defaultVertexSrc,t||ra.defaultFragmentSrc);super(i,r),this.padding=0,this.resolution=ra.defaultResolution,this.multisample=ra.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new me}apply(e,t,r,i,n){e.applyFilter(this,t,r,i)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return O_}static get defaultFragmentSrc(){return D_}},zt=ra;zt.defaultResolution=1;zt.defaultMultisample=Ft.NONE;var Ai=class{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new mt(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;let{backgroundColor:r,background:i,backgroundAlpha:n}=t,s=i??r;s!==void 0&&(this.color=s),this.alpha=n}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}};Ai.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};Ai.extension={type:[$.RendererSystem,$.CanvasRendererSystem],name:"background"};J.add(Ai);var Ls=class{constructor(t){this.renderer=t,this.emptyRenderer=new Xr(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,r){let{boundTextures:i}=this.renderer.texture;for(let n=r-1;n>=0;--n)t[n]=i[n]||null,t[n]&&(t[n]._batchLocation=n)}boundArray(t,r,i,n){let{elements:s,ids:a,count:c}=t,f=0;for(let p=0;p<c;p++){let l=s[p],h=l._batchLocation;if(h>=0&&h<n&&r[h]===l){a[p]=h;continue}for(;f<n;){let d=r[f];if(d&&d._batchEnabled===i&&d._batchLocation===f){f++;continue}a[p]=f,l._batchLocation=f,r[f]=l;break}}}destroy(){this.renderer=null}};Ls.extension={type:$.RendererSystem,name:"batch"};J.add(Ls);var L_=0,Ci=class{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=L_++}init(t){if(t.context)this.initFromContext(t.context);else{let r=this.renderer.background.alpha<1,i=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:r,premultipliedAlpha:i,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=L_++,this.renderer.runners.contextChange.emit(t);let r=this.renderer.view;r.addEventListener!==void 0&&(r.addEventListener("webglcontextlost",this.handleContextLost,!1),r.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){let r=this.createContext(this.renderer.view,t);this.initFromContext(r)}createContext(t,r){let i;if(X.PREFER_ENV>=pr.WEBGL2&&(i=t.getContext("webgl2",r)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=t.getContext("webgl",r)||t.getContext("experimental-webgl",r),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){let{gl:t}=this,r={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,r,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,r,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){let t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){let r=t.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),r&&!r.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");let n=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}};Ci.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"};Ci.extension={type:$.RendererSystem,name:"context"};J.add(Ci);var xh=class extends nr{upload(t,r,i){let n=t.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===fe.UNPACK);let s=r.realWidth,a=r.realHeight;return i.width===s&&i.height===a?n.texSubImage2D(r.target,0,0,0,s,a,r.format,i.type,this.data):(i.width=s,i.height=a,n.texImage2D(r.target,0,i.internalFormat,s,a,0,r.format,i.type,this.data)),!0}};var an=class{constructor(t,r){this.width=Math.round(t||100),this.height=Math.round(r||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new he("disposeFramebuffer"),this.multisample=Ft.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,r){return this.colorTextures[t]=r||new ht(null,{scaleMode:Pr.NEAREST,resolution:1,mipmap:Ce.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new ht(new xh(null,{width:this.width,height:this.height}),{scaleMode:Pr.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Ce.OFF,format:et.DEPTH_COMPONENT,type:lt.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,r){if(t=Math.round(t),r=Math.round(r),!(t===this.width&&r===this.height)){this.width=t,this.height=r,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){let n=this.colorTextures[i],s=n.resolution;n.setSize(t/s,r/s)}if(this.depthTexture){let i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,r/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}};var zn=class extends ht{constructor(t={}){if(typeof t=="number"){let r=arguments[0],i=arguments[1],n=arguments[2],s=arguments[3];t={width:r,height:i,scaleMode:n,resolution:s}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=Ft.NONE),super(null,t),this.mipmap=Ce.OFF,this.valid=!0,this._clear=new mt([0,0,0,0]),this.framebuffer=new an(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}resize(t,r){this.framebuffer.resize(t*this.resolution,r*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}};var Re=class extends _r{constructor(t){let r=t,i=r.naturalWidth||r.videoWidth||r.width,n=r.naturalHeight||r.videoHeight||r.height;super(i,n),this.source=t,this.noSubImage=!1}static crossOrigin(t,r,i){i===void 0&&!r.startsWith("data:")?t.crossOrigin=oh(r):i!==!1&&(t.crossOrigin=typeof i=="string"?i:"anonymous")}upload(t,r,i,n){let s=t.gl,a=r.realWidth,c=r.realHeight;if(n=n||this.source,typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement){if(!n.complete||n.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement&&n.readyState<=1&&n.buffered.length===0)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===fe.UNPACK),!this.noSubImage&&r.target===s.TEXTURE_2D&&i.width===a&&i.height===c?s.texSubImage2D(s.TEXTURE_2D,0,0,0,r.format,i.type,n):(i.width=a,i.height=c,s.texImage2D(r.target,0,i.internalFormat,r.format,i.type,n)),!0}update(){if(this.destroyed)return;let t=this.source,r=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(r,i),super.update()}dispose(){this.source=null}};var ln=class extends Re{constructor(t,r){if(r=r||{},typeof t=="string"){let i=new Image;Re.crossOrigin(i,t,r.crossorigin),i.src=t,t=i}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(r.createBitmap??X.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.bitmap=null,this._load=null,r.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((r,i)=>{let n=this.source;this.url=n.src;let s=()=>{this.destroyed||(n.onload=null,n.onerror=null,this.resize(n.width,n.height),this._load=null,this.createBitmap?r(this.process()):r(this))};n.complete&&n.src?s():(n.onload=s,n.onerror=a=>{i(a),this.onError.emit(a)})}),this._load)}process(){let t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);let r=globalThis.createImageBitmap,i=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:i?"cors":"no-cors"}).then(n=>n.blob()).then(n=>r(n,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===fe.UNPACK?"premultiply":"none"})).then(n=>this.destroyed?Promise.reject():(this.bitmap=n,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,r,i){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,r,i,this.bitmap),!this.preserveBitmap){let n=!0,s=r._glTextures;for(let a in s){let c=s[a];if(c!==i&&c.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}};var Fs=class{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,r,i){let n=r.width,s=r.height;if(i){let a=t.width/2/n,c=t.height/2/s,f=t.x/n+a,p=t.y/s+c;i=Jt.add(i,Jt.NW),this.x0=f+a*Jt.uX(i),this.y0=p+c*Jt.uY(i),i=Jt.add(i,2),this.x1=f+a*Jt.uX(i),this.y1=p+c*Jt.uY(i),i=Jt.add(i,2),this.x2=f+a*Jt.uX(i),this.y2=p+c*Jt.uY(i),i=Jt.add(i,2),this.x3=f+a*Jt.uX(i),this.y3=p+c*Jt.uY(i)}else this.x0=t.x/n,this.y0=t.y/s,this.x1=(t.x+t.width)/n,this.y1=t.y/s,this.x2=(t.x+t.width)/n,this.y2=(t.y+t.height)/s,this.x3=t.x/n,this.y3=(t.y+t.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}};var F_=new Fs;function vh(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}var nt=class extends tn.default{constructor(t,r,i,n,s,a,c){if(super(),this.noFrame=!1,r||(this.noFrame=!0,r=new ct(0,0,1,1)),t instanceof nt&&(t=t.baseTexture),this.baseTexture=t,this._frame=r,this.trim=n,this.valid=!1,this._uvs=F_,this.uvMatrix=null,this.orig=i||r,this._rotate=Number(s||0),s===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new pt(a.x,a.y):new pt(0,0),this.defaultBorders=c,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=r:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){let{resource:r}=this.baseTexture;r?.url&&we[r.url]&&nt.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,nt.removeFromCache(this),this.textureCacheIds=null}clone(){let t=this._frame.clone(),r=this._frame===this.orig?t:this.orig.clone(),i=new nt(this.baseTexture,!this.noFrame&&t,r,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=t),i}updateUvs(){this._uvs===F_&&(this._uvs=new Fs),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,r={},i=X.STRICT_TEXTURE_CACHE){let n=typeof t=="string",s=null;if(n)s=t;else if(t instanceof ht){if(!t.cacheId){let c=r?.pixiIdPrefix||"pixiid";t.cacheId=`${c}-${si()}`,ht.addToCache(t,t.cacheId)}s=t.cacheId}else{if(!t._pixiId){let c=r?.pixiIdPrefix||"pixiid";t._pixiId=`${c}_${si()}`}s=t._pixiId}let a=we[s];if(n&&i&&!a)throw new Error(`The cacheId "${s}" does not exist in TextureCache.`);return!a&&!(t instanceof ht)?(r.resolution||(r.resolution=Ko(t)),a=new nt(new ht(t,r)),a.baseTexture.cacheId=s,ht.addToCache(a.baseTexture,s),nt.addToCache(a,s)):!a&&t instanceof ht&&(a=new nt(t),nt.addToCache(a,s)),a}static fromURL(t,r){let i=Object.assign({autoLoad:!1},r?.resourceOptions),n=nt.from(t,Object.assign({resourceOptions:i},r),!1),s=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):s.load().then(()=>Promise.resolve(n))}static fromBuffer(t,r,i,n){return new nt(ht.fromBuffer(t,r,i,n))}static fromLoader(t,r,i,n){let s=new ht(t,Object.assign({scaleMode:ht.defaultOptions.scaleMode,resolution:Ko(r)},n)),{resource:a}=s;a instanceof ln&&(a.url=r);let c=new nt(s);return i||(i=r),ht.addToCache(c.baseTexture,i),nt.addToCache(c,i),i!==r&&(ht.addToCache(c.baseTexture,r),nt.addToCache(c,r)),c.baseTexture.valid?Promise.resolve(c):new Promise(f=>{c.baseTexture.once("loaded",()=>f(c))})}static addToCache(t,r){r&&(t.textureCacheIds.includes(r)||t.textureCacheIds.push(r),we[r]&&we[r]!==t&&console.warn(`Texture added to the cache with an id [${r}] that already had an entry`),we[r]=t)}static removeFromCache(t){if(typeof t=="string"){let r=we[t];if(r){let i=r.textureCacheIds.indexOf(t);return i>-1&&r.textureCacheIds.splice(i,1),delete we[t],r}}else if(t?.textureCacheIds){for(let r=0;r<t.textureCacheIds.length;++r)we[t.textureCacheIds[r]]===t&&delete we[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;let{x:r,y:i,width:n,height:s}=t,a=r+n>this.baseTexture.width,c=i+s>this.baseTexture.height;if(a||c){let f=a&&c?"and":"or",p=`X: ${r} + ${n} = ${r+n} > ${this.baseTexture.width}`,l=`Y: ${i} + ${s} = ${i+s} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${p} ${f} ${l}`)}this.valid=n&&s&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return nt._EMPTY||(nt._EMPTY=new nt(new ht),vh(nt._EMPTY),vh(nt._EMPTY.baseTexture)),nt._EMPTY}static get WHITE(){if(!nt._WHITE){let t=X.ADAPTER.createCanvas(16,16),r=t.getContext("2d");t.width=16,t.height=16,r.fillStyle="white",r.fillRect(0,0,16,16),nt._WHITE=new nt(ht.from(t)),vh(nt._WHITE),vh(nt._WHITE.baseTexture)}return nt._WHITE}};var ze=class extends nt{constructor(t,r){super(t,r),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,r,i=!0){let n=this.baseTexture.resolution,s=Math.round(t*n)/n,a=Math.round(r*n)/n;this.valid=s>0&&a>0,this._frame.width=this.orig.width=s,this._frame.height=this.orig.height=a,i&&this.baseTexture.resize(s,a),this.updateUvs()}setResolution(t){let{baseTexture:r}=this;r.resolution!==t&&(r.setResolution(t),this.resize(r.width,r.height,!1))}static create(t){return new ze(new zn(t))}};var Ns=class{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,r,i=Ft.NONE){let n=new zn(Object.assign({width:t,height:r,resolution:1,multisample:i},this.textureOptions));return new ze(n)}getOptimalTexture(t,r,i=1,n=Ft.NONE){let s;t=Math.ceil(t*i-1e-6),r=Math.ceil(r*i-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||r!==this._pixelsHeight?(t=Qi(t),r=Qi(r),s=((t&65535)<<16|r&65535)>>>0,n>1&&(s+=n*4294967296)):s=n>1?-n:-1,this.texturePool[s]||(this.texturePool[s]=[]);let a=this.texturePool[s].pop();return a||(a=this.createTexture(t,r,n)),a.filterPoolKey=s,a.setResolution(i),a}getFilterTexture(t,r,i){let n=this.getOptimalTexture(t.width,t.height,r||t.resolution,i||Ft.NONE);return n.filterFrame=t.filterFrame,n}returnTexture(t){let r=t.filterPoolKey;t.filterFrame=null,this.texturePool[r].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(let r in this.texturePool){let i=this.texturePool[r];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(let r in this.texturePool){if(!(Number(r)<0))continue;let i=this.texturePool[r];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0);this.texturePool[r]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}};Ns.SCREEN_KEY=-1;var ia=class extends Oe{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}};var $n=class extends Oe{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Ht(this.vertices),this.uvBuffer=new Ht(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,r){let i=0,n=0;return this.uvs[0]=i,this.uvs[1]=n,this.uvs[2]=i+r.width/t.width,this.uvs[3]=n,this.uvs[4]=i+r.width/t.width,this.uvs[5]=n+r.height/t.height,this.uvs[6]=i,this.uvs[7]=n+r.height/t.height,i=r.x,n=r.y,this.vertices[0]=i,this.vertices[1]=n,this.vertices[2]=i+r.width,this.vertices[3]=n,this.vertices[4]=i+r.width,this.vertices[5]=n+r.height,this.vertices[6]=i,this.vertices[7]=n+r.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}};var na=class{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Ft.NONE,this.sourceFrame=new ct,this.destinationFrame=new ct,this.bindingSourceFrame=new ct,this.bindingDestinationFrame=new ct,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}};var yh=[new pt,new pt,new pt,new pt],ff=new St,Us=class{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Ns,this.statePool=[],this.quad=new ia,this.quadUv=new $n,this.tempRect=new ct,this.activeState={},this.globalUniforms=new ge({outputFrame:new ct,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,r){let i=this.renderer,n=this.defaultFilterStack,s=this.statePool.pop()||new na,a=this.renderer.renderTexture,c=r[0].resolution,f=r[0].multisample,p=r[0].padding,l=r[0].autoFit,h=r[0].legacy??!0;for(let _=1;_<r.length;_++){let x=r[_];c=Math.min(c,x.resolution),f=Math.min(f,x.multisample),p=this.useMaxPadding?Math.max(p,x.padding):p+x.padding,l=l&&x.autoFit,h=h||(x.legacy??!0)}n.length===1&&(this.defaultFilterStack[0].renderTexture=a.current),n.push(s),s.resolution=c,s.multisample=f,s.legacy=h,s.target=t,s.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),s.sourceFrame.pad(p);let d=this.tempRect.copyFrom(a.sourceFrame);i.projection.transform&&this.transformAABB(ff.copyFrom(i.projection.transform).invert(),d),l?(s.sourceFrame.fit(d),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(d)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,a.current?a.current.resolution:i.resolution,a.sourceFrame,a.destinationFrame,i.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,c,f),s.filters=r,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;let m=this.tempRect;m.x=0,m.y=0,m.width=s.sourceFrame.width,m.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(a.sourceFrame),s.bindingDestinationFrame.copyFrom(a.destinationFrame),s.transform=i.projection.transform,i.projection.transform=null,a.bind(s.renderTexture,s.sourceFrame,m),i.framebuffer.clear(0,0,0,0)}pop(){let t=this.defaultFilterStack,r=t.pop(),i=r.filters;this.activeState=r;let n=this.globalUniforms.uniforms;n.outputFrame=r.sourceFrame,n.resolution=r.resolution;let s=n.inputSize,a=n.inputPixel,c=n.inputClamp;if(s[0]=r.destinationFrame.width,s[1]=r.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],a[0]=Math.round(s[0]*r.resolution),a[1]=Math.round(s[1]*r.resolution),a[2]=1/a[0],a[3]=1/a[1],c[0]=.5*a[2],c[1]=.5*a[3],c[2]=r.sourceFrame.width*s[2]-.5*a[2],c[3]=r.sourceFrame.height*s[3]-.5*a[3],r.legacy){let p=n.filterArea;p[0]=r.destinationFrame.width,p[1]=r.destinationFrame.height,p[2]=r.sourceFrame.x,p[3]=r.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();let f=t[t.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,r.renderTexture,f.renderTexture,gr.BLEND,r),this.returnFilterTexture(r.renderTexture);else{let p=r.renderTexture,l=this.getOptimalFilterTexture(p.width,p.height,r.resolution);l.filterFrame=p.filterFrame;let h=0;for(h=0;h<i.length-1;++h){h===1&&r.multisample>1&&(l=this.getOptimalFilterTexture(p.width,p.height,r.resolution),l.filterFrame=p.filterFrame),i[h].apply(this,p,l,gr.CLEAR,r);let d=p;p=l,l=d}i[h].apply(this,p,f.renderTexture,gr.BLEND,r),h>1&&r.multisample>1&&this.returnFilterTexture(r.renderTexture),this.returnFilterTexture(p),this.returnFilterTexture(l)}r.clear(),this.statePool.push(r)}bindAndClear(t,r=gr.CLEAR){let{renderTexture:i,state:n}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t?.filterFrame){let a=this.tempRect;a.x=0,a.y=0,a.width=t.filterFrame.width,a.height=t.filterFrame.height,i.bind(t,t.filterFrame,a)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);let s=n.stateId&1||this.forceClear;(r===gr.CLEAR||r===gr.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,r,i,n){let s=this.renderer;s.state.set(t.state),this.bindAndClear(i,n),t.uniforms.uSampler=r,t.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(r._frame,r.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(rr.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(rr.TRIANGLE_STRIP))}calculateSpriteMatrix(t,r){let{sourceFrame:i,destinationFrame:n}=this.activeState,{orig:s}=r._texture,a=t.set(n.width,0,0,n.height,i.x,i.y),c=r.worldTransform.copyTo(St.TEMP_MATRIX);return c.invert(),a.prepend(c),a.scale(1/s.width,1/s.height),a.translate(r.anchor.x,r.anchor.y),a}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,r,i=1,n=Ft.NONE){return this.texturePool.getOptimalTexture(t,r,i,n)}getFilterTexture(t,r,i){if(typeof t=="number"){let s=t;t=r,r=s}t=t||this.activeState.renderTexture;let n=this.texturePool.getOptimalTexture(t.width,t.height,r||t.resolution,i||Ft.NONE);return n.filterFrame=t.filterFrame,n}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,r){let i=yh[0],n=yh[1],s=yh[2],a=yh[3];i.set(r.left,r.top),n.set(r.left,r.bottom),s.set(r.right,r.top),a.set(r.right,r.bottom),t.apply(i,i),t.apply(n,n),t.apply(s,s),t.apply(a,a);let c=Math.min(i.x,n.x,s.x,a.x),f=Math.min(i.y,n.y,s.y,a.y),p=Math.max(i.x,n.x,s.x,a.x),l=Math.max(i.y,n.y,s.y,a.y);r.x=c,r.y=f,r.width=p-c,r.height=l-f}roundFrame(t,r,i,n,s){if(!(t.width<=0||t.height<=0||i.width<=0||i.height<=0)){if(s){let{a,b:c,c:f,d:p}=s;if((Math.abs(c)>1e-4||Math.abs(f)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(p)>1e-4))return}s=s?ff.copyFrom(s):ff.identity(),s.translate(-i.x,-i.y).scale(n.width/i.width,n.height/i.height).translate(n.x,n.y),this.transformAABB(s,t),t.ceil(r),this.transformAABB(s.invert(),t)}}};Us.extension={type:$.RendererSystem,name:"filter"};J.add(Us);var sa=class{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Ft.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}};var vA=new ct,ks=class{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new an(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);let t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new ct,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let r=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;X.PREFER_ENV===pr.WEBGL_LEGACY&&(r=null,i=null),r?t.drawBuffers=n=>r.drawBuffersWEBGL(n):(this.hasMRT=!1,t.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,r,i=0){let{gl:n}=this;if(t){let s=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,n.bindFramebuffer(n.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==i&&(t.dirtyId++,t.dirtyFormat++,s.mipLevel=i),s.dirtyId!==t.dirtyId&&(s.dirtyId=t.dirtyId,s.dirtyFormat!==t.dirtyFormat?(s.dirtyFormat=t.dirtyFormat,s.dirtySize=t.dirtySize,this.updateFramebuffer(t,i)):s.dirtySize!==t.dirtySize&&(s.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let a=0;a<t.colorTextures.length;a++){let c=t.colorTextures[a];this.renderer.texture.unbind(c.parentTextureArray||c)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),r){let a=r.width>>i,c=r.height>>i,f=a/r.width;this.setViewport(r.x*f,r.y*f,a,c)}else{let a=t.width>>i,c=t.height>>i;this.setViewport(0,0,a,c)}}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,r,i,n){let s=this.viewport;t=Math.round(t),r=Math.round(r),i=Math.round(i),n=Math.round(n),(s.width!==i||s.height!==n||s.x!==t||s.y!==r)&&(s.x=t,s.y=r,s.width=i,s.height=n,this.gl.viewport(t,r,i,n))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,r,i,n,s=Wl.COLOR|Wl.DEPTH){let{gl:a}=this;a.clearColor(t,r,i,n),a.clear(s)}initFramebuffer(t){let{gl:r}=this,i=new sa(r.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i}resizeFramebuffer(t){let{gl:r}=this,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(r.bindRenderbuffer(r.RENDERBUFFER,i.stencil),i.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,r.DEPTH24_STENCIL8,t.width,t.height):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,t.width,t.height));let n=t.colorTextures,s=n.length;r.drawBuffers||(s=Math.min(s,1));for(let a=0;a<s;a++){let c=n[a],f=c.parentTextureArray||c;this.renderer.texture.bind(f,0),a===0&&i.msaaBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,i.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,f._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,r){let{gl:i}=this,n=t.glFramebuffers[this.CONTEXT_UID],s=t.colorTextures,a=s.length;i.drawBuffers||(a=Math.min(a,1)),n.multisample>1&&this.canMultisampleFramebuffer(t)?n.msaaBuffer=n.msaaBuffer||i.createRenderbuffer():n.msaaBuffer&&(i.deleteRenderbuffer(n.msaaBuffer),n.msaaBuffer=null,n.blitFramebuffer&&(n.blitFramebuffer.dispose(),n.blitFramebuffer=null));let c=[];for(let f=0;f<a;f++){let p=s[f],l=p.parentTextureArray||p;this.renderer.texture.bind(l,0),f===0&&n.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,n.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,n.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+f,p.target,l._glTextures[this.CONTEXT_UID].texture,r),c.push(i.COLOR_ATTACHMENT0+f))}if(c.length>1&&i.drawBuffers(c),t.depthTexture&&this.writeDepthTexture){let p=t.depthTexture;this.renderer.texture.bind(p,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,p._glTextures[this.CONTEXT_UID].texture,r)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(n.stencil=n.stencil||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,n.stencil),n.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,i.DEPTH24_STENCIL8,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,n.stencil)):n.stencil&&(i.deleteRenderbuffer(n.stencil),n.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){let{msaaSamples:r}=this,i=Ft.NONE;if(t<=1||r===null)return i;for(let n=0;n<r.length;n++)if(r[n]<=t){i=r[n];break}return i===1&&(i=Ft.NONE),i}blit(t,r,i){let{current:n,renderer:s,gl:a,CONTEXT_UID:c}=this;if(s.context.webGLVersion!==2||!n)return;let f=n.glFramebuffers[c];if(!f)return;if(!t){if(!f.msaaBuffer)return;let l=n.colorTextures[0];if(!l)return;f.blitFramebuffer||(f.blitFramebuffer=new an(n.width,n.height),f.blitFramebuffer.addColorTexture(0,l)),t=f.blitFramebuffer,t.colorTextures[0]!==l&&(t.colorTextures[0]=l,t.dirtyId++,t.dirtyFormat++),(t.width!==n.width||t.height!==n.height)&&(t.width=n.width,t.height=n.height,t.dirtyId++,t.dirtySize++)}r||(r=vA,r.width=n.width,r.height=n.height),i||(i=r);let p=r.width===i.width&&r.height===i.height;this.bind(t),a.bindFramebuffer(a.READ_FRAMEBUFFER,f.framebuffer),a.blitFramebuffer(r.left,r.top,r.right,r.bottom,i.left,i.top,i.right,i.bottom,a.COLOR_BUFFER_BIT,p?a.NEAREST:a.LINEAR)}disposeFramebuffer(t,r){let i=t.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(!i)return;delete t.glFramebuffers[this.CONTEXT_UID];let s=this.managedFramebuffers.indexOf(t);s>=0&&this.managedFramebuffers.splice(s,1),t.disposeRunner.remove(this),r||(n.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&n.deleteRenderbuffer(i.msaaBuffer),i.stencil&&n.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,r)}disposeAll(t){let r=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<r.length;i++)this.disposeFramebuffer(r[i],t)}forceStencil(){let t=this.current;if(!t)return;let r=t.glFramebuffers[this.CONTEXT_UID];if(!r||r.stencil)return;t.stencil=!0;let i=t.width,n=t.height,s=this.gl,a=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,a),r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,s.DEPTH24_STENCIL8,i,n):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,i,n),r.stencil=a,s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,a)}reset(){this.current=this.unknownFramebuffer,this.viewport=new ct}destroy(){this.renderer=null}};ks.extension={type:$.RendererSystem,name:"framebuffer"};J.add(ks);var df={5126:4,5123:2,5121:1},Gs=class{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);let t=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;X.PREFER_ENV===pr.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=()=>i.createVertexArrayOES(),t.bindVertexArray=n=>i.bindVertexArrayOES(n),t.deleteVertexArray=n=>i.deleteVertexArrayOES(n)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(r.webGLVersion!==2){let i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=(n,s)=>i.vertexAttribDivisorANGLE(n,s),t.drawElementsInstanced=(n,s,a,c,f)=>i.drawElementsInstancedANGLE(n,s,a,c,f),t.drawArraysInstanced=(n,s,a,c)=>i.drawArraysInstancedANGLE(n,s,a,c)):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex}bind(t,r){r=r||this.renderer.shader.shader;let{gl:i}=this,n=t.glVertexArrayObjects[this.CONTEXT_UID],s=!1;n||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=n={},s=!0);let a=n[r.program.id]||this.initGeometryVao(t,r,s);this._activeGeometry=t,this._activeVao!==a&&(this._activeVao=a,this.hasVao?i.bindVertexArray(a):this.activateVao(t,r.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){let t=this._activeGeometry,r=this.renderer.buffer;for(let i=0;i<t.buffers.length;i++){let n=t.buffers[i];r.update(n)}}checkCompatibility(t,r){let i=t.attributes,n=r.attributeData;for(let s in n)if(!i[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(t,r){let i=t.attributes,n=r.attributeData,s=["g",t.id];for(let a in i)n[a]&&s.push(a,n[a].location);return s.join("-")}initGeometryVao(t,r,i=!0){let n=this.gl,s=this.CONTEXT_UID,a=this.renderer.buffer,c=r.program;c.glPrograms[s]||this.renderer.shader.generateProgram(r),this.checkCompatibility(t,c);let f=this.getSignature(t,c),p=t.glVertexArrayObjects[this.CONTEXT_UID],l=p[f];if(l)return p[c.id]=l,l;let h=t.buffers,d=t.attributes,m={},_={};for(let x in h)m[x]=0,_[x]=0;for(let x in d)!d[x].size&&c.attributeData[x]?d[x].size=c.attributeData[x].size:d[x].size||console.warn(`PIXI Geometry attribute '${x}' size cannot be determined (likely the bound shader does not have the attribute)`),m[d[x].buffer]+=d[x].size*df[d[x].type];for(let x in d){let T=d[x],S=T.size;T.stride===void 0&&(m[T.buffer]===S*df[T.type]?T.stride=0:T.stride=m[T.buffer]),T.start===void 0&&(T.start=_[T.buffer],_[T.buffer]+=S*df[T.type])}l=n.createVertexArray(),n.bindVertexArray(l);for(let x=0;x<h.length;x++){let T=h[x];a.bind(T),i&&T._glBuffers[s].refCount++}return this.activateVao(t,c),p[c.id]=l,p[f]=l,n.bindVertexArray(null),a.unbind(ir.ARRAY_BUFFER),l}disposeGeometry(t,r){if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];let i=t.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,s=t.buffers,a=this.renderer?.buffer;if(t.disposeRunner.remove(this),!!i){if(a)for(let c=0;c<s.length;c++){let f=s[c]._glBuffers[this.CONTEXT_UID];f&&(f.refCount--,f.refCount===0&&!r&&a.dispose(s[c],r))}if(!r){for(let c in i)if(c[0]==="g"){let f=i[c];this._activeVao===f&&this.unbind(),n.deleteVertexArray(f)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){let r=Object.keys(this.managedGeometries);for(let i=0;i<r.length;i++)this.disposeGeometry(this.managedGeometries[r[i]],t)}activateVao(t,r){let i=this.gl,n=this.CONTEXT_UID,s=this.renderer.buffer,a=t.buffers,c=t.attributes;t.indexBuffer&&s.bind(t.indexBuffer);let f=null;for(let p in c){let l=c[p],h=a[l.buffer],d=h._glBuffers[n];if(r.attributeData[p]){f!==d&&(s.bind(h),f=d);let m=r.attributeData[p].location;if(i.enableVertexAttribArray(m),i.vertexAttribPointer(m,l.size,l.type||i.FLOAT,l.normalized,l.stride,l.start),l.instance)if(this.hasInstance)i.vertexAttribDivisor(m,l.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,r,i,n){let{gl:s}=this,a=this._activeGeometry;if(a.indexBuffer){let c=a.indexBuffer.data.BYTES_PER_ELEMENT,f=c===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;c===2||c===4&&this.canUseUInt32ElementIndex?a.instanced?s.drawElementsInstanced(t,r||a.indexBuffer.data.length,f,(i||0)*c,n||1):s.drawElements(t,r||a.indexBuffer.data.length,f,(i||0)*c):console.warn("unsupported index buffer type: uint32")}else a.instanced?s.drawArraysInstanced(t,i,r||a.getSize(),n||1):s.drawArrays(t,i,r||a.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}};Gs.extension={type:$.RendererSystem,name:"geometry"};J.add(Gs);var N_=new St,hn=class{constructor(t,r){this._texture=t,this.mapCoord=new St,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof r>"u"?.5:r,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,r){r===void 0&&(r=t);let i=this.mapCoord;for(let n=0;n<t.length;n+=2){let s=t[n],a=t[n+1];r[n]=s*i.a+a*i.c+i.tx,r[n+1]=s*i.b+a*i.d+i.ty}return r}update(t){let r=this._texture;if(!r||!r.valid||!t&&this._textureID===r._updateID)return!1;this._textureID=r._updateID,this._updateID++;let i=r._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);let n=r.orig,s=r.trim;s&&(N_.set(n.width/s.width,0,0,n.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(N_));let a=r.baseTexture,c=this.uClampFrame,f=this.clampMargin/a.resolution,p=this.clampOffset;return c[0]=(r._frame.x+f+p)/a.width,c[1]=(r._frame.y+f+p)/a.height,c[2]=(r._frame.x+r._frame.width-f+p)/a.width,c[3]=(r._frame.y+r._frame.height-f+p)/a.height,this.uClampOffset[0]=p/a.realWidth,this.uClampOffset[1]=p/a.realHeight,this.isSimple=r._frame.width===a.width&&r._frame.height===a.height&&r.rotate===0,!0}};var U_=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`;var k_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;var oa=class extends zt{constructor(t,r,i){let n=null;typeof t!="string"&&r===void 0&&i===void 0&&(n=t,t=void 0,r=void 0,i=void 0),super(t||k_,r||U_,i),this.maskSprite=n,this.maskMatrix=new St}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,r,i,n){let s=this._maskSprite,a=s._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new hn(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,s).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,t.applyFilter(this,r,i,n))}};var aa=class{constructor(t=null){this.type=se.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=zt.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=se.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}};var Hs=class{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,r){let i=r;if(!i.isMaskData){let s=this.maskDataPool.pop()||new aa;s.pooled=!0,s.maskObject=r,i=s}let n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(n),i._colorMask=n?n._colorMask:15,i.autoDetect&&this.detect(i),i._target=t,i.type!==se.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case se.SCISSOR:this.renderer.scissor.push(i);break;case se.STENCIL:this.renderer.stencil.push(i);break;case se.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case se.COLOR:this.pushColorMask(i);break;default:break}i.type===se.SPRITE&&this.maskStack.push(i)}pop(t){let r=this.maskStack.pop();if(!(!r||r._target!==t)){if(r.enabled)switch(r.type){case se.SCISSOR:this.renderer.scissor.pop(r);break;case se.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case se.SPRITE:this.popSpriteMask(r);break;case se.COLOR:this.popColorMask(r);break;default:break}if(r.reset(),r.pooled&&this.maskDataPool.push(r),this.maskStack.length!==0){let i=this.maskStack[this.maskStack.length-1];i.type===se.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(t){let r=t.maskObject;r?r.isSprite?t.type=se.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=se.SCISSOR:t.type=se.STENCIL:t.type=se.COLOR}pushSpriteMask(t){let{maskObject:r}=t,i=t._target,n=t._filters;n||(n=this.alphaMaskPool[this.alphaMaskIndex],n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new oa]));let s=this.renderer,a=s.renderTexture,c,f;if(a.current){let l=a.current;c=t.resolution||l.resolution,f=t.multisample??l.multisample}else c=t.resolution||s.resolution,f=t.multisample??s.multisample;n[0].resolution=c,n[0].multisample=f,n[0].maskSprite=r;let p=i.filterArea;i.filterArea=r.getBounds(!0),s.filter.push(i,n),i.filterArea=p,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){let r=t._colorMask,i=t._colorMask=r&t.colorMask;i!==r&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(t){let r=t._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==r&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}};Hs.extension={type:$.RendererSystem,name:"mask"};J.add(Hs);var Vs=class{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){let{gl:r}=this.renderer,i=this.getStackLength();this.maskStack=t;let n=this.getStackLength();n!==i&&(n===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}};var G_=new St,H_=[],Th=class extends Vs{constructor(e){super(e),this.glConst=X.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){let e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;let t=e._scissorRect,{maskObject:r}=e,{renderer:i}=this,n=i.renderTexture,s=r.getBounds(!0,H_.pop()??new ct);this.roundFrameToPixels(s,n.current?n.current.resolution:i.resolution,n.sourceFrame,n.destinationFrame,i.projection.transform),t&&s.fit(t),e._scissorRectLocal=s}static isMatrixRotated(e){if(!e)return!1;let{a:t,b:r,c:i,d:n}=e;return(Math.abs(r)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(n)>1e-4)}testScissor(e){let{maskObject:t}=e;if(!t.isFastRect||!t.isFastRect()||Th.isMatrixRotated(t.worldTransform)||Th.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);let r=e._scissorRectLocal;return r.width>0&&r.height>0}roundFrameToPixels(e,t,r,i,n){Th.isMatrixRotated(n)||(n=n?G_.copyFrom(n):G_.identity(),n.translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.renderer.filter.transformAABB(n,e),e.fit(i),e.x=Math.round(e.x*t),e.y=Math.round(e.y*t),e.width=Math.round(e.width*t),e.height=Math.round(e.height*t))}push(e){e._scissorRectLocal||this.calcScissorRect(e);let{gl:t}=this.renderer;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){let{gl:t}=this.renderer;e&&H_.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){let e=this.maskStack[this.maskStack.length-1]._scissorRect,t;this.renderer.renderTexture.current?t=e.y:t=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}},Eh=Th;Eh.extension={type:$.RendererSystem,name:"scissor"};J.add(Eh);var Ws=class extends Vs{constructor(t){super(t),this.glConst=X.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){let t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){let r=t.maskObject,{gl:i}=this.renderer,n=t._stencilCounter;n===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),t._stencilCounter++;let s=t._colorMask;s!==0&&(t._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,n,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,s!==0&&(t._colorMask=s,i.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}pop(t){let r=this.renderer.gl;if(this.getStackLength()===0)r.disable(r.STENCIL_TEST);else{let i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,n=i?i._colorMask:15;n!==0&&(i._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilOp(r.KEEP,r.KEEP,r.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,n!==0&&(i._colorMask=n,r.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}}_useCurrent(){let t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}};Ws.extension={type:$.RendererSystem,name:"stencil"};J.add(Ws);var Xs=class{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return _t("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return _t("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return _t("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){let t=this.rendererPlugins;for(let r in t)this.plugins[r]=new t[r](this.renderer)}destroy(){for(let t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}};Xs.extension={type:[$.RendererSystem,$.CanvasRendererSystem],name:"_plugin"};J.add(Xs);var zs=class{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new St,this.transform=null}update(t,r,i,n){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,n),this.transform&&this.projectionMatrix.append(this.transform);let s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)}calculateProjection(t,r,i,n){let s=this.projectionMatrix,a=n?-1:1;s.identity(),s.a=1/r.width*2,s.d=a*(1/r.height*2),s.tx=-1-r.x*s.a,s.ty=-a-r.y*s.d}setTransform(t){}destroy(){this.renderer=null}};zs.extension={type:$.RendererSystem,name:"projection"};J.add(zs);var yA=new Xn,$s=class{constructor(t){this.renderer=t,this._tempMatrix=new St}generateTexture(t,r){let{region:i,...n}=r||{},s=i||t.getLocalBounds(null,!0);s.width===0&&(s.width=1),s.height===0&&(s.height=1);let a=ze.create({width:s.width,height:s.height,...n});this._tempMatrix.tx=-s.x,this._tempMatrix.ty=-s.y;let c=t.transform;return t.transform=yA,this.renderer.render(t,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=c,a}destroy(){}};$s.extension={type:[$.RendererSystem,$.CanvasRendererSystem],name:"textureGenerator"};J.add($s);var Yn=new ct,la=new ct,Ys=class{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new ct,this.destinationFrame=new ct,this.viewportFrame=new ct}bind(t=null,r,i){let n=this.renderer;this.current=t;let s,a,c;t?(s=t.baseTexture,c=s.resolution,r||(Yn.width=t.frame.width,Yn.height=t.frame.height,r=Yn),i||(la.x=t.frame.x,la.y=t.frame.y,la.width=r.width,la.height=r.height,i=la),a=s.framebuffer):(c=n.resolution,r||(Yn.width=n._view.screen.width,Yn.height=n._view.screen.height,r=Yn),i||(i=Yn,i.width=r.width,i.height=r.height));let f=this.viewportFrame;f.x=i.x*c,f.y=i.y*c,f.width=i.width*c,f.height=i.height*c,t||(f.y=n.view.height-(f.y+f.height)),f.ceil(),this.renderer.framebuffer.bind(a,f),this.renderer.projection.update(i,r,c,!a),t?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(i)}clear(t,r){let i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,n=t?mt.shared.setValue(t):i,s=this.destinationFrame,a=this.current?this.current.baseTexture:this.renderer._view.screen,c=s.width!==a.width||s.height!==a.height;if(c){let{x:f,y:p,width:l,height:h}=this.viewportFrame;f=Math.round(f),p=Math.round(p),l=Math.round(l),h=Math.round(h),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(f,p,l,h)}this.renderer.framebuffer.clear(n.red,n.green,n.blue,n.alpha,r),c&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}};Ys.extension={type:$.RendererSystem,name:"renderTexture"};J.add(Ys);var ha=class{constructor(t,r){this.program=t,this.uniformData=r,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}};function V_(e,t){let r={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let n=0;n<i;n++){let s=t.getActiveAttrib(e,n);if(s.name.startsWith("gl_"))continue;let a=Qo(t,s.type),c={type:a,name:s.name,size:Jo(a),location:t.getAttribLocation(e,s.name)};r[s.name]=c}return r}function W_(e,t){let r={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let n=0;n<i;n++){let s=t.getActiveUniform(e,n),a=s.name.replace(/\[.*?\]$/,""),c=!!s.name.match(/\[.*?\]$/),f=Qo(t,s.type);r[a]={name:a,index:n,type:f,size:s.size,isArray:c,value:Zo(f,s.size)}}return r}function pf(e,t){let r=uh(e,e.VERTEX_SHADER,t.vertexSrc),i=uh(e,e.FRAGMENT_SHADER,t.fragmentSrc),n=e.createProgram();e.attachShader(n,r),e.attachShader(n,i);let s=t.extra?.transformFeedbackVaryings;if(s&&(typeof e.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):e.transformFeedbackVaryings(n,s.names,s.bufferMode==="separate"?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS)),e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS)||cf(e,n,r,i),t.attributeData=V_(n,e),t.uniformData=W_(n,e),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){let f=Object.keys(t.attributeData);f.sort((p,l)=>p>l?1:-1);for(let p=0;p<f.length;p++)t.attributeData[f[p]].location=p,e.bindAttribLocation(n,p,f[p]);e.linkProgram(n)}e.deleteShader(r),e.deleteShader(i);let a={};for(let f in t.uniformData){let p=t.uniformData[f];a[f]={location:e.getUniformLocation(n,f),value:Zo(p.type,p.size)}}return new ha(n,a)}function TA(e,t,r,i,n){r.buffer.update(n)}var EA={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},X_={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function z_(e){let t=e.map(s=>({data:s,offset:0,dataLen:0,dirty:0})),r=0,i=0,n=0;for(let s=0;s<t.length;s++){let a=t[s];if(r=X_[a.data.type],a.data.size>1&&(r=Math.max(r,16)*a.data.size),a.dataLen=r,i%r!==0&&i<16){let c=i%r%16;i+=c,n+=c}i+r>16?(n=Math.ceil(n/16)*16,a.offset=n,n+=r,i=r):(a.offset=n,i+=r,n+=r)}return n=Math.ceil(n/16)*16,{uboElements:t,size:n}}function $_(e,t){let r=[];for(let i in e)t[i]&&r.push(t[i]);return r.sort((i,n)=>i.index-n.index),r}function mf(e,t){if(!e.autoManage)return{size:0,syncFunc:TA};let r=$_(e.uniforms,t),{uboElements:i,size:n}=z_(r),s=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let a=0;a<i.length;a++){let c=i[a],f=e.uniforms[c.data.name],p=c.data.name,l=!1;for(let h=0;h<oi.length;h++){let d=oi[h];if(d.codeUbo&&d.test(c.data,f)){s.push(`offset = ${c.offset/4};`,oi[h].codeUbo(c.data.name,f)),l=!0;break}}if(!l)if(c.data.size>1){let h=Jo(c.data.type),d=Math.max(X_[c.data.type]/16,1),m=h/d,_=(4-m%4)%4;s.push(`
                cv = ud.${p}.value;
                v = uv.${p};
                offset = ${c.offset/4};

                t = 0;

                for(var i=0; i < ${c.data.size*d}; i++)
                {
                    for(var j = 0; j < ${m}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${_};
                }

                `)}else{let h=EA[c.data.type];s.push(`
                cv = ud.${p}.value;
                v = uv.${p};
                offset = ${c.offset/4};
                ${h};
                `)}}return s.push(`
       renderer.buffer.update(buffer);
    `),{size:n,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join(`
`))}}var wA=0,wh={textureCount:0,uboCount:0},js=class{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=wA++}systemCheck(){if(!gh())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,r){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;let i=t.program,n=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(n.program)),r||(wh.textureCount=0,wh.uboCount=0,this.syncUniformGroup(t.uniformGroup,wh)),n}setUniforms(t){let r=this.shader.program,i=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(i.uniformData,t,this.renderer)}syncUniformGroup(t,r){let i=this.getGlProgram();(!t.static||t.dirtyId!==i.uniformDirtyGroups[t.id])&&(i.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,r))}syncUniforms(t,r,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(r.uniformData,t.uniforms,this.renderer,i)}createSyncGroups(t){let r=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[r]||(this.cache[r]=hf(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[r],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,r){let i=this.getGlProgram();if(!t.static||t.dirtyId!==0||!i.uniformGroups[t.id]){t.dirtyId=0;let n=i.uniformGroups[t.id]||this.createSyncBufferGroup(t,i,r);t.buffer.update(),n(i.uniformData,t.uniforms,this.renderer,wh,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,i.uniformBufferBindings[r])}createSyncBufferGroup(t,r,i){let{gl:n}=this.renderer;this.renderer.buffer.bind(t.buffer);let s=this.gl.getUniformBlockIndex(r.program,i);r.uniformBufferBindings[i]=this.shader.uniformBindCount,n.uniformBlockBinding(r.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;let a=this.getSignature(t,this.shader.program.uniformData,"ubo"),c=this._uboCache[a];if(c||(c=this._uboCache[a]=mf(t,this.shader.program.uniformData)),t.autoManage){let f=new Float32Array(c.size/4);t.buffer.update(f)}return r.uniformGroups[t.id]=c.syncFunc,r.uniformGroups[t.id]}getSignature(t,r,i){let n=t.uniforms,s=[`${i}-`];for(let a in n)s.push(a),r[a]&&s.push(r[a].type);return s.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){let r=this.gl,i=t.program,n=pf(r,i);return i.glPrograms[this.renderer.CONTEXT_UID]=n,n}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}};js.extension={type:$.RendererSystem,name:"shader"};J.add(js);var Ri=class{constructor(t){this.renderer=t}run(t){let{renderer:r}=this;r.runners.init.emit(r.options),t.hello&&console.log(`PixiJS 7.2.2 - ${r.rendererLogId} - https://pixijs.com`),r.resize(r.screen.width,r.screen.height)}destroy(){}};Ri.defaultOptions={hello:!1};Ri.extension={type:[$.RendererSystem,$.CanvasRendererSystem],name:"startup"};J.add(Ri);function Y_(e,t=[]){return t[dt.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[dt.ADD]=[e.ONE,e.ONE],t[dt.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[dt.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[dt.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[dt.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[dt.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[dt.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[dt.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[dt.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[dt.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[dt.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[dt.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[dt.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[dt.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[dt.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[dt.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[dt.NONE]=[0,0],t[dt.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[dt.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[dt.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[dt.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[dt.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[dt.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[dt.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[dt.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[dt.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[dt.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[dt.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[dt.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}var SA=0,bA=1,AA=2,CA=3,RA=4,IA=5,gf=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=dt.NONE,this._blendEq=!1,this.map=[],this.map[SA]=this.setBlend,this.map[bA]=this.setOffset,this.map[AA]=this.setCullFace,this.map[CA]=this.setDepthTest,this.map[RA]=this.setFrontFace,this.map[IA]=this.setDepthMask,this.checks=[],this.defaultState=new me,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=Y_(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,r=0;for(;t;)t&1&&this.map[r].call(this,!!(e.data&1<<r)),t=t>>1,r++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(gf.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(gf.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;let t=this.blendModes[e],r=this.gl;t.length===2?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){let r=this.checks.indexOf(e);t&&r===-1?this.checks.push(e):!t&&r!==-1&&this.checks.splice(r,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}},Sh=gf;Sh.extension={type:$.RendererSystem,name:"state"};J.add(Sh);var qs=class extends tn.default{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);let r=(t.priority??[]).filter(n=>t.systems[n]),i=[...r,...Object.keys(t.systems).filter(n=>!r.includes(n))];for(let n of i)this.addSystem(t.systems[n],n)}addRunners(...t){t.forEach(r=>{this.runners[r]=new he(r)})}addSystem(t,r){let i=new t(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=i,this._systemsHash[r]=i;for(let n in this.runners)this.runners[n].add(i);return this}emitWithCustomOptions(t,r){let i=Object.keys(this._systemsHash);t.items.forEach(n=>{let s=i.find(a=>this._systemsHash[a]===n);n[t.name](r[s])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}};var bh=class{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=bh.defaultMaxIdle,this.checkCountMax=bh.defaultCheckCountMax,this.mode=bh.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==zl.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){let e=this.renderer.texture,t=e.managedTextures,r=!1;for(let i=0;i<t.length;i++){let n=t[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(e.destroyTexture(n,!0),t[i]=null,r=!0)}if(r){let i=0;for(let n=0;n<t.length;n++)t[n]!==null&&(t[i++]=t[n]);t.length=i}}unload(e){let t=this.renderer.texture,r=e._texture;r&&!r.framebuffer&&t.destroyTexture(r);for(let i=e.children.length-1;i>=0;i--)this.unload(e.children[i])}destroy(){this.renderer=null}},or=bh;or.defaultMode=zl.AUTO;or.defaultMaxIdle=60*60;or.defaultCheckCountMax=60*10;or.extension={type:$.RendererSystem,name:"textureGC"};J.add(or);var jn=class{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=lt.UNSIGNED_BYTE,this.internalFormat=et.RGBA,this.samplerType=0}};function j_(e){let t;return"WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?t={[lt.UNSIGNED_BYTE]:{[et.RGBA]:e.RGBA8,[et.RGB]:e.RGB8,[et.RG]:e.RG8,[et.RED]:e.R8,[et.RGBA_INTEGER]:e.RGBA8UI,[et.RGB_INTEGER]:e.RGB8UI,[et.RG_INTEGER]:e.RG8UI,[et.RED_INTEGER]:e.R8UI,[et.ALPHA]:e.ALPHA,[et.LUMINANCE]:e.LUMINANCE,[et.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[lt.BYTE]:{[et.RGBA]:e.RGBA8_SNORM,[et.RGB]:e.RGB8_SNORM,[et.RG]:e.RG8_SNORM,[et.RED]:e.R8_SNORM,[et.RGBA_INTEGER]:e.RGBA8I,[et.RGB_INTEGER]:e.RGB8I,[et.RG_INTEGER]:e.RG8I,[et.RED_INTEGER]:e.R8I},[lt.UNSIGNED_SHORT]:{[et.RGBA_INTEGER]:e.RGBA16UI,[et.RGB_INTEGER]:e.RGB16UI,[et.RG_INTEGER]:e.RG16UI,[et.RED_INTEGER]:e.R16UI,[et.DEPTH_COMPONENT]:e.DEPTH_COMPONENT16},[lt.SHORT]:{[et.RGBA_INTEGER]:e.RGBA16I,[et.RGB_INTEGER]:e.RGB16I,[et.RG_INTEGER]:e.RG16I,[et.RED_INTEGER]:e.R16I},[lt.UNSIGNED_INT]:{[et.RGBA_INTEGER]:e.RGBA32UI,[et.RGB_INTEGER]:e.RGB32UI,[et.RG_INTEGER]:e.RG32UI,[et.RED_INTEGER]:e.R32UI,[et.DEPTH_COMPONENT]:e.DEPTH_COMPONENT24},[lt.INT]:{[et.RGBA_INTEGER]:e.RGBA32I,[et.RGB_INTEGER]:e.RGB32I,[et.RG_INTEGER]:e.RG32I,[et.RED_INTEGER]:e.R32I},[lt.FLOAT]:{[et.RGBA]:e.RGBA32F,[et.RGB]:e.RGB32F,[et.RG]:e.RG32F,[et.RED]:e.R32F,[et.DEPTH_COMPONENT]:e.DEPTH_COMPONENT32F},[lt.HALF_FLOAT]:{[et.RGBA]:e.RGBA16F,[et.RGB]:e.RGB16F,[et.RG]:e.RG16F,[et.RED]:e.R16F},[lt.UNSIGNED_SHORT_5_6_5]:{[et.RGB]:e.RGB565},[lt.UNSIGNED_SHORT_4_4_4_4]:{[et.RGBA]:e.RGBA4},[lt.UNSIGNED_SHORT_5_5_5_1]:{[et.RGBA]:e.RGB5_A1},[lt.UNSIGNED_INT_2_10_10_10_REV]:{[et.RGBA]:e.RGB10_A2,[et.RGBA_INTEGER]:e.RGB10_A2UI},[lt.UNSIGNED_INT_10F_11F_11F_REV]:{[et.RGB]:e.R11F_G11F_B10F},[lt.UNSIGNED_INT_5_9_9_9_REV]:{[et.RGB]:e.RGB9_E5},[lt.UNSIGNED_INT_24_8]:{[et.DEPTH_STENCIL]:e.DEPTH24_STENCIL8},[lt.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[et.DEPTH_STENCIL]:e.DEPTH32F_STENCIL8}}:t={[lt.UNSIGNED_BYTE]:{[et.RGBA]:e.RGBA,[et.RGB]:e.RGB,[et.ALPHA]:e.ALPHA,[et.LUMINANCE]:e.LUMINANCE,[et.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[lt.UNSIGNED_SHORT_5_6_5]:{[et.RGB]:e.RGB},[lt.UNSIGNED_SHORT_4_4_4_4]:{[et.RGBA]:e.RGBA},[lt.UNSIGNED_SHORT_5_5_5_1]:{[et.RGBA]:e.RGBA}},t}var Ks=class{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new ht,this.hasIntegerTextures=!1}contextChange(){let t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=j_(t);let r=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(let n=0;n<r;n++)this.boundTextures[n]=null;this.emptyTextures={};let i=new jn(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new jn(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let n=0;n<this.boundTextures.length;n++)this.bind(null,n)}bind(t,r=0){let{gl:i}=this;if(t=t?.castToBaseTexture(),t?.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;let n=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[r]!==t&&(this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),i.bindTexture(t.target,n.texture)),n.dirtyId!==t.dirtyId?(this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),this.updateTexture(t)):n.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[r]=t}else this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[r]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){let{gl:r,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let n=0;n<i.length;n++)i[n]===this.unknownTexture&&this.bind(null,n)}for(let n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(r.activeTexture(r.TEXTURE0+n),this.currentLocation=n),r.bindTexture(t.target,this.emptyTextures[t.target].texture),i[n]=null)}ensureSamplerType(t){let{boundTextures:r,hasIntegerTextures:i,CONTEXT_UID:n}=this;if(i)for(let s=t-1;s>=0;--s){let a=r[s];a&&a._glTextures[n].samplerType!==Xl.FLOAT&&this.renderer.texture.unbind(a)}}initTexture(t){let r=new jn(this.gl.createTexture());return r.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),r}initTextureType(t,r){r.internalFormat=this.internalFormats[t.type]?.[t.format]??t.format,this.webGLVersion===2&&t.type===lt.HALF_FLOAT?r.type=this.gl.HALF_FLOAT:r.type=t.type}updateTexture(t){let r=t._glTextures[this.CONTEXT_UID];if(!r)return;let i=this.renderer;if(this.initTextureType(t,r),t.resource?.upload(i,t,r))r.samplerType!==Xl.FLOAT&&(this.hasIntegerTextures=!0);else{let n=t.realWidth,s=t.realHeight,a=i.gl;(r.width!==n||r.height!==s||r.dirtyId<0)&&(r.width=n,r.height=s,a.texImage2D(t.target,0,r.internalFormat,n,s,0,t.format,r.type,null))}t.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(t),r.dirtyId=t.dirtyId}destroyTexture(t,r){let{gl:i}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!r)){let n=this.managedTextures.indexOf(t);n!==-1&&rh(this.managedTextures,n,1)}}updateTextureStyle(t){let r=t._glTextures[this.CONTEXT_UID];r&&((t.mipmap===Ce.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?r.mipmap=!1:r.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?r.wrapMode=mr.CLAMP:r.wrapMode=t.wrapMode,t.resource?.style(this.renderer,t,r)||this.setStyle(t,r),r.dirtyStyleId=t.dirtyStyleId)}setStyle(t,r){let i=this.gl;if(r.mipmap&&t.mipmap!==Ce.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,r.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===Pr.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);let n=this.renderer.context.extensions.anisotropicFiltering;if(n&&t.anisotropicLevel>0&&t.scaleMode===Pr.LINEAR){let s=Math.min(t.anisotropicLevel,i.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,n.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===Pr.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===Pr.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}};Ks.extension={type:$.RendererSystem,name:"texture"};J.add(Ks);var Zs=class{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){let{gl:r,CONTEXT_UID:i}=this,n=t._glTransformFeedbacks[i]||this.createGLTransformFeedback(t);r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,n)}unbind(){let{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,r){let{gl:i,renderer:n}=this;r&&n.shader.bind(r),i.beginTransformFeedback(t)}endTransformFeedback(){let{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){let{gl:r,renderer:i,CONTEXT_UID:n}=this,s=r.createTransformFeedback();t._glTransformFeedbacks[n]=s,r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,s);for(let a=0;a<t.buffers.length;a++){let c=t.buffers[a];c&&(i.buffer.update(c),c._glBuffers[n].refCount++,r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,a,c._glBuffers[n].buffer||null))}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),s}disposeTransformFeedback(t,r){let i=t._glTransformFeedbacks[this.CONTEXT_UID],n=this.gl;t.disposeRunner.remove(this);let s=this.renderer.buffer;if(s)for(let a=0;a<t.buffers.length;a++){let c=t.buffers[a];if(!c)continue;let f=c._glBuffers[this.CONTEXT_UID];f&&(f.refCount--,f.refCount===0&&!r&&s.dispose(c,r))}i&&(r||n.deleteTransformFeedback(i),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}};Zs.extension={type:$.RendererSystem,name:"transformFeedback"};J.add(Zs);var Ii=class{constructor(t){this.renderer=t}init(t){this.screen=new ct(0,0,t.width,t.height),this.element=t.view||X.ADAPTER.createCanvas(),this.resolution=t.resolution||X.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,r){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(r*this.resolution);let i=this.element.width/this.resolution,n=this.element.height/this.resolution;this.screen.width=i,this.screen.height=n,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${n}px`),this.renderer.emit("resize",i,n),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){t&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}};Ii.defaultOptions={width:800,height:600,resolution:X.RESOLUTION,autoDensity:!1};Ii.extension={type:[$.RendererSystem,$.CanvasRendererSystem],name:"_view"};J.add(Ii);X.PREFER_ENV=pr.WEBGL2;X.STRICT_TEXTURE_CACHE=!1;X.RENDER_OPTIONS={...Ci.defaultOptions,...Ai.defaultOptions,...Ii.defaultOptions,...Ri.defaultOptions};Object.defineProperties(X,{WRAP_MODE:{get(){return ht.defaultOptions.wrapMode},set(e){_t("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),ht.defaultOptions.wrapMode=e}},SCALE_MODE:{get(){return ht.defaultOptions.scaleMode},set(e){_t("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),ht.defaultOptions.scaleMode=e}},MIPMAP_TEXTURES:{get(){return ht.defaultOptions.mipmap},set(e){_t("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),ht.defaultOptions.mipmap=e}},ANISOTROPIC_LEVEL:{get(){return ht.defaultOptions.anisotropicLevel},set(e){_t("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),ht.defaultOptions.anisotropicLevel=e}},FILTER_RESOLUTION:{get(){return _t("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),zt.defaultResolution},set(e){zt.defaultResolution=e}},FILTER_MULTISAMPLE:{get(){return _t("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),zt.defaultMultisample},set(e){zt.defaultMultisample=e}},SPRITE_MAX_TEXTURES:{get(){return xr.defaultMaxTextures},set(e){_t("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),xr.defaultMaxTextures=e}},SPRITE_BATCH_SIZE:{get(){return xr.defaultBatchSize},set(e){_t("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),xr.defaultBatchSize=e}},CAN_UPLOAD_SAME_BUFFER:{get(){return xr.canUploadSameBuffer},set(e){_t("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),xr.canUploadSameBuffer=e}},GC_MODE:{get(){return or.defaultMode},set(e){_t("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),or.defaultMode=e}},GC_MAX_IDLE:{get(){return or.defaultMaxIdle},set(e){_t("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),or.defaultMaxIdle=e}},GC_MAX_CHECK_COUNT:{get(){return or.defaultCheckCountMax},set(e){_t("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),or.defaultCheckCountMax=e}},PRECISION_VERTEX:{get(){return Se.defaultVertexPrecision},set(e){_t("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Se.defaultVertexPrecision=e}},PRECISION_FRAGMENT:{get(){return Se.defaultFragmentPrecision},set(e){_t("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Se.defaultFragmentPrecision=e}}});var vr=(e=>(e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e))(vr||{});var Js=class{constructor(t,r=null,i=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=r,this.priority=i,this.once=n}match(t,r=null){return this.fn===t&&this.context===r}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));let r=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);let r=this.next;return this.next=t?null:r,this.previous=null,r}};var yr=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Js(null,null,1/0),this.deltaMS=1/yr.targetFPMS,this.elapsedMS=1/yr.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,r=vr.NORMAL){return this._addListener(new Js(e,t,r))}addOnce(e,t,r=vr.NORMAL){return this._addListener(new Js(e,t,r,!0))}_addListener(e){let t=this._head.next,r=this._head;if(!t)e.connect(r);else{for(;t;){if(e.priority>t.priority){e.connect(r);break}r=t,t=t.next}e.previous||e.connect(r)}return this._startIfPossible(),this}remove(e,t){let r=this._head.next;for(;r;)r.match(e,t)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){let n=e-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=e-n%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*yr.targetFPMS;let r=this._head,i=r.next;for(;i;)i=i.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){let t=Math.min(this.maxFPS,e),r=Math.min(Math.max(0,t)/1e3,yr.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{let t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!yr._shared){let e=yr._shared=new yr;e.autoStart=!0,e._protected=!0}return yr._shared}static get system(){if(!yr._system){let e=yr._system=new yr;e.autoStart=!0,e._protected=!0}return yr._system}},ie=yr;ie.targetFPMS=.06;Object.defineProperties(X,{TARGET_FPMS:{get(){return ie.targetFPMS},set(e){_t("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),ie.targetFPMS=e}}});var ua=class{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,vr.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?ie.shared:new ie,t.autoStart&&this.start()}static destroy(){if(this._ticker){let t=this._ticker;this.ticker=null,t.destroy()}}};ua.extension=$.Application;J.add(ua);var q_=[];J.handleByList($.Renderer,q_);function _f(e){for(let t of q_)if(t.test(e))return new t(e);throw new Error("Unable to auto-detect a suitable renderer.")}var K_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`;var Z_=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;var xf=K_,ca=Z_;var fa=class{constructor(t){this.renderer=t}contextChange(t){let r;if(this.renderer.context.webGLVersion===1){let i=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),r=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,i)}else{let i=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),r=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,i)}r>=Ft.HIGH?this.multisample=Ft.HIGH:r>=Ft.MEDIUM?this.multisample=Ft.MEDIUM:r>=Ft.LOW?this.multisample=Ft.LOW:this.multisample=Ft.NONE}destroy(){}};fa.extension={type:$.RendererSystem,name:"_multisample"};J.add(fa);var Ah=class{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}};var da=class{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){let{gl:r,CONTEXT_UID:i}=this,n=t._glBuffers[i]||this.createGLBuffer(t);r.bindBuffer(t.type,n.buffer)}unbind(t){let{gl:r}=this;r.bindBuffer(t,null)}bindBufferBase(t,r){let{gl:i,CONTEXT_UID:n}=this;if(this.boundBufferBases[r]!==t){let s=t._glBuffers[n]||this.createGLBuffer(t);this.boundBufferBases[r]=t,i.bindBufferBase(i.UNIFORM_BUFFER,r,s.buffer)}}bindBufferRange(t,r,i){let{gl:n,CONTEXT_UID:s}=this;i=i||0;let a=t._glBuffers[s]||this.createGLBuffer(t);n.bindBufferRange(n.UNIFORM_BUFFER,r||0,a.buffer,i*256,256)}update(t){let{gl:r,CONTEXT_UID:i}=this,n=t._glBuffers[i]||this.createGLBuffer(t);if(t._updateID!==n.updateID)if(n.updateID=t._updateID,r.bindBuffer(t.type,n.buffer),n.byteLength>=t.data.byteLength)r.bufferSubData(t.type,0,t.data);else{let s=t.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;n.byteLength=t.data.byteLength,r.bufferData(t.type,t.data,s)}}dispose(t,r){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];let i=t._glBuffers[this.CONTEXT_UID],n=this.gl;t.disposeRunner.remove(this),i&&(r||n.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){let r=Object.keys(this.managedBuffers);for(let i=0;i<r.length;i++)this.dispose(this.managedBuffers[r[i]],t)}createGLBuffer(t){let{CONTEXT_UID:r,gl:i}=this;return t._glBuffers[r]=new Ah(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[r]}};da.extension={type:$.RendererSystem,name:"buffer"};J.add(da);var pa=class{constructor(t){this.renderer=t}render(t,r){let i=this.renderer,n,s,a,c;if(r&&(n=r.renderTexture,s=r.clear,a=r.transform,c=r.skipUpdateTransform),this.renderingToScreen=!n,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=a,!i.context.isLost){if(n||(this.lastObjectRendered=t),!c){let f=t.enableTempParent();t.updateTransform(),t.disableTempParent(f)}i.renderTexture.bind(n),i.batch.currentRenderer.start(),(s??i.background.clearBeforeRender)&&i.renderTexture.clear(),t.render(i),i.batch.currentRenderer.flush(),n&&(r.blit&&i.framebuffer.blit(),n.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}};pa.extension={type:$.RendererSystem,name:"objectRenderer"};J.add(pa);var vf=class extends qs{constructor(e){super(),this.type=Bc.WEBGL,e=Object.assign({},X.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new ge({projectionMatrix:new St},!0);let t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:vf.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in e&&(_t("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=vf.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e?.forceCanvas?!1:Ql()}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return _t("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return _t("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return _t("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return _t("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){_t("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return _t("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){_t("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return _t("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}},qn=vf;qn.extension={type:$.Renderer,priority:1};qn.__plugins={};qn.__systems={};J.handleByMap($.RendererPlugin,qn.__plugins);J.handleByMap($.RendererSystem,qn.__systems);J.add(qn);var un=class extends _r{constructor(t,r){let{width:i,height:n}=r||{};super(i,n),this.items=[],this.itemDirtyIds=[];for(let s=0;s<t;s++){let a=new ht;this.items.push(a),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,r){for(let i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof _r?this.addResourceAt(t[i],i):this.addResourceAt(Bs(t[i],r),i))}dispose(){for(let t=0,r=this.length;t<r;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,r){if(!this.items[r])throw new Error(`Index ${r} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[r].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=t,this.items[r].on("update",t.update,t)}unbind(t){super.unbind(t);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",t.update,t)}load(){if(this._load)return this._load;let r=this.items.map(i=>i.resource).filter(i=>i).map(i=>i.load());return this._load=Promise.all(r).then(()=>{let{realWidth:i,realHeight:n}=this.items[0];return this.resize(i,n),Promise.resolve(this)}),this._load}};var Qs=class extends un{constructor(t,r){let{width:i,height:n}=r||{},s,a;Array.isArray(t)?(s=t,a=t.length):a=t,super(a,{width:i,height:n}),s&&this.initFromArray(s,r)}addBaseTextureAt(t,r){if(t.resource)this.addResourceAt(t.resource,r);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=wi.TEXTURE_2D_ARRAY}upload(t,r,i){let{length:n,itemDirtyIds:s,items:a}=this,{gl:c}=t;i.dirtyId<0&&c.texImage3D(c.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,n,0,r.format,i.type,null);for(let f=0;f<n;f++){let p=a[f];s[f]<p.dirtyId&&(s[f]=p.dirtyId,p.valid&&c.texSubImage3D(c.TEXTURE_2D_ARRAY,0,0,0,f,p.resource.width,p.resource.height,1,r.format,i.type,p.resource.source))}return!0}};var to=class extends Re{constructor(t){super(t)}static test(t){let{OffscreenCanvas:r}=globalThis;return r&&t instanceof r?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}};var ma=class extends un{constructor(e,t){let{width:r,height:i,autoLoad:n,linkBaseTexture:s}=t||{};if(e&&e.length!==ma.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:r,height:i});for(let a=0;a<ma.SIDES;a++)this.items[a].target=wi.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=s!==!1,e&&this.initFromArray(e,t),n!==!1&&this.load()}bind(e){super.bind(e),e.target=wi.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,r){if(r===void 0&&(r=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=wi.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(e,t,r){let i=this.itemDirtyIds;for(let n=0;n<ma.SIDES;n++){let s=this.items[n];(i[n]<s.dirtyId||r.dirtyId<t.dirtyId)&&(s.valid&&s.resource?(s.resource.upload(e,s,r),i[n]=s.dirtyId):i[n]<-1&&(e.gl.texImage2D(s.target,0,r.internalFormat,t.realWidth,t.realHeight,0,t.format,r.type,null),i[n]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===ma.SIDES}},ga=ma;ga.SIDES=6;var $r=class extends Re{constructor(t,r){r=r||{};let i,n;typeof t=="string"?(i=$r.EMPTY,n=t):(i=t,n=null),super(i),this.url=n,this.crossOrigin=r.crossOrigin??!0,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,r)=>{if(this.url===null){t(this);return}try{let i=await X.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;let n=await i.blob();if(this.destroyed)return;let s=await createImageBitmap(n,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===fe.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=s,this.update(),t(this)}catch(i){if(this.destroyed)return;r(i),this.onError.emit(i)}}),this._load)}upload(t,r,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),super.upload(t,r,i)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return $r._EMPTY=$r._EMPTY??X.ADAPTER.createCanvas(0,0),$r._EMPTY}};var Ch=class extends Re{constructor(e,t){t=t||{},super(X.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),e(this)},Ch.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){let e=new Image;Re.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=t=>{this._resolve&&(e.onerror=null,this.onError.emit(t))},e.onload=()=>{if(!this._resolve)return;let t=e.width,r=e.height;if(!t||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=t*this.scale,n=r*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/r*t,n=this._overrideHeight||this._overrideWidth/t*r),i=Math.round(i),n=Math.round(n);let s=this.source;s.width=i,s.height=n,s._pixiId=`canvas_${si()}`,s.getContext("2d").drawImage(e,0,0,t,r,0,0,i,n),this._resolve(),this._resolve=null}}static getSize(e){let t=Ch.SVG_SIZE.exec(e),r={};return t&&(r[t[1]]=Math.round(parseFloat(t[3])),r[t[5]]=Math.round(parseFloat(t[7]))),r}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,t){return t==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&Ch.SVG_XML.test(e)}},Pi=Ch;Pi.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;Pi.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var yf=class extends Re{constructor(e,t){if(t=t||{},!(e instanceof HTMLVideoElement)){let r=document.createElement("video");r.setAttribute("preload","auto"),r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline",""),typeof e=="string"&&(e=[e]);let i=e[0].src||e[0];Re.crossOrigin(r,i,t.crossorigin);for(let n=0;n<e.length;++n){let s=document.createElement("source"),{src:a,mime:c}=e[n];a=a||e[n];let f=a.split("?").shift().toLowerCase(),p=f.slice(f.lastIndexOf(".")+1);c=c||yf.MIME_TYPES[p]||`video/${p}`,s.src=a,s.type=c,r.appendChild(s)}e=r}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){let t=ie.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;let e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)}_isSourcePlaying(){let e=this.source;return!e.paused&&!e.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(ie.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(ie.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){let e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);let t=this.valid;this.resize(e.videoWidth,e.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._isConnectedToTicker&&(ie.shared.remove(this.update,this),this._isConnectedToTicker=!1);let e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(ie.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(ie.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e)}static test(e,t){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||yf.TYPES.includes(t)}},eo=yf;eo.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];eo.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};Ms.push($r,ln,to,eo,Pi,nr,ga,Qs);var ai=class{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?ct.EMPTY:(t=t||new ct(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,r){let{a:i,b:n,c:s,d:a,tx:c,ty:f}=t,p=i*r.x+s*r.y+c,l=n*r.x+a*r.y+f;this.minX=Math.min(this.minX,p),this.maxX=Math.max(this.maxX,p),this.minY=Math.min(this.minY,l),this.maxY=Math.max(this.maxY,l)}addQuad(t){let r=this.minX,i=this.minY,n=this.maxX,s=this.maxY,a=t[0],c=t[1];r=a<r?a:r,i=c<i?c:i,n=a>n?a:n,s=c>s?c:s,a=t[2],c=t[3],r=a<r?a:r,i=c<i?c:i,n=a>n?a:n,s=c>s?c:s,a=t[4],c=t[5],r=a<r?a:r,i=c<i?c:i,n=a>n?a:n,s=c>s?c:s,a=t[6],c=t[7],r=a<r?a:r,i=c<i?c:i,n=a>n?a:n,s=c>s?c:s,this.minX=r,this.minY=i,this.maxX=n,this.maxY=s}addFrame(t,r,i,n,s){this.addFrameMatrix(t.worldTransform,r,i,n,s)}addFrameMatrix(t,r,i,n,s){let a=t.a,c=t.b,f=t.c,p=t.d,l=t.tx,h=t.ty,d=this.minX,m=this.minY,_=this.maxX,x=this.maxY,T=a*r+f*i+l,S=c*r+p*i+h;d=T<d?T:d,m=S<m?S:m,_=T>_?T:_,x=S>x?S:x,T=a*n+f*i+l,S=c*n+p*i+h,d=T<d?T:d,m=S<m?S:m,_=T>_?T:_,x=S>x?S:x,T=a*r+f*s+l,S=c*r+p*s+h,d=T<d?T:d,m=S<m?S:m,_=T>_?T:_,x=S>x?S:x,T=a*n+f*s+l,S=c*n+p*s+h,d=T<d?T:d,m=S<m?S:m,_=T>_?T:_,x=S>x?S:x,this.minX=d,this.minY=m,this.maxX=_,this.maxY=x}addVertexData(t,r,i){let n=this.minX,s=this.minY,a=this.maxX,c=this.maxY;for(let f=r;f<i;f+=2){let p=t[f],l=t[f+1];n=p<n?p:n,s=l<s?l:s,a=p>a?p:a,c=l>c?l:c}this.minX=n,this.minY=s,this.maxX=a,this.maxY=c}addVertices(t,r,i,n){this.addVerticesMatrix(t.worldTransform,r,i,n)}addVerticesMatrix(t,r,i,n,s=0,a=s){let c=t.a,f=t.b,p=t.c,l=t.d,h=t.tx,d=t.ty,m=this.minX,_=this.minY,x=this.maxX,T=this.maxY;for(let S=i;S<n;S+=2){let w=r[S],y=r[S+1],E=c*w+p*y+h,R=l*y+f*w+d;m=Math.min(m,E-s),x=Math.max(x,E+s),_=Math.min(_,R-a),T=Math.max(T,R+a)}this.minX=m,this.minY=_,this.maxX=x,this.maxY=T}addBounds(t){let r=this.minX,i=this.minY,n=this.maxX,s=this.maxY;this.minX=t.minX<r?t.minX:r,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>n?t.maxX:n,this.maxY=t.maxY>s?t.maxY:s}addBoundsMask(t,r){let i=t.minX>r.minX?t.minX:r.minX,n=t.minY>r.minY?t.minY:r.minY,s=t.maxX<r.maxX?t.maxX:r.maxX,a=t.maxY<r.maxY?t.maxY:r.maxY;if(i<=s&&n<=a){let c=this.minX,f=this.minY,p=this.maxX,l=this.maxY;this.minX=i<c?i:c,this.minY=n<f?n:f,this.maxX=s>p?s:p,this.maxY=a>l?a:l}}addBoundsMatrix(t,r){this.addFrameMatrix(r,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,r){let i=t.minX>r.x?t.minX:r.x,n=t.minY>r.y?t.minY:r.y,s=t.maxX<r.x+r.width?t.maxX:r.x+r.width,a=t.maxY<r.y+r.height?t.maxY:r.y+r.height;if(i<=s&&n<=a){let c=this.minX,f=this.minY,p=this.maxX,l=this.maxY;this.minX=i<c?i:c,this.minY=n<f?n:f,this.maxX=s>p?s:p,this.maxY=a>l?a:l}}pad(t=0,r=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=r,this.maxY+=r)}addFramePad(t,r,i,n,s,a){t-=s,r-=a,i+=s,n+=a,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<r?this.minY:r,this.maxY=this.maxY>n?this.maxY:n}};var Nt=class extends rt.EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Xn,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new ai,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){let r=Object.keys(t);for(let i=0;i<r.length;++i){let n=r[i];Object.defineProperty(Nt.prototype,n,Object.getOwnPropertyDescriptor(t,n))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,r){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new ct),r=this._boundsRect),this._bounds.getRectangle(r)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new ct),t=this._localBoundsRect),this._localBounds||(this._localBounds=new ai);let r=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;let n=this._bounds,s=this._boundsID;this._bounds=this._localBounds;let a=this.getBounds(!1,t);return this.parent=i,this.transform=r,this._bounds=n,this._bounds.updateID+=this._boundsID-s,a}toGlobal(t,r,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,r)}toLocal(t,r,i,n){return r&&(t=r.toGlobal(t,i,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){this.parent?.removeChild(this)}setTransform(t=0,r=0,i=1,n=1,s=0,a=0,c=0,f=0,p=0){return this.position.x=t,this.position.y=r,this.scale.x=i||1,this.scale.y=n||1,this.rotation=s,this.skew.x=a,this.skew.y=c,this.pivot.x=f,this.pivot.y=p,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Rh),this.tempDisplayObjectParent}enableTempParent(){let t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*sf}set angle(t){this.transform.rotation=t*of}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){let r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount--,r._maskRefCount===0&&(r.renderable=!0,r.isMask=!1))}if(this._mask=t,this._mask){let r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount===0&&(r.renderable=!1,r.isMask=!0),r._maskRefCount++)}}}},Rh=class extends Nt{constructor(){super(...arguments),this.sortDirty=null}};Nt.prototype.displayObjectUpdateTransform=Nt.prototype.updateTransform;var PA=new St;function MA(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}var Tf=class extends Nt{constructor(){super(),this.children=[],this.sortableChildren=Tf.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.addChild(e[t]);else{let t=e[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return e[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}swapChildren(e,t){if(e===t)return;let r=this.getChildIndex(e),i=this.getChildIndex(t);this.children[r]=t,this.children[i]=e,this.onChildrenChange(r<i?r:i)}getChildIndex(e){let t=this.children.indexOf(e);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);let r=this.getChildIndex(e);rt.removeItems(this.children,r,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.removeChild(e[t]);else{let t=e[0],r=this.children.indexOf(t);if(r===-1)return null;t.parent=null,t.transform._parentID=-1,rt.removeItems(this.children,r,1),this._boundsID++,this.onChildrenChange(r),t.emit("removed",this),this.emit("childRemoved",t,this,r)}return e[0]}removeChildAt(e){let t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,rt.removeItems(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}removeChildren(e=0,t=this.children.length){let r=e,i=t,n=i-r,s;if(n>0&&n<=i){s=this.children.splice(r,n);for(let a=0;a<s.length;++a)s[a].parent=null,s[a].transform&&(s[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let a=0;a<s.length;++a)s[a].emit("removed",this),this.emit("childRemoved",s[a],this,a);return s}else if(n===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let t=0,r=this.children.length;t<r;++t){let i=this.children[t];i._lastSortedIndex=t,!e&&i.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(MA),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){let r=this.children[e];r.visible&&r.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){let t=this.children[e];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){let r=t._mask.isMaskData?t._mask.maskObject:t._mask;r?(r.calculateBounds(),this._bounds.addBoundsMask(t._bounds,r._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){let r=super.getLocalBounds(e);if(!t)for(let i=0,n=this.children.length;i<n;++i){let s=this.children[i];s.visible&&s.updateTransform()}return r}_calculateBounds(){}_renderWithCulling(e){let t=e.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let r,i;this.cullArea?(r=this.cullArea,i=this.worldTransform):this._render!==Tf.prototype._render&&(r=this.getBounds(!0));let n=e.projection.transform;if(n&&(i?(i=PA.copyFrom(i),i.prepend(n)):i=n),r&&t.intersects(r,i))this._render(e);else if(this.cullArea)return;for(let s=0,a=this.children.length;s<a;++s){let c=this.children[s],f=c.cullable;c.cullable=f||!this.cullArea,c.render(e),c.cullable=f}}render(e){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters?.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let t=0,r=this.children.length;t<r;++t)this.children[t].render(e)}}renderAdvanced(e){let t=this.filters,r=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let n=0;n<t.length;n++)t[n].enabled&&this._enabledFilters.push(t[n])}let i=t&&this._enabledFilters?.length||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==se.NONE));if(i&&e.batch.flush(),t&&this._enabledFilters?.length&&e.filter.push(this,this._enabledFilters),r&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let n=0,s=this.children.length;n<s;++n)this.children[n].render(e)}i&&e.batch.flush(),r&&e.mask.pop(this),t&&this._enabledFilters?.length&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;let t=typeof e=="boolean"?e:e?.children,r=this.removeChildren(0,this.children.length);if(t)for(let i=0;i<r.length;++i)r[i].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){let t=this.getLocalBounds().width;t!==0?this.scale.x=e/t:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){let t=this.getLocalBounds().height;t!==0?this.scale.y=e/t:this.scale.y=1,this._height=e}},oe=Tf;oe.defaultSortableChildren=!1;oe.prototype.containerUpdateTransform=oe.prototype.updateTransform;Object.defineProperties(X,{SORTABLE_CHILDREN:{get(){return oe.defaultSortableChildren},set(e){rt.deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),oe.defaultSortableChildren=e}}});var _a=new pt,BA=new Uint16Array([0,1,2,0,2,3]),Le=class extends oe{constructor(t){super(),this._anchor=new sr(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new mt(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=dt.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||nt.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=BA,this.pluginName="batch",this.isSprite=!0,this._roundPixels=X.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=rt.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=rt.sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){let t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;let r=this.transform.worldTransform,i=r.a,n=r.b,s=r.c,a=r.d,c=r.tx,f=r.ty,p=this.vertexData,l=t.trim,h=t.orig,d=this._anchor,m=0,_=0,x=0,T=0;if(l?(_=l.x-d._x*h.width,m=_+l.width,T=l.y-d._y*h.height,x=T+l.height):(_=-d._x*h.width,m=_+h.width,T=-d._y*h.height,x=T+h.height),p[0]=i*_+s*T+c,p[1]=a*T+n*_+f,p[2]=i*m+s*T+c,p[3]=a*T+n*m+f,p[4]=i*m+s*x+c,p[5]=a*x+n*m+f,p[6]=i*_+s*x+c,p[7]=a*x+n*_+f,this._roundPixels){let S=X.RESOLUTION;for(let w=0;w<p.length;++w)p[w]=Math.round(p[w]*S)/S}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;let t=this._texture,r=this.vertexTrimmedData,i=t.orig,n=this._anchor,s=this.transform.worldTransform,a=s.a,c=s.b,f=s.c,p=s.d,l=s.tx,h=s.ty,d=-n._x*i.width,m=d+i.width,_=-n._y*i.height,x=_+i.height;r[0]=a*d+f*_+l,r[1]=p*_+c*d+h,r[2]=a*m+f*_+l,r[3]=p*_+c*m+h,r[4]=a*m+f*x+l,r[5]=p*x+c*m+h,r[6]=a*d+f*x+l,r[7]=p*x+c*d+h}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){let t=this._texture.trim,r=this._texture.orig;!t||t.width===r.width&&t.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new ai),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new ct),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,_a);let r=this._texture.orig.width,i=this._texture.orig.height,n=-r*this.anchor.x,s=0;return _a.x>=n&&_a.x<n+r&&(s=-i*this.anchor.y,_a.y>=s&&_a.y<s+i)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t?.texture){let i=typeof t=="boolean"?t:t?.baseTexture;this._texture.destroy(!!i)}this._texture=null}static from(t,r){let i=t instanceof nt?t:nt.from(t,r);return new Le(i)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){let r=rt.sign(this.scale.x)||1;this.scale.x=r*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){let r=rt.sign(this.scale.y)||1;this.scale.y=r*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||nt.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}};var J_=new St;Nt.prototype._cacheAsBitmap=!1;Nt.prototype._cacheData=null;Nt.prototype._cacheAsBitmapResolution=null;Nt.prototype._cacheAsBitmapMultisample=null;var Ef=class{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}};Object.defineProperties(Nt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(e){e!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(e){e!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(e){if(this._cacheAsBitmap===e)return;this._cacheAsBitmap=e;let t;e?(this._cacheData||(this._cacheData=new Ef),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});Nt.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};Nt.prototype._initCachedDisplayObject=function(t){if(this._cacheData?.sprite)return;let r=this.alpha;this.alpha=1,t.batch.flush();let i=this.getLocalBounds(null,!0).clone();if(this.filters?.length){let d=this.filters[0].padding;i.pad(d)}i.ceil(X.RESOLUTION);let n=t.renderTexture.current,s=t.renderTexture.sourceFrame.clone(),a=t.renderTexture.destinationFrame.clone(),c=t.projection.transform,f=ze.create({width:i.width,height:i.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:this.cacheAsBitmapMultisample??t.multisample}),p=`cacheAsBitmap_${rt.uid()}`;this._cacheData.textureCacheId=p,ht.addToCache(f.baseTexture,p),nt.addToCache(f,p);let l=this.transform.localTransform.copyTo(J_).invert().translate(-i.x,-i.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:f,clear:!0,transform:l,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=c,t.renderTexture.bind(n,s,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;let h=new Le(f);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(i.x/i.width),h.anchor.y=-(i.y/i.height),h.alpha=r,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=h.containsPoint.bind(h)};Nt.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};Nt.prototype._initCachedDisplayObjectCanvas=function(t){if(this._cacheData?.sprite)return;let r=this.getLocalBounds(null,!0),i=this.alpha;this.alpha=1;let n=t.canvasContext.activeContext,s=t._projTransform;r.ceil(X.RESOLUTION);let a=ze.create({width:r.width,height:r.height}),c=`cacheAsBitmap_${rt.uid()}`;this._cacheData.textureCacheId=c,ht.addToCache(a.baseTexture,c),nt.addToCache(a,c);let f=J_;this.transform.localTransform.copyTo(f),f.invert(),f.tx-=r.x,f.ty-=r.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:a,clear:!0,transform:f,skipUpdateTransform:!1}),t.canvasContext.activeContext=n,t._projTransform=s,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;let p=new Le(a);p.transform.worldTransform=this.transform.worldTransform,p.anchor.x=-(r.x/r.width),p.anchor.y=-(r.y/r.height),p.alpha=i,p._bounds=this._bounds,this._cacheData.sprite=p,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=p.containsPoint.bind(p)};Nt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Nt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Nt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,ht.removeFromCache(this._cacheData.textureCacheId),nt.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Nt.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};Nt.prototype.name=null;oe.prototype.getChildByName=function(t,r){for(let i=0,n=this.children.length;i<n;i++)if(this.children[i].name===t)return this.children[i];if(r)for(let i=0,n=this.children.length;i<n;i++){let s=this.children[i];if(!s.getChildByName)continue;let a=s.getChildByName(t,!0);if(a)return a}return null};Nt.prototype.getGlobalPosition=function(t=new pt,r=!1){return this.parent?this.parent.toGlobal(this.position,t,r):(t.x=this.position.x,t.y=this.position.y),t};var Q_=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;var xa=class extends zt{constructor(t=1){super(xf,Q_,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}};var DA={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},OA=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function tx(e){let t=DA[e],r=t.length,i=OA,n="",s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;",a;for(let c=0;c<e;c++){let f=s.replace("%index%",c.toString());a=c,c>=r&&(a=e-c-1),f=f.replace("%value%",t[a].toString()),n+=f,n+=`
`}return i=i.replace("%blur%",n),i=i.replace("%size%",e.toString()),i}var LA=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function ex(e,t){let r=Math.ceil(e/2),i=LA,n="",s;t?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let a=0;a<e;a++){let c=s.replace("%index%",a.toString());c=c.replace("%sampleIndex%",`${a-(r-1)}.0`),n+=c,n+=`
`}return i=i.replace("%blur%",n),i=i.replace("%size%",e.toString()),i}var cn=class extends zt{constructor(t,r=8,i=4,n=zt.defaultResolution,s=5){let a=ex(s,t),c=tx(s);super(a,c),this.horizontal=t,this.resolution=n,this._quality=0,this.quality=i,this.blur=r}apply(t,r,i,n){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/r.width):this.uniforms.strength=1/i.height*(i.height/r.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/r.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,r,i,n);else{let s=t.getFilterTexture(),a=t.renderer,c=r,f=s;this.state.blend=!1,t.applyFilter(this,c,f,gr.CLEAR);for(let p=1;p<this.passes-1;p++){t.bindAndClear(c,gr.BLIT),this.uniforms.uSampler=f;let l=f;f=c,c=l,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,f,i,n),t.returnFilterTexture(s)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}};var va=class extends zt{constructor(t=8,r=4,i=zt.defaultResolution,n=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new cn(!0,t,r,i,n),this.blurYFilter=new cn(!1,t,r,i,n),this.resolution=i,this.quality=r,this.blur=t,this.repeatEdgePixels=!1}apply(t,r,i,n){let s=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(s&&a){let c=t.getFilterTexture();this.blurXFilter.apply(t,r,c,gr.CLEAR),this.blurYFilter.apply(t,c,i,n),t.returnFilterTexture(c)}else a?this.blurYFilter.apply(t,r,i,n):this.blurXFilter.apply(t,r,i,n)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}};var rx=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;var Kn=class extends zt{constructor(){let t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(ca,rx,t),this.alpha=1}_loadMatrix(t,r=!1){let i=t;r&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(t,r,i){return t[0]=r[0]*i[0]+r[1]*i[5]+r[2]*i[10]+r[3]*i[15],t[1]=r[0]*i[1]+r[1]*i[6]+r[2]*i[11]+r[3]*i[16],t[2]=r[0]*i[2]+r[1]*i[7]+r[2]*i[12]+r[3]*i[17],t[3]=r[0]*i[3]+r[1]*i[8]+r[2]*i[13]+r[3]*i[18],t[4]=r[0]*i[4]+r[1]*i[9]+r[2]*i[14]+r[3]*i[19]+r[4],t[5]=r[5]*i[0]+r[6]*i[5]+r[7]*i[10]+r[8]*i[15],t[6]=r[5]*i[1]+r[6]*i[6]+r[7]*i[11]+r[8]*i[16],t[7]=r[5]*i[2]+r[6]*i[7]+r[7]*i[12]+r[8]*i[17],t[8]=r[5]*i[3]+r[6]*i[8]+r[7]*i[13]+r[8]*i[18],t[9]=r[5]*i[4]+r[6]*i[9]+r[7]*i[14]+r[8]*i[19]+r[9],t[10]=r[10]*i[0]+r[11]*i[5]+r[12]*i[10]+r[13]*i[15],t[11]=r[10]*i[1]+r[11]*i[6]+r[12]*i[11]+r[13]*i[16],t[12]=r[10]*i[2]+r[11]*i[7]+r[12]*i[12]+r[13]*i[17],t[13]=r[10]*i[3]+r[11]*i[8]+r[12]*i[13]+r[13]*i[18],t[14]=r[10]*i[4]+r[11]*i[9]+r[12]*i[14]+r[13]*i[19]+r[14],t[15]=r[15]*i[0]+r[16]*i[5]+r[17]*i[10]+r[18]*i[15],t[16]=r[15]*i[1]+r[16]*i[6]+r[17]*i[11]+r[18]*i[16],t[17]=r[15]*i[2]+r[16]*i[7]+r[17]*i[12]+r[18]*i[17],t[18]=r[15]*i[3]+r[16]*i[8]+r[17]*i[13]+r[18]*i[18],t[19]=r[15]*i[4]+r[16]*i[9]+r[17]*i[14]+r[18]*i[19]+r[19],t}_colorMatrix(t){let r=new Float32Array(t);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r}brightness(t,r){let i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,r)}tint(t,r){let[i,n,s]=mt.shared.setValue(t).toArray(),a=[i,0,0,0,0,0,n,0,0,0,0,0,s,0,0,0,0,0,1,0];this._loadMatrix(a,r)}greyscale(t,r){let i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,r)}blackAndWhite(t){let r=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(r,t)}hue(t,r){t=(t||0)/180*Math.PI;let i=Math.cos(t),n=Math.sin(t),s=Math.sqrt,a=1/3,c=s(a),f=i+(1-i)*a,p=a*(1-i)-c*n,l=a*(1-i)+c*n,h=a*(1-i)+c*n,d=i+a*(1-i),m=a*(1-i)-c*n,_=a*(1-i)-c*n,x=a*(1-i)+c*n,T=i+a*(1-i),S=[f,p,l,0,0,h,d,m,0,0,_,x,T,0,0,0,0,0,1,0];this._loadMatrix(S,r)}contrast(t,r){let i=(t||0)+1,n=-.5*(i-1),s=[i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0];this._loadMatrix(s,r)}saturate(t=0,r){let i=t*2/3+1,n=(i-1)*-.5,s=[i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0];this._loadMatrix(s,r)}desaturate(){this.saturate(-1)}negative(t){let r=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(r,t)}sepia(t){let r=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(r,t)}technicolor(t){let r=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(r,t)}polaroid(t){let r=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(r,t)}toBGR(t){let r=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(r,t)}kodachrome(t){let r=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(r,t)}browni(t){let r=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(r,t)}vintage(t){let r=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(r,t)}colorTone(t,r,i,n,s){t=t||.2,r=r||.15,i=i||16770432,n=n||3375104;let a=mt.shared,[c,f,p]=a.setValue(i).toArray(),[l,h,d]=a.setValue(n).toArray(),m=[.3,.59,.11,0,0,c,f,p,t,0,l,h,d,r,0,c-l,f-h,p-d,0,0];this._loadMatrix(m,s)}night(t,r){t=t||.1;let i=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(i,r)}predator(t,r){let i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,r)}lsd(t){let r=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(r,t)}reset(){let t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}};Kn.prototype.grayscale=Kn.prototype.greyscale;var ix=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`;var nx=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;var ya=class extends zt{constructor(t,r){let i=new St;t.renderable=!1,super(nx,ix,{mapSampler:t._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=i,r==null&&(r=20),this.scale=new pt(r,r)}apply(t,r,i,n){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;let s=this.maskSprite.worldTransform,a=Math.sqrt(s.a*s.a+s.b*s.b),c=Math.sqrt(s.c*s.c+s.d*s.d);a!==0&&c!==0&&(this.uniforms.rotation[0]=s.a/a,this.uniforms.rotation[1]=s.b/a,this.uniforms.rotation[2]=s.c/c,this.uniforms.rotation[3]=s.d/c),t.applyFilter(this,r,i,n)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}};var sx=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`;var ox=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;var Ta=class extends zt{constructor(){super(ox,sx)}};var ax=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;var Ea=class extends zt{constructor(t=.5,r=Math.random()){super(ca,ax,{uNoise:0,uSeed:0}),this.noise=t,this.seed=r}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}};var wf={AlphaFilter:xa,BlurFilter:va,BlurFilterPass:cn,ColorMatrixFilter:Kn,DisplacementFilter:ya,FXAAFilter:Ta,NoiseFilter:Ea};Object.entries(wf).forEach(([e,t])=>{Object.defineProperty(wf,e,{get(){return rt.deprecation("7.1.0",`filters.${e} has moved to ${e}`),t}})});var Sf=class{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(ie.system.add(this.tickerUpdate,this,vr.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(ie.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}let t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}},Mi=new Sf;var Yr=class{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Yr.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new pt,this.page=new pt,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,r,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,r,i,n,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}};var li=class extends Yr{constructor(){super(...arguments),this.client=new pt,this.movement=new pt,this.offset=new pt,this.global=new pt,this.screen=new pt}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,r,i){return t.worldTransform.applyInverse(i||this.global,r)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,r,i,n,s,a,c,f,p,l,h,d,m,_,x){throw new Error("Method not implemented.")}};var Fe=class extends li{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}};var jr=class extends li{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}};jr.DOM_DELTA_PIXEL=0;jr.DOM_DELTA_LINE=1;jr.DOM_DELTA_PAGE=2;var FA=2048,NA=new pt,bf=new pt,wa=class{constructor(t){this.dispatch=new rt.EventEmitter,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._collectInteractiveElements=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,r){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:r,priority:0}),this.mappingTable[t].sort((i,n)=>i.priority-n.priority)}dispatchEvent(t,r){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,r),this.dispatch.emit(r||t.type,t)}mapEvent(t){if(!this.rootTarget)return;let r=this.mappingTable[t.type];if(r)for(let i=0,n=r.length;i<n;i++)r[i].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,r){Mi.pauseUpdate=!0;let i=this.hitTestRecursive(this.rootTarget,this.rootTarget.eventMode,NA.set(t,r),this.hitTestFn,this.hitPruneFn);return i&&i[0]}propagate(t,r){if(!t.target)return;let i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let n=0,s=i.length-1;n<s;n++)if(t.currentTarget=i[n],this.notifyTarget(t,r),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,r),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let n=i.length-2;n>=0;n--)if(t.currentTarget=i[n],this.notifyTarget(t,r),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,r,i=this._allInteractiveElements){if(i.length===0)return;t.eventPhase=t.BUBBLING_PHASE;let n=Array.isArray(r)?r:[r];for(let s=i.length-1;s>=0;s--)n.forEach(a=>{t.currentTarget=i[s],this.notifyTarget(t,a)})}propagationPath(t){let r=[t];for(let i=0;i<FA&&t!==this.rootTarget;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");r.push(t.parent),t=t.parent}return r.reverse(),r}hitTestRecursive(t,r,i,n,s){if(s(t,i))return null;if((t.eventMode==="dynamic"||r==="dynamic")&&(Mi.pauseUpdate=!1),t.interactiveChildren&&t.children){let f=t.children;for(let p=f.length-1;p>=0;p--){let l=f[p],h=this.hitTestRecursive(l,this._isInteractive(r)?r:l.eventMode,i,n,s);if(h){if(h.length>0&&!h[h.length-1].parent)continue;let d=t.isInteractive();if((h.length>0||d)&&(this._collectInteractiveElements&&d&&this._allInteractiveElements.push(t),h.push(t)),this._collectInteractiveElements&&this._hitElements.length===0&&(this._hitElements=h),!this._collectInteractiveElements)return h}}}let a=this._isInteractive(r),c=t.isInteractive();return this._collectInteractiveElements&&(a&&c&&this._allInteractiveElements.push(t),this._hitElements.length>0)?null:a&&n(t,i)?c?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}hitPruneFn(t,r){if(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)return!0;if(this._collectInteractiveElements)return!1;if(t.hitArea&&(t.worldTransform.applyInverse(r,bf),!t.hitArea.contains(bf.x,bf.y)))return!0;if(t._mask){let i=t._mask.isMaskData?t._mask.maskObject:t._mask;if(i&&!i.containsPoint?.(r))return!0}return!1}hitTestFn(t,r){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(r):!1}notifyTarget(t,r){r=r??t.type;let i=`on${r}`;t.currentTarget[i]?.(t);let n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${r}capture`:r;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,r)}mapPointerDown(t){if(!(t instanceof Fe)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.createPointerEvent(t);if(this.dispatchEvent(r,"pointerdown"),r.pointerType==="touch")this.dispatchEvent(r,"touchstart");else if(r.pointerType==="mouse"||r.pointerType==="pen"){let n=r.button===2;this.dispatchEvent(r,n?"rightdown":"mousedown")}let i=this.trackingData(t.pointerId);i.pressTargetsByButton[t.button]=r.composedPath(),this.freeEvent(r)}mapPointerMove(t){if(!(t instanceof Fe)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._collectInteractiveElements=!0;let r=this.createPointerEvent(t);this._collectInteractiveElements=!1;let i=r.pointerType==="mouse"||r.pointerType==="pen",n=this.trackingData(t.pointerId),s=this.findMountedTarget(n.overTargets);if(n.overTargets?.length>0&&s!==r.target){let f=t.type==="mousemove"?"mouseout":"pointerout",p=this.createPointerEvent(t,f,s);if(this.dispatchEvent(p,"pointerout"),i&&this.dispatchEvent(p,"mouseout"),!r.composedPath().includes(s)){let l=this.createPointerEvent(t,"pointerleave",s);for(l.eventPhase=l.AT_TARGET;l.target&&!r.composedPath().includes(l.target);)l.currentTarget=l.target,this.notifyTarget(l),i&&this.notifyTarget(l,"mouseleave"),l.target=l.target.parent;this.freeEvent(l)}this.freeEvent(p)}if(s!==r.target){let f=t.type==="mousemove"?"mouseover":"pointerover",p=this.clonePointerEvent(r,f);this.dispatchEvent(p,"pointerover"),i&&this.dispatchEvent(p,"mouseover");let l=s?.parent;for(;l&&l!==this.rootTarget.parent&&l!==r.target;)l=l.parent;if(!l||l===this.rootTarget.parent){let d=this.clonePointerEvent(r,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==s&&d.target!==this.rootTarget.parent;)d.currentTarget=d.target,this.notifyTarget(d),i&&this.notifyTarget(d,"mouseenter"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(p)}let a=[],c=this.enableGlobalMoveEvents??!0;this.moveOnAll?a.push("pointermove"):this.dispatchEvent(r,"pointermove"),c&&a.push("globalpointermove"),r.pointerType==="touch"&&(this.moveOnAll?a.splice(1,0,"touchmove"):this.dispatchEvent(r,"touchmove"),c&&a.push("globaltouchmove")),i&&(this.moveOnAll?a.splice(1,0,"mousemove"):this.dispatchEvent(r,"mousemove"),c&&a.push("globalmousemove"),this.cursor=r.target?.cursor),a.length>0&&this.all(r,a),this._allInteractiveElements.length=0,this._hitElements.length=0,n.overTargets=r.composedPath(),this.freeEvent(r)}mapPointerOver(t){if(!(t instanceof Fe)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.trackingData(t.pointerId),i=this.createPointerEvent(t),n=i.pointerType==="mouse"||i.pointerType==="pen";this.dispatchEvent(i,"pointerover"),n&&this.dispatchEvent(i,"mouseover"),i.pointerType==="mouse"&&(this.cursor=i.target?.cursor);let s=this.clonePointerEvent(i,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),n&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;r.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(s)}mapPointerOut(t){if(!(t instanceof Fe)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.trackingData(t.pointerId);if(r.overTargets){let i=t.pointerType==="mouse"||t.pointerType==="pen",n=this.findMountedTarget(r.overTargets),s=this.createPointerEvent(t,"pointerout",n);this.dispatchEvent(s),i&&this.dispatchEvent(s,"mouseout");let a=this.createPointerEvent(t,"pointerleave",n);for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),i&&this.notifyTarget(a,"mouseleave"),a.target=a.target.parent;r.overTargets=null,this.freeEvent(s),this.freeEvent(a)}this.cursor=null}mapPointerUp(t){if(!(t instanceof Fe)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=performance.now(),i=this.createPointerEvent(t);if(this.dispatchEvent(i,"pointerup"),i.pointerType==="touch")this.dispatchEvent(i,"touchend");else if(i.pointerType==="mouse"||i.pointerType==="pen"){let c=i.button===2;this.dispatchEvent(i,c?"rightup":"mouseup")}let n=this.trackingData(t.pointerId),s=this.findMountedTarget(n.pressTargetsByButton[t.button]),a=s;if(s&&!i.composedPath().includes(s)){let c=s;for(;c&&!i.composedPath().includes(c);){if(i.currentTarget=c,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch")this.notifyTarget(i,"touchendoutside");else if(i.pointerType==="mouse"||i.pointerType==="pen"){let f=i.button===2;this.notifyTarget(i,f?"rightupoutside":"mouseupoutside")}c=c.parent}delete n.pressTargetsByButton[t.button],a=c}if(a){let c=this.clonePointerEvent(i,"click");c.target=a,c.path=null,n.clicksByButton[t.button]||(n.clicksByButton[t.button]={clickCount:0,target:c.target,timeStamp:r});let f=n.clicksByButton[t.button];if(f.target===c.target&&r-f.timeStamp<200?++f.clickCount:f.clickCount=1,f.target=c.target,f.timeStamp=r,c.detail=f.clickCount,c.pointerType==="mouse"){let p=c.button===2;this.dispatchEvent(c,p?"rightclick":"click")}else c.pointerType==="touch"&&this.dispatchEvent(c,"tap");this.dispatchEvent(c,"pointertap"),this.freeEvent(c)}this.freeEvent(i)}mapPointerUpOutside(t){if(!(t instanceof Fe)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.trackingData(t.pointerId),i=this.findMountedTarget(r.pressTargetsByButton[t.button]),n=this.createPointerEvent(t);if(i){let s=i;for(;s;)n.currentTarget=s,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch"?this.notifyTarget(n,"touchendoutside"):(n.pointerType==="mouse"||n.pointerType==="pen")&&this.notifyTarget(n,n.button===2?"rightupoutside":"mouseupoutside"),s=s.parent;delete r.pressTargetsByButton[t.button]}this.freeEvent(n)}mapWheel(t){if(!(t instanceof jr)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}let r=this.createWheelEvent(t);this.dispatchEvent(r),this.freeEvent(r)}findMountedTarget(t){if(!t)return null;let r=t[0];for(let i=1;i<t.length&&t[i].parent===r;i++)r=t[i];return r}createPointerEvent(t,r,i){let n=this.allocateEvent(Fe);return this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.nativeEvent=t.nativeEvent,n.originalEvent=t,n.target=i??this.hitTest(n.global.x,n.global.y)??this._hitElements[0],typeof r=="string"&&(n.type=r),n}createWheelEvent(t){let r=this.allocateEvent(jr);return this.copyWheelData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=this.hitTest(r.global.x,r.global.y),r}clonePointerEvent(t,r){let i=this.allocateEvent(Fe);return i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice(),i.type=r??i.type,i}copyWheelData(t,r){r.deltaMode=t.deltaMode,r.deltaX=t.deltaX,r.deltaY=t.deltaY,r.deltaZ=t.deltaZ}copyPointerData(t,r){t instanceof Fe&&r instanceof Fe&&(r.pointerId=t.pointerId,r.width=t.width,r.height=t.height,r.isPrimary=t.isPrimary,r.pointerType=t.pointerType,r.pressure=t.pressure,r.tangentialPressure=t.tangentialPressure,r.tiltX=t.tiltX,r.tiltY=t.tiltY,r.twist=t.twist)}copyMouseData(t,r){t instanceof li&&r instanceof li&&(r.altKey=t.altKey,r.button=t.button,r.buttons=t.buttons,r.client.copyFrom(t.client),r.ctrlKey=t.ctrlKey,r.metaKey=t.metaKey,r.movement.copyFrom(t.movement),r.screen.copyFrom(t.screen),r.shiftKey=t.shiftKey,r.global.copyFrom(t.global))}copyData(t,r){r.isTrusted=t.isTrusted,r.srcElement=t.srcElement,r.timeStamp=performance.now(),r.type=t.type,r.detail=t.detail,r.view=t.view,r.which=t.which,r.layer.copyFrom(t.layer),r.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);let r=this.eventPool.get(t).pop()||new t(this);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=null,r.target=null,r}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");let r=t.constructor;this.eventPool.has(r)||this.eventPool.set(r,[]),this.eventPool.get(r).push(t)}notifyListeners(t,r){let i=t.currentTarget._events[r];if(i&&t.currentTarget.isInteractive())if("fn"in i)i.once&&t.currentTarget.removeListener(r,i.fn,void 0,!0),i.fn.call(i.context,t);else for(let n=0,s=i.length;n<s&&!t.propagationImmediatelyStopped;n++)i[n].once&&t.currentTarget.removeListener(r,i[n].fn,void 0,!0),i[n].fn.call(i[n].context,t)}};var UA=1,kA={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Af=class{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new wa(null),Mi.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Fe(null),this.rootWheelEvent=new jr(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...Af.defaultEventFeatures},{set:(t,r,i)=>(r==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=i),t[r]=i,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){let{view:t,resolution:r}=this.renderer;this.setTargetElement(t),this.resolution=r,Af._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===e)return;this.currentCursor=e;let r=this.cursorStyles[e];if(r)switch(typeof r){case"string":t&&(this.domElement.style.cursor=r);break;case"function":r(e);break;case"object":t&&Object.assign(this.domElement.style,r);break}else t&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;let t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let r=0,i=t.length;r<i;r++){let n=t[r],s=this.bootstrapEvent(this.rootPointerEvent,n);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;Mi.pointerMoved();let t=this.normalizeToPointerData(e);for(let r=0,i=t.length;r<i;r++){let n=this.bootstrapEvent(this.rootPointerEvent,t[r]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);let r=t!==this.domElement?"outside":"",i=this.normalizeToPointerData(e);for(let n=0,s=i.length;n<s;n++){let a=this.bootstrapEvent(this.rootPointerEvent,i[n]);a.type+=r,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;let t=this.normalizeToPointerData(e);for(let r=0,i=t.length;r<i;r++){let n=this.bootstrapEvent(this.rootPointerEvent,t[r]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;let t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this.removeEvents(),this.domElement=e,Mi.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Mi.addTickerListener();let e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Mi.removeTickerListener();let e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,t,r){let i;this.domElement.parentElement?i=this.domElement.getBoundingClientRect():i={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};let n=1/this.resolution;e.x=(t-i.left)*(this.domElement.width/i.width)*n,e.y=(r-i.top)*(this.domElement.height/i.height)*n}normalizeToPointerData(e){let t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let r=0,i=e.changedTouches.length;r<i;r++){let n=e.changedTouches[r];typeof n.button>"u"&&(n.button=0),typeof n.buttons>"u"&&(n.buttons=1),typeof n.isPrimary>"u"&&(n.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof n.width>"u"&&(n.width=n.radiusX||1),typeof n.height>"u"&&(n.height=n.radiusY||1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="touch"),typeof n.pointerId>"u"&&(n.pointerId=n.identifier||0),typeof n.pressure>"u"&&(n.pressure=n.force||.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),typeof n.layerX>"u"&&(n.layerX=n.offsetX=n.clientX),typeof n.layerY>"u"&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,n.type=e.type,t.push(n)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){let r=e;typeof r.isPrimary>"u"&&(r.isPrimary=!0),typeof r.width>"u"&&(r.width=1),typeof r.height>"u"&&(r.height=1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="mouse"),typeof r.pointerId>"u"&&(r.pointerId=UA),typeof r.pressure>"u"&&(r.pressure=.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),r.isNormalized=!0,t.push(r)}else t.push(e);return t}normalizeWheelEvent(e){let t=this.rootWheelEvent;return this.transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=kA[e.type]||e.type),e}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}},Zn=Af;Zn.extension={name:"events",type:[$.RendererSystem,$.CanvasRendererSystem]};Zn.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};J.add(Zn);function lx(e){return e==="dynamic"||e==="static"}var hx={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??lx(Zn.defaultEventMode)},set interactive(e){_t("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=e,this.eventMode=e?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Zn.defaultEventMode},set eventMode(e){this._internalInteractive=lx(e),this._internalEventMode=e},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(e,t,r){let i=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,n=typeof t=="function"?void 0:t;e=i?`${e}capture`:e,t=typeof t=="function"?t:t.handleEvent,this.on(e,t,n)},removeEventListener(e,t,r){let i=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,n=typeof t=="function"?void 0:t;e=i?`${e}capture`:e,t=typeof t=="function"?t:t.handleEvent,this.off(e,t,n)},dispatchEvent(e){if(!(e instanceof Yr))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return e.defaultPrevented=!1,e.path=null,e.target=this,e.manager.dispatchEvent(e),!e.defaultPrevented}};Nt.mixin(hx);var Cf={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Nt.mixin(Cf);var GA=9,Ih=100,HA=0,VA=0,ux=2,cx=1,WA=-1e3,XA=-1e3,zA=2,Sa=class{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(rt.isMobile.tablet||rt.isMobile.phone)&&this.createTouchHook();let r=document.createElement("div");r.style.width=`${Ih}px`,r.style.height=`${Ih}px`,r.style.position="absolute",r.style.top=`${HA}px`,r.style.left=`${VA}px`,r.style.zIndex=ux.toString(),this.div=r,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){let t=document.createElement("button");t.style.width=`${cx}px`,t.style.height=`${cx}px`,t.style.position="absolute",t.style.top=`${WA}px`,t.style.left=`${XA}px`,t.style.zIndex=zA.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);let r=t.children;if(r)for(let i=0;i<r.length;i++)this.updateAccessibleObjects(r[i])}update(){let t=performance.now();if(rt.isMobile.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);let{x:r,y:i,width:n,height:s}=this.renderer.view.getBoundingClientRect(),{width:a,height:c,resolution:f}=this.renderer,p=n/a*f,l=s/c*f,h=this.div;h.style.left=`${r}px`,h.style.top=`${i}px`,h.style.width=`${a}px`,h.style.height=`${c}px`;for(let d=0;d<this.children.length;d++){let m=this.children[d];if(m.renderId!==this.renderId)m._accessibleActive=!1,rt.removeItems(this.children,d,1),this.div.removeChild(m._accessibleDiv),this.pool.push(m._accessibleDiv),m._accessibleDiv=null,d--;else{h=m._accessibleDiv;let _=m.hitArea,x=m.worldTransform;m.hitArea?(h.style.left=`${(x.tx+_.x*x.a)*p}px`,h.style.top=`${(x.ty+_.y*x.d)*l}px`,h.style.width=`${_.width*x.a*p}px`,h.style.height=`${_.height*x.d*l}px`):(_=m.getBounds(),this.capHitArea(_),h.style.left=`${_.x*p}px`,h.style.top=`${_.y*l}px`,h.style.width=`${_.width*p}px`,h.style.height=`${_.height*l}px`,h.title!==m.accessibleTitle&&m.accessibleTitle!==null&&(h.title=m.accessibleTitle),h.getAttribute("aria-label")!==m.accessibleHint&&m.accessibleHint!==null&&h.setAttribute("aria-label",m.accessibleHint)),(m.accessibleTitle!==h.title||m.tabIndex!==h.tabIndex)&&(h.title=m.accessibleTitle,h.tabIndex=m.tabIndex,this.debug&&this.updateDebugHTML(h))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);let{width:r,height:i}=this.renderer;t.x+t.width>r&&(t.width=r-t.x),t.y+t.height>i&&(t.height=i-t.y)}addChild(t){let r=this.pool.pop();r||(r=document.createElement("button"),r.style.width=`${Ih}px`,r.style.height=`${Ih}px`,r.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",r.style.position="absolute",r.style.zIndex=ux.toString(),r.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?r.setAttribute("aria-live","off"):r.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?r.setAttribute("aria-relevant","additions"):r.setAttribute("aria-relevant","text"),r.addEventListener("click",this._onClick.bind(this)),r.addEventListener("focus",this._onFocus.bind(this)),r.addEventListener("focusout",this._onFocusOut.bind(this))),r.style.pointerEvents=t.accessiblePointerEvents,r.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?r.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(r.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&r.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(r),t._accessibleActive=!0,t._accessibleDiv=r,r.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,r){let{displayObject:i}=t.target,n=this.renderer.events.rootBoundary,s=Object.assign(new Yr(n),{target:i});n.rootTarget=this.renderer.lastObjectRendered,r.forEach(a=>n.dispatchEvent(s,a))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===GA&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}};Sa.extension={name:"accessibility",type:[$.RendererPlugin,$.CanvasRendererPlugin]};J.add(Sa);var Rf=class{constructor(e){this.stage=new oe,e=Object.assign({forceCanvas:!1},e),this.renderer=_f(e),Rf._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(e,t){let r=Rf._plugins.slice(0);r.reverse(),r.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}},ba=Rf;ba._plugins=[];J.handleByList($.Application,ba._plugins);var Aa=class{static init(t){Object.defineProperty(this,"resizeTo",{set(r){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let r,i;if(this._resizeTo===globalThis.window)r=globalThis.innerWidth,i=globalThis.innerHeight;else{let{clientWidth:n,clientHeight:s}=this._resizeTo;r=n,i=s}this.renderer.resize(r,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}};Aa.extension=$.Application;J.add(Aa);var fx={loader:$.LoadParser,resolver:$.ResolveParser,cache:$.CacheParser,detection:$.DetectionParser};J.handle($.Asset,e=>{let t=e.ref;Object.entries(fx).filter(([r])=>!!t[r]).forEach(([r,i])=>J.add(Object.assign(t[r],{extension:t[r].extension??i})))},e=>{let t=e.ref;Object.keys(fx).filter(r=>!!t[r]).forEach(r=>J.remove(t[r]))});var Ph=class{constructor(t,r=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(t){t.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;let t=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<r;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}};function Or(e,t){if(Array.isArray(t)){for(let r of t)if(e.startsWith(`data:${r}`))return!0;return!1}return e.startsWith(`data:${t}`)}function Ne(e,t){let r=e.split("?")[0],i=rt.path.extname(r).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}var $e=(e,t)=>(Array.isArray(e)||(e=[e]),t?e.map(r=>typeof r=="string"?t(r):r):e);var Jn=(e,t)=>{let r=t.split("?")[1];return r&&(e+=`?${r}`),e};function dx(e,t,r,i,n){let s=t[r];for(let a=0;a<s.length;a++){let c=s[a];r<t.length-1?dx(e.replace(i[r],c),t,r+1,i,n):n.push(e.replace(i[r],c))}}function Mh(e){let t=/\{(.*?)\}/g,r=e.match(t),i=[];if(r){let n=[];r.forEach(s=>{let a=s.substring(1,s.length-1).split(",");n.push(a)}),dx(e,n,0,r,i)}else i.push(e);return i}var Bi=e=>!Array.isArray(e);var If=class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){let r=this._cache.get(t);return r||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),r}set(t,r){let i=$e(t),n;for(let c=0;c<this.parsers.length;c++){let f=this.parsers[c];if(f.test(r)){n=f.getCacheableAssets(i,r);break}}n||(n={},i.forEach(c=>{n[c]=r}));let s=Object.keys(n),a={cacheKeys:s,keys:i};if(i.forEach(c=>{this._cacheMap.set(c,a)}),s.forEach(c=>{this._cache.has(c)&&this._cache.get(c)!==r&&console.warn("[Cache] already has key:",c),this._cache.set(c,n[c])}),r instanceof nt){let c=r;i.forEach(f=>{c.baseTexture!==nt.EMPTY.baseTexture&&ht.addToCache(c.baseTexture,f),nt.addToCache(c,f)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}let r=this._cacheMap.get(t);r.cacheKeys.forEach(n=>{this._cache.delete(n)}),r.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}},fn=new If;var Bh=class{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,r,i)=>(this._parsersValidated=!1,t[r]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,r){let i={promise:null,parser:null};return i.promise=(async()=>{let n=null,s=null;if(r.loadParser&&(s=this._parserHash[r.loadParser],s||console.warn(`[Assets] specified load parser "${r.loadParser}" not found while loading ${t}`)),!s){for(let a=0;a<this.parsers.length;a++){let c=this.parsers[a];if(c.load&&c.test?.(t,r,this)){s=c;break}}if(!s)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await s.load(t,r,this),i.parser=s;for(let a=0;a<this.parsers.length;a++){let c=this.parsers[a];c.parse&&c.parse&&await c.testParse?.(n,r,this)&&(n=await c.parse(n,r,this)||n,i.parser=c)}return n})(),i}async load(t,r){this._parsersValidated||this._validateParsers();let i=0,n={},s=Bi(t),a=$e(t,p=>({src:p})),c=a.length,f=a.map(async p=>{let l=rt.path.toAbsolute(p.src);if(!n[p.src])try{this.promiseCache[l]||(this.promiseCache[l]=this._getLoadPromiseAndParser(l,p)),n[p.src]=await this.promiseCache[l].promise,r&&r(++i/c)}catch(h){throw delete this.promiseCache[l],delete n[p.src],new Error(`[Loader.load] Failed to load ${l}.
${h}`)}});return await Promise.all(f),s?n[a[0].src]:n}async unload(t){let i=$e(t,n=>({src:n})).map(async n=>{let s=rt.path.toAbsolute(n.src),a=this.promiseCache[s];if(a){let c=await a.promise;a.parser?.unload?.(c,n,this),delete this.promiseCache[s]}});await Promise.all(i)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,r)=>(t[r.name]&&console.warn(`[Assets] loadParser name conflict "${r.name}"`),{...t,[r.name]:r}),{})}};var ue=(e=>(e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e))(ue||{});var $A=".json",YA="application/json",Pf={extension:{type:$.LoadParser,priority:ue.Low},name:"loadJson",test(e){return Or(e,YA)||Ne(e,$A)},async load(e){return await(await X.ADAPTER.fetch(e)).json()}};J.add(Pf);var jA=".txt",qA="text/plain",Mf={name:"loadTxt",extension:{type:$.LoadParser,priority:ue.Low},test(e){return Or(e,qA)||Ne(e,jA)},async load(e){return await(await X.ADAPTER.fetch(e)).text()}};J.add(Mf);var KA=["normal","bold","100","200","300","400","500","600","700","800","900"],ZA=[".ttf",".otf",".woff",".woff2"],JA=["font/ttf","font/otf","font/woff","font/woff2"];function Bf(e){let t=rt.path.extname(e);return rt.path.basename(e,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" ")}var Df={extension:{type:$.LoadParser,priority:ue.Low},name:"loadWebFont",test(e){return Or(e,JA)||Ne(e,ZA)},async load(e,t){let r=X.ADAPTER.getFontFaceSet();if(r){let i=[],n=t.data?.family??Bf(e),s=t.data?.weights?.filter(c=>KA.includes(c))??["normal"],a=t.data??{};for(let c=0;c<s.length;c++){let f=s[c],p=new FontFace(n,`url(${encodeURI(e)})`,{...a,weight:f});await p.load(),r.add(p),i.push(p)}return i.length===1?i[0]:i}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(e){(Array.isArray(e)?e:[e]).forEach(t=>X.ADAPTER.getFontFaceSet().delete(t))}};J.add(Df);var px=0,Of,QA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",tC={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${QA}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},eC={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`},Lf,Ff=class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{let r=URL.createObjectURL(new Blob([tC.code],{type:"application/javascript"})),i=new Worker(r);i.addEventListener("message",n=>{i.terminate(),URL.revokeObjectURL(r),t(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Of===void 0&&(Of=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<Of&&(Lf||(Lf=URL.createObjectURL(new Blob([eC.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(Lf),t.addEventListener("message",r=>{this.complete(r.data),this.returnWorker(r.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,r){await this._initWorkers();let i=new Promise((n,s)=>{this.queue.push({id:t,arguments:r,resolve:n,reject:s})});return this.next(),i}next(){if(!this.queue.length)return;let t=this.getWorker();if(!t)return;let r=this.queue.pop(),i=r.id;this.resolveHash[px]={resolve:r.resolve,reject:r.reject},t.postMessage({data:r.arguments,uuid:px++,id:i})}},Nf=new Ff;function hi(e,t,r){let i=new nt(e);return i.baseTexture.on("dispose",()=>{delete t.promiseCache[r]}),i}var rC=[".jpeg",".jpg",".png",".webp",".avif"],iC=["image/jpeg","image/png","image/webp","image/avif"];async function Uf(e){let t=await X.ADAPTER.fetch(e);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${e}: ${t.status} ${t.statusText}`);let r=await t.blob();return await createImageBitmap(r)}var Di={name:"loadTextures",extension:{type:$.LoadParser,priority:ue.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(e){return Or(e,iC)||Ne(e,rC)},async load(e,t,r){let i=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Nf.isImageBitmapSupported()?i=await Nf.loadImageBitmap(e):i=await Uf(e):i=await new Promise(s=>{i=new Image,i.crossOrigin=this.config.crossOrigin,i.src=e,i.complete?s(i):i.onload=()=>{s(i)}});let n=new ht(i,{resolution:rt.getResolutionOfUrl(e),...t.data});return n.resource.src=e,hi(n,r,e)},unload(e){e.destroy(!0)}};J.add(Di);var nC=".svg",sC="image/svg+xml",kf={extension:{type:$.LoadParser,priority:ue.High},name:"loadSVG",test(e){return Or(e,sC)||Ne(e,nC)},async testParse(e){return Pi.test(e)},async parse(e,t,r){let i=new Pi(e,t?.data?.resourceOptions),n=new ht(i,{resolution:rt.getResolutionOfUrl(e),...t?.data});n.resource.src=e;let s=hi(n,r,e);return t?.data?.resourceOptions?.autoLoad||await i.load(),s},async load(e,t){return(await X.ADAPTER.fetch(e)).text()},unload:Di.unload};J.add(kf);var Dh=class{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,r)=>`${t}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(t,r)=>r.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{let r=t;this._defaultSearchParams=Object.keys(r).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(r[i])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(t,r){let i=[];Array.isArray(r)?r.forEach(n=>{if(typeof n.name=="string"){let s=this._createBundleAssetId(t,n.name);i.push(s),this.add([n.name,s],n.srcs,n.data)}else{let s=n.name.map(a=>this._createBundleAssetId(t,a));s.forEach(a=>{i.push(a)}),this.add([...n.name,...s],n.srcs)}}):Object.keys(r).forEach(n=>{i.push(this._createBundleAssetId(t,n)),this.add([n,this._createBundleAssetId(t,n)],r[n])}),this._bundles[t]=i}add(t,r,i){let n=$e(t);n.forEach(a=>{this.hasKey(a)&&console.warn(`[Resolver] already has key: ${a} overwriting`)}),Array.isArray(r)||(typeof r=="string"?r=Mh(r):r=[r]);let s=r.map(a=>{let c=a;if(typeof a=="string"){let f=!1;for(let p=0;p<this._parsers.length;p++){let l=this._parsers[p];if(l.test(a)){c=l.parse(a),f=!0;break}}f||(c={src:a})}return c.format||(c.format=c.src.split(".").pop()),c.alias||(c.alias=n),(this._basePath||this._rootPath)&&(c.src=rt.path.toAbsolute(c.src,this._basePath,this._rootPath)),c.src=this._appendDefaultSearchParams(c.src),c.data=c.data??i,c});n.forEach(a=>{this._assetMap[a]=s})}resolveBundle(t){let r=Bi(t);t=$e(t);let i={};return t.forEach(n=>{let s=this._bundles[n];if(s){let a=this.resolve(s),c={};for(let f in a){let p=a[f];c[this._extractAssetIdFromBundle(n,f)]=p}i[n]=c}}),r?i[t[0]]:i}resolveUrl(t){let r=this.resolve(t);if(typeof t!="string"){let i={};for(let n in r)i[n]=r[n].src;return i}return r.src}resolve(t){let r=Bi(t);t=$e(t);let i={};return t.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let s=this._assetMap[n],a=this._getPreferredOrder(s),c=s[0];a?.priority.forEach(f=>{a.params[f].forEach(p=>{let l=s.filter(h=>h[f]?h[f]===p:!1);l.length&&(s=l)})}),this._resolverHash[n]=s[0]??c}else{let s=n;(this._basePath||this._rootPath)&&(s=rt.path.toAbsolute(s,this._basePath,this._rootPath)),s=this._appendDefaultSearchParams(s),this._resolverHash[n]={src:s}}i[n]=this._resolverHash[n]}),r?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let r=0;r<t.length;r++){let i=t[0],n=this._preferredOrder.find(s=>s.params.format.includes(i.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;let r=/\?/.test(t)?"&":"?";return`${t}${r}${this._defaultSearchParams}`}};var Oh=class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Dh,this.loader=new Bh,this.cache=fn,this._backgroundLoader=new Ph(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let s=t.manifest;typeof s=="string"&&(s=await this.load(s)),this.resolver.addManifest(s)}let r=t.texturePreference?.resolution??1,i=typeof r=="number"?[r]:r,n=[];if(t.texturePreference?.format){let s=t.texturePreference?.format;n=typeof s=="string"?[s]:s;for(let a of this._detections)await a.test()||(n=await a.remove(n))}else for(let s of this._detections)await s.test()&&(n=await s.add(n));this.resolver.prefer({params:{format:n,resolution:i}}),t.preferences&&this.setPreferences(t.preferences)}add(t,r,i){this.resolver.add(t,r,i)}async load(t,r){this._initialized||await this.init();let i=Bi(t),n=$e(t).map(c=>typeof c!="string"?(this.resolver.add(c.src,c),c.src):(this.resolver.hasKey(c)||this.resolver.add(c,c),c)),s=this.resolver.resolve(n),a=await this._mapLoadToResolve(s,r);return i?a[n[0]]:a}addBundle(t,r){this.resolver.addBundle(t,r)}async loadBundle(t,r){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);let n=this.resolver.resolveBundle(t),s={},a=Object.keys(n),c=0,f=0,p=()=>{r?.(++c/f)},l=a.map(h=>{let d=n[h];return f+=Object.keys(d).length,this._mapLoadToResolve(d,p).then(m=>{s[h]=m})});return await Promise.all(l),i?s[t[0]]:s}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);let r=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);let r=this.resolver.resolveBundle(t);Object.values(r).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return fn.get(t);let r={};for(let i=0;i<t.length;i++)r[i]=fn.get(t[i]);return r}async _mapLoadToResolve(t,r){let i=Object.values(t),n=Object.keys(t);this._backgroundLoader.active=!1;let s=await this.loader.load(i,r);this._backgroundLoader.active=!0;let a={};return i.forEach((c,f)=>{let p=s[c.src],l=[c.src];c.alias&&l.push(...c.alias),a[n[f]]=p,fn.set(l,p)}),a}async unload(t){this._initialized||await this.init();let r=$e(t).map(n=>typeof n!="string"?n.src:n),i=this.resolver.resolve(r);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=$e(t);let r=this.resolver.resolveBundle(t),i=Object.keys(r).map(n=>this._unloadFromResolved(r[n]));await Promise.all(i)}async _unloadFromResolved(t){let r=Object.values(t);r.forEach(i=>{fn.remove(i.src)}),await this.loader.unload(r)}get detections(){return this._detections}get preferWorkers(){return Di.config.preferWorkers}set preferWorkers(t){_t("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(i=>i in t).forEach(i=>{r.config[i]=t[i]})})}},Ca=new Oh;J.handleByList($.LoadParser,Ca.loader.parsers).handleByList($.ResolveParser,Ca.resolver.parsers).handleByList($.CacheParser,Ca.cache.parsers).handleByList($.DetectionParser,Ca.detections);var Gf={extension:$.CacheParser,test:e=>Array.isArray(e)&&e.every(t=>t instanceof nt),getCacheableAssets:(e,t)=>{let r={};return e.forEach(i=>{t.forEach((n,s)=>{r[i+(s===0?"":s+1)]=n})}),r}};J.add(Gf);var Hf={extension:{type:$.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;let e="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=await X.ADAPTER.fetch(e).then(r=>r.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async e=>[...e,"avif"],remove:async e=>e.filter(t=>t!=="avif")};J.add(Hf);var Vf={extension:{type:$.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;let e="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=await X.ADAPTER.fetch(e).then(r=>r.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async e=>[...e,"webp"],remove:async e=>e.filter(t=>t!=="webp")};J.add(Vf);var mx=["png","jpg","jpeg"],Wf={extension:{type:$.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...mx],remove:async e=>e.filter(t=>!mx.includes(t))};J.add(Wf);var Xf={extension:$.ResolveParser,test:Di.test,parse:e=>({resolution:parseFloat(X.RETINA_PREFIX.exec(e)?.[1]??"1"),format:e.split(".").pop(),src:e})};J.add(Xf);var Ye=(e=>(e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e))(Ye||{}),dn={[33776]:.5,[33777]:.5,[33778]:1,[33779]:1,[35916]:.5,[35917]:.5,[35918]:1,[35919]:1,[37488]:.5,[37489]:.5,[37490]:1,[37491]:1,[37492]:.5,[37496]:1,[37493]:.5,[37497]:1,[37494]:.5,[37495]:.5,[35840]:.5,[35842]:.5,[35841]:.25,[35843]:.25,[36196]:.5,[35986]:.5,[35986]:1,[34798]:1,[37808]:1};var Oi,ro;function gx(){ro={s3tc:Oi.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Oi.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:Oi.getExtension("WEBGL_compressed_texture_etc"),etc1:Oi.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:Oi.getExtension("WEBGL_compressed_texture_pvrtc")||Oi.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:Oi.getExtension("WEBGL_compressed_texture_atc"),astc:Oi.getExtension("WEBGL_compressed_texture_astc")}}var zf={extension:{type:$.DetectionParser,priority:2},test:async()=>{let t=X.ADAPTER.createCanvas().getContext("webgl");return t?(Oi=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async e=>{ro||gx();let t=[];for(let r in ro)ro[r]&&t.push(r);return[...t,...e]},remove:async e=>(ro||gx(),e.filter(t=>!(t in ro)))};J.add(zf);var io=class extends nr{constructor(t,r={width:1,height:1,autoLoad:!0}){let i,n;typeof t=="string"?(i=t,n=new Uint8Array):(i=null,n=t),super(n,r),this.origin=i,this.buffer=n?new en(n):null,this.origin&&r.autoLoad!==!1&&this.load(),n?.length&&(this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}async load(){let i=await(await(await fetch(this.origin)).blob()).arrayBuffer();return this.data=new Uint32Array(i),this.buffer=new en(i),this.loaded=!0,this.onBlobLoaded(i),this.update(),this}};var Tr=class extends io{constructor(t,r){super(t,r),this.format=r.format,this.levels=r.levels||1,this._width=r.width,this._height=r.height,this._extension=Tr._formatToExtension(this.format),(r.levelBuffers||this.buffer)&&(this._levelBuffers=r.levelBuffers||Tr._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,r,i){let n=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let a=0,c=this.levels;a<c;a++){let{levelID:f,levelWidth:p,levelHeight:l,levelBuffer:h}=this._levelBuffers[a];n.compressedTexImage2D(n.TEXTURE_2D,f,this.format,p,l,0,h)}return!0}onBlobLoaded(){this._levelBuffers=Tr._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,r,i,n,s,a,c){let f=new Array(i),p=t.byteOffset,l=a,h=c,d=l+n-1&~(n-1),m=h+s-1&~(s-1),_=d*m*dn[r];for(let x=0;x<i;x++)f[x]={levelID:x,levelWidth:i>1?l:d,levelHeight:i>1?h:m,levelBuffer:new Uint8Array(t.buffer,p,_)},p+=_,l=l>>1||1,h=h>>1||1,d=l+n-1&~(n-1),m=h+s-1&~(s-1),_=d*m*dn[r];return f}};var $f=4,Lh=124,oC=32,_x=20,aC=542327876,Fh={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},lC={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},Nh={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4};var hC=1,uC=2,cC=4,fC=64,dC=512,pC=131072,mC=827611204,gC=861165636,_C=894720068,xC=808540228,vC=4,yC={[mC]:Ye.COMPRESSED_RGBA_S3TC_DXT1_EXT,[gC]:Ye.COMPRESSED_RGBA_S3TC_DXT3_EXT,[_C]:Ye.COMPRESSED_RGBA_S3TC_DXT5_EXT},TC={[70]:Ye.COMPRESSED_RGBA_S3TC_DXT1_EXT,[71]:Ye.COMPRESSED_RGBA_S3TC_DXT1_EXT,[73]:Ye.COMPRESSED_RGBA_S3TC_DXT3_EXT,[74]:Ye.COMPRESSED_RGBA_S3TC_DXT3_EXT,[76]:Ye.COMPRESSED_RGBA_S3TC_DXT5_EXT,[77]:Ye.COMPRESSED_RGBA_S3TC_DXT5_EXT,[72]:Ye.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,[75]:Ye.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,[78]:Ye.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function Uh(e){let t=new Uint32Array(e);if(t[0]!==aC)throw new Error("Invalid DDS file magic word");let i=new Uint32Array(e,0,Lh/Uint32Array.BYTES_PER_ELEMENT),n=i[Fh.HEIGHT],s=i[Fh.WIDTH],a=i[Fh.MIPMAP_COUNT],c=new Uint32Array(e,Fh.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,oC/Uint32Array.BYTES_PER_ELEMENT),f=c[hC];if(f&cC){let p=c[lC.FOURCC];if(p!==xC){let y=yC[p],E=$f+Lh,R=new Uint8Array(e,E);return[new Tr(R,{format:y,width:s,height:n,levels:a})]}let l=$f+Lh,h=new Uint32Array(t.buffer,l,_x/Uint32Array.BYTES_PER_ELEMENT),d=h[Nh.DXGI_FORMAT],m=h[Nh.RESOURCE_DIMENSION],_=h[Nh.MISC_FLAG],x=h[Nh.ARRAY_SIZE],T=TC[d];if(T===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${d}`);if(_===vC)throw new Error("DDSParser does not support cubemap textures");if(m===6)throw new Error("DDSParser does not supported 3D texture data");let S=new Array,w=$f+Lh+_x;if(x===1)S.push(new Uint8Array(e,w));else{let y=dn[T],E=0,R=s,C=n;for(let M=0;M<a;M++){let B=Math.max(1,R+3&-4),L=Math.max(1,C+3&-4),O=B*L*y;E+=O,R=R>>>1,C=C>>>1}let P=w;for(let M=0;M<x;M++)S.push(new Uint8Array(e,P,E)),P+=E}return S.map(y=>new Tr(y,{format:T,width:s,height:n,levels:a}))}throw f&fC?new Error("DDSParser does not support uncompressed texture data."):f&dC?new Error("DDSParser does not supported YUV uncompressed texture data."):f&pC?new Error("DDSParser does not support single-channel (lumninance) texture data!"):f&uC?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}var xx=[171,75,84,88,32,49,49,187,13,10,26,10],EC=67305985,qr={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Yf=64,kh={[lt.UNSIGNED_BYTE]:1,[lt.UNSIGNED_SHORT]:2,[lt.INT]:4,[lt.UNSIGNED_INT]:4,[lt.FLOAT]:4,[lt.HALF_FLOAT]:8},jf={[et.RGBA]:4,[et.RGB]:3,[et.RG]:2,[et.RED]:1,[et.LUMINANCE]:1,[et.LUMINANCE_ALPHA]:2,[et.ALPHA]:1},qf={[lt.UNSIGNED_SHORT_4_4_4_4]:2,[lt.UNSIGNED_SHORT_5_5_5_1]:2,[lt.UNSIGNED_SHORT_5_6_5]:2};function Gh(e,t,r=!1){let i=new DataView(t);if(!wC(e,i))return null;let n=i.getUint32(qr.ENDIANNESS,!0)===EC,s=i.getUint32(qr.GL_TYPE,n),a=i.getUint32(qr.GL_FORMAT,n),c=i.getUint32(qr.GL_INTERNAL_FORMAT,n),f=i.getUint32(qr.PIXEL_WIDTH,n),p=i.getUint32(qr.PIXEL_HEIGHT,n)||1,l=i.getUint32(qr.PIXEL_DEPTH,n)||1,h=i.getUint32(qr.NUMBER_OF_ARRAY_ELEMENTS,n)||1,d=i.getUint32(qr.NUMBER_OF_FACES,n),m=i.getUint32(qr.NUMBER_OF_MIPMAP_LEVELS,n),_=i.getUint32(qr.BYTES_OF_KEY_VALUE_DATA,n);if(p===0||l!==1)throw new Error("Only 2D textures are supported");if(d!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(h!==1)throw new Error("WebGL does not support array textures");let x=4,T=4,S=f+3&-4,w=p+3&-4,y=new Array(h),E=f*p;s===0&&(E=S*w);let R;if(s!==0?kh[s]?R=kh[s]*jf[a]:R=qf[s]:R=dn[c],R===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");let C=r?bC(i,_,n):null,M=E*R,B=f,L=p,O=S,H=w,N=Yf+_;for(let G=0;G<m;G++){let Z=i.getUint32(N,n),q=N+4;for(let it=0;it<h;it++){let Y=y[it];Y||(Y=y[it]=new Array(m)),Y[G]={levelID:G,levelWidth:m>1||s!==0?B:O,levelHeight:m>1||s!==0?L:H,levelBuffer:new Uint8Array(t,q,M)},q+=M}N+=Z+4,N=N%4!==0?N+4-N%4:N,B=B>>1||1,L=L>>1||1,O=B+x-1&~(x-1),H=L+T-1&~(T-1),M=O*H*R}return s!==0?{uncompressed:y.map(G=>{let Z=G[0].levelBuffer,q=!1;return s===lt.FLOAT?Z=new Float32Array(G[0].levelBuffer.buffer,G[0].levelBuffer.byteOffset,G[0].levelBuffer.byteLength/4):s===lt.UNSIGNED_INT?(q=!0,Z=new Uint32Array(G[0].levelBuffer.buffer,G[0].levelBuffer.byteOffset,G[0].levelBuffer.byteLength/4)):s===lt.INT&&(q=!0,Z=new Int32Array(G[0].levelBuffer.buffer,G[0].levelBuffer.byteOffset,G[0].levelBuffer.byteLength/4)),{resource:new nr(Z,{width:G[0].levelWidth,height:G[0].levelHeight}),type:s,format:q?SC(a):a}}),kvData:C}:{compressed:y.map(G=>new Tr(null,{format:c,width:f,height:p,levels:m,levelBuffers:G})),kvData:C}}function wC(e,t){for(let r=0;r<xx.length;r++)if(t.getUint8(r)!==xx[r])return console.error(`${e} is not a valid *.ktx file!`),!1;return!0}function SC(e){switch(e){case et.RGBA:return et.RGBA_INTEGER;case et.RGB:return et.RGB_INTEGER;case et.RG:return et.RG_INTEGER;case et.RED:return et.RED_INTEGER;default:return e}}function bC(e,t,r){let i=new Map,n=0;for(;n<t;){let s=e.getUint32(Yf+n,r),a=Yf+n+4,c=3-(s+3)%4;if(s===0||s>t-n){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let f=0;for(;f<s&&e.getUint8(a+f)!==0;f++);if(f===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}let p=new TextDecoder().decode(new Uint8Array(e.buffer,a,f)),l=new DataView(e.buffer,a+f+1,s-f-1);i.set(p,l),n+=4+s+c}return i}var Kf={extension:{type:$.LoadParser,priority:ue.High},name:"loadDDS",test(e){return Ne(e,".dds")},async load(e,t,r){let n=await(await X.ADAPTER.fetch(e)).arrayBuffer(),a=Uh(n).map(c=>{let f=new ht(c,{mipmap:Ce.OFF,alphaMode:fe.NO_PREMULTIPLIED_ALPHA,resolution:rt.getResolutionOfUrl(e),...t.data});return hi(f,r,e)});return a.length===1?a[0]:a},unload(e){Array.isArray(e)?e.forEach(t=>t.destroy(!0)):e.destroy(!0)}};J.add(Kf);var Zf={extension:{type:$.LoadParser,priority:ue.High},name:"loadKTX",test(e){return Ne(e,".ktx")},async load(e,t,r){let n=await(await X.ADAPTER.fetch(e)).arrayBuffer(),{compressed:s,uncompressed:a,kvData:c}=Gh(e,n),f=s??a,p={mipmap:Ce.OFF,alphaMode:fe.NO_PREMULTIPLIED_ALPHA,resolution:rt.getResolutionOfUrl(e),...t.data},l=f.map(h=>{f===a&&Object.assign(p,{type:h.type,format:h.format});let d=new ht(h,p);return d.ktxKeyValueData=c,hi(d,r,e)});return l.length===1?l[0]:l},unload(e){Array.isArray(e)?e.forEach(t=>t.destroy(!0)):e.destroy(!0)}};J.add(Zf);var Jf={extension:$.ResolveParser,test:e=>{let r=e.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(r)},parse:e=>{if(e.split("?")[0].split(".").pop()==="ktx"){let i=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(i.some(n=>e.endsWith(n)))return{resolution:parseFloat(X.RETINA_PREFIX.exec(e)?.[1]??"1"),format:i.find(n=>e.endsWith(n)),src:e}}return{resolution:parseFloat(X.RETINA_PREFIX.exec(e)?.[1]??"1"),format:e.split(".").pop(),src:e}}};J.add(Jf);var AC=new ct,CC=4,Qf=class{constructor(e){this.renderer=e}async image(e,t,r){let i=new Image;return i.src=await this.base64(e,t,r),i}async base64(e,t,r){let i=this.canvas(e);if(i.toDataURL!==void 0)return i.toDataURL(t,r);if(i.convertToBlob!==void 0){let n=await i.convertToBlob({type:t,quality:r});return await new Promise(s=>{let a=new FileReader;a.onload=()=>s(a.result),a.readAsDataURL(n)})}throw new Error("Extract.base64() requires ICanvas.toDataURL or ICanvas.convertToBlob to be implemented")}canvas(e,t){let{pixels:r,width:i,height:n,flipY:s}=this._rawPixels(e,t),a=new rt.CanvasRenderTarget(i,n,1),c=a.context.getImageData(0,0,i,n);if(Qf.arrayPostDivide(r,c.data),a.context.putImageData(c,0,0),s){let f=new rt.CanvasRenderTarget(a.width,a.height,1);f.context.scale(1,-1),f.context.drawImage(a.canvas,0,-n),a.destroy(),a=f}return a.canvas}pixels(e,t){let{pixels:r}=this._rawPixels(e,t);return Qf.arrayPostDivide(r,r),r}_rawPixels(e,t){let r=this.renderer;if(!r)throw new Error("The Extract has already been destroyed");let i,n=!1,s,a=!1;if(e)if(e instanceof ze)s=e;else{let h=r.context.webGLVersion>=2?r.multisample:Ft.NONE;if(s=r.generateTexture(e,{multisample:h}),h!==Ft.NONE){let d=ze.create({width:s.width,height:s.height});r.framebuffer.bind(s.framebuffer),r.framebuffer.blit(d.framebuffer),r.framebuffer.bind(),s.destroy(!0),s=d}a=!0}s?(i=s.baseTexture.resolution,t=t??s.frame,n=!1,r.renderTexture.bind(s)):(i=r.resolution,t||(t=AC,t.width=r.width,t.height=r.height),n=!0,r.renderTexture.bind());let c=Math.round(t.width*i),f=Math.round(t.height*i),p=new Uint8Array(CC*c*f),l=r.gl;return l.readPixels(Math.round(t.x*i),Math.round(t.y*i),c,f,l.RGBA,l.UNSIGNED_BYTE,p),a&&s?.destroy(!0),{pixels:p,width:c,height:f,flipY:n}}destroy(){this.renderer=null}static arrayPostDivide(e,t){for(let r=0;r<e.length;r+=4){let i=t[r+3]=e[r+3];i!==0?(t[r]=Math.round(Math.min(e[r]*255/i,255)),t[r+1]=Math.round(Math.min(e[r+1]*255/i,255)),t[r+2]=Math.round(Math.min(e[r+2]*255/i,255))):(t[r]=e[r],t[r+1]=e[r+1],t[r+2]=e[r+2])}}},td=Qf;td.extension={name:"extract",type:$.RendererSystem};J.add(td);var pn={build(e){let t=e.points,r,i,n,s,a,c;if(e.type===Yt.CIRC){let _=e.shape;r=_.x,i=_.y,a=c=_.radius,n=s=0}else if(e.type===Yt.ELIP){let _=e.shape;r=_.x,i=_.y,a=_.width,c=_.height,n=s=0}else{let _=e.shape,x=_.width/2,T=_.height/2;r=_.x+x,i=_.y+T,a=c=Math.max(0,Math.min(_.radius,Math.min(x,T))),n=x-a,s=T-c}if(!(a>=0&&c>=0&&n>=0&&s>=0)){t.length=0;return}let f=Math.ceil(2.3*Math.sqrt(a+c)),p=f*8+(n?4:0)+(s?4:0);if(t.length=p,p===0)return;if(f===0){t.length=8,t[0]=t[6]=r+n,t[1]=t[3]=i+s,t[2]=t[4]=r-n,t[5]=t[7]=i-s;return}let l=0,h=f*4+(n?2:0)+2,d=h,m=p;{let _=n+a,x=s,T=r+_,S=r-_,w=i+x;if(t[l++]=T,t[l++]=w,t[--h]=w,t[--h]=S,s){let y=i-x;t[d++]=S,t[d++]=y,t[--m]=y,t[--m]=T}}for(let _=1;_<f;_++){let x=Math.PI/2*(_/f),T=n+Math.cos(x)*a,S=s+Math.sin(x)*c,w=r+T,y=r-T,E=i+S,R=i-S;t[l++]=w,t[l++]=E,t[--h]=E,t[--h]=y,t[d++]=y,t[d++]=R,t[--m]=R,t[--m]=w}{let _=n,x=s+c,T=r+_,S=r-_,w=i+x,y=i-x;t[l++]=T,t[l++]=w,t[--m]=y,t[--m]=T,n&&(t[l++]=S,t[l++]=w,t[--m]=y,t[--m]=S)}},triangulate(e,t){let r=e.points,i=t.points,n=t.indices;if(r.length===0)return;let s=i.length/2,a=s,c,f;if(e.type!==Yt.RREC){let l=e.shape;c=l.x,f=l.y}else{let l=e.shape;c=l.x+l.width/2,f=l.y+l.height/2}let p=e.matrix;i.push(e.matrix?p.a*c+p.c*f+p.tx:c,e.matrix?p.b*c+p.d*f+p.ty:f),s++,i.push(r[0],r[1]);for(let l=2;l<r.length;l+=2)i.push(r[l],r[l+1]),n.push(s++,a,s);n.push(a+1,a,s)}};function vx(e,t=!1){let r=e.length;if(r<6)return;let i=0;for(let n=0,s=e[r-2],a=e[r-1];n<r;n+=2){let c=e[n],f=e[n+1];i+=(c-s)*(f+a),s=c,a=f}if(!t&&i>0||t&&i<=0){let n=r/2;for(let s=n+n%2;s<r;s+=2){let a=r-s-2,c=r-s-1,f=s,p=s+1;[e[a],e[f]]=[e[f],e[a]],[e[c],e[p]]=[e[p],e[c]]}}}var no={build(e){e.points=e.shape.points.slice()},triangulate(e,t){let r=e.points,i=e.holes,n=t.points,s=t.indices;if(r.length>=6){vx(r,!1);let a=[];for(let p=0;p<i.length;p++){let l=i[p];vx(l.points,!0),a.push(r.length/2),r=r.concat(l.points)}let c=rt.earcut(r,a,2);if(!c)return;let f=n.length/2;for(let p=0;p<c.length;p+=3)s.push(c[p]+f),s.push(c[p+1]+f),s.push(c[p+2]+f);for(let p=0;p<r.length;p++)n.push(r[p])}}};var Hh={build(e){let t=e.shape,r=t.x,i=t.y,n=t.width,s=t.height,a=e.points;a.length=0,n>=0&&s>=0&&a.push(r,i,r+n,i,r+n,i+s,r,i+s)},triangulate(e,t){let r=e.points,i=t.points;if(r.length===0)return;let n=i.length/2;i.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),t.indices.push(n,n+1,n+2,n+1,n+2,n+3)}};var Vh={build(e){pn.build(e)},triangulate(e,t){pn.triangulate(e,t)}};var je=(e=>(e.MITER="miter",e.BEVEL="bevel",e.ROUND="round",e))(je||{}),Kr=(e=>(e.BUTT="butt",e.ROUND="round",e.SQUARE="square",e))(Kr||{}),Lr={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(e,t=20){if(!this.adaptive||!e||isNaN(e))return t;let r=Math.ceil(e/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}};var Qn=class{static curveTo(t,r,i,n,s,a){let c=a[a.length-2],p=a[a.length-1]-r,l=c-t,h=n-r,d=i-t,m=Math.abs(p*d-l*h);if(m<1e-8||s===0)return(a[a.length-2]!==t||a[a.length-1]!==r)&&a.push(t,r),null;let _=p*p+l*l,x=h*h+d*d,T=p*h+l*d,S=s*Math.sqrt(_)/m,w=s*Math.sqrt(x)/m,y=S*T/_,E=w*T/x,R=S*d+w*l,C=S*h+w*p,P=l*(w+y),M=p*(w+y),B=d*(S+E),L=h*(S+E),O=Math.atan2(M-C,P-R),H=Math.atan2(L-C,B-R);return{cx:R+t,cy:C+r,radius:s,startAngle:O,endAngle:H,anticlockwise:l*h>d*p}}static arc(t,r,i,n,s,a,c,f,p){let l=c-a,h=Lr._segmentsCount(Math.abs(l)*s,Math.ceil(Math.abs(l)/sn)*40),d=l/(h*2),m=d*2,_=Math.cos(d),x=Math.sin(d),T=h-1,S=T%1/T;for(let w=0;w<=T;++w){let y=w+S*w,E=d+a+m*y,R=Math.cos(E),C=-Math.sin(E);p.push((_*R+x*C)*s+i,(_*-C+x*R)*s+n)}}};var so=class{constructor(){this.reset()}begin(t,r,i){this.reset(),this.style=t,this.start=r,this.attribStart=i}end(t,r){this.attribSize=r-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}};var mn=class{static curveLength(t,r,i,n,s,a,c,f){let l=0,h=0,d=0,m=0,_=0,x=0,T=0,S=0,w=0,y=0,E=0,R=t,C=r;for(let P=1;P<=10;++P)h=P/10,d=h*h,m=d*h,_=1-h,x=_*_,T=x*_,S=T*t+3*x*h*i+3*_*d*s+m*c,w=T*r+3*x*h*n+3*_*d*a+m*f,y=R-S,E=C-w,R=S,C=w,l+=Math.sqrt(y*y+E*E);return l}static curveTo(t,r,i,n,s,a,c){let f=c[c.length-2],p=c[c.length-1];c.length-=2;let l=Lr._segmentsCount(mn.curveLength(f,p,t,r,i,n,s,a)),h=0,d=0,m=0,_=0,x=0;c.push(f,p);for(let T=1,S=0;T<=l;++T)S=T/l,h=1-S,d=h*h,m=d*h,_=S*S,x=_*S,c.push(m*f+3*d*S*t+3*h*_*i+x*s,m*p+3*d*S*r+3*h*_*n+x*a)}};function yx(e,t,r,i,n,s,a,c){let f=e-r*n,p=t-i*n,l=e+r*s,h=t+i*s,d,m;a?(d=i,m=-r):(d=-i,m=r);let _=f+d,x=p+m,T=l+d,S=h+m;return c.push(_,x,T,S),2}function ts(e,t,r,i,n,s,a,c){let f=r-e,p=i-t,l=Math.atan2(f,p),h=Math.atan2(n-e,s-t);c&&l<h?l+=Math.PI*2:!c&&l>h&&(h+=Math.PI*2);let d=l,m=h-l,_=Math.abs(m),x=Math.sqrt(f*f+p*p),T=(15*_*Math.sqrt(x)/Math.PI>>0)+1,S=m/T;if(d+=S,c){a.push(e,t,r,i);for(let w=1,y=d;w<T;w++,y+=S)a.push(e,t,e+Math.sin(y)*x,t+Math.cos(y)*x);a.push(e,t,n,s)}else{a.push(r,i,e,t);for(let w=1,y=d;w<T;w++,y+=S)a.push(e+Math.sin(y)*x,t+Math.cos(y)*x,e,t);a.push(n,s,e,t)}return T*2}function RC(e,t){let r=e.shape,i=e.points||r.points.slice(),n=t.closePointEps;if(i.length===0)return;let s=e.lineStyle,a=new pt(i[0],i[1]),c=new pt(i[i.length-2],i[i.length-1]),f=r.type!==Yt.POLY||r.closeStroke,p=Math.abs(a.x-c.x)<n&&Math.abs(a.y-c.y)<n;if(f){i=i.slice(),p&&(i.pop(),i.pop(),c.set(i[i.length-2],i[i.length-1]));let it=(a.x+c.x)*.5,Y=(c.y+a.y)*.5;i.unshift(it,Y),i.push(it,Y)}let l=t.points,h=i.length/2,d=i.length,m=l.length/2,_=s.width/2,x=_*_,T=s.miterLimit*s.miterLimit,S=i[0],w=i[1],y=i[2],E=i[3],R=0,C=0,P=-(w-E),M=S-y,B=0,L=0,O=Math.sqrt(P*P+M*M);P/=O,M/=O,P*=_,M*=_;let H=s.alignment,N=(1-H)*2,G=H*2;f||(s.cap===Kr.ROUND?d+=ts(S-P*(N-G)*.5,w-M*(N-G)*.5,S-P*N,w-M*N,S+P*G,w+M*G,l,!0)+2:s.cap===Kr.SQUARE&&(d+=yx(S,w,P,M,N,G,!0,l))),l.push(S-P*N,w-M*N,S+P*G,w+M*G);for(let it=1;it<h-1;++it){S=i[(it-1)*2],w=i[(it-1)*2+1],y=i[it*2],E=i[it*2+1],R=i[(it+1)*2],C=i[(it+1)*2+1],P=-(w-E),M=S-y,O=Math.sqrt(P*P+M*M),P/=O,M/=O,P*=_,M*=_,B=-(E-C),L=y-R,O=Math.sqrt(B*B+L*L),B/=O,L/=O,B*=_,L*=_;let Y=y-S,Q=w-E,ot=y-R,xt=C-E,Et=Y*ot+Q*xt,Rt=Q*ot-xt*Y,Tt=Rt<0;if(Math.abs(Rt)<.001*Math.abs(Et)){l.push(y-P*N,E-M*N,y+P*G,E+M*G),Et>=0&&(s.join===je.ROUND?d+=ts(y,E,y-P*N,E-M*N,y-B*N,E-L*N,l,!1)+4:d+=2,l.push(y-B*G,E-L*G,y+B*N,E+L*N));continue}let Wt=(-P+S)*(-M+E)-(-P+y)*(-M+w),Ot=(-B+R)*(-L+E)-(-B+y)*(-L+C),te=(Y*Ot-ot*Wt)/Rt,ve=(xt*Wt-Q*Ot)/Rt,jt=(te-y)*(te-y)+(ve-E)*(ve-E),Xt=y+(te-y)*N,Kt=E+(ve-E)*N,Lt=y-(te-y)*G,Ut=E-(ve-E)*G,Jr=Math.min(Y*Y+Q*Q,ot*ot+xt*xt),Pe=Tt?N:G,bn=Jr+Pe*Pe*x,ss=jt<=bn,ar=s.join;if(ar===je.MITER&&jt/x>T&&(ar=je.BEVEL),ss)switch(ar){case je.MITER:{l.push(Xt,Kt,Lt,Ut);break}case je.BEVEL:{Tt?l.push(Xt,Kt,y+P*G,E+M*G,Xt,Kt,y+B*G,E+L*G):l.push(y-P*N,E-M*N,Lt,Ut,y-B*N,E-L*N,Lt,Ut),d+=2;break}case je.ROUND:{Tt?(l.push(Xt,Kt,y+P*G,E+M*G),d+=ts(y,E,y+P*G,E+M*G,y+B*G,E+L*G,l,!0)+4,l.push(Xt,Kt,y+B*G,E+L*G)):(l.push(y-P*N,E-M*N,Lt,Ut),d+=ts(y,E,y-P*N,E-M*N,y-B*N,E-L*N,l,!1)+4,l.push(y-B*N,E-L*N,Lt,Ut));break}}else{switch(l.push(y-P*N,E-M*N,y+P*G,E+M*G),ar){case je.MITER:{Tt?l.push(Lt,Ut,Lt,Ut):l.push(Xt,Kt,Xt,Kt),d+=2;break}case je.ROUND:{Tt?d+=ts(y,E,y+P*G,E+M*G,y+B*G,E+L*G,l,!0)+2:d+=ts(y,E,y-P*N,E-M*N,y-B*N,E-L*N,l,!1)+2;break}}l.push(y-B*N,E-L*N,y+B*G,E+L*G),d+=2}}S=i[(h-2)*2],w=i[(h-2)*2+1],y=i[(h-1)*2],E=i[(h-1)*2+1],P=-(w-E),M=S-y,O=Math.sqrt(P*P+M*M),P/=O,M/=O,P*=_,M*=_,l.push(y-P*N,E-M*N,y+P*G,E+M*G),f||(s.cap===Kr.ROUND?d+=ts(y-P*(N-G)*.5,E-M*(N-G)*.5,y-P*N,E-M*N,y+P*G,E+M*G,l,!1)+2:s.cap===Kr.SQUARE&&(d+=yx(y,E,P,M,N,G,!1,l)));let Z=t.indices,q=Lr.epsilon*Lr.epsilon;for(let it=m;it<d+m-2;++it)S=l[it*2],w=l[it*2+1],y=l[(it+1)*2],E=l[(it+1)*2+1],R=l[(it+2)*2],C=l[(it+2)*2+1],!(Math.abs(S*(E-C)+y*(C-w)+R*(w-E))<q)&&Z.push(it,it+1,it+2)}function IC(e,t){let r=0,i=e.shape,n=e.points||i.points,s=i.type!==Yt.POLY||i.closeStroke;if(n.length===0)return;let a=t.points,c=t.indices,f=n.length/2,p=a.length/2,l=p;for(a.push(n[0],n[1]),r=1;r<f;r++)a.push(n[r*2],n[r*2+1]),c.push(l,l+1),l++;s&&c.push(l,p)}function Ra(e,t){e.lineStyle.native?IC(e,t):RC(e,t)}var gn=class{static curveLength(t,r,i,n,s,a){let c=t-2*i+s,f=r-2*n+a,p=2*i-2*t,l=2*n-2*r,h=4*(c*c+f*f),d=4*(c*p+f*l),m=p*p+l*l,_=2*Math.sqrt(h+d+m),x=Math.sqrt(h),T=2*h*x,S=2*Math.sqrt(m),w=d/x;return(T*_+x*d*(_-S)+(4*m*h-d*d)*Math.log((2*x+w+_)/(w+S)))/(4*T)}static curveTo(t,r,i,n,s){let a=s[s.length-2],c=s[s.length-1],f=Lr._segmentsCount(gn.curveLength(a,c,t,r,i,n)),p=0,l=0;for(let h=1;h<=f;++h){let d=h/f;p=a+(t-a)*d,l=c+(r-c)*d,s.push(p+(t+(i-t)*d-p)*d,l+(r+(n-r)*d-l)*d)}}};var Ia={[Yt.POLY]:no,[Yt.CIRC]:pn,[Yt.ELIP]:pn,[Yt.RECT]:Hh,[Yt.RREC]:Vh},Wh=[],oo=[];var _n=class{constructor(t,r=null,i=null,n=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=i,this.fillStyle=r,this.matrix=n,this.type=t.type}clone(){return new _n(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}};var ao=new pt,Tx=class extends Fn{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new ai,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),oo.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){let t=this.batches[e];t.reset(),Wh.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,r=null,i=null){let n=new _n(e,t,r,i);return this.graphicsData.push(n),this.dirty++,this}drawHole(e,t=null){if(!this.graphicsData.length)return null;let r=new _n(e,null,null,t),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){let t=this.graphicsData;for(let r=0;r<t.length;++r){let i=t[r];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(e,ao):ao.copyFrom(e),i.shape.contains(ao.x,ao.y))){let n=!1;if(i.holes){for(let s=0;s<i.holes.length;s++)if(i.holes[s].shape.contains(ao.x,ao.y)){n=!0;break}}if(!n)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;let e=this.uvs,t=this.graphicsData,r=null,i=null;this.batches.length>0&&(r=this.batches[this.batches.length-1],i=r.style);for(let c=this.shapeIndex;c<t.length;c++){this.shapeIndex++;let f=t[c],p=f.fillStyle,l=f.lineStyle;Ia[f.type].build(f),f.matrix&&this.transformPoints(f.points,f.matrix),(p.visible||l.visible)&&this.processHoles(f.holes);for(let d=0;d<2;d++){let m=d===0?p:l;if(!m.visible)continue;let _=m.texture.baseTexture,x=this.indices.length,T=this.points.length/2;_.wrapMode=mr.REPEAT,d===0?this.processFill(f):this.processLine(f);let S=this.points.length/2-T;S!==0&&(r&&!this._compareStyles(i,m)&&(r.end(x,T),r=null),r||(r=Wh.pop()||new so,r.begin(m,x,T),this.batches.push(r),i=m),this.addUvs(this.points,e,m.texture,T,S,m.matrix))}}let n=this.indices.length,s=this.points.length/2;if(r&&r.end(n,s),this.batches.length===0){this.batchable=!0;return}let a=s>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){let r=this.graphicsData[e],i=r.fillStyle,n=r.lineStyle;if(i&&!i.texture.baseTexture.valid||n&&!n.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);let e=this.batches;for(let t=0,r=e.length;t<r;t++){let i=e[t];for(let n=0;n<i.size;n++){let s=i.start+n;this.indicesUint16[s]=this.indicesUint16[s]-i.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;let e=this.batches;for(let t=0;t<e.length;t++)if(e[t].style.native)return!1;return this.points.length<Tx.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++ht._globalBatch;for(let l=0;l<this.drawCalls.length;l++)this.drawCalls[l].texArray.clear(),oo.push(this.drawCalls[l]);this.drawCalls.length=0;let t=this.colors,r=this.textureIds,i=oo.pop();i||(i=new rn,i.texArray=new on),i.texArray.count=0,i.start=0,i.size=0,i.type=rr.TRIANGLES;let n=0,s=null,a=0,c=!1,f=rr.TRIANGLES,p=0;this.drawCalls.push(i);for(let l=0;l<this.batches.length;l++){let h=this.batches[l],d=8,m=h.style,_=m.texture.baseTexture;c!==!!m.native&&(c=!!m.native,f=c?rr.LINES:rr.TRIANGLES,s=null,n=d,e++),s!==_&&(s=_,_._batchEnabled!==e&&(n===d&&(e++,n=0,i.size>0&&(i=oo.pop(),i||(i=new rn,i.texArray=new on),this.drawCalls.push(i)),i.start=p,i.size=0,i.texArray.count=0,i.type=f),_.touched=1,_._batchEnabled=e,_._batchLocation=n,_.wrapMode=mr.REPEAT,i.texArray.elements[i.texArray.count++]=_,n++)),i.size+=h.size,p+=h.size,a=_._batchLocation,this.addColors(t,m.color,m.alpha,h.attribSize,h.attribStart),this.addTextureIds(r,a,h.attribSize,h.attribStart)}ht._globalBatch=e,this.packAttributes()}packAttributes(){let e=this.points,t=this.uvs,r=this.colors,i=this.textureIds,n=new ArrayBuffer(e.length*3*4),s=new Float32Array(n),a=new Uint32Array(n),c=0;for(let f=0;f<e.length/2;f++)s[c++]=e[f*2],s[c++]=e[f*2+1],s[c++]=t[f*2],s[c++]=t[f*2+1],a[c++]=r[f],s[c++]=i[f];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?no.triangulate(e,this):Ia[e.type].triangulate(e,this)}processLine(e){Ra(e,this);for(let t=0;t<e.holes.length;t++)Ra(e.holes[t],this)}processHoles(e){for(let t=0;t<e.length;t++){let r=e[t];Ia[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){let e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,t){for(let r=0;r<e.length/2;r++){let i=e[r*2],n=e[r*2+1];e[r*2]=t.a*i+t.c*n+t.tx,e[r*2+1]=t.b*i+t.d*n+t.ty}}addColors(e,t,r,i,n=0){let s=mt.shared.setValue(t).toLittleEndianNumber(),a=mt.shared.setValue(s).toPremultiplied(r);e.length=Math.max(e.length,n+i);for(let c=0;c<i;c++)e[n+c]=a}addTextureIds(e,t,r,i=0){e.length=Math.max(e.length,i+r);for(let n=0;n<r;n++)e[i+n]=t}addUvs(e,t,r,i,n,s=null){let a=0,c=t.length,f=r.frame;for(;a<n;){let l=e[(i+a)*2],h=e[(i+a)*2+1];if(s){let d=s.a*l+s.c*h+s.tx;h=s.b*l+s.d*h+s.ty,l=d}a++,t.push(l/f.width,h/f.height)}let p=r.baseTexture;(f.width<p.width||f.height<p.height)&&this.adjustUvs(t,r,c,n)}adjustUvs(e,t,r,i){let n=t.baseTexture,s=1e-6,a=r+i*2,c=t.frame,f=c.width/n.width,p=c.height/n.height,l=c.x/c.width,h=c.y/c.height,d=Math.floor(e[r]+s),m=Math.floor(e[r+1]+s);for(let _=r+2;_<a;_+=2)d=Math.min(d,Math.floor(e[_]+s)),m=Math.min(m,Math.floor(e[_+1]+s));l-=d,h-=m;for(let _=r;_<a;_+=2)e[_]=(e[_]+l)*f,e[_+1]=(e[_+1]+h)*p}},Xh=Tx;Xh.BATCHABLE_SIZE=100;var Li=class{constructor(){this.color=16777215,this.alpha=1,this.texture=nt.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){let t=new Li;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=nt.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}};var es=class extends Li{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Kr.BUTT,this.join=je.MITER,this.miterLimit=10}clone(){let t=new es;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}};var ed={},zh=class extends oe{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Li,this._lineStyle=new es,this._matrix=null,this._holeMode=!1,this.state=me.for2d(),this._geometry=e||new Xh,this._geometry.refCount++,this._transformID=-1,this._tintColor=new mt(16777215),this.blendMode=dt.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new zh(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,r,i=.5,n=!1){return typeof e=="number"&&(e={width:e,color:t,alpha:r,alignment:i,native:n}),this.lineTextureStyle(e)}lineTextureStyle(e){let t={width:0,texture:nt.WHITE,color:e?.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Kr.BUTT,join:je.MITER,miterLimit:10};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();let r=e.width>0&&e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:r},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){let e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new Wr,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new Wr,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);let r=this.currentPath.points,i=r[r.length-2],n=r[r.length-1];return(i!==e||n!==t)&&r.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,r,i){this._initCurve();let n=this.currentPath.points;return n.length===0&&this.moveTo(0,0),gn.curveTo(e,t,r,i,n),this}bezierCurveTo(e,t,r,i,n,s){return this._initCurve(),mn.curveTo(e,t,r,i,n,s,this.currentPath.points),this}arcTo(e,t,r,i,n){this._initCurve(e,t);let s=this.currentPath.points,a=Qn.curveTo(e,t,r,i,n,s);if(a){let{cx:c,cy:f,radius:p,startAngle:l,endAngle:h,anticlockwise:d}=a;this.arc(c,f,p,l,h,d)}return this}arc(e,t,r,i,n,s=!1){if(i===n)return this;if(!s&&n<=i?n+=sn:s&&i<=n&&(i+=sn),n-i===0)return this;let c=e+Math.cos(i)*r,f=t+Math.sin(i)*r,p=this._geometry.closePointEps,l=this.currentPath?this.currentPath.points:null;if(l){let h=Math.abs(l[l.length-2]-c),d=Math.abs(l[l.length-1]-f);h<p&&d<p||l.push(c,f)}else this.moveTo(c,f),l=this.currentPath.points;return Qn.arc(c,f,e,t,r,i,n,s,l),this}beginFill(e=0,t){return this.beginTextureFill({texture:nt.WHITE,color:e,alpha:t})}normalizeColor(e){let t=mt.shared.setValue(e.color??0);e.color=t.toNumber(),e.alpha??(e.alpha=t.alpha)}beginTextureFill(e){let t={texture:nt.WHITE,color:16777215,matrix:null};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();let r=e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:r},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,r,i){return this.drawShape(new ct(e,t,r,i))}drawRoundedRect(e,t,r,i,n){return this.drawShape(new kn(e,t,r,i,n))}drawCircle(e,t,r){return this.drawShape(new Nn(e,t,r))}drawEllipse(e,t,r,i){return this.drawShape(new Un(e,t,r,i))}drawPolygon(...e){let t,r=!0,i=e[0];i.points?(r=i.closeStroke,t=i.points):Array.isArray(e[0])?t=e[0]:t=e;let n=new Wr(t);return n.closeStroke=r,this.drawShape(n),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){let e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===Yt.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();let t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){let e=this._geometry,t=this.blendMode,r=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(e.points);for(let i=0;i<r;i++){let n=e.batches[i],s=n.style.color,a=new Float32Array(this.vertexData.buffer,n.attribStart*4*2,n.attribSize*2),c=new Float32Array(e.uvsFloat32.buffer,n.attribStart*4*2,n.attribSize*2),f=new Uint16Array(e.indicesUint16.buffer,n.start*2,n.size),p={vertexData:a,blendMode:t,indices:f,uvs:c,_batchRGB:mt.shared.setValue(s).toRgbArray(),_tintRGB:s,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[i]=p}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,r=this.batches.length;t<r;t++){let i=this.batches[t];i.worldAlpha=this.worldAlpha*i.alpha,e.plugins[this.pluginName].render(i)}}}_renderDirect(e){let t=this._resolveDirectShader(e),r=this._geometry,i=this.worldAlpha,n=t.uniforms,s=r.drawCalls;n.translationMatrix=this.transform.worldTransform,mt.shared.setValue(this._tintColor).multiply([i,i,i]).setAlpha(i).toArray(n.tint),e.shader.bind(t),e.geometry.bind(r,t),e.state.set(this.state);for(let a=0,c=s.length;a<c;a++)this._renderDrawCallDirect(e,r.drawCalls[a])}_renderDrawCallDirect(e,t){let{texArray:r,type:i,size:n,start:s}=t,a=r.count;for(let c=0;c<a;c++)e.texture.bind(r.elements[c],c);e.geometry.draw(i,n,s)}_resolveDirectShader(e){let t=this.shader,r=this.pluginName;if(!t){if(!ed[r]){let{maxTextures:i}=e.plugins[r],n=new Int32Array(i);for(let c=0;c<i;c++)n[c]=c;let s={tint:new Float32Array([1,1,1,1]),translationMatrix:new St,default:ge.from({uSamplers:n},!0)},a=e.plugins[r]._shader.program;ed[r]=new _e(a,s)}t=ed[r]}return t}_calculateBounds(){this.finishPoly();let e=this._geometry;if(!e.graphicsData.length)return;let{minX:t,minY:r,maxX:i,maxY:n}=e.bounds;this._bounds.addFrame(this.transform,t,r,i,n)}containsPoint(e){return this.worldTransform.applyInverse(e,zh._TEMP_POINT),this._geometry.containsPoint(zh._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){let t=this.batches[e];t._tintRGB=mt.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){let e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;let t=this.transform.worldTransform,r=t.a,i=t.b,n=t.c,s=t.d,a=t.tx,c=t.ty,f=this._geometry.points,p=this.vertexData,l=0;for(let h=0;h<f.length;h+=2){let d=f[h],m=f[h+1];p[l++]=r*d+n*m+a,p[l++]=s*m+i*d+c}}closePath(){let e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}},lo=zh;lo.curves=Lr;lo._TEMP_POINT=new pt;var Pa=class{constructor(t,r){this.uvBuffer=t,this.uvMatrix=r,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;let r=this.uvBuffer.data;(!this.data||this.data.length!==r.length)&&(this.data=new Float32Array(r.length)),this.uvMatrix.multiplyUvs(r,this.data),this._updateID++}};var rd=new pt,Ex=new Wr,wx=class extends oe{constructor(e,t,r,i=rr.TRIANGLES){super(),this.geometry=e,this.shader=t,this.state=r||me.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=X.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){let t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===rr.TRIANGLES&&t.length<wx.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){let t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){let t=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;let i=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[i]),e.plugins[i].render(this)}calculateVertices(){let t=this.geometry.buffers[0],r=t.data,i=t._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));let n=this.transform.worldTransform,s=n.a,a=n.b,c=n.c,f=n.d,p=n.tx,l=n.ty,h=this.vertexData;for(let d=0;d<h.length/2;d++){let m=r[d*2],_=r[d*2+1];h[d*2]=s*m+c*_+p,h[d*2+1]=a*m+f*_+l}if(this._roundPixels){let d=X.RESOLUTION;for(let m=0;m<h.length;++m)h[m]=Math.round(h[m]*d)/d}this.vertexDirty=i}calculateUvs(){let e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new Pa(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,rd);let t=this.geometry.getBuffer("aVertexPosition").data,r=Ex.points,i=this.geometry.getIndex().data,n=i.length,s=this.drawMode===4?3:1;for(let a=0;a+2<n;a+=s){let c=i[a]*2,f=i[a+1]*2,p=i[a+2]*2;if(r[0]=t[c],r[1]=t[c+1],r[2]=t[f],r[3]=t[f+1],r[4]=t[p],r[5]=t[p+1],Ex.contains(rd.x,rd.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}},xn=wx;xn.BATCHABLE_SIZE=100;var vn=class extends Oe{constructor(t,r,i){super();let n=new Ht(t),s=new Ht(r,!0),a=new Ht(i,!0,!0);this.addAttribute("aVertexPosition",n,2,!1,lt.FLOAT).addAttribute("aTextureCoord",s,2,!1,lt.FLOAT).addIndex(a),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}};var Sx=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`;var bx=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;var Fi=class extends _e{constructor(t,r){let i={uSampler:t,alpha:1,uTextureMatrix:St.IDENTITY,uColor:new Float32Array([1,1,1,1])};r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r),r.uniforms&&Object.assign(i,r.uniforms),super(r.program||Se.from(bx,Sx),i),this._colorDirty=!1,this.uvMatrix=new hn(t),this.batchable=r.program===void 0,this.pluginName=r.pluginName,this._tintColor=new mt(r.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=r.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;let r=this.texture.baseTexture.alphaMode;mt.shared.setValue(this._tintColor).premultiply(this._alpha,r).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}};var Ma=class{constructor(t,r,i){this.geometry=new Oe,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let n=0;n<t.length;++n){let s=t[n];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||lt.FLOAT,offset:s.offset},r[n]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){let t=this.geometry,r=0;this.indexBuffer=new Ht(rt.createIndicesForQuads(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let a=0;a<this.dynamicProperties.length;++a){let c=this.dynamicProperties[a];c.offset=r,r+=c.size,this.dynamicStride+=c.size}let i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new Ht(this.dynamicData,!1,!1);let n=0;this.staticStride=0;for(let a=0;a<this.staticProperties.length;++a){let c=this.staticProperties[a];c.offset=n,n+=c.size,this.staticStride+=c.size}let s=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new Ht(this.staticData,!0,!1);for(let a=0;a<this.dynamicProperties.length;++a){let c=this.dynamicProperties[a];t.addAttribute(c.attributeName,this.dynamicBuffer,0,c.type===lt.UNSIGNED_BYTE,c.type,this.dynamicStride*4,c.offset*4)}for(let a=0;a<this.staticProperties.length;++a){let c=this.staticProperties[a];t.addAttribute(c.attributeName,this.staticBuffer,0,c.type===lt.UNSIGNED_BYTE,c.type,this.staticStride*4,c.offset*4)}}uploadDynamic(t,r,i){for(let n=0;n<this.dynamicProperties.length;n++){let s=this.dynamicProperties[n];s.uploadFunction(t,r,i,s.type===lt.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,r,i){for(let n=0;n<this.staticProperties.length;n++){let s=this.staticProperties[n];s.uploadFunction(t,r,i,s.type===lt.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}};var Ax=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`;var Cx=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;var Ba=class extends Xr{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new St,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:lt.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=_e.from(Cx,Ax,{}),this.state=me.for2d()}render(t){let r=t.children,i=t._maxSize,n=t._batchSize,s=this.renderer,a=r.length;if(a===0)return;a>i&&!t.autoResize&&(a=i);let c=t._buffers;c||(c=t._buffers=this.generateBuffers(t));let f=r[0]._texture.baseTexture,p=f.alphaMode>0;this.state.blendMode=rt.correctBlendMode(t.blendMode,p),s.state.set(this.state);let l=s.gl,h=t.worldTransform.copyTo(this.tempMatrix);h.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=h.toArray(!0),this.shader.uniforms.uColor=mt.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,p).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=f,this.renderer.shader.bind(this.shader);let d=!1;for(let m=0,_=0;m<a;m+=n,_+=1){let x=a-m;x>n&&(x=n),_>=c.length&&c.push(this._generateOneMoreBuffer(t));let T=c[_];T.uploadDynamic(r,m,x);let S=t._bufferUpdateIDs[_]||0;d=d||T._updateID<S,d&&(T._updateID=t._updateID,T.uploadStatic(r,m,x)),s.geometry.bind(T.geometry),l.drawElements(l.TRIANGLES,x*6,l.UNSIGNED_SHORT,0)}}generateBuffers(t){let r=[],i=t._maxSize,n=t._batchSize,s=t._properties;for(let a=0;a<i;a+=n)r.push(new Ma(this.properties,s,n));return r}_generateOneMoreBuffer(t){let r=t._batchSize,i=t._properties;return new Ma(this.properties,i,r)}uploadVertices(t,r,i,n,s,a){let c=0,f=0,p=0,l=0;for(let h=0;h<i;++h){let d=t[r+h],m=d._texture,_=d.scale.x,x=d.scale.y,T=m.trim,S=m.orig;T?(f=T.x-d.anchor.x*S.width,c=f+T.width,l=T.y-d.anchor.y*S.height,p=l+T.height):(c=S.width*(1-d.anchor.x),f=S.width*-d.anchor.x,p=S.height*(1-d.anchor.y),l=S.height*-d.anchor.y),n[a]=f*_,n[a+1]=l*x,n[a+s]=c*_,n[a+s+1]=l*x,n[a+s*2]=c*_,n[a+s*2+1]=p*x,n[a+s*3]=f*_,n[a+s*3+1]=p*x,a+=s*4}}uploadPosition(t,r,i,n,s,a){for(let c=0;c<i;c++){let f=t[r+c].position;n[a]=f.x,n[a+1]=f.y,n[a+s]=f.x,n[a+s+1]=f.y,n[a+s*2]=f.x,n[a+s*2+1]=f.y,n[a+s*3]=f.x,n[a+s*3+1]=f.y,a+=s*4}}uploadRotation(t,r,i,n,s,a){for(let c=0;c<i;c++){let f=t[r+c].rotation;n[a]=f,n[a+s]=f,n[a+s*2]=f,n[a+s*3]=f,a+=s*4}}uploadUvs(t,r,i,n,s,a){for(let c=0;c<i;++c){let f=t[r+c]._texture._uvs;f?(n[a]=f.x0,n[a+1]=f.y0,n[a+s]=f.x1,n[a+s+1]=f.y1,n[a+s*2]=f.x2,n[a+s*2+1]=f.y2,n[a+s*3]=f.x3,n[a+s*3+1]=f.y3,a+=s*4):(n[a]=0,n[a+1]=0,n[a+s]=0,n[a+s+1]=0,n[a+s*2]=0,n[a+s*2+1]=0,n[a+s*3]=0,n[a+s*3+1]=0,a+=s*4)}}uploadTint(t,r,i,n,s,a){for(let c=0;c<i;++c){let f=t[r+c],p=mt.shared.setValue(f._tintRGB).toPremultiplied(f.alpha);n[a]=p,n[a+s]=p,n[a+s*2]=p,n[a+s*3]=p,a+=s*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}};Ba.extension={name:"particle",type:$.RendererPlugin};J.add(Ba);var yn=(e=>(e[e.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",e[e.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",e))(yn||{});var $h={willReadFrequently:!0},ft=class{static get experimentalLetterSpacingSupported(){let e=ft._experimentalLetterSpacingSupported;if(e!==void 0){let t=X.ADAPTER.getCanvasRenderingContext2D().prototype;e=ft._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,r,i,n,s,a,c,f){this.text=e,this.style=t,this.width=r,this.height=i,this.lines=n,this.lineWidths=s,this.lineHeight=a,this.maxLineWidth=c,this.fontProperties=f}static measureText(e,t,r,i=ft._canvas){r=r??t.wordWrap;let n=t.toFontString(),s=ft.measureFont(n);s.fontSize===0&&(s.fontSize=t.fontSize,s.ascent=t.fontSize);let a=i.getContext("2d",$h);a.font=n;let f=(r?ft.wordWrap(e,t,i):e).split(/(?:\r\n|\r|\n)/),p=new Array(f.length),l=0;for(let _=0;_<f.length;_++){let x=ft._measureText(f[_],t.letterSpacing,a);p[_]=x,l=Math.max(l,x)}let h=l+t.strokeThickness;t.dropShadow&&(h+=t.dropShadowDistance);let d=t.lineHeight||s.fontSize+t.strokeThickness,m=Math.max(d,s.fontSize+t.strokeThickness*2)+(f.length-1)*(d+t.leading);return t.dropShadow&&(m+=t.dropShadowDistance),new ft(e,t,h,m,f,p,d+t.leading,l,s)}static _measureText(e,t,r){let i=!1;ft.experimentalLetterSpacingSupported&&(ft.experimentalLetterSpacing?(r.letterSpacing=`${t}px`,r.textLetterSpacing=`${t}px`,i=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));let n=r.measureText(e).width;return n>0&&(i?n-=t:n+=(ft.graphemeSegmenter(e).length-1)*t),n}static wordWrap(e,t,r=ft._canvas){let i=r.getContext("2d",$h),n=0,s="",a="",c=Object.create(null),{letterSpacing:f,whiteSpace:p}=t,l=ft.collapseSpaces(p),h=ft.collapseNewlines(p),d=!l,m=t.wordWrapWidth+f,_=ft.tokenize(e);for(let x=0;x<_.length;x++){let T=_[x];if(ft.isNewline(T)){if(!h){a+=ft.addLine(s),d=!l,s="",n=0;continue}T=" "}if(l){let w=ft.isBreakingSpace(T),y=ft.isBreakingSpace(s[s.length-1]);if(w&&y)continue}let S=ft.getFromCache(T,f,c,i);if(S>m)if(s!==""&&(a+=ft.addLine(s),s="",n=0),ft.canBreakWords(T,t.breakWords)){let w=ft.wordWrapSplit(T);for(let y=0;y<w.length;y++){let E=w[y],R=E,C=1;for(;w[y+C];){let M=w[y+C];if(!ft.canBreakChars(R,M,T,y,t.breakWords))E+=M;else break;R=M,C++}y+=C-1;let P=ft.getFromCache(E,f,c,i);P+n>m&&(a+=ft.addLine(s),d=!1,s="",n=0),s+=E,n+=P}}else{s.length>0&&(a+=ft.addLine(s),s="",n=0);let w=x===_.length-1;a+=ft.addLine(T,!w),d=!1,s="",n=0}else S+n>m&&(d=!1,a+=ft.addLine(s),s="",n=0),(s.length>0||!ft.isBreakingSpace(T)||d)&&(s+=T,n+=S)}return a+=ft.addLine(s,!1),a}static addLine(e,t=!0){return e=ft.trimRight(e),e=t?`${e}
`:e,e}static getFromCache(e,t,r,i){let n=r[e];return typeof n!="number"&&(n=ft._measureText(e,t,i)+t,r[e]=n),n}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){let r=e[t];if(!ft.isBreakingSpace(r))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:ft._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:ft._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){let t=[],r="";if(typeof e!="string")return t;for(let i=0;i<e.length;i++){let n=e[i],s=e[i+1];if(ft.isBreakingSpace(n,s)||ft.isNewline(n)){r!==""&&(t.push(r),r=""),t.push(n);continue}r+=n}return r!==""&&t.push(r),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,r,i,n){return!0}static wordWrapSplit(e){return ft.graphemeSegmenter(e)}static measureFont(e){if(ft._fonts[e])return ft._fonts[e];let t={ascent:0,descent:0,fontSize:0},r=ft._canvas,i=ft._context;i.font=e;let n=ft.METRICS_STRING+ft.BASELINE_SYMBOL,s=Math.ceil(i.measureText(n).width),a=Math.ceil(i.measureText(ft.BASELINE_SYMBOL).width),c=Math.ceil(ft.HEIGHT_MULTIPLIER*a);if(a=a*ft.BASELINE_MULTIPLIER|0,s===0||c===0)return ft._fonts[e]=t,t;r.width=s,r.height=c,i.fillStyle="#f00",i.fillRect(0,0,s,c),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(n,0,a);let f=i.getImageData(0,0,s,c).data,p=f.length,l=s*4,h=0,d=0,m=!1;for(h=0;h<a;++h){for(let _=0;_<l;_+=4)if(f[d+_]!==255){m=!0;break}if(!m)d+=l;else break}for(t.ascent=a-h,d=p-l,m=!1,h=c;h>a;--h){for(let _=0;_<l;_+=4)if(f[d+_]!==255){m=!0;break}if(!m)d-=l;else break}return t.descent=h-a,t.fontSize=t.ascent+t.descent,ft._fonts[e]=t,t}static clearMetrics(e=""){e?delete ft._fonts[e]:ft._fonts={}}static get _canvas(){if(!ft.__canvas){let e;try{let t=new OffscreenCanvas(0,0);if(t.getContext("2d",$h)?.measureText)return ft.__canvas=t,t;e=X.ADAPTER.createCanvas()}catch{e=X.ADAPTER.createCanvas()}e.width=e.height=10,ft.__canvas=e}return ft.__canvas}static get _context(){return ft.__context||(ft.__context=ft._canvas.getContext("2d",$h)),ft.__context}},ce=ft;ce.METRICS_STRING="|\xC9q\xC5";ce.BASELINE_SYMBOL="M";ce.BASELINE_MULTIPLIER=1.4;ce.HEIGHT_MULTIPLIER=2;ce.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){let e=new Intl.Segmenter;return t=>[...e.segment(t)].map(r=>r.segment)}return e=>[...e]})();ce.experimentalLetterSpacing=!1;ce._fonts={};ce._newlines=[10,13];ce._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var DC=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Da=class{constructor(e){this.styleID=0,this.reset(),nd(this,e,e)}clone(){let e={};return nd(e,this,Da.defaultStyle),new Da(e)}reset(){nd(this,Da.defaultStyle,Da.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){let t=id(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){let t=id(e);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){OC(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){let t=id(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){let e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize,t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let r=t.length-1;r>=0;r--){let i=t[r].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!DC.includes(i)&&(i=`"${i}"`),t[r]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${t.join(",")}`}},qe=Da;qe.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:yn.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function id(e){let t=mt.shared;return Array.isArray(e)?e.map(r=>t.setValue(r).toHex()):t.setValue(e).toHex()}function OC(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}function nd(e,t,r){for(let i in r)Array.isArray(t[i])?e[i]=t[i].slice():e[i]=t[i]}var LC={texture:!0,children:!1,baseTexture:!0},sd=class extends Le{constructor(e,t,r){let i=!1;r||(r=X.ADAPTER.createCanvas(),i=!0),r.width=3,r.height=3;let n=nt.from(r);n.orig=new ct,n.trim=new ct,super(n),this._ownCanvas=i,this.canvas=r,this.context=r.getContext("2d",{willReadFrequently:!0}),this._resolution=sd.defaultResolution??X.RESOLUTION,this._autoResolution=sd.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return ce.experimentalLetterSpacing}static set experimentalLetterSpacing(e){rt.deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),ce.experimentalLetterSpacing=e}updateText(e){let t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();let r=this.context,i=ce.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),n=i.width,s=i.height,a=i.lines,c=i.lineHeight,f=i.lineWidths,p=i.maxLineWidth,l=i.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,n)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,s)+t.padding*2)*this._resolution),r.scale(this._resolution,this._resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.lineWidth=t.strokeThickness,r.textBaseline=t.textBaseline,r.lineJoin=t.lineJoin,r.miterLimit=t.miterLimit;let h,d,m=t.dropShadow?2:1;for(let _=0;_<m;++_){let x=t.dropShadow&&_===0,T=x?Math.ceil(Math.max(1,s)+t.padding*2):0,S=T*this._resolution;if(x){r.fillStyle="black",r.strokeStyle="black";let y=t.dropShadowColor,E=t.dropShadowBlur*this._resolution,R=t.dropShadowDistance*this._resolution;r.shadowColor=mt.shared.setValue(y).setAlpha(t.dropShadowAlpha).toRgbaString(),r.shadowBlur=E,r.shadowOffsetX=Math.cos(t.dropShadowAngle)*R,r.shadowOffsetY=Math.sin(t.dropShadowAngle)*R+S}else r.fillStyle=this._generateFillStyle(t,a,i),r.strokeStyle=t.stroke,r.shadowColor="black",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0;let w=(c-l.fontSize)/2;c-l.fontSize<0&&(w=0);for(let y=0;y<a.length;y++)h=t.strokeThickness/2,d=t.strokeThickness/2+y*c+l.ascent+w,t.align==="right"?h+=p-f[y]:t.align==="center"&&(h+=(p-f[y])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(a[y],h+t.padding,d+t.padding-T,!0),t.fill&&this.drawLetterSpacing(a[y],h+t.padding,d+t.padding-T)}this.updateTexture()}drawLetterSpacing(e,t,r,i=!1){let s=this._style.letterSpacing,a=!1;if(ce.experimentalLetterSpacingSupported&&(ce.experimentalLetterSpacing?(this.context.letterSpacing=`${s}px`,this.context.textLetterSpacing=`${s}px`,a=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),s===0||a){i?this.context.strokeText(e,t,r):this.context.fillText(e,t,r);return}let c=t,f=ce.graphemeSegmenter(e),p=this.context.measureText(e).width,l=0;for(let h=0;h<f.length;++h){let d=f[h];i?this.context.strokeText(d,c,r):this.context.fillText(d,c,r);let m="";for(let _=h+1;_<f.length;++_)m+=f[_];l=this.context.measureText(m).width,c+=p-l+s,p=l}}updateTexture(){let e=this.canvas;if(this._style.trim){let s=rt.trimCanvas(e);s.data&&(e.width=s.width,e.height=s.height,this.context.putImageData(s.data,0,0))}let t=this._texture,r=this._style,i=r.trim?0:r.padding,n=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-i,t.trim.y=-i,t.orig.width=t._frame.width-i*2,t.orig.height=t._frame.height-i*2,this._onTextureUpdate(),n.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,t,r){let i=e.fill;if(Array.isArray(i)){if(i.length===1)return i[0]}else return i;let n,s=e.dropShadow?e.dropShadowDistance:0,a=e.padding||0,c=this.canvas.width/this._resolution-s-a*2,f=this.canvas.height/this._resolution-s-a*2,p=i.slice(),l=e.fillGradientStops.slice();if(!l.length){let h=p.length+1;for(let d=1;d<h;++d)l.push(d/h)}if(p.unshift(i[0]),l.unshift(0),p.push(i[i.length-1]),l.push(1),e.fillGradientType===yn.LINEAR_VERTICAL){n=this.context.createLinearGradient(c/2,a,c/2,f+a);let h=r.fontProperties.fontSize+e.strokeThickness;for(let d=0;d<t.length;d++){let m=r.lineHeight*(d-1)+h,_=r.lineHeight*d,x=_;d>0&&m>_&&(x=(_+m)/2);let T=_+h,S=r.lineHeight*(d+1),w=T;d+1<t.length&&S<T&&(w=(T+S)/2);let y=(w-x)/f;for(let E=0;E<p.length;E++){let R=0;typeof l[E]=="number"?R=l[E]:R=E/p.length;let C=Math.min(1,Math.max(0,x/f+R*y));C=Number(C.toFixed(5)),n.addColorStop(C,p[E])}}}else{n=this.context.createLinearGradient(a,f/2,c+a,f/2);let h=p.length+1,d=1;for(let m=0;m<p.length;m++){let _;typeof l[m]=="number"?_=l[m]:_=d/h,n.addColorStop(_,p[m]),d++}}return n}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},LC,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);let t=rt.sign(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);let t=rt.sign(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof qe?this._style=e:this._style=new qe(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}},Oa=sd;Oa.defaultAutoResolution=!0;var La=class{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}};function FC(e,t){let r=!1;if(e?._textures?.length){for(let i=0;i<e._textures.length;i++)if(e._textures[i]instanceof nt){let n=e._textures[i].baseTexture;t.includes(n)||(t.push(n),r=!0)}}return r}function NC(e,t){if(e.baseTexture instanceof ht){let r=e.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function UC(e,t){if(e._texture&&e._texture instanceof nt){let r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function kC(e,t){return t instanceof Oa?(t.updateText(!0),!0):!1}function GC(e,t){if(t instanceof qe){let r=t.toFontString();return ce.measureFont(r),!0}return!1}function HC(e,t){if(e instanceof Oa){t.includes(e.style)||t.push(e.style),t.includes(e)||t.push(e);let r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function VC(e,t){return e instanceof qe?(t.includes(e)||t.push(e),!0):!1}var Rx=class{constructor(e){this.limiter=new La(Rx.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(HC),this.registerFindHook(VC),this.registerFindHook(FC),this.registerFindHook(NC),this.registerFindHook(UC),this.registerUploadHook(kC),this.registerUploadHook(GC)}upload(e){return new Promise(t=>{e&&this.add(e),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,ie.system.addOnce(this.tick,this,vr.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){let e=this.queue[0],t=!1;if(e&&!e._destroyed){for(let r=0,i=this.uploadHooks.length;r<i;r++)if(this.uploadHooks[r](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)ie.system.addOnce(this.tick,this,vr.UTILITY);else{this.ticking=!1;let e=this.completes.slice(0);this.completes.length=0;for(let t=0,r=e.length;t<r;t++)e[t]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let t=0,r=this.addHooks.length;t<r&&!this.addHooks[t](e,this.queue);t++);if(e instanceof oe)for(let t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this}destroy(){this.ticking&&ie.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}},rs=Rx;rs.uploadsPerFrame=4;Object.defineProperties(X,{UPLOADS_PER_FRAME:{get(){return rs.uploadsPerFrame},set(e){rt.deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),rs.uploadsPerFrame=e}}});function Ix(e,t){return t instanceof ht?(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0):!1}function WC(e,t){if(!(t instanceof lo))return!1;let{geometry:r}=t;t.finishPoly(),r.updateBatches();let{batches:i}=r;for(let n=0;n<i.length;n++){let{texture:s}=i[n].style;s&&Ix(e,s.baseTexture)}return r.batchable||e.geometry.bind(r,t._resolveDirectShader(e)),!0}function XC(e,t){return e instanceof lo?(t.push(e),!0):!1}var Fa=class extends rs{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(XC),this.registerUploadHook(Ix),this.registerUploadHook(WC)}};Fa.extension={name:"prepare",type:$.RendererSystem};J.add(Fa);var r7=new pt;var Px=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`;var Mx=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`;var Bx=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`;var od=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`;var Dx=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;var Yh=new St,Na=class extends Xr{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new $n,this.state=me.for2d()}contextChange(){let t=this.renderer,r={globals:t.globalUniforms};this.simpleShader=_e.from(od,Dx,r),this.shader=t.context.webGLVersion>1?_e.from(Mx,Px,r):_e.from(od,Bx,r)}render(t){let r=this.renderer,i=this.quad,n=i.vertices;n[0]=n[6]=t._width*-t.anchor.x,n[1]=n[3]=t._height*-t.anchor.y,n[2]=n[4]=t._width*(1-t.anchor.x),n[5]=n[7]=t._height*(1-t.anchor.y);let s=t.uvRespectAnchor?t.anchor.x:0,a=t.uvRespectAnchor?t.anchor.y:0;n=i.uvs,n[0]=n[6]=-s,n[1]=n[3]=-a,n[2]=n[4]=1-s,n[5]=n[7]=1-a,i.invalidate();let c=t._texture,f=c.baseTexture,p=f.alphaMode>0,l=t.tileTransform.localTransform,h=t.uvMatrix,d=f.isPowerOfTwo&&c.frame.width===f.width&&c.frame.height===f.height;d&&(f._glTextures[r.CONTEXT_UID]?d=f.wrapMode!==mr.CLAMP:f.wrapMode===mr.CLAMP&&(f.wrapMode=mr.REPEAT));let m=d?this.simpleShader:this.shader,_=c.width,x=c.height,T=t._width,S=t._height;Yh.set(l.a*_/T,l.b*_/S,l.c*x/T,l.d*x/S,l.tx/T,l.ty/S),Yh.invert(),d?Yh.prepend(h.mapCoord):(m.uniforms.uMapCoord=h.mapCoord.toArray(!0),m.uniforms.uClampFrame=h.uClampFrame,m.uniforms.uClampOffset=h.uClampOffset),m.uniforms.uTransform=Yh.toArray(!0),m.uniforms.uColor=mt.shared.setValue(t.tint).premultiply(t.worldAlpha,p).toArray(m.uniforms.uColor),m.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),m.uniforms.uSampler=c,r.shader.bind(m),r.geometry.bind(i),this.state.blendMode=rt.correctBlendMode(t.blendMode,p),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}};Na.extension={name:"tilingSprite",type:$.RendererPlugin};J.add(Na);var Ua=class{constructor(e,t,r=null){this.linkedSheets=[],this._texture=e instanceof nt?e:null,this.baseTexture=e instanceof ht?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;let i=this.baseTexture.resource;this.resolution=this._updateResolution(r||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){let{scale:t}=this.data.meta,r=rt.getResolutionOfUrl(e,null);return r===null&&(r=parseFloat(t??"1")),r!==1&&this.baseTexture.setResolution(r),r}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Ua.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e,r=Ua.BATCH_SIZE;for(;t-e<r&&t<this._frameKeys.length;){let i=this._frameKeys[t],n=this._frames[i],s=n.frame;if(s){let a=null,c=null,f=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,p=new ct(0,0,Math.floor(f.w)/this.resolution,Math.floor(f.h)/this.resolution);n.rotated?a=new ct(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.h)/this.resolution,Math.floor(s.w)/this.resolution):a=new ct(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(c=new ct(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution)),this.textures[i]=new nt(this.baseTexture,a,p,c,n.rotated?2:0,n.anchor,n.borders),nt.addToCache(this.textures[i],i)}t++}}_processAnimations(){let e=this.data.animations||{};for(let t in e){this.animations[t]=[];for(let r=0;r<e[t].length;r++){let i=e[t][r];this.animations[t].push(this.textures[i])}}}_parseComplete(){let e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Ua.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Ua.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(let t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}},ka=Ua;ka.BATCH_SIZE=1e3;var zC=["jpg","png","jpeg","avif","webp"];function Ox(e,t,r){let i={};if(e.forEach(n=>{i[n]=t}),Object.keys(t.textures).forEach(n=>{i[n]=t.textures[n]}),!r){let n=rt.path.dirname(e[0]);t.linkedSheets.forEach((s,a)=>{let c=Ox([`${n}/${t.data.meta.related_multi_packs[a]}`],s,!0);Object.assign(i,c)})}return i}var Lx={extension:$.Asset,cache:{test:e=>e instanceof ka,getCacheableAssets:(e,t)=>Ox(e,t,!1)},resolver:{test:e=>{let r=e.split("?")[0].split("."),i=r.pop(),n=r.pop();return i==="json"&&zC.includes(n)},parse:e=>{let t=e.split(".");return{resolution:parseFloat(X.RETINA_PREFIX.exec(e)?.[1]??"1"),format:t[t.length-2],src:e}}},loader:{name:"spritesheetLoader",extension:{type:$.LoadParser,priority:ue.Normal},async testParse(e,t){return rt.path.extname(t.src).toLowerCase()===".json"&&!!e.frames},async parse(e,t,r){let i=rt.path.dirname(t.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");let n=i+e.meta.image;n=Jn(n,t.src);let a=(await r.load([n]))[n],c=new ka(a.baseTexture,e,t.src);await c.parse();let f=e?.meta?.related_multi_packs;if(Array.isArray(f)){let p=[];for(let h of f){if(typeof h!="string")continue;let d=i+h;t.data?.ignoreMultiPack||(d=Jn(d,t.src),p.push(r.load({src:d,data:{ignoreMultiPack:!0}})))}let l=await Promise.all(p);c.linkedSheets=l,l.forEach(h=>{h.linkedSheets=[c].concat(c.linkedSheets.filter(d=>d!==h))})}return c},unload(e){e.destroy(!0)}}};J.add(Lx);var ui=class{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}};var ci=class{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){let r=t.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(let s in r){let a=r[s].match(/^[a-z]+/gm)[0],c=r[s].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),f={};for(let p in c){let l=c[p].split("="),h=l[0],d=l[1].replace(/"/gm,""),m=parseFloat(d),_=isNaN(m)?d:m;f[h]=_}i[a].push(f)}let n=new ui;return i.info.forEach(s=>n.info.push({face:s.face,size:parseInt(s.size,10)})),i.common.forEach(s=>n.common.push({lineHeight:parseInt(s.lineHeight,10)})),i.page.forEach(s=>n.page.push({id:parseInt(s.id,10),file:s.file})),i.char.forEach(s=>n.char.push({id:parseInt(s.id,10),page:parseInt(s.page,10),x:parseInt(s.x,10),y:parseInt(s.y,10),width:parseInt(s.width,10),height:parseInt(s.height,10),xoffset:parseInt(s.xoffset,10),yoffset:parseInt(s.yoffset,10),xadvance:parseInt(s.xadvance,10)})),i.kerning.forEach(s=>n.kerning.push({first:parseInt(s.first,10),second:parseInt(s.second,10),amount:parseInt(s.amount,10)})),i.distanceField.forEach(s=>n.distanceField.push({distanceRange:parseInt(s.distanceRange,10),fieldType:s.fieldType})),n}};var Ni=class{static test(t){let r=t;return"getElementsByTagName"in r&&r.getElementsByTagName("page").length&&r.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){let r=new ui,i=t.getElementsByTagName("info"),n=t.getElementsByTagName("common"),s=t.getElementsByTagName("page"),a=t.getElementsByTagName("char"),c=t.getElementsByTagName("kerning"),f=t.getElementsByTagName("distanceField");for(let p=0;p<i.length;p++)r.info.push({face:i[p].getAttribute("face"),size:parseInt(i[p].getAttribute("size"),10)});for(let p=0;p<n.length;p++)r.common.push({lineHeight:parseInt(n[p].getAttribute("lineHeight"),10)});for(let p=0;p<s.length;p++)r.page.push({id:parseInt(s[p].getAttribute("id"),10)||0,file:s[p].getAttribute("file")});for(let p=0;p<a.length;p++){let l=a[p];r.char.push({id:parseInt(l.getAttribute("id"),10),page:parseInt(l.getAttribute("page"),10)||0,x:parseInt(l.getAttribute("x"),10),y:parseInt(l.getAttribute("y"),10),width:parseInt(l.getAttribute("width"),10),height:parseInt(l.getAttribute("height"),10),xoffset:parseInt(l.getAttribute("xoffset"),10),yoffset:parseInt(l.getAttribute("yoffset"),10),xadvance:parseInt(l.getAttribute("xadvance"),10)})}for(let p=0;p<c.length;p++)r.kerning.push({first:parseInt(c[p].getAttribute("first"),10),second:parseInt(c[p].getAttribute("second"),10),amount:parseInt(c[p].getAttribute("amount"),10)});for(let p=0;p<f.length;p++)r.distanceField.push({fieldType:f[p].getAttribute("fieldType"),distanceRange:parseInt(f[p].getAttribute("distanceRange"),10)});return r}};var Ui=class{static test(t){return typeof t=="string"&&t.includes("<font>")?Ni.test(X.ADAPTER.parseXML(t)):!1}static parse(t){return Ni.parse(X.ADAPTER.parseXML(t))}};var ad=[ci,Ni,Ui];function ld(e){for(let t=0;t<ad.length;t++)if(ad[t].test(e))return ad[t];return null}function hd(e,t,r,i,n,s){let a=r.fill;if(Array.isArray(a)){if(a.length===1)return a[0]}else return a;let c,f=r.dropShadow?r.dropShadowDistance:0,p=r.padding||0,l=e.width/i-f-p*2,h=e.height/i-f-p*2,d=a.slice(),m=r.fillGradientStops.slice();if(!m.length){let _=d.length+1;for(let x=1;x<_;++x)m.push(x/_)}if(d.unshift(a[0]),m.unshift(0),d.push(a[a.length-1]),m.push(1),r.fillGradientType===yn.LINEAR_VERTICAL){c=t.createLinearGradient(l/2,p,l/2,h+p);let _=0,T=(s.fontProperties.fontSize+r.strokeThickness)/h;for(let S=0;S<n.length;S++){let w=s.lineHeight*S;for(let y=0;y<d.length;y++){let E=0;typeof m[y]=="number"?E=m[y]:E=y/d.length;let R=w/h+E*T,C=Math.max(_,R);C=Math.min(C,1),c.addColorStop(C,d[y]),_=C}}}else{c=t.createLinearGradient(p,h/2,l+p,h/2);let _=d.length+1,x=1;for(let T=0;T<d.length;T++){let S;typeof m[T]=="number"?S=m[T]:S=x/_,c.addColorStop(S,d[T]),x++}}return c}function ud(e,t,r,i,n,s,a){let c=r.text,f=r.fontProperties;t.translate(i,n),t.scale(s,s);let p=a.strokeThickness/2,l=-(a.strokeThickness/2);if(t.font=a.toFontString(),t.lineWidth=a.strokeThickness,t.textBaseline=a.textBaseline,t.lineJoin=a.lineJoin,t.miterLimit=a.miterLimit,t.fillStyle=hd(e,t,a,s,[c],r),t.strokeStyle=a.stroke,a.dropShadow){let h=a.dropShadowColor,d=a.dropShadowBlur*s,m=a.dropShadowDistance*s;t.shadowColor=mt.shared.setValue(h).setAlpha(a.dropShadowAlpha).toRgbaString(),t.shadowBlur=d,t.shadowOffsetX=Math.cos(a.dropShadowAngle)*m,t.shadowOffsetY=Math.sin(a.dropShadowAngle)*m}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;a.stroke&&a.strokeThickness&&t.strokeText(c,p,l+r.lineHeight-f.descent),a.fill&&t.fillText(c,p,l+r.lineHeight-f.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function is(e){return e.codePointAt?e.codePointAt(0):e.charCodeAt(0)}function Ga(e){return Array.from?Array.from(e):e.split("")}function cd(e){typeof e=="string"&&(e=[e]);let t=[];for(let r=0,i=e.length;r<i;r++){let n=e[r];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);let s=n[0].charCodeAt(0),a=n[1].charCodeAt(0);if(a<s)throw new Error("[BitmapFont]: Invalid character range.");for(let c=s,f=a;c<=f;c++)t.push(String.fromCharCode(c))}else t.push(...Ga(n))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}var Zr=class{constructor(e,t,r){let[i]=e.info,[n]=e.common,[s]=e.page,[a]=e.distanceField,c=rt.getResolutionOfUrl(s.file),f={};this._ownsTextures=r,this.font=i.face,this.size=i.size,this.lineHeight=n.lineHeight/c,this.chars={},this.pageTextures=f;for(let p=0;p<e.page.length;p++){let{id:l,file:h}=e.page[p];f[l]=t instanceof Array?t[p]:t[h],a?.fieldType&&a.fieldType!=="none"&&(f[l].baseTexture.alphaMode=fe.NO_PREMULTIPLIED_ALPHA,f[l].baseTexture.mipmap=Ce.OFF)}for(let p=0;p<e.char.length;p++){let{id:l,page:h}=e.char[p],{x:d,y:m,width:_,height:x,xoffset:T,yoffset:S,xadvance:w}=e.char[p];d/=c,m/=c,_/=c,x/=c,T/=c,S/=c,w/=c;let y=new ct(d+f[h].frame.x/c,m+f[h].frame.y/c,_,x);this.chars[l]={xOffset:T,yOffset:S,xAdvance:w,kerning:{},texture:new nt(f[h].baseTexture,y),page:h}}for(let p=0;p<e.kerning.length;p++){let{first:l,second:h,amount:d}=e.kerning[p];l/=c,h/=c,d/=c,this.chars[h]&&(this.chars[h].kerning[l]=d)}this.distanceFieldRange=a?.distanceRange,this.distanceFieldType=a?.fieldType?.toLowerCase()??"none"}destroy(){for(let e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(let e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,t,r){let i;if(e instanceof ui)i=e;else{let s=ld(e);if(!s)throw new Error("Unrecognized data format for font.");i=s.parse(e)}t instanceof nt&&(t=[t]);let n=new Zr(i,t,r);return Zr.available[n.font]=n,n}static uninstall(e){let t=Zr.available[e];if(!t)throw new Error(`No font found named '${e}'`);t.destroy(),delete Zr.available[e]}static from(e,t,r){if(!e)throw new Error("[BitmapFont] Property `name` is required.");let{chars:i,padding:n,resolution:s,textureWidth:a,textureHeight:c,...f}=Object.assign({},Zr.defaultOptions,r),p=cd(i),l=t instanceof qe?t:new qe(t),h=a,d=new ui;d.info[0]={face:l.fontFamily,size:l.fontSize},d.common[0]={lineHeight:l.fontSize};let m=0,_=0,x,T,S,w=0,y=[],E=[];for(let C=0;C<p.length;C++){x||(x=X.ADAPTER.createCanvas(),x.width=a,x.height=c,T=x.getContext("2d"),S=new ht(x,{resolution:s,...f}),y.push(S),E.push(new nt(S)),d.page.push({id:E.length-1,file:""}));let P=p[C],M=ce.measureText(P,l,!1,x),B=M.width,L=Math.ceil(M.height),O=Math.ceil((l.fontStyle==="italic"?2:1)*B);if(_>=c-L*s){if(_===0)throw new Error(`[BitmapFont] textureHeight ${c}px is too small (fontFamily: '${l.fontFamily}', fontSize: ${l.fontSize}px, char: '${P}')`);--C,x=null,T=null,S=null,_=0,m=0,w=0;continue}if(w=Math.max(L+M.fontProperties.descent,w),O*s+m>=h){if(m===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${l.fontFamily}', fontSize: ${l.fontSize}px, char: '${P}')`);--C,_+=w*s,_=Math.ceil(_),m=0,w=0;continue}ud(x,T,M,m,_,s,l);let H=is(M.text);d.char.push({id:H,page:E.length-1,x:m/s,y:_/s,width:O,height:L,xoffset:0,yoffset:0,xadvance:B-(l.dropShadow?l.dropShadowDistance:0)-(l.stroke?l.strokeThickness:0)}),m+=(O+2*n)*s,m=Math.ceil(m)}for(let C=0,P=p.length;C<P;C++){let M=p[C];for(let B=0;B<P;B++){let L=p[B],O=T.measureText(M).width,H=T.measureText(L).width,G=T.measureText(M+L).width-(O+H);G&&d.kerning.push({first:is(M),second:is(L),amount:G})}}let R=new Zr(d,E,!0);return Zr.available[e]!==void 0&&Zr.uninstall(e),Zr.available[e]=R,R}},Ie=Zr;Ie.ALPHA=[["a","z"],["A","Z"]," "];Ie.NUMERIC=[["0","9"]];Ie.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];Ie.ASCII=[[" ","~"]];Ie.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Zr.ALPHANUMERIC};Ie.available={};var Fx=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`;var Nx=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;var Ux=[],kx=[],Gx=[],Hx=class extends oe{constructor(e,t={}){super();let{align:r,tint:i,maxWidth:n,letterSpacing:s,fontName:a,fontSize:c}=Object.assign({},Hx.styleDefaults,t);if(!Ie.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=r,this._tintColor=new mt(i),this._font=void 0,this._fontName=a,this._fontSize=c,this.text=e,this._maxWidth=n,this._maxLineHeight=0,this._letterSpacing=s,this._anchor=new sr(()=>{this.dirty=!0},this,0,0),this._roundPixels=X.ROUND_PIXELS,this.dirty=!0,this._resolution=X.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){let e=Ie.available[this._fontName],t=this.fontSize,r=t/e.size,i=new pt,n=[],s=[],a=[],c=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",f=Ga(c),p=this._maxWidth*e.size/t,l=e.distanceFieldType==="none"?Ux:kx,h=null,d=0,m=0,_=0,x=-1,T=0,S=0,w=0,y=0;for(let L=0;L<f.length;L++){let O=f[L],H=is(O);if(/(?:\s)/.test(O)&&(x=L,T=d,y++),O==="\r"||O===`
`){s.push(d),a.push(-1),m=Math.max(m,d),++_,++S,i.x=0,i.y+=e.lineHeight,h=null,y=0;continue}let N=e.chars[H];if(!N)continue;h&&N.kerning[h]&&(i.x+=N.kerning[h]);let G=Gx.pop()||{texture:nt.EMPTY,line:0,charCode:0,prevSpaces:0,position:new pt};G.texture=N.texture,G.line=_,G.charCode=H,G.position.x=Math.round(i.x+N.xOffset+this._letterSpacing/2),G.position.y=Math.round(i.y+N.yOffset),G.prevSpaces=y,n.push(G),d=G.position.x+Math.max(N.xAdvance-N.xOffset,N.texture.orig.width),i.x+=N.xAdvance+this._letterSpacing,w=Math.max(w,N.yOffset+N.texture.height),h=H,x!==-1&&p>0&&i.x>p&&(++S,rt.removeItems(n,1+x-S,1+L-x),L=x,x=-1,s.push(T),a.push(n.length>0?n[n.length-1].prevSpaces:0),m=Math.max(m,T),_++,i.x=0,i.y+=e.lineHeight,h=null,y=0)}let E=f[f.length-1];E!=="\r"&&E!==`
`&&(/(?:\s)/.test(E)&&(d=T),s.push(d),m=Math.max(m,d),a.push(-1));let R=[];for(let L=0;L<=_;L++){let O=0;this._align==="right"?O=m-s[L]:this._align==="center"?O=(m-s[L])/2:this._align==="justify"&&(O=a[L]<0?0:(m-s[L])/a[L]),R.push(O)}let C=n.length,P={},M=[],B=this._activePagesMeshData;l.push(...B);for(let L=0;L<C;L++){let O=n[L].texture,H=O.baseTexture.uid;if(!P[H]){let N=l.pop();if(!N){let Z=new vn,q,it;e.distanceFieldType==="none"?(q=new Fi(nt.EMPTY),it=dt.NORMAL):(q=new Fi(nt.EMPTY,{program:Se.from(Nx,Fx),uniforms:{uFWidth:0}}),it=dt.NORMAL_NPM);let Y=new xn(Z,q);Y.blendMode=it,N={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:Y,vertices:null,uvs:null,indices:null}}N.index=0,N.indexCount=0,N.vertexCount=0,N.uvsCount=0,N.total=0;let{_textureCache:G}=this;G[H]=G[H]||new nt(O.baseTexture),N.mesh.texture=G[H],N.mesh.tint=this._tintColor.value,M.push(N),P[H]=N}P[H].total++}for(let L=0;L<B.length;L++)M.includes(B[L])||this.removeChild(B[L].mesh);for(let L=0;L<M.length;L++)M[L].mesh.parent!==this&&this.addChild(M[L].mesh);this._activePagesMeshData=M;for(let L in P){let O=P[L],H=O.total;if(!(O.indices?.length>6*H)||O.vertices.length<xn.BATCHABLE_SIZE*2)O.vertices=new Float32Array(4*2*H),O.uvs=new Float32Array(4*2*H),O.indices=new Uint16Array(6*H);else{let N=O.total,G=O.vertices;for(let Z=N*4*2;Z<G.length;Z++)G[Z]=0}O.mesh.size=6*H}for(let L=0;L<C;L++){let O=n[L],H=O.position.x+R[O.line]*(this._align==="justify"?O.prevSpaces:1);this._roundPixels&&(H=Math.round(H));let N=H*r,G=O.position.y*r,Z=O.texture,q=P[Z.baseTexture.uid],it=Z.frame,Y=Z._uvs,Q=q.index++;q.indices[Q*6+0]=0+Q*4,q.indices[Q*6+1]=1+Q*4,q.indices[Q*6+2]=2+Q*4,q.indices[Q*6+3]=0+Q*4,q.indices[Q*6+4]=2+Q*4,q.indices[Q*6+5]=3+Q*4,q.vertices[Q*8+0]=N,q.vertices[Q*8+1]=G,q.vertices[Q*8+2]=N+it.width*r,q.vertices[Q*8+3]=G,q.vertices[Q*8+4]=N+it.width*r,q.vertices[Q*8+5]=G+it.height*r,q.vertices[Q*8+6]=N,q.vertices[Q*8+7]=G+it.height*r,q.uvs[Q*8+0]=Y.x0,q.uvs[Q*8+1]=Y.y0,q.uvs[Q*8+2]=Y.x1,q.uvs[Q*8+3]=Y.y1,q.uvs[Q*8+4]=Y.x2,q.uvs[Q*8+5]=Y.y2,q.uvs[Q*8+6]=Y.x3,q.uvs[Q*8+7]=Y.y3}this._textWidth=m*r,this._textHeight=(i.y+e.lineHeight)*r;for(let L in P){let O=P[L];if(this.anchor.x!==0||this.anchor.y!==0){let Z=0,q=this._textWidth*this.anchor.x,it=this._textHeight*this.anchor.y;for(let Y=0;Y<O.total;Y++)O.vertices[Z++]-=q,O.vertices[Z++]-=it,O.vertices[Z++]-=q,O.vertices[Z++]-=it,O.vertices[Z++]-=q,O.vertices[Z++]-=it,O.vertices[Z++]-=q,O.vertices[Z++]-=it}this._maxLineHeight=w*r;let H=O.mesh.geometry.getBuffer("aVertexPosition"),N=O.mesh.geometry.getBuffer("aTextureCoord"),G=O.mesh.geometry.getIndex();H.data=O.vertices,N.data=O.uvs,G.data=O.indices,H.update(),N.update(),G.update()}for(let L=0;L<n.length;L++)Gx.push(n[L]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);let{distanceFieldRange:t,distanceFieldType:r,size:i}=Ie.available[this._fontName];if(r!=="none"){let{a:n,b:s,c:a,d:c}=this.worldTransform,f=Math.sqrt(n*n+s*s),p=Math.sqrt(a*a+c*c),l=(Math.abs(f)+Math.abs(p))/2,h=this.fontSize/i,d=e._view.resolution;for(let m of this._activePagesMeshData)m.mesh.shader.uniforms.uFWidth=l*t*h*d}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){let e=Ie.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!Ie.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??Ie.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){let{_textureCache:t}=this,i=Ie.available[this._fontName].distanceFieldType==="none"?Ux:kx;i.push(...this._activePagesMeshData);for(let n of this._activePagesMeshData)this.removeChild(n.mesh);this._activePagesMeshData=[],i.filter(n=>t[n.mesh.texture.baseTexture.uid]).forEach(n=>{n.mesh.texture=nt.EMPTY});for(let n in t)t[n].destroy(),delete t[n];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}},Vx=Hx;Vx.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};var $C=[".xml",".fnt"],Wx={extension:{type:$.LoadParser,priority:ue.Normal},name:"loadBitmapFont",test(e){return $C.includes(rt.path.extname(e).toLowerCase())},async testParse(e){return ci.test(e)||Ui.test(e)},async parse(e,t,r){let i=ci.test(e)?ci.parse(e):Ui.parse(e),{src:n}=t,{page:s}=i,a=[];for(let p=0;p<s.length;++p){let l=s[p].file,h=rt.path.join(rt.path.dirname(n),l);h=Jn(h,n),a.push(h)}let c=await r.load(a),f=a.map(p=>c[p]);return Ie.install(i,f,!0)},async load(e,t){return(await X.ADAPTER.fetch(e)).text()},unload(e){e.destroy()}};J.add(Wx);var ho=class extends qe{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new ho(Object.keys(ho.defaultOptions).reduce((t,r)=>({...t,[r]:e[r]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete ho.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,t={}){let{availableFonts:r}=ho;if(r[e]){let i=r[e];return this._fonts.push(i),i.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return X.ADAPTER.fetch(e).then(i=>i.blob()).then(async i=>new Promise((n,s)=>{let a=URL.createObjectURL(i),c=new FileReader;c.onload=()=>n([a,c.result]),c.onerror=s,c.readAsDataURL(i)})).then(async([i,n])=>{let s=Object.assign({family:rt.path.basename(e,rt.path.extname(e)),weight:"normal",style:"normal",src:i,dataSrc:n,refs:1,originalUrl:e,fontFace:null},t);r[e]=s,this._fonts.push(s),this.styleID++;let a=new FontFace(s.family,`url(${s.src})`,{weight:s.weight,style:s.style});s.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){let t=e.filter(r=>!this._overrides.includes(r));t.length>0&&(this._overrides.push(...t),this.styleID++)}removeOverride(...e){let t=e.filter(r=>this._overrides.includes(r));t.length>0&&(this._overrides=this._overrides.filter(r=>!t.includes(r)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,t)=>`${e}
            @font-face {
                font-family: "${t.family}";
                src: url('${t.dataSrc}');
                font-weight: ${t.weight};
                font-style: ${t.style}; 
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=rt.rgb2hex(e)),typeof e=="number"?rt.hex2string(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor),t=this.dropShadowAlpha,r=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),i=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&t<1&&(e+=(t*255|0).toString(16).padStart(2,"0"));let n=`${r}px ${i}px`;return this.dropShadowBlur>0?`text-shadow: ${n} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${n} ${e}`}reset(){Object.assign(this,ho.defaultOptions)}onBeforeDraw(){let{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(t=>setTimeout(t,100)):Promise.resolve()}get isSafari(){let{userAgent:e}=X.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}},ns=ho;ns.availableFonts={};ns.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};var uo=class extends Le{constructor(e="",t={}){super(nt.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this._loading=!1,this.localStyleID=-1,this.dirty=!1,this.ownsStyle=!1;let r=new Image,i=nt.from(r,{scaleMode:X.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new ct,i.trim=new ct,this.texture=i;let n="http://www.w3.org/2000/svg",s="http://www.w3.org/1999/xhtml",a=document.createElementNS(n,"svg"),c=document.createElementNS(n,"foreignObject"),f=document.createElementNS(s,"div"),p=document.createElementNS(s,"style");c.setAttribute("width","10000"),c.setAttribute("height","10000"),c.style.overflow="hidden",a.appendChild(c),this.maxWidth=uo.defaultMaxWidth,this.maxHeight=uo.defaultMaxHeight,this._domElement=f,this._styleElement=p,this._svgRoot=a,this._foreignObject=c,this._foreignObject.appendChild(p),this._foreignObject.appendChild(f),this._image=r,this._loadImage=new Image,this._autoResolution=uo.defaultAutoResolution,this._resolution=uo.defaultResolution??X.RESOLUTION,this.text=e,this.style=t}measureText(e){let{text:t,style:r,resolution:i}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:t,style:r.toCSS(i)}),this._styleElement.textContent=r.toGlobalCSS(),document.body.appendChild(this._svgRoot);let n=this._domElement.getBoundingClientRect();this._svgRoot.remove();let s=Math.min(this.maxWidth,Math.ceil(n.width)),a=Math.min(this.maxHeight,Math.ceil(n.height));return this._svgRoot.setAttribute("width",s.toString()),this._svgRoot.setAttribute("height",a.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),r!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(i)}),this._styleElement.textContent=this._style?.toGlobalCSS()),{width:s+r.padding*2,height:a+r.padding*2}}async updateText(e=!0){let{style:t,_image:r,_loadImage:i}=this;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;let{width:n,height:s}=this.measureText();r.width=i.width=Math.ceil(Math.max(1,n)),r.height=i.height=Math.ceil(Math.max(1,s)),this._loading||(this._loading=!0,await new Promise(a=>{i.onload=async()=>{await t.onBeforeDraw(),this._loading=!1,r.src=i.src,i.onload=null,i.src="",this.updateTexture(),a()};let c=new XMLSerializer().serializeToString(this._svgRoot);i.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(c)}`}))}get source(){return this._image}updateTexture(){let{style:e,texture:t,_image:r,resolution:i}=this,{padding:n}=e,{baseTexture:s}=t;t.trim.width=t._frame.width=r.width/i,t.trim.height=t._frame.height=r.height/i,t.trim.x=-n,t.trim.y=-n,t.orig.width=t._frame.width-n*2,t.orig.height=t._frame.height-n*2,this._onTextureUpdate(),s.setRealSize(r.width,r.height,i),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},uo.defaultDestroyOptions,e),super.destroy(e);let t=null;this.ownsStyle&&this._style?.cleanFonts(),this._style=t,this._svgRoot?.remove(),this._svgRoot=t,this._domElement?.remove(),this._domElement=t,this._foreignObject?.remove(),this._foreignObject=t,this._styleElement?.remove(),this._styleElement=t,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=t,this._image.src="",this._image=t}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);let t=rt.sign(this.scale.x)||1;this.scale.x=t*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);let t=rt.sign(this.scale.y)||1;this.scale.y=t*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof ns?(this.ownsStyle=!1,this._style=e):e instanceof qe?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=ns.from(e)):(this.ownsStyle=!0,this._style=new ns(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}},Ha=uo;Ha.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0};Ha.defaultMaxWidth=2024;Ha.defaultMaxHeight=2024;Ha.defaultAutoResolution=!0;function Va(e,t){return function(){return e.apply(t,arguments)}}var{toString:$x}=Object.prototype,{getPrototypeOf:pd}=Object,md=(e=>t=>{let r=$x.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ki=e=>(e=e.toLowerCase(),t=>md(t)===e),qh=e=>t=>typeof t===e,{isArray:co}=Array,Wa=qh("undefined");function jC(e){return e!==null&&!Wa(e)&&e.constructor!==null&&!Wa(e.constructor)&&Tn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}var Yx=ki("ArrayBuffer");function qC(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Yx(e.buffer),t}var KC=qh("string"),Tn=qh("function"),jx=qh("number"),gd=e=>e!==null&&typeof e=="object",ZC=e=>e===!0||e===!1,jh=e=>{if(md(e)!=="object")return!1;let t=pd(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},JC=ki("Date"),QC=ki("File"),tR=ki("Blob"),eR=ki("FileList"),rR=e=>gd(e)&&Tn(e.pipe),iR=e=>{let t="[object FormData]";return e&&(typeof FormData=="function"&&e instanceof FormData||$x.call(e)===t||Tn(e.toString)&&e.toString()===t)},nR=ki("URLSearchParams"),sR=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Xa(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let i,n;if(typeof e!="object"&&(e=[e]),co(e))for(i=0,n=e.length;i<n;i++)t.call(null,e[i],i,e);else{let s=r?Object.getOwnPropertyNames(e):Object.keys(e),a=s.length,c;for(i=0;i<a;i++)c=s[i],t.call(null,e[c],c,e)}}function qx(e,t){t=t.toLowerCase();let r=Object.keys(e),i=r.length,n;for(;i-- >0;)if(n=r[i],t===n.toLowerCase())return n;return null}var Kx=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Zx=e=>!Wa(e)&&e!==Kx;function dd(){let{caseless:e}=Zx(this)&&this||{},t={},r=(i,n)=>{let s=e&&qx(t,n)||n;jh(t[s])&&jh(i)?t[s]=dd(t[s],i):jh(i)?t[s]=dd({},i):co(i)?t[s]=i.slice():t[s]=i};for(let i=0,n=arguments.length;i<n;i++)arguments[i]&&Xa(arguments[i],r);return t}var oR=(e,t,r,{allOwnKeys:i}={})=>(Xa(t,(n,s)=>{r&&Tn(n)?e[s]=Va(n,r):e[s]=n},{allOwnKeys:i}),e),aR=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),lR=(e,t,r,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},hR=(e,t,r,i)=>{let n,s,a,c={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),s=n.length;s-- >0;)a=n[s],(!i||i(a,e,t))&&!c[a]&&(t[a]=e[a],c[a]=!0);e=r!==!1&&pd(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},uR=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;let i=e.indexOf(t,r);return i!==-1&&i===r},cR=e=>{if(!e)return null;if(co(e))return e;let t=e.length;if(!jx(t))return null;let r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},fR=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&pd(Uint8Array)),dR=(e,t)=>{let i=(e&&e[Symbol.iterator]).call(e),n;for(;(n=i.next())&&!n.done;){let s=n.value;t.call(e,s[0],s[1])}},pR=(e,t)=>{let r,i=[];for(;(r=e.exec(t))!==null;)i.push(r);return i},mR=ki("HTMLFormElement"),gR=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,i,n){return i.toUpperCase()+n}),Xx=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),_R=ki("RegExp"),Jx=(e,t)=>{let r=Object.getOwnPropertyDescriptors(e),i={};Xa(r,(n,s)=>{t(n,s,e)!==!1&&(i[s]=n)}),Object.defineProperties(e,i)},xR=e=>{Jx(e,(t,r)=>{if(Tn(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;let i=e[r];if(Tn(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},vR=(e,t)=>{let r={},i=n=>{n.forEach(s=>{r[s]=!0})};return co(e)?i(e):i(String(e).split(t)),r},yR=()=>{},TR=(e,t)=>(e=+e,Number.isFinite(e)?e:t),fd="abcdefghijklmnopqrstuvwxyz",zx="0123456789",Qx={DIGIT:zx,ALPHA:fd,ALPHA_DIGIT:fd+fd.toUpperCase()+zx},ER=(e=16,t=Qx.ALPHA_DIGIT)=>{let r="",{length:i}=t;for(;e--;)r+=t[Math.random()*i|0];return r};function wR(e){return!!(e&&Tn(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}var SR=e=>{let t=new Array(10),r=(i,n)=>{if(gd(i)){if(t.indexOf(i)>=0)return;if(!("toJSON"in i)){t[n]=i;let s=co(i)?[]:{};return Xa(i,(a,c)=>{let f=r(a,n+1);!Wa(f)&&(s[c]=f)}),t[n]=void 0,s}}return i};return r(e,0)},W={isArray:co,isArrayBuffer:Yx,isBuffer:jC,isFormData:iR,isArrayBufferView:qC,isString:KC,isNumber:jx,isBoolean:ZC,isObject:gd,isPlainObject:jh,isUndefined:Wa,isDate:JC,isFile:QC,isBlob:tR,isRegExp:_R,isFunction:Tn,isStream:rR,isURLSearchParams:nR,isTypedArray:fR,isFileList:eR,forEach:Xa,merge:dd,extend:oR,trim:sR,stripBOM:aR,inherits:lR,toFlatObject:hR,kindOf:md,kindOfTest:ki,endsWith:uR,toArray:cR,forEachEntry:dR,matchAll:pR,isHTMLForm:mR,hasOwnProperty:Xx,hasOwnProp:Xx,reduceDescriptors:Jx,freezeMethods:xR,toObjectSet:vR,toCamelCase:gR,noop:yR,toFiniteNumber:TR,findKey:qx,global:Kx,isContextDefined:Zx,ALPHABET:Qx,generateString:ER,isSpecCompliantForm:wR,toJSONObject:SR};function fo(e,t,r,i,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),i&&(this.request=i),n&&(this.response=n)}W.inherits(fo,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:W.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var t0=fo.prototype,e0={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{e0[e]={value:e}});Object.defineProperties(fo,e0);Object.defineProperty(t0,"isAxiosError",{value:!0});fo.from=(e,t,r,i,n,s)=>{let a=Object.create(t0);return W.toFlatObject(e,a,function(f){return f!==Error.prototype},c=>c!=="isAxiosError"),fo.call(a,e.message,t,r,i,n),a.cause=e,a.name=e.name,s&&Object.assign(a,s),a};var Bt=fo;var Kh=null;function _d(e){return W.isPlainObject(e)||W.isArray(e)}function i0(e){return W.endsWith(e,"[]")?e.slice(0,-2):e}function r0(e,t,r){return e?e.concat(t).map(function(n,s){return n=i0(n),!r&&s?"["+n+"]":n}).join(r?".":""):t}function bR(e){return W.isArray(e)&&!e.some(_d)}var AR=W.toFlatObject(W,{},null,function(t){return/^is[A-Z]/.test(t)});function CR(e,t,r){if(!W.isObject(e))throw new TypeError("target must be an object");t=t||new(Kh||FormData),r=W.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,T){return!W.isUndefined(T[x])});let i=r.metaTokens,n=r.visitor||l,s=r.dots,a=r.indexes,f=(r.Blob||typeof Blob<"u"&&Blob)&&W.isSpecCompliantForm(t);if(!W.isFunction(n))throw new TypeError("visitor must be a function");function p(_){if(_===null)return"";if(W.isDate(_))return _.toISOString();if(!f&&W.isBlob(_))throw new Bt("Blob is not supported. Use a Buffer instead.");return W.isArrayBuffer(_)||W.isTypedArray(_)?f&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function l(_,x,T){let S=_;if(_&&!T&&typeof _=="object"){if(W.endsWith(x,"{}"))x=i?x:x.slice(0,-2),_=JSON.stringify(_);else if(W.isArray(_)&&bR(_)||(W.isFileList(_)||W.endsWith(x,"[]"))&&(S=W.toArray(_)))return x=i0(x),S.forEach(function(y,E){!(W.isUndefined(y)||y===null)&&t.append(a===!0?r0([x],E,s):a===null?x:x+"[]",p(y))}),!1}return _d(_)?!0:(t.append(r0(T,x,s),p(_)),!1)}let h=[],d=Object.assign(AR,{defaultVisitor:l,convertValue:p,isVisitable:_d});function m(_,x){if(!W.isUndefined(_)){if(h.indexOf(_)!==-1)throw Error("Circular reference detected in "+x.join("."));h.push(_),W.forEach(_,function(S,w){(!(W.isUndefined(S)||S===null)&&n.call(t,S,W.isString(w)?w.trim():w,x,d))===!0&&m(S,x?x.concat(w):[w])}),h.pop()}}if(!W.isObject(e))throw new TypeError("data must be an object");return m(e),t}var En=CR;function n0(e){let t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function s0(e,t){this._pairs=[],e&&En(e,this,t)}var o0=s0.prototype;o0.append=function(t,r){this._pairs.push([t,r])};o0.toString=function(t){let r=t?function(i){return t.call(this,i,n0)}:n0;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};var Zh=s0;function RR(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function za(e,t,r){if(!t)return e;let i=r&&r.encode||RR,n=r&&r.serialize,s;if(n?s=n(t,r):s=W.isURLSearchParams(t)?t.toString():new Zh(t,r).toString(i),s){let a=e.indexOf("#");a!==-1&&(e=e.slice(0,a)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}var xd=class{constructor(){this.handlers=[]}use(t,r,i){return this.handlers.push({fulfilled:t,rejected:r,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){W.forEach(this.handlers,function(i){i!==null&&t(i)})}},vd=xd;var Jh={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};var a0=typeof URLSearchParams<"u"?URLSearchParams:Zh;var l0=typeof FormData<"u"?FormData:null;var h0=typeof Blob<"u"?Blob:null;var IR=(()=>{let e;return typeof navigator<"u"&&((e=navigator.product)==="ReactNative"||e==="NativeScript"||e==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),PR=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),Ue={isBrowser:!0,classes:{URLSearchParams:a0,FormData:l0,Blob:h0},isStandardBrowserEnv:IR,isStandardBrowserWebWorkerEnv:PR,protocols:["http","https","file","blob","url","data"]};function yd(e,t){return En(e,new Ue.classes.URLSearchParams,Object.assign({visitor:function(r,i,n,s){return Ue.isNode&&W.isBuffer(r)?(this.append(i,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function MR(e){return W.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function BR(e){let t={},r=Object.keys(e),i,n=r.length,s;for(i=0;i<n;i++)s=r[i],t[s]=e[s];return t}function DR(e){function t(r,i,n,s){let a=r[s++],c=Number.isFinite(+a),f=s>=r.length;return a=!a&&W.isArray(n)?n.length:a,f?(W.hasOwnProp(n,a)?n[a]=[n[a],i]:n[a]=i,!c):((!n[a]||!W.isObject(n[a]))&&(n[a]=[]),t(r,i,n[a],s)&&W.isArray(n[a])&&(n[a]=BR(n[a])),!c)}if(W.isFormData(e)&&W.isFunction(e.entries)){let r={};return W.forEachEntry(e,(i,n)=>{t(MR(i),n,r,0)}),r}return null}var Qh=DR;var OR={"Content-Type":void 0};function LR(e,t,r){if(W.isString(e))try{return(t||JSON.parse)(e),W.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(r||JSON.stringify)(e)}var tu={transitional:Jh,adapter:["xhr","http"],transformRequest:[function(t,r){let i=r.getContentType()||"",n=i.indexOf("application/json")>-1,s=W.isObject(t);if(s&&W.isHTMLForm(t)&&(t=new FormData(t)),W.isFormData(t))return n&&n?JSON.stringify(Qh(t)):t;if(W.isArrayBuffer(t)||W.isBuffer(t)||W.isStream(t)||W.isFile(t)||W.isBlob(t))return t;if(W.isArrayBufferView(t))return t.buffer;if(W.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let c;if(s){if(i.indexOf("application/x-www-form-urlencoded")>-1)return yd(t,this.formSerializer).toString();if((c=W.isFileList(t))||i.indexOf("multipart/form-data")>-1){let f=this.env&&this.env.FormData;return En(c?{"files[]":t}:t,f&&new f,this.formSerializer)}}return s||n?(r.setContentType("application/json",!1),LR(t)):t}],transformResponse:[function(t){let r=this.transitional||tu.transitional,i=r&&r.forcedJSONParsing,n=this.responseType==="json";if(t&&W.isString(t)&&(i&&!this.responseType||n)){let a=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t)}catch(c){if(a)throw c.name==="SyntaxError"?Bt.from(c,Bt.ERR_BAD_RESPONSE,this,null,this.response):c}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ue.classes.FormData,Blob:Ue.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};W.forEach(["delete","get","head"],function(t){tu.headers[t]={}});W.forEach(["post","put","patch"],function(t){tu.headers[t]=W.merge(OR)});var po=tu;var FR=W.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),u0=e=>{let t={},r,i,n;return e&&e.split(`
`).forEach(function(a){n=a.indexOf(":"),r=a.substring(0,n).trim().toLowerCase(),i=a.substring(n+1).trim(),!(!r||t[r]&&FR[r])&&(r==="set-cookie"?t[r]?t[r].push(i):t[r]=[i]:t[r]=t[r]?t[r]+", "+i:i)}),t};var c0=Symbol("internals");function $a(e){return e&&String(e).trim().toLowerCase()}function eu(e){return e===!1||e==null?e:W.isArray(e)?e.map(eu):String(e)}function NR(e){let t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g,i;for(;i=r.exec(e);)t[i[1]]=i[2];return t}function UR(e){return/^[-_a-zA-Z]+$/.test(e.trim())}function Td(e,t,r,i,n){if(W.isFunction(i))return i.call(this,t,r);if(n&&(t=r),!!W.isString(t)){if(W.isString(i))return t.indexOf(i)!==-1;if(W.isRegExp(i))return i.test(t)}}function kR(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,i)=>r.toUpperCase()+i)}function GR(e,t){let r=W.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+r,{value:function(n,s,a){return this[i].call(this,t,n,s,a)},configurable:!0})})}var mo=class{constructor(t){t&&this.set(t)}set(t,r,i){let n=this;function s(c,f,p){let l=$a(f);if(!l)throw new Error("header name must be a non-empty string");let h=W.findKey(n,l);(!h||n[h]===void 0||p===!0||p===void 0&&n[h]!==!1)&&(n[h||f]=eu(c))}let a=(c,f)=>W.forEach(c,(p,l)=>s(p,l,f));return W.isPlainObject(t)||t instanceof this.constructor?a(t,r):W.isString(t)&&(t=t.trim())&&!UR(t)?a(u0(t),r):t!=null&&s(r,t,i),this}get(t,r){if(t=$a(t),t){let i=W.findKey(this,t);if(i){let n=this[i];if(!r)return n;if(r===!0)return NR(n);if(W.isFunction(r))return r.call(this,n,i);if(W.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=$a(t),t){let i=W.findKey(this,t);return!!(i&&this[i]!==void 0&&(!r||Td(this,this[i],i,r)))}return!1}delete(t,r){let i=this,n=!1;function s(a){if(a=$a(a),a){let c=W.findKey(i,a);c&&(!r||Td(i,i[c],c,r))&&(delete i[c],n=!0)}}return W.isArray(t)?t.forEach(s):s(t),n}clear(t){let r=Object.keys(this),i=r.length,n=!1;for(;i--;){let s=r[i];(!t||Td(this,this[s],s,t,!0))&&(delete this[s],n=!0)}return n}normalize(t){let r=this,i={};return W.forEach(this,(n,s)=>{let a=W.findKey(i,s);if(a){r[a]=eu(n),delete r[s];return}let c=t?kR(s):String(s).trim();c!==s&&delete r[s],r[c]=eu(n),i[c]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){let r=Object.create(null);return W.forEach(this,(i,n)=>{i!=null&&i!==!1&&(r[n]=t&&W.isArray(i)?i.join(", "):i)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){let i=new this(t);return r.forEach(n=>i.set(n)),i}static accessor(t){let i=(this[c0]=this[c0]={accessors:{}}).accessors,n=this.prototype;function s(a){let c=$a(a);i[c]||(GR(n,a),i[c]=!0)}return W.isArray(t)?t.forEach(s):s(t),this}};mo.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);W.freezeMethods(mo.prototype);W.freezeMethods(mo);var Ke=mo;function Ya(e,t){let r=this||po,i=t||r,n=Ke.from(i.headers),s=i.data;return W.forEach(e,function(c){s=c.call(r,s,n.normalize(),t?t.status:void 0)}),n.normalize(),s}function ja(e){return!!(e&&e.__CANCEL__)}function f0(e,t,r){Bt.call(this,e??"canceled",Bt.ERR_CANCELED,t,r),this.name="CanceledError"}W.inherits(f0,Bt,{__CANCEL__:!0});var wn=f0;function Ed(e,t,r){let i=r.config.validateStatus;!r.status||!i||i(r.status)?e(r):t(new Bt("Request failed with status code "+r.status,[Bt.ERR_BAD_REQUEST,Bt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}var d0=Ue.isStandardBrowserEnv?function(){return{write:function(r,i,n,s,a,c){let f=[];f.push(r+"="+encodeURIComponent(i)),W.isNumber(n)&&f.push("expires="+new Date(n).toGMTString()),W.isString(s)&&f.push("path="+s),W.isString(a)&&f.push("domain="+a),c===!0&&f.push("secure"),document.cookie=f.join("; ")},read:function(r){let i=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove:function(r){this.write(r,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function wd(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Sd(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}function qa(e,t){return e&&!wd(t)?Sd(e,t):t}var p0=Ue.isStandardBrowserEnv?function(){let t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a"),i;function n(s){let a=s;return t&&(r.setAttribute("href",a),a=r.href),r.setAttribute("href",a),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return i=n(window.location.href),function(a){let c=W.isString(a)?n(a):a;return c.protocol===i.protocol&&c.host===i.host}}():function(){return function(){return!0}}();function bd(e){let t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function HR(e,t){e=e||10;let r=new Array(e),i=new Array(e),n=0,s=0,a;return t=t!==void 0?t:1e3,function(f){let p=Date.now(),l=i[s];a||(a=p),r[n]=f,i[n]=p;let h=s,d=0;for(;h!==n;)d+=r[h++],h=h%e;if(n=(n+1)%e,n===s&&(s=(s+1)%e),p-a<t)return;let m=l&&p-l;return m?Math.round(d*1e3/m):void 0}}var m0=HR;function g0(e,t){let r=0,i=m0(50,250);return n=>{let s=n.loaded,a=n.lengthComputable?n.total:void 0,c=s-r,f=i(c),p=s<=a;r=s;let l={loaded:s,total:a,progress:a?s/a:void 0,bytes:c,rate:f||void 0,estimated:f&&a&&p?(a-s)/f:void 0,event:n};l[t?"download":"upload"]=!0,e(l)}}var VR=typeof XMLHttpRequest<"u",_0=VR&&function(e){return new Promise(function(r,i){let n=e.data,s=Ke.from(e.headers).normalize(),a=e.responseType,c;function f(){e.cancelToken&&e.cancelToken.unsubscribe(c),e.signal&&e.signal.removeEventListener("abort",c)}W.isFormData(n)&&(Ue.isStandardBrowserEnv||Ue.isStandardBrowserWebWorkerEnv)&&s.setContentType(!1);let p=new XMLHttpRequest;if(e.auth){let m=e.auth.username||"",_=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";s.set("Authorization","Basic "+btoa(m+":"+_))}let l=qa(e.baseURL,e.url);p.open(e.method.toUpperCase(),za(l,e.params,e.paramsSerializer),!0),p.timeout=e.timeout;function h(){if(!p)return;let m=Ke.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders()),x={data:!a||a==="text"||a==="json"?p.responseText:p.response,status:p.status,statusText:p.statusText,headers:m,config:e,request:p};Ed(function(S){r(S),f()},function(S){i(S),f()},x),p=null}if("onloadend"in p?p.onloadend=h:p.onreadystatechange=function(){!p||p.readyState!==4||p.status===0&&!(p.responseURL&&p.responseURL.indexOf("file:")===0)||setTimeout(h)},p.onabort=function(){p&&(i(new Bt("Request aborted",Bt.ECONNABORTED,e,p)),p=null)},p.onerror=function(){i(new Bt("Network Error",Bt.ERR_NETWORK,e,p)),p=null},p.ontimeout=function(){let _=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",x=e.transitional||Jh;e.timeoutErrorMessage&&(_=e.timeoutErrorMessage),i(new Bt(_,x.clarifyTimeoutError?Bt.ETIMEDOUT:Bt.ECONNABORTED,e,p)),p=null},Ue.isStandardBrowserEnv){let m=(e.withCredentials||p0(l))&&e.xsrfCookieName&&d0.read(e.xsrfCookieName);m&&s.set(e.xsrfHeaderName,m)}n===void 0&&s.setContentType(null),"setRequestHeader"in p&&W.forEach(s.toJSON(),function(_,x){p.setRequestHeader(x,_)}),W.isUndefined(e.withCredentials)||(p.withCredentials=!!e.withCredentials),a&&a!=="json"&&(p.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&p.addEventListener("progress",g0(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&p.upload&&p.upload.addEventListener("progress",g0(e.onUploadProgress)),(e.cancelToken||e.signal)&&(c=m=>{p&&(i(!m||m.type?new wn(null,e,p):m),p.abort(),p=null)},e.cancelToken&&e.cancelToken.subscribe(c),e.signal&&(e.signal.aborted?c():e.signal.addEventListener("abort",c)));let d=bd(l);if(d&&Ue.protocols.indexOf(d)===-1){i(new Bt("Unsupported protocol "+d+":",Bt.ERR_BAD_REQUEST,e));return}p.send(n||null)})};var ru={http:Kh,xhr:_0};W.forEach(ru,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});var x0={getAdapter:e=>{e=W.isArray(e)?e:[e];let{length:t}=e,r,i;for(let n=0;n<t&&(r=e[n],!(i=W.isString(r)?ru[r.toLowerCase()]:r));n++);if(!i)throw i===!1?new Bt(`Adapter ${r} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(W.hasOwnProp(ru,r)?`Adapter '${r}' is not available in the build`:`Unknown adapter '${r}'`);if(!W.isFunction(i))throw new TypeError("adapter is not a function");return i},adapters:ru};function Ad(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new wn(null,e)}function iu(e){return Ad(e),e.headers=Ke.from(e.headers),e.data=Ya.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),x0.getAdapter(e.adapter||po.adapter)(e).then(function(i){return Ad(e),i.data=Ya.call(e,e.transformResponse,i),i.headers=Ke.from(i.headers),i},function(i){return ja(i)||(Ad(e),i&&i.response&&(i.response.data=Ya.call(e,e.transformResponse,i.response),i.response.headers=Ke.from(i.response.headers))),Promise.reject(i)})}var v0=e=>e instanceof Ke?e.toJSON():e;function Gi(e,t){t=t||{};let r={};function i(p,l,h){return W.isPlainObject(p)&&W.isPlainObject(l)?W.merge.call({caseless:h},p,l):W.isPlainObject(l)?W.merge({},l):W.isArray(l)?l.slice():l}function n(p,l,h){if(W.isUndefined(l)){if(!W.isUndefined(p))return i(void 0,p,h)}else return i(p,l,h)}function s(p,l){if(!W.isUndefined(l))return i(void 0,l)}function a(p,l){if(W.isUndefined(l)){if(!W.isUndefined(p))return i(void 0,p)}else return i(void 0,l)}function c(p,l,h){if(h in t)return i(p,l);if(h in e)return i(void 0,p)}let f={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:c,headers:(p,l)=>n(v0(p),v0(l),!0)};return W.forEach(Object.keys(e).concat(Object.keys(t)),function(l){let h=f[l]||n,d=h(e[l],t[l],l);W.isUndefined(d)&&h!==c||(r[l]=d)}),r}var nu="1.3.4";var Cd={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Cd[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});var y0={};Cd.transitional=function(t,r,i){function n(s,a){return"[Axios v"+nu+"] Transitional option '"+s+"'"+a+(i?". "+i:"")}return(s,a,c)=>{if(t===!1)throw new Bt(n(a," has been removed"+(r?" in "+r:"")),Bt.ERR_DEPRECATED);return r&&!y0[a]&&(y0[a]=!0,console.warn(n(a," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,a,c):!0}};function WR(e,t,r){if(typeof e!="object")throw new Bt("options must be an object",Bt.ERR_BAD_OPTION_VALUE);let i=Object.keys(e),n=i.length;for(;n-- >0;){let s=i[n],a=t[s];if(a){let c=e[s],f=c===void 0||a(c,s,e);if(f!==!0)throw new Bt("option "+s+" must be "+f,Bt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Bt("Unknown option "+s,Bt.ERR_BAD_OPTION)}}var su={assertOptions:WR,validators:Cd};var Sn=su.validators,go=class{constructor(t){this.defaults=t,this.interceptors={request:new vd,response:new vd}}request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Gi(this.defaults,r);let{transitional:i,paramsSerializer:n,headers:s}=r;i!==void 0&&su.assertOptions(i,{silentJSONParsing:Sn.transitional(Sn.boolean),forcedJSONParsing:Sn.transitional(Sn.boolean),clarifyTimeoutError:Sn.transitional(Sn.boolean)},!1),n!==void 0&&su.assertOptions(n,{encode:Sn.function,serialize:Sn.function},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let a;a=s&&W.merge(s.common,s[r.method]),a&&W.forEach(["delete","get","head","post","put","patch","common"],_=>{delete s[_]}),r.headers=Ke.concat(a,s);let c=[],f=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(r)===!1||(f=f&&x.synchronous,c.unshift(x.fulfilled,x.rejected))});let p=[];this.interceptors.response.forEach(function(x){p.push(x.fulfilled,x.rejected)});let l,h=0,d;if(!f){let _=[iu.bind(this),void 0];for(_.unshift.apply(_,c),_.push.apply(_,p),d=_.length,l=Promise.resolve(r);h<d;)l=l.then(_[h++],_[h++]);return l}d=c.length;let m=r;for(h=0;h<d;){let _=c[h++],x=c[h++];try{m=_(m)}catch(T){x.call(this,T);break}}try{l=iu.call(this,m)}catch(_){return Promise.reject(_)}for(h=0,d=p.length;h<d;)l=l.then(p[h++],p[h++]);return l}getUri(t){t=Gi(this.defaults,t);let r=qa(t.baseURL,t.url);return za(r,t.params,t.paramsSerializer)}};W.forEach(["delete","get","head","options"],function(t){go.prototype[t]=function(r,i){return this.request(Gi(i||{},{method:t,url:r,data:(i||{}).data}))}});W.forEach(["post","put","patch"],function(t){function r(i){return function(s,a,c){return this.request(Gi(c||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:s,data:a}))}}go.prototype[t]=r(),go.prototype[t+"Form"]=r(!0)});var Ka=go;var Za=class{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});let i=this;this.promise.then(n=>{if(!i._listeners)return;let s=i._listeners.length;for(;s-- >0;)i._listeners[s](n);i._listeners=null}),this.promise.then=n=>{let s,a=new Promise(c=>{i.subscribe(c),s=c}).then(n);return a.cancel=function(){i.unsubscribe(s)},a},t(function(s,a,c){i.reason||(i.reason=new wn(s,a,c),r(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;let r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}static source(){let t;return{token:new Za(function(n){t=n}),cancel:t}}},T0=Za;function Rd(e){return function(r){return e.apply(null,r)}}function Id(e){return W.isObject(e)&&e.isAxiosError===!0}var Pd={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Pd).forEach(([e,t])=>{Pd[t]=e});var E0=Pd;function w0(e){let t=new Ka(e),r=Va(Ka.prototype.request,t);return W.extend(r,Ka.prototype,t,{allOwnKeys:!0}),W.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return w0(Gi(e,n))},r}var xe=w0(po);xe.Axios=Ka;xe.CanceledError=wn;xe.CancelToken=T0;xe.isCancel=ja;xe.VERSION=nu;xe.toFormData=En;xe.AxiosError=Bt;xe.Cancel=xe.CanceledError;xe.all=function(t){return Promise.all(t)};xe.spread=Rd;xe.isAxiosError=Id;xe.mergeConfig=Gi;xe.AxiosHeaders=Ke;xe.formToJSON=e=>Qh(W.isHTMLForm(e)?new FormData(e):e);xe.HttpStatusCode=E0;xe.default=xe;var Ja=xe;var{Axios:lj,AxiosError:hj,CanceledError:uj,isCancel:cj,CancelToken:fj,VERSION:dj,all:pj,Cancel:mj,isAxiosError:gj,spread:_j,toFormData:xj,AxiosHeaders:vj,HttpStatusCode:yj,formToJSON:Tj,mergeConfig:Ej}=Ja;var be=Ei(ou(),1);var S0=Ei(ou(),1);function b0(e,t){return e.anchor.set(.5),e.width=t.w,e.height=t.h,{sprite:e,body:S0.default.Bodies.rectangle(t.x,t.y,t.w,t.h),update(){this.sprite.x=this.body.position.x,this.sprite.y=this.body.position.y,this.sprite.rotation=this.body.angle}}}var A0=Ei(Bd(),1),fi;(p=>{let e=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"];function t(l){let h=e.find(m=>l.includes(m));if(h===void 0)throw new Error(`${l} does not contain a valid note`);let d=l.substring(h.length,l.length);if(!/(\d+)/g.test(d))throw new Error(`${l} does not contain a valid octave number`);return{chroma:h,octave:A0.default.parseInt(d)}}p.parse=t;function r(...l){return l.map(h=>t(h))}p.parseSeq=r;function i(l,h){return{chroma:l,octave:h}}p.create=i;function n(l,h){return l.chroma===h.chroma&&l.octave===h.octave}p.eq=n;function s(l){let h=c(l.chroma),d=(h+1)%12,m=l.octave+Math.floor((h+1)/12);return{chroma:a(d),octave:m}}p.inc=s;function a(l){if(l>11)throw new Error(`${l} is not a valid chroma index. Must be >=0 and < 12`);return e[l]}p.indexToChroma=a;function c(l){return e.indexOf(l)}p.chromaIndex=c;function f(l){return`${l.chroma}${l.octave}`}p.toString=f})(fi||={});var Hi=Ei(ou(),1),xo=class{constructor(t){this.entity=t}hasJumped=!1;color=16711680;alpha=1;jumpStrength=1;static forceVector(t,r){let i=Hi.default.Vector.create(r.x-t.x,r.y-t.y),n=Math.max(Hi.default.Vector.magnitude(i),400),s=Hi.default.Vector.div(Hi.default.Vector.normalise(i),10);return Hi.default.Vector.mult(s,n/400)}slice(t){Hi.default.Body.applyForce(this.entity.body,this.entity.body.position,xo.forceVector(this.entity.body.position,t))}jump(){if(!this.hasJumped){let t=Hi.default.Vector.create(0,-.1*this.jumpStrength);Hi.default.Body.applyForce(this.entity.body,this.entity.body.position,t),this.hasJumped=!0,setTimeout(()=>{this.hasJumped=!1},500)}}update(){this.entity.sprite.x=this.entity.body.position.x,this.entity.sprite.y=this.entity.body.position.y,this.entity.sprite.rotation=this.entity.body.angle,this.entity.body.position.y&&(this.hasJumped?this.entity.sprite.alpha=.5:this.entity.sprite.alpha=1)}};var R0=Ei(C0(),1),XR=Ei(Bd(),1);var vo=class{howl;static async load(t,r,i,n){let s=[],a=i,c=fi.inc(n);for(let l=0;!fi.eq(a,c);++l)s.push([fi.toString(a),[l*r,r]]),a=fi.inc(a);let f=Object.fromEntries(s),p=new R0.Howl({src:t,sprite:f});return new Promise((l,h)=>{p.on("load",()=>{l(new vo(p))}),p.on("loaderror",()=>{h("unable to load")}),p.load()})}constructor(t){this.howl=t}playNote(t,r){this.howl.play(`${t}${r}`)}};var Dd=class{constructor(t,r,i,n){this.player=t;this.length=r;this.type=i;this.nextNote=n;switch(i){case 2:case 0:this.idx=0,this.direction=1;break;case 1:this.idx=r-1,this.direction=-1;break}}idx=0;direction=1;playNote(){let t=this.nextNote(this.idx);switch(this.player.playNote(t.chroma,t.octave),this.type){case 0:this.idx++;break;case 1:this.idx--;break;case 2:this.idx=this.idx+this.direction,this.idx>=this.length?(this.idx=this.length-2,this.direction=-1):this.idx<0&&(this.idx=1,this.direction=1);break}this.idx=(this.idx+this.length)%this.length}},lu=class extends Dd{idx=0;direction=1;constructor(t,r,i){super(t,r.length,i,n=>r[n])}};async function zR(){let[e,t]=await Promise.all([Ja.get("assets/meta/gfx.json").then(w=>w.data),Ja.get("assets/meta/sfx.json").then(w=>w.data)]),r={};for(let w of e)r[w.name]=Le.from(w.path);let i=fi.create("C",2),n=fi.create("C",8),s={};for(let w of t)s[w.name]=await vo.load(w.path,2e3,i,n);let a=fi.parseSeq("C5","E5","G5","B5","Db6"),c=new lu(s.pipe,a,2),f=new ba({resizeTo:window,autoDensity:!0,antialias:!0});document.body.appendChild(f.view),f.renderer.events.cursorStyles.default="crosshair";let p=be.default.World.create({}),l=be.default.Engine.create({world:p}),h=b0(r.purple,{x:window.innerWidth/2,y:window.innerHeight/2,w:40,h:40}),d=new xo(h);f.stage.addChild(h.sprite);function m(w){return be.default.Composite.create({bodies:[be.default.Bodies.rectangle(f.view.width/2,-w/2,f.view.width,w,{isStatic:!0}),be.default.Bodies.rectangle(f.view.width/2,f.view.height+w/2,f.view.width,w,{isStatic:!0}),be.default.Bodies.rectangle(-w/2,f.view.height/2,w,f.view.height,{isStatic:!0}),be.default.Bodies.rectangle(f.view.width+w/2,f.view.height/2,w,f.view.height,{isStatic:!0})]})}let _=1e3,x=m(_);be.default.Composite.add(l.world,[x,h.body]);let T=be.default.Vector.create();window.addEventListener("resize",w=>{be.default.Composite.remove(l.world,x),x=m(_),be.default.Composite.add(l.world,x)}),window.addEventListener("mousemove",w=>{T.x=w.x,T.y=w.y}),window.addEventListener("keydown",w=>{w.key===" "&&d.jump()});let S=(w,y)=>{c.playNote(),d.slice(be.default.Vector.create(w,y))};window.addEventListener("touchstart",w=>{let y=w.touches[0],E=y.pageX,R=y.pageY;S(E,R)}),window.addEventListener("click",w=>{S(w.x,w.y)}),f.ticker.add(()=>{be.default.Engine.update(l,Math.floor(f.ticker.deltaMS));let w=d.entity.body.position;(w.x<0||w.x>f.view.width)&&(be.default.Body.set(d.entity.body,"position",{x:window.innerWidth/2,y:window.innerHeight/2}),be.default.Body.setVelocity(d.entity.body,{x:0,y:0})),(w.y<0||w.y>f.view.height)&&(be.default.Body.set(d.entity.body,"position",{x:window.innerWidth/2,y:window.innerHeight/2}),be.default.Body.setVelocity(d.entity.body,{x:0,y:0})),d.update()})}window.addEventListener("load",()=>{zR()});})();
/*! Bundled license information:

punycode/punycode.js:
  (*! https://mths.be/punycode v1.3.2 by @mathias *)

matter-js/build/matter.js:
  (*!
   * matter-js 0.19.0 by @liabru
   * http://brm.io/matter-js/
   * License MIT
   * 
   * The MIT License (MIT)
   * 
   * Copyright (c) Liam Brummitt and contributors.
   * 
   * Permission is hereby granted, free of charge, to any person obtaining a copy
   * of this software and associated documentation files (the "Software"), to deal
   * in the Software without restriction, including without limitation the rights
   * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
   * copies of the Software, and to permit persons to whom the Software is
   * furnished to do so, subject to the following conditions:
   * 
   * The above copyright notice and this permission notice shall be included in
   * all copies or substantial portions of the Software.
   * 
   * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
   * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
   * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
   * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
   * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
   * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
   * THE SOFTWARE.
   *)

lodash/lodash.js:
  (**
   * @license
   * Lodash <https://lodash.com/>
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)

howler/dist/howler.js:
  (*!
   *  howler.js v2.2.3
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   *)
  (*!
   *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
   *  
   *  howler.js v2.2.3
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   *)
*/
