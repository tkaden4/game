"use strict";(()=>{var _S=Object.create;var Vu=Object.defineProperty;var vS=Object.getOwnPropertyDescriptor;var yS=Object.getOwnPropertyNames;var TS=Object.getPrototypeOf,ES=Object.prototype.hasOwnProperty;var Jr=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),SS=(e,t)=>{for(var r in t)Vu(e,r,{get:t[r],enumerable:!0})},wS=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of yS(t))!ES.call(e,n)&&n!==r&&Vu(e,n,{get:()=>t[n],enumerable:!(i=vS(t,n))||i.enumerable});return e};var Sn=(e,t,r)=>(r=e!=null?_S(TS(e)):{},wS(t||!e||!e.__esModule?Vu(r,"default",{value:e,enumerable:!0}):r,e));var fm=Jr((wA,$u)=>{"use strict";var CS=Object.prototype.hasOwnProperty,Ge="~";function vo(){}Object.create&&(vo.prototype=Object.create(null),new vo().__proto__||(Ge=!1));function RS(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function cm(e,t,r,i,n){if(typeof r!="function")throw new TypeError("The listener must be a function");var o=new RS(r,i||e,n),a=Ge?Ge+t:t;return e._events[a]?e._events[a].fn?e._events[a]=[e._events[a],o]:e._events[a].push(o):(e._events[a]=o,e._eventsCount++),e}function _h(e,t){--e._eventsCount===0?e._events=new vo:delete e._events[t]}function Pe(){this._events=new vo,this._eventsCount=0}Pe.prototype.eventNames=function(){var t=[],r,i;if(this._eventsCount===0)return t;for(i in r=this._events)CS.call(r,i)&&t.push(Ge?i.slice(1):i);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};Pe.prototype.listeners=function(t){var r=Ge?Ge+t:t,i=this._events[r];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,o=i.length,a=new Array(o);n<o;n++)a[n]=i[n].fn;return a};Pe.prototype.listenerCount=function(t){var r=Ge?Ge+t:t,i=this._events[r];return i?i.fn?1:i.length:0};Pe.prototype.emit=function(t,r,i,n,o,a){var l=Ge?Ge+t:t;if(!this._events[l])return!1;var c=this._events[l],d=arguments.length,f,u;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,r),!0;case 3:return c.fn.call(c.context,r,i),!0;case 4:return c.fn.call(c.context,r,i,n),!0;case 5:return c.fn.call(c.context,r,i,n,o),!0;case 6:return c.fn.call(c.context,r,i,n,o,a),!0}for(u=1,f=new Array(d-1);u<d;u++)f[u-1]=arguments[u];c.fn.apply(c.context,f)}else{var m=c.length,g;for(u=0;u<m;u++)switch(c[u].once&&this.removeListener(t,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,r);break;case 3:c[u].fn.call(c[u].context,r,i);break;case 4:c[u].fn.call(c[u].context,r,i,n);break;default:if(!f)for(g=1,f=new Array(d-1);g<d;g++)f[g-1]=arguments[g];c[u].fn.apply(c[u].context,f)}}return!0};Pe.prototype.on=function(t,r,i){return cm(this,t,r,i,!1)};Pe.prototype.once=function(t,r,i){return cm(this,t,r,i,!0)};Pe.prototype.removeListener=function(t,r,i,n){var o=Ge?Ge+t:t;if(!this._events[o])return this;if(!r)return _h(this,o),this;var a=this._events[o];if(a.fn)a.fn===r&&(!n||a.once)&&(!i||a.context===i)&&_h(this,o);else{for(var l=0,c=[],d=a.length;l<d;l++)(a[l].fn!==r||n&&!a[l].once||i&&a[l].context!==i)&&c.push(a[l]);c.length?this._events[o]=c.length===1?c[0]:c:_h(this,o)}return this};Pe.prototype.removeAllListeners=function(t){var r;return t?(r=Ge?Ge+t:t,this._events[r]&&_h(this,r)):(this._events=new vo,this._eventsCount=0),this};Pe.prototype.off=Pe.prototype.removeListener;Pe.prototype.addListener=Pe.prototype.on;Pe.prefixed=Ge;Pe.EventEmitter=Pe;typeof $u<"u"&&($u.exports=Pe)});var xm=Jr((bA,qu)=>{"use strict";qu.exports=Th;qu.exports.default=Th;function Th(e,t,r){r=r||2;var i=t&&t.length,n=i?t[0]*r:e.length,o=pm(e,0,n,r,!0),a=[];if(!o||o.next===o.prev)return a;var l,c,d,f,u,m,g;if(i&&(o=DS(e,t,o,r)),e.length>80*r){l=d=e[0],c=f=e[1];for(var x=r;x<n;x+=r)u=e[x],m=e[x+1],u<l&&(l=u),m<c&&(c=m),u>d&&(d=u),m>f&&(f=m);g=Math.max(d-l,f-c),g=g!==0?32767/g:0}return yo(o,a,r,l,c,g,0),a}function pm(e,t,r,i,n){var o,a;if(n===Zu(e,t,r,i)>0)for(o=t;o<r;o+=i)a=dm(o,e[o],e[o+1],a);else for(o=r-i;o>=t;o-=i)a=dm(o,e[o],e[o+1],a);return a&&Eh(a,a.next)&&(Eo(a),a=a.next),a}function wn(e,t){if(!e)return e;t||(t=e);var r=e,i;do if(i=!1,!r.steiner&&(Eh(r,r.next)||te(r.prev,r,r.next)===0)){if(Eo(r),r=t=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==t);return t}function yo(e,t,r,i,n,o,a){if(e){!a&&o&&US(e,i,n,o);for(var l=e,c,d;e.prev!==e.next;){if(c=e.prev,d=e.next,o?PS(e,i,n,o):IS(e)){t.push(c.i/r|0),t.push(e.i/r|0),t.push(d.i/r|0),Eo(e),e=d.next,l=d.next;continue}if(e=d,e===l){a?a===1?(e=MS(wn(e),t,r),yo(e,t,r,i,n,o,2)):a===2&&BS(e,t,r,i,n,o):yo(wn(e),t,r,i,n,o,1);break}}}}function IS(e){var t=e.prev,r=e,i=e.next;if(te(t,r,i)>=0)return!1;for(var n=t.x,o=r.x,a=i.x,l=t.y,c=r.y,d=i.y,f=n<o?n<a?n:a:o<a?o:a,u=l<c?l<d?l:d:c<d?c:d,m=n>o?n>a?n:a:o>a?o:a,g=l>c?l>d?l:d:c>d?c:d,x=i.next;x!==t;){if(x.x>=f&&x.x<=m&&x.y>=u&&x.y<=g&&fs(n,l,o,c,a,d,x.x,x.y)&&te(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function PS(e,t,r,i){var n=e.prev,o=e,a=e.next;if(te(n,o,a)>=0)return!1;for(var l=n.x,c=o.x,d=a.x,f=n.y,u=o.y,m=a.y,g=l<c?l<d?l:d:c<d?c:d,x=f<u?f<m?f:m:u<m?u:m,y=l>c?l>d?l:d:c>d?c:d,S=f>u?f>m?f:m:u>m?u:m,b=ju(g,x,t,r,i),w=ju(y,S,t,r,i),v=e.prevZ,T=e.nextZ;v&&v.z>=b&&T&&T.z<=w;){if(v.x>=g&&v.x<=y&&v.y>=x&&v.y<=S&&v!==n&&v!==a&&fs(l,f,c,u,d,m,v.x,v.y)&&te(v.prev,v,v.next)>=0||(v=v.prevZ,T.x>=g&&T.x<=y&&T.y>=x&&T.y<=S&&T!==n&&T!==a&&fs(l,f,c,u,d,m,T.x,T.y)&&te(T.prev,T,T.next)>=0))return!1;T=T.nextZ}for(;v&&v.z>=b;){if(v.x>=g&&v.x<=y&&v.y>=x&&v.y<=S&&v!==n&&v!==a&&fs(l,f,c,u,d,m,v.x,v.y)&&te(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;T&&T.z<=w;){if(T.x>=g&&T.x<=y&&T.y>=x&&T.y<=S&&T!==n&&T!==a&&fs(l,f,c,u,d,m,T.x,T.y)&&te(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}function MS(e,t,r){var i=e;do{var n=i.prev,o=i.next.next;!Eh(n,o)&&mm(n,i,i.next,o)&&To(n,o)&&To(o,n)&&(t.push(n.i/r|0),t.push(i.i/r|0),t.push(o.i/r|0),Eo(i),Eo(i.next),i=e=o),i=i.next}while(i!==e);return wn(i)}function BS(e,t,r,i,n,o){var a=e;do{for(var l=a.next.next;l!==a.prev;){if(a.i!==l.i&&HS(a,l)){var c=gm(a,l);a=wn(a,a.next),c=wn(c,c.next),yo(a,t,r,i,n,o,0),yo(c,t,r,i,n,o,0);return}l=l.next}a=a.next}while(a!==e)}function DS(e,t,r,i){var n=[],o,a,l,c,d;for(o=0,a=t.length;o<a;o++)l=t[o]*i,c=o<a-1?t[o+1]*i:e.length,d=pm(e,l,c,i,!1),d===d.next&&(d.steiner=!0),n.push(kS(d));for(n.sort(LS),o=0;o<n.length;o++)r=FS(n[o],r);return r}function LS(e,t){return e.x-t.x}function FS(e,t){var r=OS(e,t);if(!r)return t;var i=gm(r,e);return wn(i,i.next),wn(r,r.next)}function OS(e,t){var r=t,i=e.x,n=e.y,o=-1/0,a;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){var l=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(l<=i&&l>o&&(o=l,a=r.x<r.next.x?r:r.next,l===i))return a}r=r.next}while(r!==t);if(!a)return null;var c=a,d=a.x,f=a.y,u=1/0,m;r=a;do i>=r.x&&r.x>=d&&i!==r.x&&fs(n<f?i:o,n,d,f,n<f?o:i,n,r.x,r.y)&&(m=Math.abs(n-r.y)/(i-r.x),To(r,e)&&(m<u||m===u&&(r.x>a.x||r.x===a.x&&NS(a,r)))&&(a=r,u=m)),r=r.next;while(r!==c);return a}function NS(e,t){return te(e.prev,e,t.prev)<0&&te(t.next,e,e.next)<0}function US(e,t,r,i){var n=e;do n.z===0&&(n.z=ju(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,GS(n)}function GS(e){var t,r,i,n,o,a,l,c,d=1;do{for(r=e,e=null,o=null,a=0;r;){for(a++,i=r,l=0,t=0;t<d&&(l++,i=i.nextZ,!!i);t++);for(c=d;l>0||c>0&&i;)l!==0&&(c===0||!i||r.z<=i.z)?(n=r,r=r.nextZ,l--):(n=i,i=i.nextZ,c--),o?o.nextZ=n:e=n,n.prevZ=o,o=n;r=i}o.nextZ=null,d*=2}while(a>1);return e}function ju(e,t,r,i,n){return e=(e-r)*n|0,t=(t-i)*n|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function kS(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function fs(e,t,r,i,n,o,a,l){return(n-a)*(t-l)>=(e-a)*(o-l)&&(e-a)*(i-l)>=(r-a)*(t-l)&&(r-a)*(o-l)>=(n-a)*(i-l)}function HS(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!VS(e,t)&&(To(e,t)&&To(t,e)&&WS(e,t)&&(te(e.prev,e,t.prev)||te(e,t.prev,t))||Eh(e,t)&&te(e.prev,e,e.next)>0&&te(t.prev,t,t.next)>0)}function te(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Eh(e,t){return e.x===t.x&&e.y===t.y}function mm(e,t,r,i){var n=yh(te(e,t,r)),o=yh(te(e,t,i)),a=yh(te(r,i,e)),l=yh(te(r,i,t));return!!(n!==o&&a!==l||n===0&&vh(e,r,t)||o===0&&vh(e,i,t)||a===0&&vh(r,e,i)||l===0&&vh(r,t,i))}function vh(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function yh(e){return e>0?1:e<0?-1:0}function VS(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&mm(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function To(e,t){return te(e.prev,e,e.next)<0?te(e,t,e.next)>=0&&te(e,e.prev,t)>=0:te(e,t,e.prev)<0||te(e,e.next,t)<0}function WS(e,t){var r=e,i=!1,n=(e.x+t.x)/2,o=(e.y+t.y)/2;do r.y>o!=r.next.y>o&&r.next.y!==r.y&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e);return i}function gm(e,t){var r=new Ku(e.i,e.x,e.y),i=new Ku(t.i,t.x,t.y),n=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,o.next=i,i.prev=o,i}function dm(e,t,r,i){var n=new Ku(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function Eo(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Ku(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Th.deviation=function(e,t,r,i){var n=t&&t.length,o=n?t[0]*r:e.length,a=Math.abs(Zu(e,0,o,r));if(n)for(var l=0,c=t.length;l<c;l++){var d=t[l]*r,f=l<c-1?t[l+1]*r:e.length;a-=Math.abs(Zu(e,d,f,r))}var u=0;for(l=0;l<i.length;l+=3){var m=i[l]*r,g=i[l+1]*r,x=i[l+2]*r;u+=Math.abs((e[m]-e[x])*(e[g+1]-e[m+1])-(e[m]-e[g])*(e[x+1]-e[m+1]))}return a===0&&u===0?0:Math.abs((u-a)/a)};function Zu(e,t,r,i){for(var n=0,o=t,a=r-i;o<r;o+=i)n+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return n}Th.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,n=0;n<e.length;n++){for(var o=0;o<e[n].length;o++)for(var a=0;a<t;a++)r.vertices.push(e[n][o][a]);n>0&&(i+=e[n-1].length,r.holes.push(i))}return r}});var _m=Jr((ds,ps)=>{(function(e){var t=typeof ds=="object"&&ds&&!ds.nodeType&&ds,r=typeof ps=="object"&&ps&&!ps.nodeType&&ps,i=typeof global=="object"&&global;(i.global===i||i.window===i||i.self===i)&&(e=i);var n,o=2147483647,a=36,l=1,c=26,d=38,f=700,u=72,m=128,g="-",x=/^xn--/,y=/[^\x20-\x7E]/,S=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=a-l,v=Math.floor,T=String.fromCharCode,I;function C(Y){throw RangeError(b[Y])}function P(Y,J){for(var st=Y.length,xt=[];st--;)xt[st]=J(Y[st]);return xt}function M(Y,J){var st=Y.split("@"),xt="";st.length>1&&(xt=st[0]+"@",Y=st[1]),Y=Y.replace(S,".");var Tt=Y.split("."),Ct=P(Tt,J).join(".");return xt+Ct}function B(Y){for(var J=[],st=0,xt=Y.length,Tt,Ct;st<xt;)Tt=Y.charCodeAt(st++),Tt>=55296&&Tt<=56319&&st<xt?(Ct=Y.charCodeAt(st++),(Ct&64512)==56320?J.push(((Tt&1023)<<10)+(Ct&1023)+65536):(J.push(Tt),st--)):J.push(Tt);return J}function F(Y){return P(Y,function(J){var st="";return J>65535&&(J-=65536,st+=T(J>>>10&1023|55296),J=56320|J&1023),st+=T(J),st}).join("")}function L(Y){return Y-48<10?Y-22:Y-65<26?Y-65:Y-97<26?Y-97:a}function V(Y,J){return Y+22+75*(Y<26)-((J!=0)<<5)}function N(Y,J,st){var xt=0;for(Y=st?v(Y/f):Y>>1,Y+=v(Y/J);Y>w*c>>1;xt+=a)Y=v(Y/w);return v(xt+(w+1)*Y/(Y+d))}function k(Y){var J=[],st=Y.length,xt,Tt=0,Ct=m,yt=u,Ht,Bt,Jt,xe,Yt,Vt,jt,Dt,Ot;for(Ht=Y.lastIndexOf(g),Ht<0&&(Ht=0),Bt=0;Bt<Ht;++Bt)Y.charCodeAt(Bt)>=128&&C("not-basic"),J.push(Y.charCodeAt(Bt));for(Jt=Ht>0?Ht+1:0;Jt<st;){for(xe=Tt,Yt=1,Vt=a;Jt>=st&&C("invalid-input"),jt=L(Y.charCodeAt(Jt++)),(jt>=a||jt>v((o-Tt)/Yt))&&C("overflow"),Tt+=jt*Yt,Dt=Vt<=yt?l:Vt>=yt+c?c:Vt-yt,!(jt<Dt);Vt+=a)Ot=a-Dt,Yt>v(o/Ot)&&C("overflow"),Yt*=Ot;xt=J.length+1,yt=N(Tt-xe,xt,xe==0),v(Tt/xt)>o-Ct&&C("overflow"),Ct+=v(Tt/xt),Tt%=xt,J.splice(Tt++,0,Ct)}return F(J)}function Z(Y){var J,st,xt,Tt,Ct,yt,Ht,Bt,Jt,xe,Yt,Vt=[],jt,Dt,Ot,Yr;for(Y=B(Y),jt=Y.length,J=m,st=0,Ct=u,yt=0;yt<jt;++yt)Yt=Y[yt],Yt<128&&Vt.push(T(Yt));for(xt=Tt=Vt.length,Tt&&Vt.push(g);xt<jt;){for(Ht=o,yt=0;yt<jt;++yt)Yt=Y[yt],Yt>=J&&Yt<Ht&&(Ht=Yt);for(Dt=xt+1,Ht-J>v((o-st)/Dt)&&C("overflow"),st+=(Ht-J)*Dt,J=Ht,yt=0;yt<jt;++yt)if(Yt=Y[yt],Yt<J&&++st>o&&C("overflow"),Yt==J){for(Bt=st,Jt=a;xe=Jt<=Ct?l:Jt>=Ct+c?c:Jt-Ct,!(Bt<xe);Jt+=a)Yr=Bt-xe,Ot=a-xe,Vt.push(T(V(xe+Yr%Ot,0))),Bt=v(Yr/Ot);Vt.push(T(V(Bt,0))),Ct=N(st,Dt,xt==Tt),st=0,++xt}++st,++J}return Vt.join("")}function j(Y){return M(Y,function(J){return x.test(J)?k(J.slice(4).toLowerCase()):J})}function rt(Y){return M(Y,function(J){return y.test(J)?"xn--"+Z(J):J})}if(n={version:"1.3.2",ucs2:{decode:B,encode:F},decode:k,encode:Z,toASCII:rt,toUnicode:j},typeof define=="function"&&typeof define.amd=="object"&&define.amd)define("punycode",function(){return n});else if(t&&r)if(ps.exports==t)r.exports=n;else for(I in n)n.hasOwnProperty(I)&&(t[I]=n[I]);else e.punycode=n})(ds)});var ym=Jr((AA,vm)=>{"use strict";vm.exports={isString:function(e){return typeof e=="string"},isObject:function(e){return typeof e=="object"&&e!==null},isNull:function(e){return e===null},isNullOrUndefined:function(e){return e==null}}});var Em=Jr((CA,Tm)=>{"use strict";function XS(e,t){return Object.prototype.hasOwnProperty.call(e,t)}Tm.exports=function(e,t,r,i){t=t||"&",r=r||"=";var n={};if(typeof e!="string"||e.length===0)return n;var o=/\+/g;e=e.split(t);var a=1e3;i&&typeof i.maxKeys=="number"&&(a=i.maxKeys);var l=e.length;a>0&&l>a&&(l=a);for(var c=0;c<l;++c){var d=e[c].replace(o,"%20"),f=d.indexOf(r),u,m,g,x;f>=0?(u=d.substr(0,f),m=d.substr(f+1)):(u=d,m=""),g=decodeURIComponent(u),x=decodeURIComponent(m),XS(n,g)?Array.isArray(n[g])?n[g].push(x):n[g]=[n[g],x]:n[g]=x}return n}});var wm=Jr((RA,Sm)=>{"use strict";var So=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};Sm.exports=function(e,t,r,i){return t=t||"&",r=r||"=",e===null&&(e=void 0),typeof e=="object"?Object.keys(e).map(function(n){var o=encodeURIComponent(So(n))+r;return Array.isArray(e[n])?e[n].map(function(a){return o+encodeURIComponent(So(a))}).join(t):o+encodeURIComponent(So(e[n]))}).join(t):i?encodeURIComponent(So(i))+r+encodeURIComponent(So(e)):""}});var bm=Jr(wo=>{"use strict";wo.decode=wo.parse=Em();wo.encode=wo.stringify=wm()});var Im=Jr(gs=>{"use strict";var zS=_m(),Qr=ym();gs.parse=bo;gs.resolve=ew;gs.resolveObject=rw;gs.format=tw;gs.Url=Cr;function Cr(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var YS=/^([a-z0-9.+-]+:)/i,$S=/:[0-9]*$/,jS=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,KS=["<",">",'"',"`"," ","\r",`
`,"	"],ZS=["{","}","|","\\","^","`"].concat(KS),Ju=["'"].concat(ZS),Am=["%","/","?",";","#"].concat(Ju),Cm=["/","?","#"],qS=255,Rm=/^[+a-z0-9A-Z_-]{0,63}$/,JS=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,QS={javascript:!0,"javascript:":!0},Qu={javascript:!0,"javascript:":!0},ms={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},tc=bm();function bo(e,t,r){if(e&&Qr.isObject(e)&&e instanceof Cr)return e;var i=new Cr;return i.parse(e,t,r),i}Cr.prototype.parse=function(e,t,r){if(!Qr.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),n=i!==-1&&i<e.indexOf("#")?"?":"#",o=e.split(n),a=/\\/g;o[0]=o[0].replace(a,"/"),e=o.join(n);var l=e;if(l=l.trim(),!r&&e.split("#").length===1){var c=jS.exec(l);if(c)return this.path=l,this.href=l,this.pathname=c[1],c[2]?(this.search=c[2],t?this.query=tc.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var d=YS.exec(l);if(d){d=d[0];var f=d.toLowerCase();this.protocol=f,l=l.substr(d.length)}if(r||d||l.match(/^\/\/[^@\/]+@[^@\/]+/)){var u=l.substr(0,2)==="//";u&&!(d&&Qu[d])&&(l=l.substr(2),this.slashes=!0)}if(!Qu[d]&&(u||d&&!ms[d])){for(var m=-1,g=0;g<Cm.length;g++){var x=l.indexOf(Cm[g]);x!==-1&&(m===-1||x<m)&&(m=x)}var y,S;m===-1?S=l.lastIndexOf("@"):S=l.lastIndexOf("@",m),S!==-1&&(y=l.slice(0,S),l=l.slice(S+1),this.auth=decodeURIComponent(y)),m=-1;for(var g=0;g<Am.length;g++){var x=l.indexOf(Am[g]);x!==-1&&(m===-1||x<m)&&(m=x)}m===-1&&(m=l.length),this.host=l.slice(0,m),l=l.slice(m),this.parseHost(),this.hostname=this.hostname||"";var b=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!b)for(var w=this.hostname.split(/\./),g=0,v=w.length;g<v;g++){var T=w[g];if(T&&!T.match(Rm)){for(var I="",C=0,P=T.length;C<P;C++)T.charCodeAt(C)>127?I+="x":I+=T[C];if(!I.match(Rm)){var M=w.slice(0,g),B=w.slice(g+1),F=T.match(JS);F&&(M.push(F[1]),B.unshift(F[2])),B.length&&(l="/"+B.join(".")+l),this.hostname=M.join(".");break}}}this.hostname.length>qS?this.hostname="":this.hostname=this.hostname.toLowerCase(),b||(this.hostname=zS.toASCII(this.hostname));var L=this.port?":"+this.port:"",V=this.hostname||"";this.host=V+L,this.href+=this.host,b&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),l[0]!=="/"&&(l="/"+l))}if(!QS[f])for(var g=0,v=Ju.length;g<v;g++){var N=Ju[g];if(l.indexOf(N)!==-1){var k=encodeURIComponent(N);k===N&&(k=escape(N)),l=l.split(N).join(k)}}var Z=l.indexOf("#");Z!==-1&&(this.hash=l.substr(Z),l=l.slice(0,Z));var j=l.indexOf("?");if(j!==-1?(this.search=l.substr(j),this.query=l.substr(j+1),t&&(this.query=tc.parse(this.query)),l=l.slice(0,j)):t&&(this.search="",this.query={}),l&&(this.pathname=l),ms[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var L=this.pathname||"",rt=this.search||"";this.path=L+rt}return this.href=this.format(),this};function tw(e){return Qr.isString(e)&&(e=bo(e)),e instanceof Cr?e.format():Cr.prototype.format.call(e)}Cr.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",i=this.hash||"",n=!1,o="";this.host?n=e+this.host:this.hostname&&(n=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&Qr.isObject(this.query)&&Object.keys(this.query).length&&(o=tc.stringify(this.query));var a=this.search||o&&"?"+o||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||ms[t])&&n!==!1?(n="//"+(n||""),r&&r.charAt(0)!=="/"&&(r="/"+r)):n||(n=""),i&&i.charAt(0)!=="#"&&(i="#"+i),a&&a.charAt(0)!=="?"&&(a="?"+a),r=r.replace(/[?#]/g,function(l){return encodeURIComponent(l)}),a=a.replace("#","%23"),t+n+r+a+i};function ew(e,t){return bo(e,!1,!0).resolve(t)}Cr.prototype.resolve=function(e){return this.resolveObject(bo(e,!1,!0)).format()};function rw(e,t){return e?bo(e,!1,!0).resolveObject(t):t}Cr.prototype.resolveObject=function(e){if(Qr.isString(e)){var t=new Cr;t.parse(e,!1,!0),e=t}for(var r=new Cr,i=Object.keys(this),n=0;n<i.length;n++){var o=i[n];r[o]=this[o]}if(r.hash=e.hash,e.href==="")return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var a=Object.keys(e),l=0;l<a.length;l++){var c=a[l];c!=="protocol"&&(r[c]=e[c])}return ms[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!ms[e.protocol]){for(var d=Object.keys(e),f=0;f<d.length;f++){var u=d[f];r[u]=e[u]}return r.href=r.format(),r}if(r.protocol=e.protocol,!e.host&&!Qu[e.protocol]){for(var v=(e.pathname||"").split("/");v.length&&!(e.host=v.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),v[0]!==""&&v.unshift(""),v.length<2&&v.unshift(""),r.pathname=v.join("/")}else r.pathname=e.pathname;if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var m=r.pathname||"",g=r.search||"";r.path=m+g}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var x=r.pathname&&r.pathname.charAt(0)==="/",y=e.host||e.pathname&&e.pathname.charAt(0)==="/",S=y||x||r.host&&e.pathname,b=S,w=r.pathname&&r.pathname.split("/")||[],v=e.pathname&&e.pathname.split("/")||[],T=r.protocol&&!ms[r.protocol];if(T&&(r.hostname="",r.port=null,r.host&&(w[0]===""?w[0]=r.host:w.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(v[0]===""?v[0]=e.host:v.unshift(e.host)),e.host=null),S=S&&(v[0]===""||w[0]==="")),y)r.host=e.host||e.host===""?e.host:r.host,r.hostname=e.hostname||e.hostname===""?e.hostname:r.hostname,r.search=e.search,r.query=e.query,w=v;else if(v.length)w||(w=[]),w.pop(),w=w.concat(v),r.search=e.search,r.query=e.query;else if(!Qr.isNullOrUndefined(e.search)){if(T){r.hostname=r.host=w.shift();var I=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;I&&(r.auth=I.shift(),r.host=r.hostname=I.shift())}return r.search=e.search,r.query=e.query,(!Qr.isNull(r.pathname)||!Qr.isNull(r.search))&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!w.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var C=w.slice(-1)[0],P=(r.host||e.host||w.length>1)&&(C==="."||C==="..")||C==="",M=0,B=w.length;B>=0;B--)C=w[B],C==="."?w.splice(B,1):C===".."?(w.splice(B,1),M++):M&&(w.splice(B,1),M--);if(!S&&!b)for(;M--;M)w.unshift("..");S&&w[0]!==""&&(!w[0]||w[0].charAt(0)!=="/")&&w.unshift(""),P&&w.join("/").substr(-1)!=="/"&&w.push("");var F=w[0]===""||w[0]&&w[0].charAt(0)==="/";if(T){r.hostname=r.host=F?"":w.length?w.shift():"";var I=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;I&&(r.auth=I.shift(),r.host=r.hostname=I.shift())}return S=S||r.host&&w.length,S&&!F&&w.unshift(""),w.length?r.pathname=w.join("/"):(r.pathname=null,r.path=null),(!Qr.isNull(r.pathname)||!Qr.isNull(r.search))&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r};Cr.prototype.parseHost=function(){var e=this.host,t=$S.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}});var vl=Jr((wa,Sf)=>{(function(t,r){typeof wa=="object"&&typeof Sf=="object"?Sf.exports=r():typeof define=="function"&&define.amd?define("Matter",[],r):typeof wa=="object"?wa.Matter=r():t.Matter=r()})(wa,function(){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(i,n,o){r.o(i,n)||Object.defineProperty(i,n,{enumerable:!0,get:o})},r.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},r.t=function(i,n){if(n&1&&(i=r(i)),n&8||n&4&&typeof i=="object"&&i&&i.__esModule)return i;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:i}),n&2&&typeof i!="string")for(var a in i)r.d(o,a,function(l){return i[l]}.bind(null,a));return o},r.n=function(i){var n=i&&i.__esModule?function(){return i.default}:function(){return i};return r.d(n,"a",n),n},r.o=function(i,n){return Object.prototype.hasOwnProperty.call(i,n)},r.p="",r(r.s=20)}([function(e,t){var r={};e.exports=r,function(){r._baseDelta=1e3/60,r._nextId=0,r._seed=0,r._nowStartTime=+new Date,r._warnedOnce={},r._decomp=null,r.extend=function(n,o){var a,l,c;typeof o=="boolean"?(a=2,c=o):(a=1,c=!0);for(var d=a;d<arguments.length;d++){var f=arguments[d];if(f)for(var u in f)c&&f[u]&&f[u].constructor===Object&&(!n[u]||n[u].constructor===Object)?(n[u]=n[u]||{},r.extend(n[u],c,f[u])):n[u]=f[u]}return n},r.clone=function(n,o){return r.extend({},o,n)},r.keys=function(n){if(Object.keys)return Object.keys(n);var o=[];for(var a in n)o.push(a);return o},r.values=function(n){var o=[];if(Object.keys){for(var a=Object.keys(n),l=0;l<a.length;l++)o.push(n[a[l]]);return o}for(var c in n)o.push(n[c]);return o},r.get=function(n,o,a,l){o=o.split(".").slice(a,l);for(var c=0;c<o.length;c+=1)n=n[o[c]];return n},r.set=function(n,o,a,l,c){var d=o.split(".").slice(l,c);return r.get(n,o,0,-1)[d[d.length-1]]=a,a},r.shuffle=function(n){for(var o=n.length-1;o>0;o--){var a=Math.floor(r.random()*(o+1)),l=n[o];n[o]=n[a],n[a]=l}return n},r.choose=function(n){return n[Math.floor(r.random()*n.length)]},r.isElement=function(n){return typeof HTMLElement<"u"?n instanceof HTMLElement:!!(n&&n.nodeType&&n.nodeName)},r.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"},r.isFunction=function(n){return typeof n=="function"},r.isPlainObject=function(n){return typeof n=="object"&&n.constructor===Object},r.isString=function(n){return toString.call(n)==="[object String]"},r.clamp=function(n,o,a){return n<o?o:n>a?a:n},r.sign=function(n){return n<0?-1:1},r.now=function(){if(typeof window<"u"&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-r._nowStartTime},r.random=function(n,o){return n=typeof n<"u"?n:0,o=typeof o<"u"?o:1,n+i()*(o-n)};var i=function(){return r._seed=(r._seed*9301+49297)%233280,r._seed/233280};r.colorToNumber=function(n){return n=n.replace("#",""),n.length==3&&(n=n.charAt(0)+n.charAt(0)+n.charAt(1)+n.charAt(1)+n.charAt(2)+n.charAt(2)),parseInt(n,16)},r.logLevel=1,r.log=function(){console&&r.logLevel>0&&r.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.info=function(){console&&r.logLevel>0&&r.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.warn=function(){console&&r.logLevel>0&&r.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.warnOnce=function(){var n=Array.prototype.slice.call(arguments).join(" ");r._warnedOnce[n]||(r.warn(n),r._warnedOnce[n]=!0)},r.deprecated=function(n,o,a){n[o]=r.chain(function(){r.warnOnce("\u{1F505} deprecated \u{1F505}",a)},n[o])},r.nextId=function(){return r._nextId++},r.indexOf=function(n,o){if(n.indexOf)return n.indexOf(o);for(var a=0;a<n.length;a++)if(n[a]===o)return a;return-1},r.map=function(n,o){if(n.map)return n.map(o);for(var a=[],l=0;l<n.length;l+=1)a.push(o(n[l]));return a},r.topologicalSort=function(n){var o=[],a=[],l=[];for(var c in n)!a[c]&&!l[c]&&r._topologicalSort(c,a,l,n,o);return o},r._topologicalSort=function(n,o,a,l,c){var d=l[n]||[];a[n]=!0;for(var f=0;f<d.length;f+=1){var u=d[f];a[u]||o[u]||r._topologicalSort(u,o,a,l,c)}a[n]=!1,o[n]=!0,c.push(n)},r.chain=function(){for(var n=[],o=0;o<arguments.length;o+=1){var a=arguments[o];a._chained?n.push.apply(n,a._chained):n.push(a)}var l=function(){for(var c,d=new Array(arguments.length),f=0,u=arguments.length;f<u;f++)d[f]=arguments[f];for(f=0;f<n.length;f+=1){var m=n[f].apply(c,d);typeof m<"u"&&(c=m)}return c};return l._chained=n,l},r.chainPathBefore=function(n,o,a){return r.set(n,o,r.chain(a,r.get(n,o)))},r.chainPathAfter=function(n,o,a){return r.set(n,o,r.chain(r.get(n,o),a))},r.setDecomp=function(n){r._decomp=n},r.getDecomp=function(){var n=r._decomp;try{!n&&typeof window<"u"&&(n=window.decomp),!n&&typeof global<"u"&&(n=global.decomp)}catch{n=null}return n}}()},function(e,t){var r={};e.exports=r,function(){r.create=function(i){var n={min:{x:0,y:0},max:{x:0,y:0}};return i&&r.update(n,i),n},r.update=function(i,n,o){i.min.x=1/0,i.max.x=-1/0,i.min.y=1/0,i.max.y=-1/0;for(var a=0;a<n.length;a++){var l=n[a];l.x>i.max.x&&(i.max.x=l.x),l.x<i.min.x&&(i.min.x=l.x),l.y>i.max.y&&(i.max.y=l.y),l.y<i.min.y&&(i.min.y=l.y)}o&&(o.x>0?i.max.x+=o.x:i.min.x+=o.x,o.y>0?i.max.y+=o.y:i.min.y+=o.y)},r.contains=function(i,n){return n.x>=i.min.x&&n.x<=i.max.x&&n.y>=i.min.y&&n.y<=i.max.y},r.overlaps=function(i,n){return i.min.x<=n.max.x&&i.max.x>=n.min.x&&i.max.y>=n.min.y&&i.min.y<=n.max.y},r.translate=function(i,n){i.min.x+=n.x,i.max.x+=n.x,i.min.y+=n.y,i.max.y+=n.y},r.shift=function(i,n){var o=i.max.x-i.min.x,a=i.max.y-i.min.y;i.min.x=n.x,i.max.x=n.x+o,i.min.y=n.y,i.max.y=n.y+a}}()},function(e,t){var r={};e.exports=r,function(){r.create=function(i,n){return{x:i||0,y:n||0}},r.clone=function(i){return{x:i.x,y:i.y}},r.magnitude=function(i){return Math.sqrt(i.x*i.x+i.y*i.y)},r.magnitudeSquared=function(i){return i.x*i.x+i.y*i.y},r.rotate=function(i,n,o){var a=Math.cos(n),l=Math.sin(n);o||(o={});var c=i.x*a-i.y*l;return o.y=i.x*l+i.y*a,o.x=c,o},r.rotateAbout=function(i,n,o,a){var l=Math.cos(n),c=Math.sin(n);a||(a={});var d=o.x+((i.x-o.x)*l-(i.y-o.y)*c);return a.y=o.y+((i.x-o.x)*c+(i.y-o.y)*l),a.x=d,a},r.normalise=function(i){var n=r.magnitude(i);return n===0?{x:0,y:0}:{x:i.x/n,y:i.y/n}},r.dot=function(i,n){return i.x*n.x+i.y*n.y},r.cross=function(i,n){return i.x*n.y-i.y*n.x},r.cross3=function(i,n,o){return(n.x-i.x)*(o.y-i.y)-(n.y-i.y)*(o.x-i.x)},r.add=function(i,n,o){return o||(o={}),o.x=i.x+n.x,o.y=i.y+n.y,o},r.sub=function(i,n,o){return o||(o={}),o.x=i.x-n.x,o.y=i.y-n.y,o},r.mult=function(i,n){return{x:i.x*n,y:i.y*n}},r.div=function(i,n){return{x:i.x/n,y:i.y/n}},r.perp=function(i,n){return n=n===!0?-1:1,{x:n*-i.y,y:n*i.x}},r.neg=function(i){return{x:-i.x,y:-i.y}},r.angle=function(i,n){return Math.atan2(n.y-i.y,n.x-i.x)},r._temp=[r.create(),r.create(),r.create(),r.create(),r.create(),r.create()]}()},function(e,t,r){var i={};e.exports=i;var n=r(2),o=r(0);(function(){i.create=function(a,l){for(var c=[],d=0;d<a.length;d++){var f=a[d],u={x:f.x,y:f.y,index:d,body:l,isInternal:!1};c.push(u)}return c},i.fromPath=function(a,l){var c=/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/ig,d=[];return a.replace(c,function(f,u,m){d.push({x:parseFloat(u),y:parseFloat(m)})}),i.create(d,l)},i.centre=function(a){for(var l=i.area(a,!0),c={x:0,y:0},d,f,u,m=0;m<a.length;m++)u=(m+1)%a.length,d=n.cross(a[m],a[u]),f=n.mult(n.add(a[m],a[u]),d),c=n.add(c,f);return n.div(c,6*l)},i.mean=function(a){for(var l={x:0,y:0},c=0;c<a.length;c++)l.x+=a[c].x,l.y+=a[c].y;return n.div(l,a.length)},i.area=function(a,l){for(var c=0,d=a.length-1,f=0;f<a.length;f++)c+=(a[d].x-a[f].x)*(a[d].y+a[f].y),d=f;return l?c/2:Math.abs(c)/2},i.inertia=function(a,l){for(var c=0,d=0,f=a,u,m,g=0;g<f.length;g++)m=(g+1)%f.length,u=Math.abs(n.cross(f[m],f[g])),c+=u*(n.dot(f[m],f[m])+n.dot(f[m],f[g])+n.dot(f[g],f[g])),d+=u;return l/6*(c/d)},i.translate=function(a,l,c){c=typeof c<"u"?c:1;var d=a.length,f=l.x*c,u=l.y*c,m;for(m=0;m<d;m++)a[m].x+=f,a[m].y+=u;return a},i.rotate=function(a,l,c){if(l!==0){var d=Math.cos(l),f=Math.sin(l),u=c.x,m=c.y,g=a.length,x,y,S,b;for(b=0;b<g;b++)x=a[b],y=x.x-u,S=x.y-m,x.x=u+(y*d-S*f),x.y=m+(y*f+S*d);return a}},i.contains=function(a,l){for(var c=l.x,d=l.y,f=a.length,u=a[f-1],m,g=0;g<f;g++){if(m=a[g],(c-u.x)*(m.y-u.y)+(d-u.y)*(u.x-m.x)>0)return!1;u=m}return!0},i.scale=function(a,l,c,d){if(l===1&&c===1)return a;d=d||i.centre(a);for(var f,u,m=0;m<a.length;m++)f=a[m],u=n.sub(f,d),a[m].x=d.x+u.x*l,a[m].y=d.y+u.y*c;return a},i.chamfer=function(a,l,c,d,f){typeof l=="number"?l=[l]:l=l||[8],c=typeof c<"u"?c:-1,d=d||2,f=f||14;for(var u=[],m=0;m<a.length;m++){var g=a[m-1>=0?m-1:a.length-1],x=a[m],y=a[(m+1)%a.length],S=l[m<l.length?m:l.length-1];if(S===0){u.push(x);continue}var b=n.normalise({x:x.y-g.y,y:g.x-x.x}),w=n.normalise({x:y.y-x.y,y:x.x-y.x}),v=Math.sqrt(2*Math.pow(S,2)),T=n.mult(o.clone(b),S),I=n.normalise(n.mult(n.add(b,w),.5)),C=n.sub(x,n.mult(I,v)),P=c;c===-1&&(P=Math.pow(S,.32)*1.75),P=o.clamp(P,d,f),P%2===1&&(P+=1);for(var M=Math.acos(n.dot(b,w)),B=M/P,F=0;F<P;F++)u.push(n.add(n.rotate(T,B*F),C))}return u},i.clockwiseSort=function(a){var l=i.mean(a);return a.sort(function(c,d){return n.angle(l,c)-n.angle(l,d)}),a},i.isConvex=function(a){var l=0,c=a.length,d,f,u,m;if(c<3)return null;for(d=0;d<c;d++)if(f=(d+1)%c,u=(d+2)%c,m=(a[f].x-a[d].x)*(a[u].y-a[f].y),m-=(a[f].y-a[d].y)*(a[u].x-a[f].x),m<0?l|=1:m>0&&(l|=2),l===3)return!1;return l!==0?!0:null},i.hull=function(a){var l=[],c=[],d,f;for(a=a.slice(0),a.sort(function(u,m){var g=u.x-m.x;return g!==0?g:u.y-m.y}),f=0;f<a.length;f+=1){for(d=a[f];c.length>=2&&n.cross3(c[c.length-2],c[c.length-1],d)<=0;)c.pop();c.push(d)}for(f=a.length-1;f>=0;f-=1){for(d=a[f];l.length>=2&&n.cross3(l[l.length-2],l[l.length-1],d)<=0;)l.pop();l.push(d)}return l.pop(),c.pop(),l.concat(c)}})()},function(e,t,r){var i={};e.exports=i;var n=r(3),o=r(2),a=r(7),l=r(0),c=r(1),d=r(11);(function(){i._timeCorrection=!0,i._inertiaScale=4,i._nextCollidingGroupId=1,i._nextNonCollidingGroupId=-1,i._nextCategory=1,i._baseDelta=1e3/60,i.create=function(u){var m={id:l.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:n.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,deltaTime:16.666666666666668,_original:null},g=l.extend(m,u);return f(g,u),g},i.nextGroup=function(u){return u?i._nextNonCollidingGroupId--:i._nextCollidingGroupId++},i.nextCategory=function(){return i._nextCategory=i._nextCategory<<1,i._nextCategory};var f=function(u,m){m=m||{},i.set(u,{bounds:u.bounds||c.create(u.vertices),positionPrev:u.positionPrev||o.clone(u.position),anglePrev:u.anglePrev||u.angle,vertices:u.vertices,parts:u.parts||[u],isStatic:u.isStatic,isSleeping:u.isSleeping,parent:u.parent||u}),n.rotate(u.vertices,u.angle,u.position),d.rotate(u.axes,u.angle),c.update(u.bounds,u.vertices,u.velocity),i.set(u,{axes:m.axes||u.axes,area:m.area||u.area,mass:m.mass||u.mass,inertia:m.inertia||u.inertia});var g=u.isStatic?"#14151f":l.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),x=u.isStatic?"#555":"#ccc",y=u.isStatic&&u.render.fillStyle===null?1:0;u.render.fillStyle=u.render.fillStyle||g,u.render.strokeStyle=u.render.strokeStyle||x,u.render.lineWidth=u.render.lineWidth||y,u.render.sprite.xOffset+=-(u.bounds.min.x-u.position.x)/(u.bounds.max.x-u.bounds.min.x),u.render.sprite.yOffset+=-(u.bounds.min.y-u.position.y)/(u.bounds.max.y-u.bounds.min.y)};i.set=function(u,m,g){var x;typeof m=="string"&&(x=m,m={},m[x]=g);for(x in m)if(Object.prototype.hasOwnProperty.call(m,x))switch(g=m[x],x){case"isStatic":i.setStatic(u,g);break;case"isSleeping":a.set(u,g);break;case"mass":i.setMass(u,g);break;case"density":i.setDensity(u,g);break;case"inertia":i.setInertia(u,g);break;case"vertices":i.setVertices(u,g);break;case"position":i.setPosition(u,g);break;case"angle":i.setAngle(u,g);break;case"velocity":i.setVelocity(u,g);break;case"angularVelocity":i.setAngularVelocity(u,g);break;case"speed":i.setSpeed(u,g);break;case"angularSpeed":i.setAngularSpeed(u,g);break;case"parts":i.setParts(u,g);break;case"centre":i.setCentre(u,g);break;default:u[x]=g}},i.setStatic=function(u,m){for(var g=0;g<u.parts.length;g++){var x=u.parts[g];x.isStatic=m,m?(x._original={restitution:x.restitution,friction:x.friction,mass:x.mass,inertia:x.inertia,density:x.density,inverseMass:x.inverseMass,inverseInertia:x.inverseInertia},x.restitution=0,x.friction=1,x.mass=x.inertia=x.density=1/0,x.inverseMass=x.inverseInertia=0,x.positionPrev.x=x.position.x,x.positionPrev.y=x.position.y,x.anglePrev=x.angle,x.angularVelocity=0,x.speed=0,x.angularSpeed=0,x.motion=0):x._original&&(x.restitution=x._original.restitution,x.friction=x._original.friction,x.mass=x._original.mass,x.inertia=x._original.inertia,x.density=x._original.density,x.inverseMass=x._original.inverseMass,x.inverseInertia=x._original.inverseInertia,x._original=null)}},i.setMass=function(u,m){var g=u.inertia/(u.mass/6);u.inertia=g*(m/6),u.inverseInertia=1/u.inertia,u.mass=m,u.inverseMass=1/u.mass,u.density=u.mass/u.area},i.setDensity=function(u,m){i.setMass(u,m*u.area),u.density=m},i.setInertia=function(u,m){u.inertia=m,u.inverseInertia=1/u.inertia},i.setVertices=function(u,m){m[0].body===u?u.vertices=m:u.vertices=n.create(m,u),u.axes=d.fromVertices(u.vertices),u.area=n.area(u.vertices),i.setMass(u,u.density*u.area);var g=n.centre(u.vertices);n.translate(u.vertices,g,-1),i.setInertia(u,i._inertiaScale*n.inertia(u.vertices,u.mass)),n.translate(u.vertices,u.position),c.update(u.bounds,u.vertices,u.velocity)},i.setParts=function(u,m,g){var x;for(m=m.slice(0),u.parts.length=0,u.parts.push(u),u.parent=u,x=0;x<m.length;x++){var y=m[x];y!==u&&(y.parent=u,u.parts.push(y))}if(u.parts.length!==1){if(g=typeof g<"u"?g:!0,g){var S=[];for(x=0;x<m.length;x++)S=S.concat(m[x].vertices);n.clockwiseSort(S);var b=n.hull(S),w=n.centre(b);i.setVertices(u,b),n.translate(u.vertices,w)}var v=i._totalProperties(u);u.area=v.area,u.parent=u,u.position.x=v.centre.x,u.position.y=v.centre.y,u.positionPrev.x=v.centre.x,u.positionPrev.y=v.centre.y,i.setMass(u,v.mass),i.setInertia(u,v.inertia),i.setPosition(u,v.centre)}},i.setCentre=function(u,m,g){g?(u.positionPrev.x+=m.x,u.positionPrev.y+=m.y,u.position.x+=m.x,u.position.y+=m.y):(u.positionPrev.x=m.x-(u.position.x-u.positionPrev.x),u.positionPrev.y=m.y-(u.position.y-u.positionPrev.y),u.position.x=m.x,u.position.y=m.y)},i.setPosition=function(u,m,g){var x=o.sub(m,u.position);g?(u.positionPrev.x=u.position.x,u.positionPrev.y=u.position.y,u.velocity.x=x.x,u.velocity.y=x.y,u.speed=o.magnitude(x)):(u.positionPrev.x+=x.x,u.positionPrev.y+=x.y);for(var y=0;y<u.parts.length;y++){var S=u.parts[y];S.position.x+=x.x,S.position.y+=x.y,n.translate(S.vertices,x),c.update(S.bounds,S.vertices,u.velocity)}},i.setAngle=function(u,m,g){var x=m-u.angle;g?(u.anglePrev=u.angle,u.angularVelocity=x,u.angularSpeed=Math.abs(x)):u.anglePrev+=x;for(var y=0;y<u.parts.length;y++){var S=u.parts[y];S.angle+=x,n.rotate(S.vertices,x,u.position),d.rotate(S.axes,x),c.update(S.bounds,S.vertices,u.velocity),y>0&&o.rotateAbout(S.position,x,u.position,S.position)}},i.setVelocity=function(u,m){var g=u.deltaTime/i._baseDelta;u.positionPrev.x=u.position.x-m.x*g,u.positionPrev.y=u.position.y-m.y*g,u.velocity.x=(u.position.x-u.positionPrev.x)/g,u.velocity.y=(u.position.y-u.positionPrev.y)/g,u.speed=o.magnitude(u.velocity)},i.getVelocity=function(u){var m=i._baseDelta/u.deltaTime;return{x:(u.position.x-u.positionPrev.x)*m,y:(u.position.y-u.positionPrev.y)*m}},i.getSpeed=function(u){return o.magnitude(i.getVelocity(u))},i.setSpeed=function(u,m){i.setVelocity(u,o.mult(o.normalise(i.getVelocity(u)),m))},i.setAngularVelocity=function(u,m){var g=u.deltaTime/i._baseDelta;u.anglePrev=u.angle-m*g,u.angularVelocity=(u.angle-u.anglePrev)/g,u.angularSpeed=Math.abs(u.angularVelocity)},i.getAngularVelocity=function(u){return(u.angle-u.anglePrev)*i._baseDelta/u.deltaTime},i.getAngularSpeed=function(u){return Math.abs(i.getAngularVelocity(u))},i.setAngularSpeed=function(u,m){i.setAngularVelocity(u,l.sign(i.getAngularVelocity(u))*m)},i.translate=function(u,m,g){i.setPosition(u,o.add(u.position,m),g)},i.rotate=function(u,m,g,x){if(!g)i.setAngle(u,u.angle+m,x);else{var y=Math.cos(m),S=Math.sin(m),b=u.position.x-g.x,w=u.position.y-g.y;i.setPosition(u,{x:g.x+(b*y-w*S),y:g.y+(b*S+w*y)},x),i.setAngle(u,u.angle+m,x)}},i.scale=function(u,m,g,x){var y=0,S=0;x=x||u.position;for(var b=0;b<u.parts.length;b++){var w=u.parts[b];n.scale(w.vertices,m,g,x),w.axes=d.fromVertices(w.vertices),w.area=n.area(w.vertices),i.setMass(w,u.density*w.area),n.translate(w.vertices,{x:-w.position.x,y:-w.position.y}),i.setInertia(w,i._inertiaScale*n.inertia(w.vertices,w.mass)),n.translate(w.vertices,{x:w.position.x,y:w.position.y}),b>0&&(y+=w.area,S+=w.inertia),w.position.x=x.x+(w.position.x-x.x)*m,w.position.y=x.y+(w.position.y-x.y)*g,c.update(w.bounds,w.vertices,u.velocity)}u.parts.length>1&&(u.area=y,u.isStatic||(i.setMass(u,u.density*y),i.setInertia(u,S))),u.circleRadius&&(m===g?u.circleRadius*=m:u.circleRadius=null)},i.update=function(u,m){m=(typeof m<"u"?m:1e3/60)*u.timeScale;var g=m*m,x=i._timeCorrection?m/(u.deltaTime||m):1,y=1-u.frictionAir*(m/l._baseDelta),S=(u.position.x-u.positionPrev.x)*x,b=(u.position.y-u.positionPrev.y)*x;u.velocity.x=S*y+u.force.x/u.mass*g,u.velocity.y=b*y+u.force.y/u.mass*g,u.positionPrev.x=u.position.x,u.positionPrev.y=u.position.y,u.position.x+=u.velocity.x,u.position.y+=u.velocity.y,u.deltaTime=m,u.angularVelocity=(u.angle-u.anglePrev)*y*x+u.torque/u.inertia*g,u.anglePrev=u.angle,u.angle+=u.angularVelocity;for(var w=0;w<u.parts.length;w++){var v=u.parts[w];n.translate(v.vertices,u.velocity),w>0&&(v.position.x+=u.velocity.x,v.position.y+=u.velocity.y),u.angularVelocity!==0&&(n.rotate(v.vertices,u.angularVelocity,u.position),d.rotate(v.axes,u.angularVelocity),w>0&&o.rotateAbout(v.position,u.angularVelocity,u.position,v.position)),c.update(v.bounds,v.vertices,u.velocity)}},i.updateVelocities=function(u){var m=i._baseDelta/u.deltaTime,g=u.velocity;g.x=(u.position.x-u.positionPrev.x)*m,g.y=(u.position.y-u.positionPrev.y)*m,u.speed=Math.sqrt(g.x*g.x+g.y*g.y),u.angularVelocity=(u.angle-u.anglePrev)*m,u.angularSpeed=Math.abs(u.angularVelocity)},i.applyForce=function(u,m,g){var x={x:m.x-u.position.x,y:m.y-u.position.y};u.force.x+=g.x,u.force.y+=g.y,u.torque+=x.x*g.y-x.y*g.x},i._totalProperties=function(u){for(var m={mass:0,area:0,inertia:0,centre:{x:0,y:0}},g=u.parts.length===1?0:1;g<u.parts.length;g++){var x=u.parts[g],y=x.mass!==1/0?x.mass:1;m.mass+=y,m.area+=x.area,m.inertia+=x.inertia,m.centre=o.add(m.centre,o.mult(x.position,y))}return m.centre=o.div(m.centre,m.mass),m}})()},function(e,t,r){var i={};e.exports=i;var n=r(0);(function(){i.on=function(o,a,l){for(var c=a.split(" "),d,f=0;f<c.length;f++)d=c[f],o.events=o.events||{},o.events[d]=o.events[d]||[],o.events[d].push(l);return l},i.off=function(o,a,l){if(!a){o.events={};return}typeof a=="function"&&(l=a,a=n.keys(o.events).join(" "));for(var c=a.split(" "),d=0;d<c.length;d++){var f=o.events[c[d]],u=[];if(l&&f)for(var m=0;m<f.length;m++)f[m]!==l&&u.push(f[m]);o.events[c[d]]=u}},i.trigger=function(o,a,l){var c,d,f,u,m=o.events;if(m&&n.keys(m).length>0){l||(l={}),c=a.split(" ");for(var g=0;g<c.length;g++)if(d=c[g],f=m[d],f){u=n.clone(l,!1),u.name=d,u.source=o;for(var x=0;x<f.length;x++)f[x].apply(o,[u])}}}})()},function(e,t,r){var i={};e.exports=i;var n=r(5),o=r(0),a=r(1),l=r(4);(function(){i.create=function(c){return o.extend({id:o.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},c)},i.setModified=function(c,d,f,u){if(c.isModified=d,d&&c.cache&&(c.cache.allBodies=null,c.cache.allConstraints=null,c.cache.allComposites=null),f&&c.parent&&i.setModified(c.parent,d,f,u),u)for(var m=0;m<c.composites.length;m++){var g=c.composites[m];i.setModified(g,d,f,u)}},i.add=function(c,d){var f=[].concat(d);n.trigger(c,"beforeAdd",{object:d});for(var u=0;u<f.length;u++){var m=f[u];switch(m.type){case"body":if(m.parent!==m){o.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}i.addBody(c,m);break;case"constraint":i.addConstraint(c,m);break;case"composite":i.addComposite(c,m);break;case"mouseConstraint":i.addConstraint(c,m.constraint);break}}return n.trigger(c,"afterAdd",{object:d}),c},i.remove=function(c,d,f){var u=[].concat(d);n.trigger(c,"beforeRemove",{object:d});for(var m=0;m<u.length;m++){var g=u[m];switch(g.type){case"body":i.removeBody(c,g,f);break;case"constraint":i.removeConstraint(c,g,f);break;case"composite":i.removeComposite(c,g,f);break;case"mouseConstraint":i.removeConstraint(c,g.constraint);break}}return n.trigger(c,"afterRemove",{object:d}),c},i.addComposite=function(c,d){return c.composites.push(d),d.parent=c,i.setModified(c,!0,!0,!1),c},i.removeComposite=function(c,d,f){var u=o.indexOf(c.composites,d);if(u!==-1&&i.removeCompositeAt(c,u),f)for(var m=0;m<c.composites.length;m++)i.removeComposite(c.composites[m],d,!0);return c},i.removeCompositeAt=function(c,d){return c.composites.splice(d,1),i.setModified(c,!0,!0,!1),c},i.addBody=function(c,d){return c.bodies.push(d),i.setModified(c,!0,!0,!1),c},i.removeBody=function(c,d,f){var u=o.indexOf(c.bodies,d);if(u!==-1&&i.removeBodyAt(c,u),f)for(var m=0;m<c.composites.length;m++)i.removeBody(c.composites[m],d,!0);return c},i.removeBodyAt=function(c,d){return c.bodies.splice(d,1),i.setModified(c,!0,!0,!1),c},i.addConstraint=function(c,d){return c.constraints.push(d),i.setModified(c,!0,!0,!1),c},i.removeConstraint=function(c,d,f){var u=o.indexOf(c.constraints,d);if(u!==-1&&i.removeConstraintAt(c,u),f)for(var m=0;m<c.composites.length;m++)i.removeConstraint(c.composites[m],d,!0);return c},i.removeConstraintAt=function(c,d){return c.constraints.splice(d,1),i.setModified(c,!0,!0,!1),c},i.clear=function(c,d,f){if(f)for(var u=0;u<c.composites.length;u++)i.clear(c.composites[u],d,!0);return d?c.bodies=c.bodies.filter(function(m){return m.isStatic}):c.bodies.length=0,c.constraints.length=0,c.composites.length=0,i.setModified(c,!0,!0,!1),c},i.allBodies=function(c){if(c.cache&&c.cache.allBodies)return c.cache.allBodies;for(var d=[].concat(c.bodies),f=0;f<c.composites.length;f++)d=d.concat(i.allBodies(c.composites[f]));return c.cache&&(c.cache.allBodies=d),d},i.allConstraints=function(c){if(c.cache&&c.cache.allConstraints)return c.cache.allConstraints;for(var d=[].concat(c.constraints),f=0;f<c.composites.length;f++)d=d.concat(i.allConstraints(c.composites[f]));return c.cache&&(c.cache.allConstraints=d),d},i.allComposites=function(c){if(c.cache&&c.cache.allComposites)return c.cache.allComposites;for(var d=[].concat(c.composites),f=0;f<c.composites.length;f++)d=d.concat(i.allComposites(c.composites[f]));return c.cache&&(c.cache.allComposites=d),d},i.get=function(c,d,f){var u,m;switch(f){case"body":u=i.allBodies(c);break;case"constraint":u=i.allConstraints(c);break;case"composite":u=i.allComposites(c).concat(c);break}return u?(m=u.filter(function(g){return g.id.toString()===d.toString()}),m.length===0?null:m[0]):null},i.move=function(c,d,f){return i.remove(c,d),i.add(f,d),c},i.rebase=function(c){for(var d=i.allBodies(c).concat(i.allConstraints(c)).concat(i.allComposites(c)),f=0;f<d.length;f++)d[f].id=o.nextId();return c},i.translate=function(c,d,f){for(var u=f?i.allBodies(c):c.bodies,m=0;m<u.length;m++)l.translate(u[m],d);return c},i.rotate=function(c,d,f,u){for(var m=Math.cos(d),g=Math.sin(d),x=u?i.allBodies(c):c.bodies,y=0;y<x.length;y++){var S=x[y],b=S.position.x-f.x,w=S.position.y-f.y;l.setPosition(S,{x:f.x+(b*m-w*g),y:f.y+(b*g+w*m)}),l.rotate(S,d)}return c},i.scale=function(c,d,f,u,m){for(var g=m?i.allBodies(c):c.bodies,x=0;x<g.length;x++){var y=g[x],S=y.position.x-u.x,b=y.position.y-u.y;l.setPosition(y,{x:u.x+S*d,y:u.y+b*f}),l.scale(y,d,f)}return c},i.bounds=function(c){for(var d=i.allBodies(c),f=[],u=0;u<d.length;u+=1){var m=d[u];f.push(m.bounds.min,m.bounds.max)}return a.create(f)}})()},function(e,t,r){var i={};e.exports=i;var n=r(4),o=r(5),a=r(0);(function(){i._motionWakeThreshold=.18,i._motionSleepThreshold=.08,i._minBias=.9,i.update=function(l,c){for(var d=c/a._baseDelta,f=i._motionSleepThreshold,u=0;u<l.length;u++){var m=l[u],g=n.getSpeed(m),x=n.getAngularSpeed(m),y=g*g+x*x;if(m.force.x!==0||m.force.y!==0){i.set(m,!1);continue}var S=Math.min(m.motion,y),b=Math.max(m.motion,y);m.motion=i._minBias*S+(1-i._minBias)*b,m.sleepThreshold>0&&m.motion<f?(m.sleepCounter+=1,m.sleepCounter>=m.sleepThreshold/d&&i.set(m,!0)):m.sleepCounter>0&&(m.sleepCounter-=1)}},i.afterCollisions=function(l){for(var c=i._motionSleepThreshold,d=0;d<l.length;d++){var f=l[d];if(f.isActive){var u=f.collision,m=u.bodyA.parent,g=u.bodyB.parent;if(!(m.isSleeping&&g.isSleeping||m.isStatic||g.isStatic)&&(m.isSleeping||g.isSleeping)){var x=m.isSleeping&&!m.isStatic?m:g,y=x===m?g:m;!x.isStatic&&y.motion>c&&i.set(x,!1)}}}},i.set=function(l,c){var d=l.isSleeping;c?(l.isSleeping=!0,l.sleepCounter=l.sleepThreshold,l.positionImpulse.x=0,l.positionImpulse.y=0,l.positionPrev.x=l.position.x,l.positionPrev.y=l.position.y,l.anglePrev=l.angle,l.speed=0,l.angularSpeed=0,l.motion=0,d||o.trigger(l,"sleepStart")):(l.isSleeping=!1,l.sleepCounter=0,d&&o.trigger(l,"sleepEnd"))}})()},function(e,t,r){var i={};e.exports=i;var n=r(3),o=r(9);(function(){var a=[],l={overlap:0,axis:null},c={overlap:0,axis:null};i.create=function(d,f){return{pair:null,collided:!1,bodyA:d,bodyB:f,parentA:d.parent,parentB:f.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[]}},i.collides=function(d,f,u){if(i._overlapAxes(l,d.vertices,f.vertices,d.axes),l.overlap<=0||(i._overlapAxes(c,f.vertices,d.vertices,f.axes),c.overlap<=0))return null;var m=u&&u.table[o.id(d,f)],g;m?g=m.collision:(g=i.create(d,f),g.collided=!0,g.bodyA=d.id<f.id?d:f,g.bodyB=d.id<f.id?f:d,g.parentA=g.bodyA.parent,g.parentB=g.bodyB.parent),d=g.bodyA,f=g.bodyB;var x;l.overlap<c.overlap?x=l:x=c;var y=g.normal,S=g.supports,b=x.axis,w=b.x,v=b.y;w*(f.position.x-d.position.x)+v*(f.position.y-d.position.y)<0?(y.x=w,y.y=v):(y.x=-w,y.y=-v),g.tangent.x=-y.y,g.tangent.y=y.x,g.depth=x.overlap,g.penetration.x=y.x*g.depth,g.penetration.y=y.y*g.depth;var T=i._findSupports(d,f,y,1),I=0;if(n.contains(d.vertices,T[0])&&(S[I++]=T[0]),n.contains(d.vertices,T[1])&&(S[I++]=T[1]),I<2){var C=i._findSupports(f,d,y,-1);n.contains(f.vertices,C[0])&&(S[I++]=C[0]),I<2&&n.contains(f.vertices,C[1])&&(S[I++]=C[1])}return I===0&&(S[I++]=T[0]),S.length=I,g},i._overlapAxes=function(d,f,u,m){var g=f.length,x=u.length,y=f[0].x,S=f[0].y,b=u[0].x,w=u[0].y,v=m.length,T=Number.MAX_VALUE,I=0,C,P,M,B,F,L;for(F=0;F<v;F++){var V=m[F],N=V.x,k=V.y,Z=y*N+S*k,j=b*N+w*k,rt=Z,Y=j;for(L=1;L<g;L+=1)B=f[L].x*N+f[L].y*k,B>rt?rt=B:B<Z&&(Z=B);for(L=1;L<x;L+=1)B=u[L].x*N+u[L].y*k,B>Y?Y=B:B<j&&(j=B);if(P=rt-j,M=Y-Z,C=P<M?P:M,C<T&&(T=C,I=F,C<=0))break}d.axis=m[I],d.overlap=T},i._projectToAxis=function(d,f,u){for(var m=f[0].x*u.x+f[0].y*u.y,g=m,x=1;x<f.length;x+=1){var y=f[x].x*u.x+f[x].y*u.y;y>g?g=y:y<m&&(m=y)}d.min=m,d.max=g},i._findSupports=function(d,f,u,m){var g=f.vertices,x=g.length,y=d.position.x,S=d.position.y,b=u.x*m,w=u.y*m,v=Number.MAX_VALUE,T,I,C,P,M;for(M=0;M<x;M+=1)I=g[M],P=b*(y-I.x)+w*(S-I.y),P<v&&(v=P,T=I);return C=g[(x+T.index-1)%x],v=b*(y-C.x)+w*(S-C.y),I=g[(T.index+1)%x],b*(y-I.x)+w*(S-I.y)<v?(a[0]=T,a[1]=I,a):(a[0]=T,a[1]=C,a)}})()},function(e,t,r){var i={};e.exports=i;var n=r(16);(function(){i.create=function(o,a){var l=o.bodyA,c=o.bodyB,d={id:i.id(l,c),bodyA:l,bodyB:c,collision:o,contacts:[],activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:l.isSensor||c.isSensor,timeCreated:a,timeUpdated:a,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return i.update(d,o,a),d},i.update=function(o,a,l){var c=o.contacts,d=a.supports,f=o.activeContacts,u=a.parentA,m=a.parentB,g=u.vertices.length;o.isActive=!0,o.timeUpdated=l,o.collision=a,o.separation=a.depth,o.inverseMass=u.inverseMass+m.inverseMass,o.friction=u.friction<m.friction?u.friction:m.friction,o.frictionStatic=u.frictionStatic>m.frictionStatic?u.frictionStatic:m.frictionStatic,o.restitution=u.restitution>m.restitution?u.restitution:m.restitution,o.slop=u.slop>m.slop?u.slop:m.slop,a.pair=o,f.length=0;for(var x=0;x<d.length;x++){var y=d[x],S=y.body===u?y.index:g+y.index,b=c[S];b?f.push(b):f.push(c[S]=n.create(y))}},i.setActive=function(o,a,l){a?(o.isActive=!0,o.timeUpdated=l):(o.isActive=!1,o.activeContacts.length=0)},i.id=function(o,a){return o.id<a.id?"A"+o.id+"B"+a.id:"A"+a.id+"B"+o.id}})()},function(e,t,r){var i={};e.exports=i;var n=r(3),o=r(2),a=r(7),l=r(1),c=r(11),d=r(0);(function(){i._warming=.4,i._torqueDampen=1,i._minLength=1e-6,i.create=function(f){var u=f;u.bodyA&&!u.pointA&&(u.pointA={x:0,y:0}),u.bodyB&&!u.pointB&&(u.pointB={x:0,y:0});var m=u.bodyA?o.add(u.bodyA.position,u.pointA):u.pointA,g=u.bodyB?o.add(u.bodyB.position,u.pointB):u.pointB,x=o.magnitude(o.sub(m,g));u.length=typeof u.length<"u"?u.length:x,u.id=u.id||d.nextId(),u.label=u.label||"Constraint",u.type="constraint",u.stiffness=u.stiffness||(u.length>0?1:.7),u.damping=u.damping||0,u.angularStiffness=u.angularStiffness||0,u.angleA=u.bodyA?u.bodyA.angle:u.angleA,u.angleB=u.bodyB?u.bodyB.angle:u.angleB,u.plugin={};var y={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return u.length===0&&u.stiffness>.1?(y.type="pin",y.anchors=!1):u.stiffness<.9&&(y.type="spring"),u.render=d.extend(y,u.render),u},i.preSolveAll=function(f){for(var u=0;u<f.length;u+=1){var m=f[u],g=m.constraintImpulse;m.isStatic||g.x===0&&g.y===0&&g.angle===0||(m.position.x+=g.x,m.position.y+=g.y,m.angle+=g.angle)}},i.solveAll=function(f,u){for(var m=d.clamp(u/d._baseDelta,0,1),g=0;g<f.length;g+=1){var x=f[g],y=!x.bodyA||x.bodyA&&x.bodyA.isStatic,S=!x.bodyB||x.bodyB&&x.bodyB.isStatic;(y||S)&&i.solve(f[g],m)}for(g=0;g<f.length;g+=1)x=f[g],y=!x.bodyA||x.bodyA&&x.bodyA.isStatic,S=!x.bodyB||x.bodyB&&x.bodyB.isStatic,!y&&!S&&i.solve(f[g],m)},i.solve=function(f,u){var m=f.bodyA,g=f.bodyB,x=f.pointA,y=f.pointB;if(!(!m&&!g)){m&&!m.isStatic&&(o.rotate(x,m.angle-f.angleA,x),f.angleA=m.angle),g&&!g.isStatic&&(o.rotate(y,g.angle-f.angleB,y),f.angleB=g.angle);var S=x,b=y;if(m&&(S=o.add(m.position,x)),g&&(b=o.add(g.position,y)),!(!S||!b)){var w=o.sub(S,b),v=o.magnitude(w);v<i._minLength&&(v=i._minLength);var T=(v-f.length)/v,I=f.stiffness>=1||f.length===0,C=I?f.stiffness*u:f.stiffness*u*u,P=f.damping*u,M=o.mult(w,T*C),B=(m?m.inverseMass:0)+(g?g.inverseMass:0),F=(m?m.inverseInertia:0)+(g?g.inverseInertia:0),L=B+F,V,N,k,Z,j;if(P>0){var rt=o.create();k=o.div(w,v),j=o.sub(g&&o.sub(g.position,g.positionPrev)||rt,m&&o.sub(m.position,m.positionPrev)||rt),Z=o.dot(k,j)}m&&!m.isStatic&&(N=m.inverseMass/B,m.constraintImpulse.x-=M.x*N,m.constraintImpulse.y-=M.y*N,m.position.x-=M.x*N,m.position.y-=M.y*N,P>0&&(m.positionPrev.x-=P*k.x*Z*N,m.positionPrev.y-=P*k.y*Z*N),V=o.cross(x,M)/L*i._torqueDampen*m.inverseInertia*(1-f.angularStiffness),m.constraintImpulse.angle-=V,m.angle-=V),g&&!g.isStatic&&(N=g.inverseMass/B,g.constraintImpulse.x+=M.x*N,g.constraintImpulse.y+=M.y*N,g.position.x+=M.x*N,g.position.y+=M.y*N,P>0&&(g.positionPrev.x+=P*k.x*Z*N,g.positionPrev.y+=P*k.y*Z*N),V=o.cross(y,M)/L*i._torqueDampen*g.inverseInertia*(1-f.angularStiffness),g.constraintImpulse.angle+=V,g.angle+=V)}}},i.postSolveAll=function(f){for(var u=0;u<f.length;u++){var m=f[u],g=m.constraintImpulse;if(!(m.isStatic||g.x===0&&g.y===0&&g.angle===0)){a.set(m,!1);for(var x=0;x<m.parts.length;x++){var y=m.parts[x];n.translate(y.vertices,g),x>0&&(y.position.x+=g.x,y.position.y+=g.y),g.angle!==0&&(n.rotate(y.vertices,g.angle,m.position),c.rotate(y.axes,g.angle),x>0&&o.rotateAbout(y.position,g.angle,m.position,y.position)),l.update(y.bounds,y.vertices,m.velocity)}g.angle*=i._warming,g.x*=i._warming,g.y*=i._warming}}},i.pointAWorld=function(f){return{x:(f.bodyA?f.bodyA.position.x:0)+(f.pointA?f.pointA.x:0),y:(f.bodyA?f.bodyA.position.y:0)+(f.pointA?f.pointA.y:0)}},i.pointBWorld=function(f){return{x:(f.bodyB?f.bodyB.position.x:0)+(f.pointB?f.pointB.x:0),y:(f.bodyB?f.bodyB.position.y:0)+(f.pointB?f.pointB.y:0)}}})()},function(e,t,r){var i={};e.exports=i;var n=r(2),o=r(0);(function(){i.fromVertices=function(a){for(var l={},c=0;c<a.length;c++){var d=(c+1)%a.length,f=n.normalise({x:a[d].y-a[c].y,y:a[c].x-a[d].x}),u=f.y===0?1/0:f.x/f.y;u=u.toFixed(3).toString(),l[u]=f}return o.values(l)},i.rotate=function(a,l){if(l!==0)for(var c=Math.cos(l),d=Math.sin(l),f=0;f<a.length;f++){var u=a[f],m;m=u.x*c-u.y*d,u.y=u.x*d+u.y*c,u.x=m}}})()},function(e,t,r){var i={};e.exports=i;var n=r(3),o=r(0),a=r(4),l=r(1),c=r(2);(function(){i.rectangle=function(d,f,u,m,g){g=g||{};var x={label:"Rectangle Body",position:{x:d,y:f},vertices:n.fromPath("L 0 0 L "+u+" 0 L "+u+" "+m+" L 0 "+m)};if(g.chamfer){var y=g.chamfer;x.vertices=n.chamfer(x.vertices,y.radius,y.quality,y.qualityMin,y.qualityMax),delete g.chamfer}return a.create(o.extend({},x,g))},i.trapezoid=function(d,f,u,m,g,x){x=x||{},g*=.5;var y=(1-g*2)*u,S=u*g,b=S+y,w=b+S,v;g<.5?v="L 0 0 L "+S+" "+-m+" L "+b+" "+-m+" L "+w+" 0":v="L 0 0 L "+b+" "+-m+" L "+w+" 0";var T={label:"Trapezoid Body",position:{x:d,y:f},vertices:n.fromPath(v)};if(x.chamfer){var I=x.chamfer;T.vertices=n.chamfer(T.vertices,I.radius,I.quality,I.qualityMin,I.qualityMax),delete x.chamfer}return a.create(o.extend({},T,x))},i.circle=function(d,f,u,m,g){m=m||{};var x={label:"Circle Body",circleRadius:u};g=g||25;var y=Math.ceil(Math.max(10,Math.min(g,u)));return y%2===1&&(y+=1),i.polygon(d,f,y,u,o.extend({},x,m))},i.polygon=function(d,f,u,m,g){if(g=g||{},u<3)return i.circle(d,f,m,g);for(var x=2*Math.PI/u,y="",S=x*.5,b=0;b<u;b+=1){var w=S+b*x,v=Math.cos(w)*m,T=Math.sin(w)*m;y+="L "+v.toFixed(3)+" "+T.toFixed(3)+" "}var I={label:"Polygon Body",position:{x:d,y:f},vertices:n.fromPath(y)};if(g.chamfer){var C=g.chamfer;I.vertices=n.chamfer(I.vertices,C.radius,C.quality,C.qualityMin,C.qualityMax),delete g.chamfer}return a.create(o.extend({},I,g))},i.fromVertices=function(d,f,u,m,g,x,y,S){var b=o.getDecomp(),w,v,T,I,C,P,M,B,F,L,V;for(w=!!(b&&b.quickDecomp),m=m||{},T=[],g=typeof g<"u"?g:!1,x=typeof x<"u"?x:.01,y=typeof y<"u"?y:10,S=typeof S<"u"?S:.01,o.isArray(u[0])||(u=[u]),L=0;L<u.length;L+=1)if(P=u[L],I=n.isConvex(P),C=!I,C&&!w&&o.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),I||!w)I?P=n.clockwiseSort(P):P=n.hull(P),T.push({position:{x:d,y:f},vertices:P});else{var N=P.map(function(yt){return[yt.x,yt.y]});b.makeCCW(N),x!==!1&&b.removeCollinearPoints(N,x),S!==!1&&b.removeDuplicatePoints&&b.removeDuplicatePoints(N,S);var k=b.quickDecomp(N);for(M=0;M<k.length;M++){var Z=k[M],j=Z.map(function(yt){return{x:yt[0],y:yt[1]}});y>0&&n.area(j)<y||T.push({position:n.centre(j),vertices:j})}}for(M=0;M<T.length;M++)T[M]=a.create(o.extend(T[M],m));if(g){var rt=5;for(M=0;M<T.length;M++){var Y=T[M];for(B=M+1;B<T.length;B++){var J=T[B];if(l.overlaps(Y.bounds,J.bounds)){var st=Y.vertices,xt=J.vertices;for(F=0;F<Y.vertices.length;F++)for(V=0;V<J.vertices.length;V++){var Tt=c.magnitudeSquared(c.sub(st[(F+1)%st.length],xt[V])),Ct=c.magnitudeSquared(c.sub(st[F],xt[(V+1)%xt.length]));Tt<rt&&Ct<rt&&(st[F].isInternal=!0,xt[V].isInternal=!0)}}}}}return T.length>1?(v=a.create(o.extend({parts:T.slice(0)},m)),a.setPosition(v,{x:d,y:f}),v):T[0]}})()},function(e,t,r){var i={};e.exports=i;var n=r(0),o=r(8);(function(){i.create=function(a){var l={bodies:[],pairs:null};return n.extend(l,a)},i.setBodies=function(a,l){a.bodies=l.slice(0)},i.clear=function(a){a.bodies=[]},i.collisions=function(a){var l=[],c=a.pairs,d=a.bodies,f=d.length,u=i.canCollide,m=o.collides,g,x;for(d.sort(i._compareBoundsX),g=0;g<f;g++){var y=d[g],S=y.bounds,b=y.bounds.max.x,w=y.bounds.max.y,v=y.bounds.min.y,T=y.isStatic||y.isSleeping,I=y.parts.length,C=I===1;for(x=g+1;x<f;x++){var P=d[x],M=P.bounds;if(M.min.x>b)break;if(!(w<M.min.y||v>M.max.y)&&!(T&&(P.isStatic||P.isSleeping))&&u(y.collisionFilter,P.collisionFilter)){var B=P.parts.length;if(C&&B===1){var F=m(y,P,c);F&&l.push(F)}else for(var L=I>1?1:0,V=B>1?1:0,N=L;N<I;N++)for(var k=y.parts[N],S=k.bounds,Z=V;Z<B;Z++){var j=P.parts[Z],M=j.bounds;if(!(S.min.x>M.max.x||S.max.x<M.min.x||S.max.y<M.min.y||S.min.y>M.max.y)){var F=m(k,j,c);F&&l.push(F)}}}}}return l},i.canCollide=function(a,l){return a.group===l.group&&a.group!==0?a.group>0:(a.mask&l.category)!==0&&(l.mask&a.category)!==0},i._compareBoundsX=function(a,l){return a.bounds.min.x-l.bounds.min.x}})()},function(e,t,r){var i={};e.exports=i;var n=r(0);(function(){i.create=function(o){var a={};return o||n.log("Mouse.create: element was undefined, defaulting to document.body","warn"),a.element=o||document.body,a.absolute={x:0,y:0},a.position={x:0,y:0},a.mousedownPosition={x:0,y:0},a.mouseupPosition={x:0,y:0},a.offset={x:0,y:0},a.scale={x:1,y:1},a.wheelDelta=0,a.button=-1,a.pixelRatio=parseInt(a.element.getAttribute("data-pixel-ratio"),10)||1,a.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},a.mousemove=function(l){var c=i._getRelativeMousePosition(l,a.element,a.pixelRatio),d=l.changedTouches;d&&(a.button=0,l.preventDefault()),a.absolute.x=c.x,a.absolute.y=c.y,a.position.x=a.absolute.x*a.scale.x+a.offset.x,a.position.y=a.absolute.y*a.scale.y+a.offset.y,a.sourceEvents.mousemove=l},a.mousedown=function(l){var c=i._getRelativeMousePosition(l,a.element,a.pixelRatio),d=l.changedTouches;d?(a.button=0,l.preventDefault()):a.button=l.button,a.absolute.x=c.x,a.absolute.y=c.y,a.position.x=a.absolute.x*a.scale.x+a.offset.x,a.position.y=a.absolute.y*a.scale.y+a.offset.y,a.mousedownPosition.x=a.position.x,a.mousedownPosition.y=a.position.y,a.sourceEvents.mousedown=l},a.mouseup=function(l){var c=i._getRelativeMousePosition(l,a.element,a.pixelRatio),d=l.changedTouches;d&&l.preventDefault(),a.button=-1,a.absolute.x=c.x,a.absolute.y=c.y,a.position.x=a.absolute.x*a.scale.x+a.offset.x,a.position.y=a.absolute.y*a.scale.y+a.offset.y,a.mouseupPosition.x=a.position.x,a.mouseupPosition.y=a.position.y,a.sourceEvents.mouseup=l},a.mousewheel=function(l){a.wheelDelta=Math.max(-1,Math.min(1,l.wheelDelta||-l.detail)),l.preventDefault()},i.setElement(a,a.element),a},i.setElement=function(o,a){o.element=a,a.addEventListener("mousemove",o.mousemove),a.addEventListener("mousedown",o.mousedown),a.addEventListener("mouseup",o.mouseup),a.addEventListener("mousewheel",o.mousewheel),a.addEventListener("DOMMouseScroll",o.mousewheel),a.addEventListener("touchmove",o.mousemove),a.addEventListener("touchstart",o.mousedown),a.addEventListener("touchend",o.mouseup)},i.clearSourceEvents=function(o){o.sourceEvents.mousemove=null,o.sourceEvents.mousedown=null,o.sourceEvents.mouseup=null,o.sourceEvents.mousewheel=null,o.wheelDelta=0},i.setOffset=function(o,a){o.offset.x=a.x,o.offset.y=a.y,o.position.x=o.absolute.x*o.scale.x+o.offset.x,o.position.y=o.absolute.y*o.scale.y+o.offset.y},i.setScale=function(o,a){o.scale.x=a.x,o.scale.y=a.y,o.position.x=o.absolute.x*o.scale.x+o.offset.x,o.position.y=o.absolute.y*o.scale.y+o.offset.y},i._getRelativeMousePosition=function(o,a,l){var c=a.getBoundingClientRect(),d=document.documentElement||document.body.parentNode||document.body,f=window.pageXOffset!==void 0?window.pageXOffset:d.scrollLeft,u=window.pageYOffset!==void 0?window.pageYOffset:d.scrollTop,m=o.changedTouches,g,x;return m?(g=m[0].pageX-c.left-f,x=m[0].pageY-c.top-u):(g=o.pageX-c.left-f,x=o.pageY-c.top-u),{x:g/(a.clientWidth/(a.width||a.clientWidth)*l),y:x/(a.clientHeight/(a.height||a.clientHeight)*l)}}})()},function(e,t,r){var i={};e.exports=i;var n=r(0);(function(){i._registry={},i.register=function(o){if(i.isPlugin(o)||n.warn("Plugin.register:",i.toString(o),"does not implement all required fields."),o.name in i._registry){var a=i._registry[o.name],l=i.versionParse(o.version).number,c=i.versionParse(a.version).number;l>c?(n.warn("Plugin.register:",i.toString(a),"was upgraded to",i.toString(o)),i._registry[o.name]=o):l<c?n.warn("Plugin.register:",i.toString(a),"can not be downgraded to",i.toString(o)):o!==a&&n.warn("Plugin.register:",i.toString(o),"is already registered to different plugin object")}else i._registry[o.name]=o;return o},i.resolve=function(o){return i._registry[i.dependencyParse(o).name]},i.toString=function(o){return typeof o=="string"?o:(o.name||"anonymous")+"@"+(o.version||o.range||"0.0.0")},i.isPlugin=function(o){return o&&o.name&&o.version&&o.install},i.isUsed=function(o,a){return o.used.indexOf(a)>-1},i.isFor=function(o,a){var l=o.for&&i.dependencyParse(o.for);return!o.for||a.name===l.name&&i.versionSatisfies(a.version,l.range)},i.use=function(o,a){if(o.uses=(o.uses||[]).concat(a||[]),o.uses.length===0){n.warn("Plugin.use:",i.toString(o),"does not specify any dependencies to install.");return}for(var l=i.dependencies(o),c=n.topologicalSort(l),d=[],f=0;f<c.length;f+=1)if(c[f]!==o.name){var u=i.resolve(c[f]);if(!u){d.push("\u274C "+c[f]);continue}i.isUsed(o,u.name)||(i.isFor(u,o)||(n.warn("Plugin.use:",i.toString(u),"is for",u.for,"but installed on",i.toString(o)+"."),u._warned=!0),u.install?u.install(o):(n.warn("Plugin.use:",i.toString(u),"does not specify an install function."),u._warned=!0),u._warned?(d.push("\u{1F536} "+i.toString(u)),delete u._warned):d.push("\u2705 "+i.toString(u)),o.used.push(u.name))}d.length>0&&n.info(d.join("  "))},i.dependencies=function(o,a){var l=i.dependencyParse(o),c=l.name;if(a=a||{},!(c in a)){o=i.resolve(o)||o,a[c]=n.map(o.uses||[],function(f){i.isPlugin(f)&&i.register(f);var u=i.dependencyParse(f),m=i.resolve(f);return m&&!i.versionSatisfies(m.version,u.range)?(n.warn("Plugin.dependencies:",i.toString(m),"does not satisfy",i.toString(u),"used by",i.toString(l)+"."),m._warned=!0,o._warned=!0):m||(n.warn("Plugin.dependencies:",i.toString(f),"used by",i.toString(l),"could not be resolved."),o._warned=!0),u.name});for(var d=0;d<a[c].length;d+=1)i.dependencies(a[c][d],a);return a}},i.dependencyParse=function(o){if(n.isString(o)){var a=/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/;return a.test(o)||n.warn("Plugin.dependencyParse:",o,"is not a valid dependency string."),{name:o.split("@")[0],range:o.split("@")[1]||"*"}}return{name:o.name,range:o.range||o.version}},i.versionParse=function(o){var a=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;a.test(o)||n.warn("Plugin.versionParse:",o,"is not a valid version or range.");var l=a.exec(o),c=Number(l[4]),d=Number(l[5]),f=Number(l[6]);return{isRange:!!(l[1]||l[2]),version:l[3],range:o,operator:l[1]||l[2]||"",major:c,minor:d,patch:f,parts:[c,d,f],prerelease:l[7],number:c*1e8+d*1e4+f}},i.versionSatisfies=function(o,a){a=a||"*";var l=i.versionParse(a),c=i.versionParse(o);if(l.isRange){if(l.operator==="*"||o==="*")return!0;if(l.operator===">")return c.number>l.number;if(l.operator===">=")return c.number>=l.number;if(l.operator==="~")return c.major===l.major&&c.minor===l.minor&&c.patch>=l.patch;if(l.operator==="^")return l.major>0?c.major===l.major&&c.number>=l.number:l.minor>0?c.minor===l.minor&&c.patch>=l.patch:c.patch===l.patch}return o===a||o==="*"}})()},function(e,t){var r={};e.exports=r,function(){r.create=function(i){return{vertex:i,normalImpulse:0,tangentImpulse:0}}}()},function(e,t,r){var i={};e.exports=i;var n=r(7),o=r(18),a=r(13),l=r(19),c=r(5),d=r(6),f=r(10),u=r(0),m=r(4);(function(){i.create=function(g){g=g||{};var x={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0}},y=u.extend(x,g);return y.world=g.world||d.create({label:"World"}),y.pairs=g.pairs||l.create(),y.detector=g.detector||a.create(),y.grid={buckets:[]},y.world.gravity=y.gravity,y.broadphase=y.grid,y.metrics={},y},i.update=function(g,x){var y=u.now(),S=g.world,b=g.detector,w=g.pairs,v=g.timing,T=v.timestamp,I;x=typeof x<"u"?x:u._baseDelta,x*=v.timeScale,v.timestamp+=x,v.lastDelta=x;var C={timestamp:v.timestamp,delta:x};c.trigger(g,"beforeUpdate",C);var P=d.allBodies(S),M=d.allConstraints(S);for(S.isModified&&(a.setBodies(b,P),d.setModified(S,!1,!1,!0)),g.enableSleeping&&n.update(P,x),i._bodiesApplyGravity(P,g.gravity),x>0&&i._bodiesUpdate(P,x),f.preSolveAll(P),I=0;I<g.constraintIterations;I++)f.solveAll(M,x);f.postSolveAll(P),b.pairs=g.pairs;var B=a.collisions(b);l.update(w,B,T),g.enableSleeping&&n.afterCollisions(w.list),w.collisionStart.length>0&&c.trigger(g,"collisionStart",{pairs:w.collisionStart});var F=u.clamp(20/g.positionIterations,0,1);for(o.preSolvePosition(w.list),I=0;I<g.positionIterations;I++)o.solvePosition(w.list,x,F);for(o.postSolvePosition(P),f.preSolveAll(P),I=0;I<g.constraintIterations;I++)f.solveAll(M,x);for(f.postSolveAll(P),o.preSolveVelocity(w.list),I=0;I<g.velocityIterations;I++)o.solveVelocity(w.list,x);return i._bodiesUpdateVelocities(P),w.collisionActive.length>0&&c.trigger(g,"collisionActive",{pairs:w.collisionActive}),w.collisionEnd.length>0&&c.trigger(g,"collisionEnd",{pairs:w.collisionEnd}),i._bodiesClearForces(P),c.trigger(g,"afterUpdate",C),g.timing.lastElapsed=u.now()-y,g},i.merge=function(g,x){if(u.extend(g,x),x.world){g.world=x.world,i.clear(g);for(var y=d.allBodies(g.world),S=0;S<y.length;S++){var b=y[S];n.set(b,!1),b.id=u.nextId()}}},i.clear=function(g){l.clear(g.pairs),a.clear(g.detector)},i._bodiesClearForces=function(g){for(var x=g.length,y=0;y<x;y++){var S=g[y];S.force.x=0,S.force.y=0,S.torque=0}},i._bodiesApplyGravity=function(g,x){var y=typeof x.scale<"u"?x.scale:.001,S=g.length;if(!(x.x===0&&x.y===0||y===0))for(var b=0;b<S;b++){var w=g[b];w.isStatic||w.isSleeping||(w.force.y+=w.mass*x.y*y,w.force.x+=w.mass*x.x*y)}},i._bodiesUpdate=function(g,x){for(var y=g.length,S=0;S<y;S++){var b=g[S];b.isStatic||b.isSleeping||m.update(b,x)}},i._bodiesUpdateVelocities=function(g){for(var x=g.length,y=0;y<x;y++)m.updateVelocities(g[y])}})()},function(e,t,r){var i={};e.exports=i;var n=r(3),o=r(0),a=r(1);(function(){i._restingThresh=2,i._restingThreshTangent=Math.sqrt(6),i._positionDampen=.9,i._positionWarming=.8,i._frictionNormalMultiplier=5,i._frictionMaxStatic=Number.MAX_VALUE,i.preSolvePosition=function(l){var c,d,f,u=l.length;for(c=0;c<u;c++)d=l[c],d.isActive&&(f=d.activeContacts.length,d.collision.parentA.totalContacts+=f,d.collision.parentB.totalContacts+=f)},i.solvePosition=function(l,c,d){var f,u,m,g,x,y,S,b,w=i._positionDampen*(d||1),v=o.clamp(c/o._baseDelta,0,1),T=l.length;for(f=0;f<T;f++)u=l[f],!(!u.isActive||u.isSensor)&&(m=u.collision,g=m.parentA,x=m.parentB,y=m.normal,u.separation=y.x*(x.positionImpulse.x+m.penetration.x-g.positionImpulse.x)+y.y*(x.positionImpulse.y+m.penetration.y-g.positionImpulse.y));for(f=0;f<T;f++)u=l[f],!(!u.isActive||u.isSensor)&&(m=u.collision,g=m.parentA,x=m.parentB,y=m.normal,b=u.separation-u.slop*v,(g.isStatic||x.isStatic)&&(b*=2),g.isStatic||g.isSleeping||(S=w/g.totalContacts,g.positionImpulse.x+=y.x*b*S,g.positionImpulse.y+=y.y*b*S),x.isStatic||x.isSleeping||(S=w/x.totalContacts,x.positionImpulse.x-=y.x*b*S,x.positionImpulse.y-=y.y*b*S))},i.postSolvePosition=function(l){for(var c=i._positionWarming,d=l.length,f=n.translate,u=a.update,m=0;m<d;m++){var g=l[m],x=g.positionImpulse,y=x.x,S=x.y,b=g.velocity;if(g.totalContacts=0,y!==0||S!==0){for(var w=0;w<g.parts.length;w++){var v=g.parts[w];f(v.vertices,x),u(v.bounds,v.vertices,b),v.position.x+=y,v.position.y+=S}g.positionPrev.x+=y,g.positionPrev.y+=S,y*b.x+S*b.y<0?(x.x=0,x.y=0):(x.x*=c,x.y*=c)}}},i.preSolveVelocity=function(l){var c=l.length,d,f;for(d=0;d<c;d++){var u=l[d];if(!(!u.isActive||u.isSensor)){var m=u.activeContacts,g=m.length,x=u.collision,y=x.parentA,S=x.parentB,b=x.normal,w=x.tangent;for(f=0;f<g;f++){var v=m[f],T=v.vertex,I=v.normalImpulse,C=v.tangentImpulse;if(I!==0||C!==0){var P=b.x*I+w.x*C,M=b.y*I+w.y*C;y.isStatic||y.isSleeping||(y.positionPrev.x+=P*y.inverseMass,y.positionPrev.y+=M*y.inverseMass,y.anglePrev+=y.inverseInertia*((T.x-y.position.x)*M-(T.y-y.position.y)*P)),S.isStatic||S.isSleeping||(S.positionPrev.x-=P*S.inverseMass,S.positionPrev.y-=M*S.inverseMass,S.anglePrev-=S.inverseInertia*((T.x-S.position.x)*M-(T.y-S.position.y)*P))}}}}},i.solveVelocity=function(l,c){var d=c/o._baseDelta,f=d*d,u=f*d,m=-i._restingThresh*d,g=i._restingThreshTangent,x=i._frictionNormalMultiplier*d,y=i._frictionMaxStatic,S=l.length,b,w,v,T;for(v=0;v<S;v++){var I=l[v];if(!(!I.isActive||I.isSensor)){var C=I.collision,P=C.parentA,M=C.parentB,B=P.velocity,F=M.velocity,L=C.normal.x,V=C.normal.y,N=C.tangent.x,k=C.tangent.y,Z=I.activeContacts,j=Z.length,rt=1/j,Y=P.inverseMass+M.inverseMass,J=I.friction*I.frictionStatic*x;for(B.x=P.position.x-P.positionPrev.x,B.y=P.position.y-P.positionPrev.y,F.x=M.position.x-M.positionPrev.x,F.y=M.position.y-M.positionPrev.y,P.angularVelocity=P.angle-P.anglePrev,M.angularVelocity=M.angle-M.anglePrev,T=0;T<j;T++){var st=Z[T],xt=st.vertex,Tt=xt.x-P.position.x,Ct=xt.y-P.position.y,yt=xt.x-M.position.x,Ht=xt.y-M.position.y,Bt=B.x-Ct*P.angularVelocity,Jt=B.y+Tt*P.angularVelocity,xe=F.x-Ht*M.angularVelocity,Yt=F.y+yt*M.angularVelocity,Vt=Bt-xe,jt=Jt-Yt,Dt=L*Vt+V*jt,Ot=N*Vt+k*jt,Yr=I.separation+Dt,Ce=Math.min(Yr,1);Ce=Yr<0?0:Ce;var dn=Ce*J;Ot<-dn||Ot>dn?(w=Ot>0?Ot:-Ot,b=I.friction*(Ot>0?1:-1)*u,b<-w?b=-w:b>w&&(b=w)):(b=Ot,w=y);var jn=Tt*V-Ct*L,rr=yt*V-Ht*L,Ye=rt/(Y+P.inverseInertia*jn*jn+M.inverseInertia*rr*rr),$r=(1+I.restitution)*Dt*Ye;if(b*=Ye,Dt<m)st.normalImpulse=0;else{var Kn=st.normalImpulse;st.normalImpulse+=$r,st.normalImpulse>0&&(st.normalImpulse=0),$r=st.normalImpulse-Kn}if(Ot<-g||Ot>g)st.tangentImpulse=0;else{var yl=st.tangentImpulse;st.tangentImpulse+=b,st.tangentImpulse<-w&&(st.tangentImpulse=-w),st.tangentImpulse>w&&(st.tangentImpulse=w),b=st.tangentImpulse-yl}var jr=L*$r+N*b,Zn=V*$r+k*b;P.isStatic||P.isSleeping||(P.positionPrev.x+=jr*P.inverseMass,P.positionPrev.y+=Zn*P.inverseMass,P.anglePrev+=(Tt*Zn-Ct*jr)*P.inverseInertia),M.isStatic||M.isSleeping||(M.positionPrev.x-=jr*M.inverseMass,M.positionPrev.y-=Zn*M.inverseMass,M.anglePrev-=(yt*Zn-Ht*jr)*M.inverseInertia)}}}}})()},function(e,t,r){var i={};e.exports=i;var n=r(9),o=r(0);(function(){i.create=function(a){return o.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},a)},i.update=function(a,l,c){var d=a.list,f=d.length,u=a.table,m=l.length,g=a.collisionStart,x=a.collisionEnd,y=a.collisionActive,S,b,w,v;for(g.length=0,x.length=0,y.length=0,v=0;v<f;v++)d[v].confirmedActive=!1;for(v=0;v<m;v++)S=l[v],w=S.pair,w?(w.isActive?y.push(w):g.push(w),n.update(w,S,c),w.confirmedActive=!0):(w=n.create(S,c),u[w.id]=w,g.push(w),d.push(w));var T=[];for(f=d.length,v=0;v<f;v++)w=d[v],w.confirmedActive||(n.setActive(w,!1,c),x.push(w),!w.collision.bodyA.isSleeping&&!w.collision.bodyB.isSleeping&&T.push(v));for(v=0;v<T.length;v++)b=T[v]-v,w=d[b],d.splice(b,1),delete u[w.id]},i.clear=function(a){return a.table={},a.list.length=0,a.collisionStart.length=0,a.collisionActive.length=0,a.collisionEnd.length=0,a}})()},function(e,t,r){var i=e.exports=r(21);i.Axes=r(11),i.Bodies=r(12),i.Body=r(4),i.Bounds=r(1),i.Collision=r(8),i.Common=r(0),i.Composite=r(6),i.Composites=r(22),i.Constraint=r(10),i.Contact=r(16),i.Detector=r(13),i.Engine=r(17),i.Events=r(5),i.Grid=r(23),i.Mouse=r(14),i.MouseConstraint=r(24),i.Pair=r(9),i.Pairs=r(19),i.Plugin=r(15),i.Query=r(25),i.Render=r(26),i.Resolver=r(18),i.Runner=r(27),i.SAT=r(28),i.Sleeping=r(7),i.Svg=r(29),i.Vector=r(2),i.Vertices=r(3),i.World=r(30),i.Engine.run=i.Runner.run,i.Common.deprecated(i.Engine,"run","Engine.run \u27A4 use Matter.Runner.run(engine) instead")},function(e,t,r){var i={};e.exports=i;var n=r(15),o=r(0);(function(){i.name="matter-js",i.version="0.19.0",i.uses=[],i.used=[],i.use=function(){n.use(i,Array.prototype.slice.call(arguments))},i.before=function(a,l){return a=a.replace(/^Matter./,""),o.chainPathBefore(i,a,l)},i.after=function(a,l){return a=a.replace(/^Matter./,""),o.chainPathAfter(i,a,l)}})()},function(e,t,r){var i={};e.exports=i;var n=r(6),o=r(10),a=r(0),l=r(4),c=r(12),d=a.deprecated;(function(){i.stack=function(f,u,m,g,x,y,S){for(var b=n.create({label:"Stack"}),w=f,v=u,T,I=0,C=0;C<g;C++){for(var P=0,M=0;M<m;M++){var B=S(w,v,M,C,T,I);if(B){var F=B.bounds.max.y-B.bounds.min.y,L=B.bounds.max.x-B.bounds.min.x;F>P&&(P=F),l.translate(B,{x:L*.5,y:F*.5}),w=B.bounds.max.x+x,n.addBody(b,B),T=B,I+=1}else w+=x}v+=P+y,w=f}return b},i.chain=function(f,u,m,g,x,y){for(var S=f.bodies,b=1;b<S.length;b++){var w=S[b-1],v=S[b],T=w.bounds.max.y-w.bounds.min.y,I=w.bounds.max.x-w.bounds.min.x,C=v.bounds.max.y-v.bounds.min.y,P=v.bounds.max.x-v.bounds.min.x,M={bodyA:w,pointA:{x:I*u,y:T*m},bodyB:v,pointB:{x:P*g,y:C*x}},B=a.extend(M,y);n.addConstraint(f,o.create(B))}return f.label+=" Chain",f},i.mesh=function(f,u,m,g,x){var y=f.bodies,S,b,w,v,T;for(S=0;S<m;S++){for(b=1;b<u;b++)w=y[b-1+S*u],v=y[b+S*u],n.addConstraint(f,o.create(a.extend({bodyA:w,bodyB:v},x)));if(S>0)for(b=0;b<u;b++)w=y[b+(S-1)*u],v=y[b+S*u],n.addConstraint(f,o.create(a.extend({bodyA:w,bodyB:v},x))),g&&b>0&&(T=y[b-1+(S-1)*u],n.addConstraint(f,o.create(a.extend({bodyA:T,bodyB:v},x)))),g&&b<u-1&&(T=y[b+1+(S-1)*u],n.addConstraint(f,o.create(a.extend({bodyA:T,bodyB:v},x))))}return f.label+=" Mesh",f},i.pyramid=function(f,u,m,g,x,y,S){return i.stack(f,u,m,g,x,y,function(b,w,v,T,I,C){var P=Math.min(g,Math.ceil(m/2)),M=I?I.bounds.max.x-I.bounds.min.x:0;if(!(T>P)){T=P-T;var B=T,F=m-1-T;if(!(v<B||v>F)){C===1&&l.translate(I,{x:(v+(m%2===1?1:-1))*M,y:0});var L=I?v*M:0;return S(f+L+v*x,w,v,T,I,C)}}})},i.newtonsCradle=function(f,u,m,g,x){for(var y=n.create({label:"Newtons Cradle"}),S=0;S<m;S++){var b=1.9,w=c.circle(f+S*(g*b),u+x,g,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),v=o.create({pointA:{x:f+S*(g*b),y:u},bodyB:w});n.addBody(y,w),n.addConstraint(y,v)}return y},d(i,"newtonsCradle","Composites.newtonsCradle \u27A4 moved to newtonsCradle example"),i.car=function(f,u,m,g,x){var y=l.nextGroup(!0),S=20,b=-m*.5+S,w=m*.5-S,v=0,T=n.create({label:"Car"}),I=c.rectangle(f,u,m,g,{collisionFilter:{group:y},chamfer:{radius:g*.5},density:2e-4}),C=c.circle(f+b,u+v,x,{collisionFilter:{group:y},friction:.8}),P=c.circle(f+w,u+v,x,{collisionFilter:{group:y},friction:.8}),M=o.create({bodyB:I,pointB:{x:b,y:v},bodyA:C,stiffness:1,length:0}),B=o.create({bodyB:I,pointB:{x:w,y:v},bodyA:P,stiffness:1,length:0});return n.addBody(T,I),n.addBody(T,C),n.addBody(T,P),n.addConstraint(T,M),n.addConstraint(T,B),T},d(i,"car","Composites.car \u27A4 moved to car example"),i.softBody=function(f,u,m,g,x,y,S,b,w,v){w=a.extend({inertia:1/0},w),v=a.extend({stiffness:.2,render:{type:"line",anchors:!1}},v);var T=i.stack(f,u,m,g,x,y,function(I,C){return c.circle(I,C,b,w)});return i.mesh(T,m,g,S,v),T.label="Soft Body",T},d(i,"softBody","Composites.softBody \u27A4 moved to softBody and cloth examples")})()},function(e,t,r){var i={};e.exports=i;var n=r(9),o=r(0),a=o.deprecated;(function(){i.create=function(l){var c={buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return o.extend(c,l)},i.update=function(l,c,d,f){var u,m,g,x=d.world,y=l.buckets,S,b,w=!1;for(u=0;u<c.length;u++){var v=c[u];if(!(v.isSleeping&&!f)&&!(x.bounds&&(v.bounds.max.x<x.bounds.min.x||v.bounds.min.x>x.bounds.max.x||v.bounds.max.y<x.bounds.min.y||v.bounds.min.y>x.bounds.max.y))){var T=i._getRegion(l,v);if(!v.region||T.id!==v.region.id||f){(!v.region||f)&&(v.region=T);var I=i._regionUnion(T,v.region);for(m=I.startCol;m<=I.endCol;m++)for(g=I.startRow;g<=I.endRow;g++){b=i._getBucketId(m,g),S=y[b];var C=m>=T.startCol&&m<=T.endCol&&g>=T.startRow&&g<=T.endRow,P=m>=v.region.startCol&&m<=v.region.endCol&&g>=v.region.startRow&&g<=v.region.endRow;!C&&P&&P&&S&&i._bucketRemoveBody(l,S,v),(v.region===T||C&&!P||f)&&(S||(S=i._createBucket(y,b)),i._bucketAddBody(l,S,v))}v.region=T,w=!0}}}w&&(l.pairsList=i._createActivePairsList(l))},a(i,"update","Grid.update \u27A4 replaced by Matter.Detector"),i.clear=function(l){l.buckets={},l.pairs={},l.pairsList=[]},a(i,"clear","Grid.clear \u27A4 replaced by Matter.Detector"),i._regionUnion=function(l,c){var d=Math.min(l.startCol,c.startCol),f=Math.max(l.endCol,c.endCol),u=Math.min(l.startRow,c.startRow),m=Math.max(l.endRow,c.endRow);return i._createRegion(d,f,u,m)},i._getRegion=function(l,c){var d=c.bounds,f=Math.floor(d.min.x/l.bucketWidth),u=Math.floor(d.max.x/l.bucketWidth),m=Math.floor(d.min.y/l.bucketHeight),g=Math.floor(d.max.y/l.bucketHeight);return i._createRegion(f,u,m,g)},i._createRegion=function(l,c,d,f){return{id:l+","+c+","+d+","+f,startCol:l,endCol:c,startRow:d,endRow:f}},i._getBucketId=function(l,c){return"C"+l+"R"+c},i._createBucket=function(l,c){var d=l[c]=[];return d},i._bucketAddBody=function(l,c,d){var f=l.pairs,u=n.id,m=c.length,g;for(g=0;g<m;g++){var x=c[g];if(!(d.id===x.id||d.isStatic&&x.isStatic)){var y=u(d,x),S=f[y];S?S[2]+=1:f[y]=[d,x,1]}}c.push(d)},i._bucketRemoveBody=function(l,c,d){var f=l.pairs,u=n.id,m;c.splice(o.indexOf(c,d),1);var g=c.length;for(m=0;m<g;m++){var x=f[u(d,c[m])];x&&(x[2]-=1)}},i._createActivePairsList=function(l){var c,d=l.pairs,f=o.keys(d),u=f.length,m=[],g;for(g=0;g<u;g++)c=d[f[g]],c[2]>0?m.push(c):delete d[f[g]];return m}})()},function(e,t,r){var i={};e.exports=i;var n=r(3),o=r(7),a=r(14),l=r(5),c=r(13),d=r(10),f=r(6),u=r(0),m=r(1);(function(){i.create=function(g,x){var y=(g?g.mouse:null)||(x?x.mouse:null);y||(g&&g.render&&g.render.canvas?y=a.create(g.render.canvas):x&&x.element?y=a.create(x.element):(y=a.create(),u.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var S=d.create({label:"Mouse Constraint",pointA:y.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),b={type:"mouseConstraint",mouse:y,element:null,body:null,constraint:S,collisionFilter:{category:1,mask:4294967295,group:0}},w=u.extend(b,x);return l.on(g,"beforeUpdate",function(){var v=f.allBodies(g.world);i.update(w,v),i._triggerEvents(w)}),w},i.update=function(g,x){var y=g.mouse,S=g.constraint,b=g.body;if(y.button===0){if(S.bodyB)o.set(S.bodyB,!1),S.pointA=y.position;else for(var w=0;w<x.length;w++)if(b=x[w],m.contains(b.bounds,y.position)&&c.canCollide(b.collisionFilter,g.collisionFilter))for(var v=b.parts.length>1?1:0;v<b.parts.length;v++){var T=b.parts[v];if(n.contains(T.vertices,y.position)){S.pointA=y.position,S.bodyB=g.body=b,S.pointB={x:y.position.x-b.position.x,y:y.position.y-b.position.y},S.angleB=b.angle,o.set(b,!1),l.trigger(g,"startdrag",{mouse:y,body:b});break}}}else S.bodyB=g.body=null,S.pointB=null,b&&l.trigger(g,"enddrag",{mouse:y,body:b})},i._triggerEvents=function(g){var x=g.mouse,y=x.sourceEvents;y.mousemove&&l.trigger(g,"mousemove",{mouse:x}),y.mousedown&&l.trigger(g,"mousedown",{mouse:x}),y.mouseup&&l.trigger(g,"mouseup",{mouse:x}),a.clearSourceEvents(x)}})()},function(e,t,r){var i={};e.exports=i;var n=r(2),o=r(8),a=r(1),l=r(12),c=r(3);(function(){i.collides=function(d,f){for(var u=[],m=f.length,g=d.bounds,x=o.collides,y=a.overlaps,S=0;S<m;S++){var b=f[S],w=b.parts.length,v=w===1?0:1;if(y(b.bounds,g))for(var T=v;T<w;T++){var I=b.parts[T];if(y(I.bounds,g)){var C=x(I,d);if(C){u.push(C);break}}}}return u},i.ray=function(d,f,u,m){m=m||1e-100;for(var g=n.angle(f,u),x=n.magnitude(n.sub(f,u)),y=(u.x+f.x)*.5,S=(u.y+f.y)*.5,b=l.rectangle(y,S,x,m,{angle:g}),w=i.collides(b,d),v=0;v<w.length;v+=1){var T=w[v];T.body=T.bodyB=T.bodyA}return w},i.region=function(d,f,u){for(var m=[],g=0;g<d.length;g++){var x=d[g],y=a.overlaps(x.bounds,f);(y&&!u||!y&&u)&&m.push(x)}return m},i.point=function(d,f){for(var u=[],m=0;m<d.length;m++){var g=d[m];if(a.contains(g.bounds,f))for(var x=g.parts.length===1?0:1;x<g.parts.length;x++){var y=g.parts[x];if(a.contains(y.bounds,f)&&c.contains(y.vertices,f)){u.push(g);break}}}return u}})()},function(e,t,r){var i={};e.exports=i;var n=r(4),o=r(0),a=r(6),l=r(1),c=r(5),d=r(2),f=r(14);(function(){var u,m;typeof window<"u"&&(u=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(v){window.setTimeout(function(){v(o.now())},1e3/60)},m=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),i._goodFps=30,i._goodDelta=1e3/60,i.create=function(v){var T={engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",hasBounds:!!v.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},I=o.extend(T,v);return I.canvas&&(I.canvas.width=I.options.width||I.canvas.width,I.canvas.height=I.options.height||I.canvas.height),I.mouse=v.mouse,I.engine=v.engine,I.canvas=I.canvas||y(I.options.width,I.options.height),I.context=I.canvas.getContext("2d"),I.textures={},I.bounds=I.bounds||{min:{x:0,y:0},max:{x:I.canvas.width,y:I.canvas.height}},I.controller=i,I.options.showBroadphase=!1,I.options.pixelRatio!==1&&i.setPixelRatio(I,I.options.pixelRatio),o.isElement(I.element)&&I.element.appendChild(I.canvas),I},i.run=function(v){(function T(I){v.frameRequestId=u(T),g(v,I),i.world(v,I),(v.options.showStats||v.options.showDebug)&&i.stats(v,v.context,I),(v.options.showPerformance||v.options.showDebug)&&i.performance(v,v.context,I)})()},i.stop=function(v){m(v.frameRequestId)},i.setPixelRatio=function(v,T){var I=v.options,C=v.canvas;T==="auto"&&(T=S(C)),I.pixelRatio=T,C.setAttribute("data-pixel-ratio",T),C.width=I.width*T,C.height=I.height*T,C.style.width=I.width+"px",C.style.height=I.height+"px"},i.lookAt=function(v,T,I,C){C=typeof C<"u"?C:!0,T=o.isArray(T)?T:[T],I=I||{x:0,y:0};for(var P={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},M=0;M<T.length;M+=1){var B=T[M],F=B.bounds?B.bounds.min:B.min||B.position||B,L=B.bounds?B.bounds.max:B.max||B.position||B;F&&L&&(F.x<P.min.x&&(P.min.x=F.x),L.x>P.max.x&&(P.max.x=L.x),F.y<P.min.y&&(P.min.y=F.y),L.y>P.max.y&&(P.max.y=L.y))}var V=P.max.x-P.min.x+2*I.x,N=P.max.y-P.min.y+2*I.y,k=v.canvas.height,Z=v.canvas.width,j=Z/k,rt=V/N,Y=1,J=1;rt>j?J=rt/j:Y=j/rt,v.options.hasBounds=!0,v.bounds.min.x=P.min.x,v.bounds.max.x=P.min.x+V*Y,v.bounds.min.y=P.min.y,v.bounds.max.y=P.min.y+N*J,C&&(v.bounds.min.x+=V*.5-V*Y*.5,v.bounds.max.x+=V*.5-V*Y*.5,v.bounds.min.y+=N*.5-N*J*.5,v.bounds.max.y+=N*.5-N*J*.5),v.bounds.min.x-=I.x,v.bounds.max.x-=I.x,v.bounds.min.y-=I.y,v.bounds.max.y-=I.y,v.mouse&&(f.setScale(v.mouse,{x:(v.bounds.max.x-v.bounds.min.x)/v.canvas.width,y:(v.bounds.max.y-v.bounds.min.y)/v.canvas.height}),f.setOffset(v.mouse,v.bounds.min))},i.startViewTransform=function(v){var T=v.bounds.max.x-v.bounds.min.x,I=v.bounds.max.y-v.bounds.min.y,C=T/v.options.width,P=I/v.options.height;v.context.setTransform(v.options.pixelRatio/C,0,0,v.options.pixelRatio/P,0,0),v.context.translate(-v.bounds.min.x,-v.bounds.min.y)},i.endViewTransform=function(v){v.context.setTransform(v.options.pixelRatio,0,0,v.options.pixelRatio,0,0)},i.world=function(v,T){var I=o.now(),C=v.engine,P=C.world,M=v.canvas,B=v.context,F=v.options,L=v.timing,V=a.allBodies(P),N=a.allConstraints(P),k=F.wireframes?F.wireframeBackground:F.background,Z=[],j=[],rt,Y={timestamp:C.timing.timestamp};if(c.trigger(v,"beforeRender",Y),v.currentBackground!==k&&w(v,k),B.globalCompositeOperation="source-in",B.fillStyle="transparent",B.fillRect(0,0,M.width,M.height),B.globalCompositeOperation="source-over",F.hasBounds){for(rt=0;rt<V.length;rt++){var J=V[rt];l.overlaps(J.bounds,v.bounds)&&Z.push(J)}for(rt=0;rt<N.length;rt++){var st=N[rt],xt=st.bodyA,Tt=st.bodyB,Ct=st.pointA,yt=st.pointB;xt&&(Ct=d.add(xt.position,st.pointA)),Tt&&(yt=d.add(Tt.position,st.pointB)),!(!Ct||!yt)&&(l.contains(v.bounds,Ct)||l.contains(v.bounds,yt))&&j.push(st)}i.startViewTransform(v),v.mouse&&(f.setScale(v.mouse,{x:(v.bounds.max.x-v.bounds.min.x)/v.options.width,y:(v.bounds.max.y-v.bounds.min.y)/v.options.height}),f.setOffset(v.mouse,v.bounds.min))}else j=N,Z=V,v.options.pixelRatio!==1&&v.context.setTransform(v.options.pixelRatio,0,0,v.options.pixelRatio,0,0);!F.wireframes||C.enableSleeping&&F.showSleeping?i.bodies(v,Z,B):(F.showConvexHulls&&i.bodyConvexHulls(v,Z,B),i.bodyWireframes(v,Z,B)),F.showBounds&&i.bodyBounds(v,Z,B),(F.showAxes||F.showAngleIndicator)&&i.bodyAxes(v,Z,B),F.showPositions&&i.bodyPositions(v,Z,B),F.showVelocity&&i.bodyVelocity(v,Z,B),F.showIds&&i.bodyIds(v,Z,B),F.showSeparations&&i.separations(v,C.pairs.list,B),F.showCollisions&&i.collisions(v,C.pairs.list,B),F.showVertexNumbers&&i.vertexNumbers(v,Z,B),F.showMousePosition&&i.mousePosition(v,v.mouse,B),i.constraints(j,B),F.hasBounds&&i.endViewTransform(v),c.trigger(v,"afterRender",Y),L.lastElapsed=o.now()-I},i.stats=function(v,T,I){for(var C=v.engine,P=C.world,M=a.allBodies(P),B=0,F=55,L=44,V=0,N=0,k=0;k<M.length;k+=1)B+=M[k].parts.length;var Z={Part:B,Body:M.length,Cons:a.allConstraints(P).length,Comp:a.allComposites(P).length,Pair:C.pairs.list.length};T.fillStyle="#0e0f19",T.fillRect(V,N,F*5.5,L),T.font="12px Arial",T.textBaseline="top",T.textAlign="right";for(var j in Z){var rt=Z[j];T.fillStyle="#aaa",T.fillText(j,V+F,N+8),T.fillStyle="#eee",T.fillText(rt,V+F,N+26),V+=F}},i.performance=function(v,T){var I=v.engine,C=v.timing,P=C.deltaHistory,M=C.elapsedHistory,B=C.timestampElapsedHistory,F=C.engineDeltaHistory,L=C.engineElapsedHistory,V=I.timing.lastDelta,N=x(P),k=x(M),Z=x(F),j=x(L),rt=x(B),Y=rt/N||0,J=1e3/N||0,st=4,xt=12,Tt=60,Ct=34,yt=10,Ht=69;T.fillStyle="#0e0f19",T.fillRect(0,50,xt*4+Tt*5+22,Ct),i.status(T,yt,Ht,Tt,st,P.length,Math.round(J)+" fps",J/i._goodFps,function(Bt){return P[Bt]/N-1}),i.status(T,yt+xt+Tt,Ht,Tt,st,F.length,V.toFixed(2)+" dt",i._goodDelta/V,function(Bt){return F[Bt]/Z-1}),i.status(T,yt+(xt+Tt)*2,Ht,Tt,st,L.length,j.toFixed(2)+" ut",1-j/i._goodFps,function(Bt){return L[Bt]/j-1}),i.status(T,yt+(xt+Tt)*3,Ht,Tt,st,M.length,k.toFixed(2)+" rt",1-k/i._goodFps,function(Bt){return M[Bt]/k-1}),i.status(T,yt+(xt+Tt)*4,Ht,Tt,st,B.length,Y.toFixed(2)+" x",Y*Y*Y,function(Bt){return(B[Bt]/P[Bt]/Y||0)-1})},i.status=function(v,T,I,C,P,M,B,F,L){v.strokeStyle="#888",v.fillStyle="#444",v.lineWidth=1,v.fillRect(T,I+7,C,1),v.beginPath(),v.moveTo(T,I+7-P*o.clamp(.4*L(0),-2,2));for(var V=0;V<C;V+=1)v.lineTo(T+V,I+7-(V<M?P*o.clamp(.4*L(V),-2,2):0));v.stroke(),v.fillStyle="hsl("+o.clamp(25+95*F,0,120)+",100%,60%)",v.fillRect(T,I-7,4,4),v.font="12px Arial",v.textBaseline="middle",v.textAlign="right",v.fillStyle="#eee",v.fillText(B,T+C,I-5)},i.constraints=function(v,T){for(var I=T,C=0;C<v.length;C++){var P=v[C];if(!(!P.render.visible||!P.pointA||!P.pointB)){var M=P.bodyA,B=P.bodyB,F,L;if(M?F=d.add(M.position,P.pointA):F=P.pointA,P.render.type==="pin")I.beginPath(),I.arc(F.x,F.y,3,0,2*Math.PI),I.closePath();else{if(B?L=d.add(B.position,P.pointB):L=P.pointB,I.beginPath(),I.moveTo(F.x,F.y),P.render.type==="spring")for(var V=d.sub(L,F),N=d.perp(d.normalise(V)),k=Math.ceil(o.clamp(P.length/5,12,20)),Z,j=1;j<k;j+=1)Z=j%2===0?1:-1,I.lineTo(F.x+V.x*(j/k)+N.x*Z*4,F.y+V.y*(j/k)+N.y*Z*4);I.lineTo(L.x,L.y)}P.render.lineWidth&&(I.lineWidth=P.render.lineWidth,I.strokeStyle=P.render.strokeStyle,I.stroke()),P.render.anchors&&(I.fillStyle=P.render.strokeStyle,I.beginPath(),I.arc(F.x,F.y,3,0,2*Math.PI),I.arc(L.x,L.y,3,0,2*Math.PI),I.closePath(),I.fill())}}},i.bodies=function(v,T,I){var C=I,P=v.engine,M=v.options,B=M.showInternalEdges||!M.wireframes,F,L,V,N;for(V=0;V<T.length;V++)if(F=T[V],!!F.render.visible){for(N=F.parts.length>1?1:0;N<F.parts.length;N++)if(L=F.parts[N],!!L.render.visible){if(M.showSleeping&&F.isSleeping?C.globalAlpha=.5*L.render.opacity:L.render.opacity!==1&&(C.globalAlpha=L.render.opacity),L.render.sprite&&L.render.sprite.texture&&!M.wireframes){var k=L.render.sprite,Z=b(v,k.texture);C.translate(L.position.x,L.position.y),C.rotate(L.angle),C.drawImage(Z,Z.width*-k.xOffset*k.xScale,Z.height*-k.yOffset*k.yScale,Z.width*k.xScale,Z.height*k.yScale),C.rotate(-L.angle),C.translate(-L.position.x,-L.position.y)}else{if(L.circleRadius)C.beginPath(),C.arc(L.position.x,L.position.y,L.circleRadius,0,2*Math.PI);else{C.beginPath(),C.moveTo(L.vertices[0].x,L.vertices[0].y);for(var j=1;j<L.vertices.length;j++)!L.vertices[j-1].isInternal||B?C.lineTo(L.vertices[j].x,L.vertices[j].y):C.moveTo(L.vertices[j].x,L.vertices[j].y),L.vertices[j].isInternal&&!B&&C.moveTo(L.vertices[(j+1)%L.vertices.length].x,L.vertices[(j+1)%L.vertices.length].y);C.lineTo(L.vertices[0].x,L.vertices[0].y),C.closePath()}M.wireframes?(C.lineWidth=1,C.strokeStyle="#bbb",C.stroke()):(C.fillStyle=L.render.fillStyle,L.render.lineWidth&&(C.lineWidth=L.render.lineWidth,C.strokeStyle=L.render.strokeStyle,C.stroke()),C.fill())}C.globalAlpha=1}}},i.bodyWireframes=function(v,T,I){var C=I,P=v.options.showInternalEdges,M,B,F,L,V;for(C.beginPath(),F=0;F<T.length;F++)if(M=T[F],!!M.render.visible)for(V=M.parts.length>1?1:0;V<M.parts.length;V++){for(B=M.parts[V],C.moveTo(B.vertices[0].x,B.vertices[0].y),L=1;L<B.vertices.length;L++)!B.vertices[L-1].isInternal||P?C.lineTo(B.vertices[L].x,B.vertices[L].y):C.moveTo(B.vertices[L].x,B.vertices[L].y),B.vertices[L].isInternal&&!P&&C.moveTo(B.vertices[(L+1)%B.vertices.length].x,B.vertices[(L+1)%B.vertices.length].y);C.lineTo(B.vertices[0].x,B.vertices[0].y)}C.lineWidth=1,C.strokeStyle="#bbb",C.stroke()},i.bodyConvexHulls=function(v,T,I){var C=I,P,M,B,F,L;for(C.beginPath(),B=0;B<T.length;B++)if(P=T[B],!(!P.render.visible||P.parts.length===1)){for(C.moveTo(P.vertices[0].x,P.vertices[0].y),F=1;F<P.vertices.length;F++)C.lineTo(P.vertices[F].x,P.vertices[F].y);C.lineTo(P.vertices[0].x,P.vertices[0].y)}C.lineWidth=1,C.strokeStyle="rgba(255,255,255,0.2)",C.stroke()},i.vertexNumbers=function(v,T,I){var C=I,P,M,B;for(P=0;P<T.length;P++){var F=T[P].parts;for(B=F.length>1?1:0;B<F.length;B++){var L=F[B];for(M=0;M<L.vertices.length;M++)C.fillStyle="rgba(255,255,255,0.2)",C.fillText(P+"_"+M,L.position.x+(L.vertices[M].x-L.position.x)*.8,L.position.y+(L.vertices[M].y-L.position.y)*.8)}}},i.mousePosition=function(v,T,I){var C=I;C.fillStyle="rgba(255,255,255,0.8)",C.fillText(T.position.x+"  "+T.position.y,T.position.x+5,T.position.y-5)},i.bodyBounds=function(v,T,I){var C=I,P=v.engine,M=v.options;C.beginPath();for(var B=0;B<T.length;B++){var F=T[B];if(F.render.visible)for(var L=T[B].parts,V=L.length>1?1:0;V<L.length;V++){var N=L[V];C.rect(N.bounds.min.x,N.bounds.min.y,N.bounds.max.x-N.bounds.min.x,N.bounds.max.y-N.bounds.min.y)}}M.wireframes?C.strokeStyle="rgba(255,255,255,0.08)":C.strokeStyle="rgba(0,0,0,0.1)",C.lineWidth=1,C.stroke()},i.bodyAxes=function(v,T,I){var C=I,P=v.engine,M=v.options,B,F,L,V;for(C.beginPath(),F=0;F<T.length;F++){var N=T[F],k=N.parts;if(N.render.visible)if(M.showAxes)for(L=k.length>1?1:0;L<k.length;L++)for(B=k[L],V=0;V<B.axes.length;V++){var Z=B.axes[V];C.moveTo(B.position.x,B.position.y),C.lineTo(B.position.x+Z.x*20,B.position.y+Z.y*20)}else for(L=k.length>1?1:0;L<k.length;L++)for(B=k[L],V=0;V<B.axes.length;V++)C.moveTo(B.position.x,B.position.y),C.lineTo((B.vertices[0].x+B.vertices[B.vertices.length-1].x)/2,(B.vertices[0].y+B.vertices[B.vertices.length-1].y)/2)}M.wireframes?(C.strokeStyle="indianred",C.lineWidth=1):(C.strokeStyle="rgba(255, 255, 255, 0.4)",C.globalCompositeOperation="overlay",C.lineWidth=2),C.stroke(),C.globalCompositeOperation="source-over"},i.bodyPositions=function(v,T,I){var C=I,P=v.engine,M=v.options,B,F,L,V;for(C.beginPath(),L=0;L<T.length;L++)if(B=T[L],!!B.render.visible)for(V=0;V<B.parts.length;V++)F=B.parts[V],C.arc(F.position.x,F.position.y,3,0,2*Math.PI,!1),C.closePath();for(M.wireframes?C.fillStyle="indianred":C.fillStyle="rgba(0,0,0,0.5)",C.fill(),C.beginPath(),L=0;L<T.length;L++)B=T[L],B.render.visible&&(C.arc(B.positionPrev.x,B.positionPrev.y,2,0,2*Math.PI,!1),C.closePath());C.fillStyle="rgba(255,165,0,0.8)",C.fill()},i.bodyVelocity=function(v,T,I){var C=I;C.beginPath();for(var P=0;P<T.length;P++){var M=T[P];if(M.render.visible){var B=n.getVelocity(M);C.moveTo(M.position.x,M.position.y),C.lineTo(M.position.x+B.x,M.position.y+B.y)}}C.lineWidth=3,C.strokeStyle="cornflowerblue",C.stroke()},i.bodyIds=function(v,T,I){var C=I,P,M;for(P=0;P<T.length;P++)if(T[P].render.visible){var B=T[P].parts;for(M=B.length>1?1:0;M<B.length;M++){var F=B[M];C.font="12px Arial",C.fillStyle="rgba(255,255,255,0.5)",C.fillText(F.id,F.position.x+10,F.position.y-10)}}},i.collisions=function(v,T,I){var C=I,P=v.options,M,B,F,L,V,N,k;for(C.beginPath(),N=0;N<T.length;N++)if(M=T[N],!!M.isActive)for(B=M.collision,k=0;k<M.activeContacts.length;k++){var Z=M.activeContacts[k],j=Z.vertex;C.rect(j.x-1.5,j.y-1.5,3.5,3.5)}for(P.wireframes?C.fillStyle="rgba(255,255,255,0.7)":C.fillStyle="orange",C.fill(),C.beginPath(),N=0;N<T.length;N++)if(M=T[N],!!M.isActive&&(B=M.collision,M.activeContacts.length>0)){var rt=M.activeContacts[0].vertex.x,Y=M.activeContacts[0].vertex.y;M.activeContacts.length===2&&(rt=(M.activeContacts[0].vertex.x+M.activeContacts[1].vertex.x)/2,Y=(M.activeContacts[0].vertex.y+M.activeContacts[1].vertex.y)/2),B.bodyB===B.supports[0].body||B.bodyA.isStatic===!0?C.moveTo(rt-B.normal.x*8,Y-B.normal.y*8):C.moveTo(rt+B.normal.x*8,Y+B.normal.y*8),C.lineTo(rt,Y)}P.wireframes?C.strokeStyle="rgba(255,165,0,0.7)":C.strokeStyle="orange",C.lineWidth=1,C.stroke()},i.separations=function(v,T,I){var C=I,P=v.options,M,B,F,L,V,N,k;for(C.beginPath(),N=0;N<T.length;N++)if(M=T[N],!!M.isActive){B=M.collision,L=B.bodyA,V=B.bodyB;var Z=1;!V.isStatic&&!L.isStatic&&(Z=.5),V.isStatic&&(Z=0),C.moveTo(V.position.x,V.position.y),C.lineTo(V.position.x-B.penetration.x*Z,V.position.y-B.penetration.y*Z),Z=1,!V.isStatic&&!L.isStatic&&(Z=.5),L.isStatic&&(Z=0),C.moveTo(L.position.x,L.position.y),C.lineTo(L.position.x+B.penetration.x*Z,L.position.y+B.penetration.y*Z)}P.wireframes?C.strokeStyle="rgba(255,165,0,0.5)":C.strokeStyle="orange",C.stroke()},i.inspector=function(v,T){var I=v.engine,C=v.selected,P=v.render,M=P.options,B;if(M.hasBounds){var F=P.bounds.max.x-P.bounds.min.x,L=P.bounds.max.y-P.bounds.min.y,V=F/P.options.width,N=L/P.options.height;T.scale(1/V,1/N),T.translate(-P.bounds.min.x,-P.bounds.min.y)}for(var k=0;k<C.length;k++){var Z=C[k].data;switch(T.translate(.5,.5),T.lineWidth=1,T.strokeStyle="rgba(255,165,0,0.9)",T.setLineDash([1,2]),Z.type){case"body":B=Z.bounds,T.beginPath(),T.rect(Math.floor(B.min.x-3),Math.floor(B.min.y-3),Math.floor(B.max.x-B.min.x+6),Math.floor(B.max.y-B.min.y+6)),T.closePath(),T.stroke();break;case"constraint":var j=Z.pointA;Z.bodyA&&(j=Z.pointB),T.beginPath(),T.arc(j.x,j.y,10,0,2*Math.PI),T.closePath(),T.stroke();break}T.setLineDash([]),T.translate(-.5,-.5)}v.selectStart!==null&&(T.translate(.5,.5),T.lineWidth=1,T.strokeStyle="rgba(255,165,0,0.6)",T.fillStyle="rgba(255,165,0,0.1)",B=v.selectBounds,T.beginPath(),T.rect(Math.floor(B.min.x),Math.floor(B.min.y),Math.floor(B.max.x-B.min.x),Math.floor(B.max.y-B.min.y)),T.closePath(),T.stroke(),T.fill(),T.translate(-.5,-.5)),M.hasBounds&&T.setTransform(1,0,0,1,0,0)};var g=function(v,T){var I=v.engine,C=v.timing,P=C.historySize,M=I.timing.timestamp;C.delta=T-C.lastTime||i._goodDelta,C.lastTime=T,C.timestampElapsed=M-C.lastTimestamp||0,C.lastTimestamp=M,C.deltaHistory.unshift(C.delta),C.deltaHistory.length=Math.min(C.deltaHistory.length,P),C.engineDeltaHistory.unshift(I.timing.lastDelta),C.engineDeltaHistory.length=Math.min(C.engineDeltaHistory.length,P),C.timestampElapsedHistory.unshift(C.timestampElapsed),C.timestampElapsedHistory.length=Math.min(C.timestampElapsedHistory.length,P),C.engineElapsedHistory.unshift(I.timing.lastElapsed),C.engineElapsedHistory.length=Math.min(C.engineElapsedHistory.length,P),C.elapsedHistory.unshift(C.lastElapsed),C.elapsedHistory.length=Math.min(C.elapsedHistory.length,P)},x=function(v){for(var T=0,I=0;I<v.length;I+=1)T+=v[I];return T/v.length||0},y=function(v,T){var I=document.createElement("canvas");return I.width=v,I.height=T,I.oncontextmenu=function(){return!1},I.onselectstart=function(){return!1},I},S=function(v){var T=v.getContext("2d"),I=window.devicePixelRatio||1,C=T.webkitBackingStorePixelRatio||T.mozBackingStorePixelRatio||T.msBackingStorePixelRatio||T.oBackingStorePixelRatio||T.backingStorePixelRatio||1;return I/C},b=function(v,T){var I=v.textures[T];return I||(I=v.textures[T]=new Image,I.src=T,I)},w=function(v,T){var I=T;/(jpg|gif|png)$/.test(T)&&(I="url("+T+")"),v.canvas.style.background=I,v.canvas.style.backgroundSize="contain",v.currentBackground=T}})()},function(e,t,r){var i={};e.exports=i;var n=r(5),o=r(17),a=r(0);(function(){var l,c;if(typeof window<"u"&&(l=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,c=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),!l){var d;l=function(f){d=setTimeout(function(){f(a.now())},1e3/60)},c=function(){clearTimeout(d)}}i.create=function(f){var u={fps:60,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,frameRequestId:null,isFixed:!1,enabled:!0},m=a.extend(u,f);return m.delta=m.delta||1e3/m.fps,m.deltaMin=m.deltaMin||1e3/m.fps,m.deltaMax=m.deltaMax||1e3/(m.fps*.5),m.fps=1e3/m.delta,m},i.run=function(f,u){return typeof f.positionIterations<"u"&&(u=f,f=i.create()),function m(g){f.frameRequestId=l(m),g&&f.enabled&&i.tick(f,u,g)}(),f},i.tick=function(f,u,m){var g=u.timing,x;f.isFixed?x=f.delta:(x=m-f.timePrev||f.delta,f.timePrev=m,f.deltaHistory.push(x),f.deltaHistory=f.deltaHistory.slice(-f.deltaSampleSize),x=Math.min.apply(null,f.deltaHistory),x=x<f.deltaMin?f.deltaMin:x,x=x>f.deltaMax?f.deltaMax:x,f.delta=x);var y={timestamp:g.timestamp};n.trigger(f,"beforeTick",y),f.frameCounter+=1,m-f.counterTimestamp>=1e3&&(f.fps=f.frameCounter*((m-f.counterTimestamp)/1e3),f.counterTimestamp=m,f.frameCounter=0),n.trigger(f,"tick",y),n.trigger(f,"beforeUpdate",y),o.update(u,x),n.trigger(f,"afterUpdate",y),n.trigger(f,"afterTick",y)},i.stop=function(f){c(f.frameRequestId)},i.start=function(f,u){i.run(f,u)}})()},function(e,t,r){var i={};e.exports=i;var n=r(8),o=r(0),a=o.deprecated;(function(){i.collides=function(l,c){return n.collides(l,c)},a(i,"collides","SAT.collides \u27A4 replaced by Collision.collides")})()},function(e,t,r){var i={};e.exports=i;var n=r(1),o=r(0);(function(){i.pathToVertices=function(a,l){typeof window<"u"&&!("SVGPathSeg"in window)&&o.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var c,d,f,u,m,g,x,y,S,b,w=[],v,T,I=0,C=0,P=0;l=l||15;var M=function(F,L,V){var N=V%2===1&&V>1;if(!S||F!=S.x||L!=S.y){S&&N?(v=S.x,T=S.y):(v=0,T=0);var k={x:v+F,y:T+L};(N||!S)&&(S=k),w.push(k),C=v+F,P=T+L}},B=function(F){var L=F.pathSegTypeAsLetter.toUpperCase();if(L!=="Z"){switch(L){case"M":case"L":case"T":case"C":case"S":case"Q":C=F.x,P=F.y;break;case"H":C=F.x;break;case"V":P=F.y;break}M(C,P,F.pathSegType)}};for(i._svgPathToAbsolute(a),f=a.getTotalLength(),g=[],c=0;c<a.pathSegList.numberOfItems;c+=1)g.push(a.pathSegList.getItem(c));for(x=g.concat();I<f;){if(b=a.getPathSegAtLength(I),m=g[b],m!=y){for(;x.length&&x[0]!=m;)B(x.shift());y=m}switch(m.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":u=a.getPointAtLength(I),M(u.x,u.y,0);break}I+=l}for(c=0,d=x.length;c<d;++c)B(x[c]);return w},i._svgPathToAbsolute=function(a){for(var l,c,d,f,u,m,g=a.pathSegList,x=0,y=0,S=g.numberOfItems,b=0;b<S;++b){var w=g.getItem(b),v=w.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(v))"x"in w&&(x=w.x),"y"in w&&(y=w.y);else switch("x1"in w&&(d=x+w.x1),"x2"in w&&(u=x+w.x2),"y1"in w&&(f=y+w.y1),"y2"in w&&(m=y+w.y2),"x"in w&&(x+=w.x),"y"in w&&(y+=w.y),v){case"m":g.replaceItem(a.createSVGPathSegMovetoAbs(x,y),b);break;case"l":g.replaceItem(a.createSVGPathSegLinetoAbs(x,y),b);break;case"h":g.replaceItem(a.createSVGPathSegLinetoHorizontalAbs(x),b);break;case"v":g.replaceItem(a.createSVGPathSegLinetoVerticalAbs(y),b);break;case"c":g.replaceItem(a.createSVGPathSegCurvetoCubicAbs(x,y,d,f,u,m),b);break;case"s":g.replaceItem(a.createSVGPathSegCurvetoCubicSmoothAbs(x,y,u,m),b);break;case"q":g.replaceItem(a.createSVGPathSegCurvetoQuadraticAbs(x,y,d,f),b);break;case"t":g.replaceItem(a.createSVGPathSegCurvetoQuadraticSmoothAbs(x,y),b);break;case"a":g.replaceItem(a.createSVGPathSegArcAbs(x,y,w.r1,w.r2,w.angle,w.largeArcFlag,w.sweepFlag),b);break;case"z":case"Z":x=l,y=c;break}(v=="M"||v=="m")&&(l=x,c=y)}}})()},function(e,t,r){var i={};e.exports=i;var n=r(6),o=r(0);(function(){i.create=n.create,i.add=n.add,i.remove=n.remove,i.clear=n.clear,i.addComposite=n.addComposite,i.addBody=n.addBody,i.addConstraint=n.addConstraint})()}])})});var Nx=Jr((to,ba)=>{(function(){var e,t="4.17.21",r=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",n="Expected a function",o="Invalid `variable` option passed into `_.template`",a="__lodash_hash_undefined__",l=500,c="__lodash_placeholder__",d=1,f=2,u=4,m=1,g=2,x=1,y=2,S=4,b=8,w=16,v=32,T=64,I=128,C=256,P=512,M=30,B="...",F=800,L=16,V=1,N=2,k=3,Z=1/0,j=9007199254740991,rt=17976931348623157e292,Y=0/0,J=4294967295,st=J-1,xt=J>>>1,Tt=[["ary",I],["bind",x],["bindKey",y],["curry",b],["curryRight",w],["flip",P],["partial",v],["partialRight",T],["rearg",C]],Ct="[object Arguments]",yt="[object Array]",Ht="[object AsyncFunction]",Bt="[object Boolean]",Jt="[object Date]",xe="[object DOMException]",Yt="[object Error]",Vt="[object Function]",jt="[object GeneratorFunction]",Dt="[object Map]",Ot="[object Number]",Yr="[object Null]",Ce="[object Object]",dn="[object Promise]",jn="[object Proxy]",rr="[object RegExp]",Ye="[object Set]",$r="[object String]",Kn="[object Symbol]",yl="[object Undefined]",jr="[object WeakMap]",Zn="[object WeakSet]",eo="[object ArrayBuffer]",qn="[object DataView]",Tl="[object Float32Array]",El="[object Float64Array]",Sl="[object Int8Array]",wl="[object Int16Array]",bl="[object Int32Array]",Al="[object Uint8Array]",Cl="[object Uint8ClampedArray]",Rl="[object Uint16Array]",Il="[object Uint32Array]",Gx=/\b__p \+= '';/g,kx=/\b(__p \+=) '' \+/g,Hx=/(__e\(.*?\)|\b__t\)) \+\n'';/g,bf=/&(?:amp|lt|gt|quot|#39);/g,Af=/[&<>"']/g,Vx=RegExp(bf.source),Wx=RegExp(Af.source),Xx=/<%-([\s\S]+?)%>/g,zx=/<%([\s\S]+?)%>/g,Cf=/<%=([\s\S]+?)%>/g,Yx=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$x=/^\w*$/,jx=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pl=/[\\^$.*+?()[\]{}|]/g,Kx=RegExp(Pl.source),Ml=/^\s+/,Zx=/\s/,qx=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Jx=/\{\n\/\* \[wrapped with (.+)\] \*/,Qx=/,? & /,t_=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,e_=/[()=,{}\[\]\/\s]/,r_=/\\(\\)?/g,i_=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Rf=/\w*$/,n_=/^[-+]0x[0-9a-f]+$/i,s_=/^0b[01]+$/i,o_=/^\[object .+?Constructor\]$/,a_=/^0o[0-7]+$/i,h_=/^(?:0|[1-9]\d*)$/,l_=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Aa=/($^)/,u_=/['\n\r\u2028\u2029\\]/g,Ca="\\ud800-\\udfff",c_="\\u0300-\\u036f",f_="\\ufe20-\\ufe2f",d_="\\u20d0-\\u20ff",If=c_+f_+d_,Pf="\\u2700-\\u27bf",Mf="a-z\\xdf-\\xf6\\xf8-\\xff",p_="\\xac\\xb1\\xd7\\xf7",m_="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",g_="\\u2000-\\u206f",x_=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Bf="A-Z\\xc0-\\xd6\\xd8-\\xde",Df="\\ufe0e\\ufe0f",Lf=p_+m_+g_+x_,Bl="['\u2019]",__="["+Ca+"]",Ff="["+Lf+"]",Ra="["+If+"]",Of="\\d+",v_="["+Pf+"]",Nf="["+Mf+"]",Uf="[^"+Ca+Lf+Of+Pf+Mf+Bf+"]",Dl="\\ud83c[\\udffb-\\udfff]",y_="(?:"+Ra+"|"+Dl+")",Gf="[^"+Ca+"]",Ll="(?:\\ud83c[\\udde6-\\uddff]){2}",Fl="[\\ud800-\\udbff][\\udc00-\\udfff]",Jn="["+Bf+"]",kf="\\u200d",Hf="(?:"+Nf+"|"+Uf+")",T_="(?:"+Jn+"|"+Uf+")",Vf="(?:"+Bl+"(?:d|ll|m|re|s|t|ve))?",Wf="(?:"+Bl+"(?:D|LL|M|RE|S|T|VE))?",Xf=y_+"?",zf="["+Df+"]?",E_="(?:"+kf+"(?:"+[Gf,Ll,Fl].join("|")+")"+zf+Xf+")*",S_="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",w_="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Yf=zf+Xf+E_,b_="(?:"+[v_,Ll,Fl].join("|")+")"+Yf,A_="(?:"+[Gf+Ra+"?",Ra,Ll,Fl,__].join("|")+")",C_=RegExp(Bl,"g"),R_=RegExp(Ra,"g"),Ol=RegExp(Dl+"(?="+Dl+")|"+A_+Yf,"g"),I_=RegExp([Jn+"?"+Nf+"+"+Vf+"(?="+[Ff,Jn,"$"].join("|")+")",T_+"+"+Wf+"(?="+[Ff,Jn+Hf,"$"].join("|")+")",Jn+"?"+Hf+"+"+Vf,Jn+"+"+Wf,w_,S_,Of,b_].join("|"),"g"),P_=RegExp("["+kf+Ca+If+Df+"]"),M_=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,B_=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],D_=-1,Kt={};Kt[Tl]=Kt[El]=Kt[Sl]=Kt[wl]=Kt[bl]=Kt[Al]=Kt[Cl]=Kt[Rl]=Kt[Il]=!0,Kt[Ct]=Kt[yt]=Kt[eo]=Kt[Bt]=Kt[qn]=Kt[Jt]=Kt[Yt]=Kt[Vt]=Kt[Dt]=Kt[Ot]=Kt[Ce]=Kt[rr]=Kt[Ye]=Kt[$r]=Kt[jr]=!1;var $t={};$t[Ct]=$t[yt]=$t[eo]=$t[qn]=$t[Bt]=$t[Jt]=$t[Tl]=$t[El]=$t[Sl]=$t[wl]=$t[bl]=$t[Dt]=$t[Ot]=$t[Ce]=$t[rr]=$t[Ye]=$t[$r]=$t[Kn]=$t[Al]=$t[Cl]=$t[Rl]=$t[Il]=!0,$t[Yt]=$t[Vt]=$t[jr]=!1;var L_={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},F_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},O_={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},N_={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},U_=parseFloat,G_=parseInt,$f=typeof global=="object"&&global&&global.Object===Object&&global,k_=typeof self=="object"&&self&&self.Object===Object&&self,_e=$f||k_||Function("return this")(),Nl=typeof to=="object"&&to&&!to.nodeType&&to,pn=Nl&&typeof ba=="object"&&ba&&!ba.nodeType&&ba,jf=pn&&pn.exports===Nl,Ul=jf&&$f.process,xr=function(){try{var U=pn&&pn.require&&pn.require("util").types;return U||Ul&&Ul.binding&&Ul.binding("util")}catch{}}(),Kf=xr&&xr.isArrayBuffer,Zf=xr&&xr.isDate,qf=xr&&xr.isMap,Jf=xr&&xr.isRegExp,Qf=xr&&xr.isSet,td=xr&&xr.isTypedArray;function ir(U,X,H){switch(H.length){case 0:return U.call(X);case 1:return U.call(X,H[0]);case 2:return U.call(X,H[0],H[1]);case 3:return U.call(X,H[0],H[1],H[2])}return U.apply(X,H)}function H_(U,X,H,ot){for(var Et=-1,Nt=U==null?0:U.length;++Et<Nt;){var ce=U[Et];X(ot,ce,H(ce),U)}return ot}function _r(U,X){for(var H=-1,ot=U==null?0:U.length;++H<ot&&X(U[H],H,U)!==!1;);return U}function V_(U,X){for(var H=U==null?0:U.length;H--&&X(U[H],H,U)!==!1;);return U}function ed(U,X){for(var H=-1,ot=U==null?0:U.length;++H<ot;)if(!X(U[H],H,U))return!1;return!0}function Di(U,X){for(var H=-1,ot=U==null?0:U.length,Et=0,Nt=[];++H<ot;){var ce=U[H];X(ce,H,U)&&(Nt[Et++]=ce)}return Nt}function Ia(U,X){var H=U==null?0:U.length;return!!H&&Qn(U,X,0)>-1}function Gl(U,X,H){for(var ot=-1,Et=U==null?0:U.length;++ot<Et;)if(H(X,U[ot]))return!0;return!1}function qt(U,X){for(var H=-1,ot=U==null?0:U.length,Et=Array(ot);++H<ot;)Et[H]=X(U[H],H,U);return Et}function Li(U,X){for(var H=-1,ot=X.length,Et=U.length;++H<ot;)U[Et+H]=X[H];return U}function kl(U,X,H,ot){var Et=-1,Nt=U==null?0:U.length;for(ot&&Nt&&(H=U[++Et]);++Et<Nt;)H=X(H,U[Et],Et,U);return H}function W_(U,X,H,ot){var Et=U==null?0:U.length;for(ot&&Et&&(H=U[--Et]);Et--;)H=X(H,U[Et],Et,U);return H}function Hl(U,X){for(var H=-1,ot=U==null?0:U.length;++H<ot;)if(X(U[H],H,U))return!0;return!1}var X_=Vl("length");function z_(U){return U.split("")}function Y_(U){return U.match(t_)||[]}function rd(U,X,H){var ot;return H(U,function(Et,Nt,ce){if(X(Et,Nt,ce))return ot=Nt,!1}),ot}function Pa(U,X,H,ot){for(var Et=U.length,Nt=H+(ot?1:-1);ot?Nt--:++Nt<Et;)if(X(U[Nt],Nt,U))return Nt;return-1}function Qn(U,X,H){return X===X?n0(U,X,H):Pa(U,id,H)}function $_(U,X,H,ot){for(var Et=H-1,Nt=U.length;++Et<Nt;)if(ot(U[Et],X))return Et;return-1}function id(U){return U!==U}function nd(U,X){var H=U==null?0:U.length;return H?Xl(U,X)/H:Y}function Vl(U){return function(X){return X==null?e:X[U]}}function Wl(U){return function(X){return U==null?e:U[X]}}function sd(U,X,H,ot,Et){return Et(U,function(Nt,ce,Xt){H=ot?(ot=!1,Nt):X(H,Nt,ce,Xt)}),H}function j_(U,X){var H=U.length;for(U.sort(X);H--;)U[H]=U[H].value;return U}function Xl(U,X){for(var H,ot=-1,Et=U.length;++ot<Et;){var Nt=X(U[ot]);Nt!==e&&(H=H===e?Nt:H+Nt)}return H}function zl(U,X){for(var H=-1,ot=Array(U);++H<U;)ot[H]=X(H);return ot}function K_(U,X){return qt(X,function(H){return[H,U[H]]})}function od(U){return U&&U.slice(0,ud(U)+1).replace(Ml,"")}function nr(U){return function(X){return U(X)}}function Yl(U,X){return qt(X,function(H){return U[H]})}function ro(U,X){return U.has(X)}function ad(U,X){for(var H=-1,ot=U.length;++H<ot&&Qn(X,U[H],0)>-1;);return H}function hd(U,X){for(var H=U.length;H--&&Qn(X,U[H],0)>-1;);return H}function Z_(U,X){for(var H=U.length,ot=0;H--;)U[H]===X&&++ot;return ot}var q_=Wl(L_),J_=Wl(F_);function Q_(U){return"\\"+N_[U]}function t0(U,X){return U==null?e:U[X]}function ts(U){return P_.test(U)}function e0(U){return M_.test(U)}function r0(U){for(var X,H=[];!(X=U.next()).done;)H.push(X.value);return H}function $l(U){var X=-1,H=Array(U.size);return U.forEach(function(ot,Et){H[++X]=[Et,ot]}),H}function ld(U,X){return function(H){return U(X(H))}}function Fi(U,X){for(var H=-1,ot=U.length,Et=0,Nt=[];++H<ot;){var ce=U[H];(ce===X||ce===c)&&(U[H]=c,Nt[Et++]=H)}return Nt}function Ma(U){var X=-1,H=Array(U.size);return U.forEach(function(ot){H[++X]=ot}),H}function i0(U){var X=-1,H=Array(U.size);return U.forEach(function(ot){H[++X]=[ot,ot]}),H}function n0(U,X,H){for(var ot=H-1,Et=U.length;++ot<Et;)if(U[ot]===X)return ot;return-1}function s0(U,X,H){for(var ot=H+1;ot--;)if(U[ot]===X)return ot;return ot}function es(U){return ts(U)?a0(U):X_(U)}function Mr(U){return ts(U)?h0(U):z_(U)}function ud(U){for(var X=U.length;X--&&Zx.test(U.charAt(X)););return X}var o0=Wl(O_);function a0(U){for(var X=Ol.lastIndex=0;Ol.test(U);)++X;return X}function h0(U){return U.match(Ol)||[]}function l0(U){return U.match(I_)||[]}var u0=function U(X){X=X==null?_e:Oi.defaults(_e.Object(),X,Oi.pick(_e,B_));var H=X.Array,ot=X.Date,Et=X.Error,Nt=X.Function,ce=X.Math,Xt=X.Object,jl=X.RegExp,c0=X.String,vr=X.TypeError,Ba=H.prototype,f0=Nt.prototype,rs=Xt.prototype,Da=X["__core-js_shared__"],La=f0.toString,kt=rs.hasOwnProperty,d0=0,cd=function(){var s=/[^.]+$/.exec(Da&&Da.keys&&Da.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}(),Fa=rs.toString,p0=La.call(Xt),m0=_e._,g0=jl("^"+La.call(kt).replace(Pl,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Oa=jf?X.Buffer:e,Ni=X.Symbol,Na=X.Uint8Array,fd=Oa?Oa.allocUnsafe:e,Ua=ld(Xt.getPrototypeOf,Xt),dd=Xt.create,pd=rs.propertyIsEnumerable,Ga=Ba.splice,md=Ni?Ni.isConcatSpreadable:e,io=Ni?Ni.iterator:e,mn=Ni?Ni.toStringTag:e,ka=function(){try{var s=yn(Xt,"defineProperty");return s({},"",{}),s}catch{}}(),x0=X.clearTimeout!==_e.clearTimeout&&X.clearTimeout,_0=ot&&ot.now!==_e.Date.now&&ot.now,v0=X.setTimeout!==_e.setTimeout&&X.setTimeout,Ha=ce.ceil,Va=ce.floor,Kl=Xt.getOwnPropertySymbols,y0=Oa?Oa.isBuffer:e,gd=X.isFinite,T0=Ba.join,E0=ld(Xt.keys,Xt),fe=ce.max,Re=ce.min,S0=ot.now,w0=X.parseInt,xd=ce.random,b0=Ba.reverse,Zl=yn(X,"DataView"),no=yn(X,"Map"),ql=yn(X,"Promise"),is=yn(X,"Set"),so=yn(X,"WeakMap"),oo=yn(Xt,"create"),Wa=so&&new so,ns={},A0=Tn(Zl),C0=Tn(no),R0=Tn(ql),I0=Tn(is),P0=Tn(so),Xa=Ni?Ni.prototype:e,ao=Xa?Xa.valueOf:e,_d=Xa?Xa.toString:e;function A(s){if(re(s)&&!wt(s)&&!(s instanceof Pt)){if(s instanceof yr)return s;if(kt.call(s,"__wrapped__"))return vp(s)}return new yr(s)}var ss=function(){function s(){}return function(h){if(!Qt(h))return{};if(dd)return dd(h);s.prototype=h;var p=new s;return s.prototype=e,p}}();function za(){}function yr(s,h){this.__wrapped__=s,this.__actions__=[],this.__chain__=!!h,this.__index__=0,this.__values__=e}A.templateSettings={escape:Xx,evaluate:zx,interpolate:Cf,variable:"",imports:{_:A}},A.prototype=za.prototype,A.prototype.constructor=A,yr.prototype=ss(za.prototype),yr.prototype.constructor=yr;function Pt(s){this.__wrapped__=s,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=J,this.__views__=[]}function M0(){var s=new Pt(this.__wrapped__);return s.__actions__=$e(this.__actions__),s.__dir__=this.__dir__,s.__filtered__=this.__filtered__,s.__iteratees__=$e(this.__iteratees__),s.__takeCount__=this.__takeCount__,s.__views__=$e(this.__views__),s}function B0(){if(this.__filtered__){var s=new Pt(this);s.__dir__=-1,s.__filtered__=!0}else s=this.clone(),s.__dir__*=-1;return s}function D0(){var s=this.__wrapped__.value(),h=this.__dir__,p=wt(s),_=h<0,E=p?s.length:0,R=zv(0,E,this.__views__),D=R.start,O=R.end,G=O-D,$=_?O:D-1,K=this.__iteratees__,Q=K.length,nt=0,lt=Re(G,this.__takeCount__);if(!p||!_&&E==G&&lt==G)return Vd(s,this.__actions__);var _t=[];t:for(;G--&&nt<lt;){$+=h;for(var At=-1,vt=s[$];++At<Q;){var It=K[At],Mt=It.iteratee,ar=It.type,Ne=Mt(vt);if(ar==N)vt=Ne;else if(!Ne){if(ar==V)continue t;break t}}_t[nt++]=vt}return _t}Pt.prototype=ss(za.prototype),Pt.prototype.constructor=Pt;function gn(s){var h=-1,p=s==null?0:s.length;for(this.clear();++h<p;){var _=s[h];this.set(_[0],_[1])}}function L0(){this.__data__=oo?oo(null):{},this.size=0}function F0(s){var h=this.has(s)&&delete this.__data__[s];return this.size-=h?1:0,h}function O0(s){var h=this.__data__;if(oo){var p=h[s];return p===a?e:p}return kt.call(h,s)?h[s]:e}function N0(s){var h=this.__data__;return oo?h[s]!==e:kt.call(h,s)}function U0(s,h){var p=this.__data__;return this.size+=this.has(s)?0:1,p[s]=oo&&h===e?a:h,this}gn.prototype.clear=L0,gn.prototype.delete=F0,gn.prototype.get=O0,gn.prototype.has=N0,gn.prototype.set=U0;function ai(s){var h=-1,p=s==null?0:s.length;for(this.clear();++h<p;){var _=s[h];this.set(_[0],_[1])}}function G0(){this.__data__=[],this.size=0}function k0(s){var h=this.__data__,p=Ya(h,s);if(p<0)return!1;var _=h.length-1;return p==_?h.pop():Ga.call(h,p,1),--this.size,!0}function H0(s){var h=this.__data__,p=Ya(h,s);return p<0?e:h[p][1]}function V0(s){return Ya(this.__data__,s)>-1}function W0(s,h){var p=this.__data__,_=Ya(p,s);return _<0?(++this.size,p.push([s,h])):p[_][1]=h,this}ai.prototype.clear=G0,ai.prototype.delete=k0,ai.prototype.get=H0,ai.prototype.has=V0,ai.prototype.set=W0;function hi(s){var h=-1,p=s==null?0:s.length;for(this.clear();++h<p;){var _=s[h];this.set(_[0],_[1])}}function X0(){this.size=0,this.__data__={hash:new gn,map:new(no||ai),string:new gn}}function z0(s){var h=nh(this,s).delete(s);return this.size-=h?1:0,h}function Y0(s){return nh(this,s).get(s)}function $0(s){return nh(this,s).has(s)}function j0(s,h){var p=nh(this,s),_=p.size;return p.set(s,h),this.size+=p.size==_?0:1,this}hi.prototype.clear=X0,hi.prototype.delete=z0,hi.prototype.get=Y0,hi.prototype.has=$0,hi.prototype.set=j0;function xn(s){var h=-1,p=s==null?0:s.length;for(this.__data__=new hi;++h<p;)this.add(s[h])}function K0(s){return this.__data__.set(s,a),this}function Z0(s){return this.__data__.has(s)}xn.prototype.add=xn.prototype.push=K0,xn.prototype.has=Z0;function Br(s){var h=this.__data__=new ai(s);this.size=h.size}function q0(){this.__data__=new ai,this.size=0}function J0(s){var h=this.__data__,p=h.delete(s);return this.size=h.size,p}function Q0(s){return this.__data__.get(s)}function tv(s){return this.__data__.has(s)}function ev(s,h){var p=this.__data__;if(p instanceof ai){var _=p.__data__;if(!no||_.length<r-1)return _.push([s,h]),this.size=++p.size,this;p=this.__data__=new hi(_)}return p.set(s,h),this.size=p.size,this}Br.prototype.clear=q0,Br.prototype.delete=J0,Br.prototype.get=Q0,Br.prototype.has=tv,Br.prototype.set=ev;function vd(s,h){var p=wt(s),_=!p&&En(s),E=!p&&!_&&Vi(s),R=!p&&!_&&!E&&ls(s),D=p||_||E||R,O=D?zl(s.length,c0):[],G=O.length;for(var $ in s)(h||kt.call(s,$))&&!(D&&($=="length"||E&&($=="offset"||$=="parent")||R&&($=="buffer"||$=="byteLength"||$=="byteOffset")||fi($,G)))&&O.push($);return O}function yd(s){var h=s.length;return h?s[hu(0,h-1)]:e}function rv(s,h){return sh($e(s),_n(h,0,s.length))}function iv(s){return sh($e(s))}function Jl(s,h,p){(p!==e&&!Dr(s[h],p)||p===e&&!(h in s))&&li(s,h,p)}function ho(s,h,p){var _=s[h];(!(kt.call(s,h)&&Dr(_,p))||p===e&&!(h in s))&&li(s,h,p)}function Ya(s,h){for(var p=s.length;p--;)if(Dr(s[p][0],h))return p;return-1}function nv(s,h,p,_){return Ui(s,function(E,R,D){h(_,E,p(E),D)}),_}function Td(s,h){return s&&Zr(h,ve(h),s)}function sv(s,h){return s&&Zr(h,Ke(h),s)}function li(s,h,p){h=="__proto__"&&ka?ka(s,h,{configurable:!0,enumerable:!0,value:p,writable:!0}):s[h]=p}function Ql(s,h){for(var p=-1,_=h.length,E=H(_),R=s==null;++p<_;)E[p]=R?e:Du(s,h[p]);return E}function _n(s,h,p){return s===s&&(p!==e&&(s=s<=p?s:p),h!==e&&(s=s>=h?s:h)),s}function Tr(s,h,p,_,E,R){var D,O=h&d,G=h&f,$=h&u;if(p&&(D=E?p(s,_,E,R):p(s)),D!==e)return D;if(!Qt(s))return s;var K=wt(s);if(K){if(D=$v(s),!O)return $e(s,D)}else{var Q=Ie(s),nt=Q==Vt||Q==jt;if(Vi(s))return zd(s,O);if(Q==Ce||Q==Ct||nt&&!E){if(D=G||nt?{}:up(s),!O)return G?Ov(s,sv(D,s)):Fv(s,Td(D,s))}else{if(!$t[Q])return E?s:{};D=jv(s,Q,O)}}R||(R=new Br);var lt=R.get(s);if(lt)return lt;R.set(s,D),Gp(s)?s.forEach(function(vt){D.add(Tr(vt,h,p,vt,s,R))}):Np(s)&&s.forEach(function(vt,It){D.set(It,Tr(vt,h,p,It,s,R))});var _t=$?G?vu:_u:G?Ke:ve,At=K?e:_t(s);return _r(At||s,function(vt,It){At&&(It=vt,vt=s[It]),ho(D,It,Tr(vt,h,p,It,s,R))}),D}function ov(s){var h=ve(s);return function(p){return Ed(p,s,h)}}function Ed(s,h,p){var _=p.length;if(s==null)return!_;for(s=Xt(s);_--;){var E=p[_],R=h[E],D=s[E];if(D===e&&!(E in s)||!R(D))return!1}return!0}function Sd(s,h,p){if(typeof s!="function")throw new vr(n);return go(function(){s.apply(e,p)},h)}function lo(s,h,p,_){var E=-1,R=Ia,D=!0,O=s.length,G=[],$=h.length;if(!O)return G;p&&(h=qt(h,nr(p))),_?(R=Gl,D=!1):h.length>=r&&(R=ro,D=!1,h=new xn(h));t:for(;++E<O;){var K=s[E],Q=p==null?K:p(K);if(K=_||K!==0?K:0,D&&Q===Q){for(var nt=$;nt--;)if(h[nt]===Q)continue t;G.push(K)}else R(h,Q,_)||G.push(K)}return G}var Ui=Zd(Kr),wd=Zd(eu,!0);function av(s,h){var p=!0;return Ui(s,function(_,E,R){return p=!!h(_,E,R),p}),p}function $a(s,h,p){for(var _=-1,E=s.length;++_<E;){var R=s[_],D=h(R);if(D!=null&&(O===e?D===D&&!or(D):p(D,O)))var O=D,G=R}return G}function hv(s,h,p,_){var E=s.length;for(p=bt(p),p<0&&(p=-p>E?0:E+p),_=_===e||_>E?E:bt(_),_<0&&(_+=E),_=p>_?0:Hp(_);p<_;)s[p++]=h;return s}function bd(s,h){var p=[];return Ui(s,function(_,E,R){h(_,E,R)&&p.push(_)}),p}function Se(s,h,p,_,E){var R=-1,D=s.length;for(p||(p=Zv),E||(E=[]);++R<D;){var O=s[R];h>0&&p(O)?h>1?Se(O,h-1,p,_,E):Li(E,O):_||(E[E.length]=O)}return E}var tu=qd(),Ad=qd(!0);function Kr(s,h){return s&&tu(s,h,ve)}function eu(s,h){return s&&Ad(s,h,ve)}function ja(s,h){return Di(h,function(p){return di(s[p])})}function vn(s,h){h=ki(h,s);for(var p=0,_=h.length;s!=null&&p<_;)s=s[qr(h[p++])];return p&&p==_?s:e}function Cd(s,h,p){var _=h(s);return wt(s)?_:Li(_,p(s))}function Fe(s){return s==null?s===e?yl:Yr:mn&&mn in Xt(s)?Xv(s):iy(s)}function ru(s,h){return s>h}function lv(s,h){return s!=null&&kt.call(s,h)}function uv(s,h){return s!=null&&h in Xt(s)}function cv(s,h,p){return s>=Re(h,p)&&s<fe(h,p)}function iu(s,h,p){for(var _=p?Gl:Ia,E=s[0].length,R=s.length,D=R,O=H(R),G=1/0,$=[];D--;){var K=s[D];D&&h&&(K=qt(K,nr(h))),G=Re(K.length,G),O[D]=!p&&(h||E>=120&&K.length>=120)?new xn(D&&K):e}K=s[0];var Q=-1,nt=O[0];t:for(;++Q<E&&$.length<G;){var lt=K[Q],_t=h?h(lt):lt;if(lt=p||lt!==0?lt:0,!(nt?ro(nt,_t):_($,_t,p))){for(D=R;--D;){var At=O[D];if(!(At?ro(At,_t):_(s[D],_t,p)))continue t}nt&&nt.push(_t),$.push(lt)}}return $}function fv(s,h,p,_){return Kr(s,function(E,R,D){h(_,p(E),R,D)}),_}function uo(s,h,p){h=ki(h,s),s=pp(s,h);var _=s==null?s:s[qr(Sr(h))];return _==null?e:ir(_,s,p)}function Rd(s){return re(s)&&Fe(s)==Ct}function dv(s){return re(s)&&Fe(s)==eo}function pv(s){return re(s)&&Fe(s)==Jt}function co(s,h,p,_,E){return s===h?!0:s==null||h==null||!re(s)&&!re(h)?s!==s&&h!==h:mv(s,h,p,_,co,E)}function mv(s,h,p,_,E,R){var D=wt(s),O=wt(h),G=D?yt:Ie(s),$=O?yt:Ie(h);G=G==Ct?Ce:G,$=$==Ct?Ce:$;var K=G==Ce,Q=$==Ce,nt=G==$;if(nt&&Vi(s)){if(!Vi(h))return!1;D=!0,K=!1}if(nt&&!K)return R||(R=new Br),D||ls(s)?ap(s,h,p,_,E,R):Vv(s,h,G,p,_,E,R);if(!(p&m)){var lt=K&&kt.call(s,"__wrapped__"),_t=Q&&kt.call(h,"__wrapped__");if(lt||_t){var At=lt?s.value():s,vt=_t?h.value():h;return R||(R=new Br),E(At,vt,p,_,R)}}return nt?(R||(R=new Br),Wv(s,h,p,_,E,R)):!1}function gv(s){return re(s)&&Ie(s)==Dt}function nu(s,h,p,_){var E=p.length,R=E,D=!_;if(s==null)return!R;for(s=Xt(s);E--;){var O=p[E];if(D&&O[2]?O[1]!==s[O[0]]:!(O[0]in s))return!1}for(;++E<R;){O=p[E];var G=O[0],$=s[G],K=O[1];if(D&&O[2]){if($===e&&!(G in s))return!1}else{var Q=new Br;if(_)var nt=_($,K,G,s,h,Q);if(!(nt===e?co(K,$,m|g,_,Q):nt))return!1}}return!0}function Id(s){if(!Qt(s)||Jv(s))return!1;var h=di(s)?g0:o_;return h.test(Tn(s))}function xv(s){return re(s)&&Fe(s)==rr}function _v(s){return re(s)&&Ie(s)==Ye}function vv(s){return re(s)&&ch(s.length)&&!!Kt[Fe(s)]}function Pd(s){return typeof s=="function"?s:s==null?Ze:typeof s=="object"?wt(s)?Dd(s[0],s[1]):Bd(s):Jp(s)}function su(s){if(!mo(s))return E0(s);var h=[];for(var p in Xt(s))kt.call(s,p)&&p!="constructor"&&h.push(p);return h}function yv(s){if(!Qt(s))return ry(s);var h=mo(s),p=[];for(var _ in s)_=="constructor"&&(h||!kt.call(s,_))||p.push(_);return p}function ou(s,h){return s<h}function Md(s,h){var p=-1,_=je(s)?H(s.length):[];return Ui(s,function(E,R,D){_[++p]=h(E,R,D)}),_}function Bd(s){var h=Tu(s);return h.length==1&&h[0][2]?fp(h[0][0],h[0][1]):function(p){return p===s||nu(p,s,h)}}function Dd(s,h){return Su(s)&&cp(h)?fp(qr(s),h):function(p){var _=Du(p,s);return _===e&&_===h?Lu(p,s):co(h,_,m|g)}}function Ka(s,h,p,_,E){s!==h&&tu(h,function(R,D){if(E||(E=new Br),Qt(R))Tv(s,h,D,p,Ka,_,E);else{var O=_?_(bu(s,D),R,D+"",s,h,E):e;O===e&&(O=R),Jl(s,D,O)}},Ke)}function Tv(s,h,p,_,E,R,D){var O=bu(s,p),G=bu(h,p),$=D.get(G);if($){Jl(s,p,$);return}var K=R?R(O,G,p+"",s,h,D):e,Q=K===e;if(Q){var nt=wt(G),lt=!nt&&Vi(G),_t=!nt&&!lt&&ls(G);K=G,nt||lt||_t?wt(O)?K=O:se(O)?K=$e(O):lt?(Q=!1,K=zd(G,!0)):_t?(Q=!1,K=Yd(G,!0)):K=[]:xo(G)||En(G)?(K=O,En(O)?K=Vp(O):(!Qt(O)||di(O))&&(K=up(G))):Q=!1}Q&&(D.set(G,K),E(K,G,_,R,D),D.delete(G)),Jl(s,p,K)}function Ld(s,h){var p=s.length;if(p)return h+=h<0?p:0,fi(h,p)?s[h]:e}function Fd(s,h,p){h.length?h=qt(h,function(R){return wt(R)?function(D){return vn(D,R.length===1?R[0]:R)}:R}):h=[Ze];var _=-1;h=qt(h,nr(mt()));var E=Md(s,function(R,D,O){var G=qt(h,function($){return $(R)});return{criteria:G,index:++_,value:R}});return j_(E,function(R,D){return Lv(R,D,p)})}function Ev(s,h){return Od(s,h,function(p,_){return Lu(s,_)})}function Od(s,h,p){for(var _=-1,E=h.length,R={};++_<E;){var D=h[_],O=vn(s,D);p(O,D)&&fo(R,ki(D,s),O)}return R}function Sv(s){return function(h){return vn(h,s)}}function au(s,h,p,_){var E=_?$_:Qn,R=-1,D=h.length,O=s;for(s===h&&(h=$e(h)),p&&(O=qt(s,nr(p)));++R<D;)for(var G=0,$=h[R],K=p?p($):$;(G=E(O,K,G,_))>-1;)O!==s&&Ga.call(O,G,1),Ga.call(s,G,1);return s}function Nd(s,h){for(var p=s?h.length:0,_=p-1;p--;){var E=h[p];if(p==_||E!==R){var R=E;fi(E)?Ga.call(s,E,1):cu(s,E)}}return s}function hu(s,h){return s+Va(xd()*(h-s+1))}function wv(s,h,p,_){for(var E=-1,R=fe(Ha((h-s)/(p||1)),0),D=H(R);R--;)D[_?R:++E]=s,s+=p;return D}function lu(s,h){var p="";if(!s||h<1||h>j)return p;do h%2&&(p+=s),h=Va(h/2),h&&(s+=s);while(h);return p}function Rt(s,h){return Au(dp(s,h,Ze),s+"")}function bv(s){return yd(us(s))}function Av(s,h){var p=us(s);return sh(p,_n(h,0,p.length))}function fo(s,h,p,_){if(!Qt(s))return s;h=ki(h,s);for(var E=-1,R=h.length,D=R-1,O=s;O!=null&&++E<R;){var G=qr(h[E]),$=p;if(G==="__proto__"||G==="constructor"||G==="prototype")return s;if(E!=D){var K=O[G];$=_?_(K,G,O):e,$===e&&($=Qt(K)?K:fi(h[E+1])?[]:{})}ho(O,G,$),O=O[G]}return s}var Ud=Wa?function(s,h){return Wa.set(s,h),s}:Ze,Cv=ka?function(s,h){return ka(s,"toString",{configurable:!0,enumerable:!1,value:Ou(h),writable:!0})}:Ze;function Rv(s){return sh(us(s))}function Er(s,h,p){var _=-1,E=s.length;h<0&&(h=-h>E?0:E+h),p=p>E?E:p,p<0&&(p+=E),E=h>p?0:p-h>>>0,h>>>=0;for(var R=H(E);++_<E;)R[_]=s[_+h];return R}function Iv(s,h){var p;return Ui(s,function(_,E,R){return p=h(_,E,R),!p}),!!p}function Za(s,h,p){var _=0,E=s==null?_:s.length;if(typeof h=="number"&&h===h&&E<=xt){for(;_<E;){var R=_+E>>>1,D=s[R];D!==null&&!or(D)&&(p?D<=h:D<h)?_=R+1:E=R}return E}return uu(s,h,Ze,p)}function uu(s,h,p,_){var E=0,R=s==null?0:s.length;if(R===0)return 0;h=p(h);for(var D=h!==h,O=h===null,G=or(h),$=h===e;E<R;){var K=Va((E+R)/2),Q=p(s[K]),nt=Q!==e,lt=Q===null,_t=Q===Q,At=or(Q);if(D)var vt=_||_t;else $?vt=_t&&(_||nt):O?vt=_t&&nt&&(_||!lt):G?vt=_t&&nt&&!lt&&(_||!At):lt||At?vt=!1:vt=_?Q<=h:Q<h;vt?E=K+1:R=K}return Re(R,st)}function Gd(s,h){for(var p=-1,_=s.length,E=0,R=[];++p<_;){var D=s[p],O=h?h(D):D;if(!p||!Dr(O,G)){var G=O;R[E++]=D===0?0:D}}return R}function kd(s){return typeof s=="number"?s:or(s)?Y:+s}function sr(s){if(typeof s=="string")return s;if(wt(s))return qt(s,sr)+"";if(or(s))return _d?_d.call(s):"";var h=s+"";return h=="0"&&1/s==-Z?"-0":h}function Gi(s,h,p){var _=-1,E=Ia,R=s.length,D=!0,O=[],G=O;if(p)D=!1,E=Gl;else if(R>=r){var $=h?null:kv(s);if($)return Ma($);D=!1,E=ro,G=new xn}else G=h?[]:O;t:for(;++_<R;){var K=s[_],Q=h?h(K):K;if(K=p||K!==0?K:0,D&&Q===Q){for(var nt=G.length;nt--;)if(G[nt]===Q)continue t;h&&G.push(Q),O.push(K)}else E(G,Q,p)||(G!==O&&G.push(Q),O.push(K))}return O}function cu(s,h){return h=ki(h,s),s=pp(s,h),s==null||delete s[qr(Sr(h))]}function Hd(s,h,p,_){return fo(s,h,p(vn(s,h)),_)}function qa(s,h,p,_){for(var E=s.length,R=_?E:-1;(_?R--:++R<E)&&h(s[R],R,s););return p?Er(s,_?0:R,_?R+1:E):Er(s,_?R+1:0,_?E:R)}function Vd(s,h){var p=s;return p instanceof Pt&&(p=p.value()),kl(h,function(_,E){return E.func.apply(E.thisArg,Li([_],E.args))},p)}function fu(s,h,p){var _=s.length;if(_<2)return _?Gi(s[0]):[];for(var E=-1,R=H(_);++E<_;)for(var D=s[E],O=-1;++O<_;)O!=E&&(R[E]=lo(R[E]||D,s[O],h,p));return Gi(Se(R,1),h,p)}function Wd(s,h,p){for(var _=-1,E=s.length,R=h.length,D={};++_<E;){var O=_<R?h[_]:e;p(D,s[_],O)}return D}function du(s){return se(s)?s:[]}function pu(s){return typeof s=="function"?s:Ze}function ki(s,h){return wt(s)?s:Su(s,h)?[s]:_p(Ut(s))}var Pv=Rt;function Hi(s,h,p){var _=s.length;return p=p===e?_:p,!h&&p>=_?s:Er(s,h,p)}var Xd=x0||function(s){return _e.clearTimeout(s)};function zd(s,h){if(h)return s.slice();var p=s.length,_=fd?fd(p):new s.constructor(p);return s.copy(_),_}function mu(s){var h=new s.constructor(s.byteLength);return new Na(h).set(new Na(s)),h}function Mv(s,h){var p=h?mu(s.buffer):s.buffer;return new s.constructor(p,s.byteOffset,s.byteLength)}function Bv(s){var h=new s.constructor(s.source,Rf.exec(s));return h.lastIndex=s.lastIndex,h}function Dv(s){return ao?Xt(ao.call(s)):{}}function Yd(s,h){var p=h?mu(s.buffer):s.buffer;return new s.constructor(p,s.byteOffset,s.length)}function $d(s,h){if(s!==h){var p=s!==e,_=s===null,E=s===s,R=or(s),D=h!==e,O=h===null,G=h===h,$=or(h);if(!O&&!$&&!R&&s>h||R&&D&&G&&!O&&!$||_&&D&&G||!p&&G||!E)return 1;if(!_&&!R&&!$&&s<h||$&&p&&E&&!_&&!R||O&&p&&E||!D&&E||!G)return-1}return 0}function Lv(s,h,p){for(var _=-1,E=s.criteria,R=h.criteria,D=E.length,O=p.length;++_<D;){var G=$d(E[_],R[_]);if(G){if(_>=O)return G;var $=p[_];return G*($=="desc"?-1:1)}}return s.index-h.index}function jd(s,h,p,_){for(var E=-1,R=s.length,D=p.length,O=-1,G=h.length,$=fe(R-D,0),K=H(G+$),Q=!_;++O<G;)K[O]=h[O];for(;++E<D;)(Q||E<R)&&(K[p[E]]=s[E]);for(;$--;)K[O++]=s[E++];return K}function Kd(s,h,p,_){for(var E=-1,R=s.length,D=-1,O=p.length,G=-1,$=h.length,K=fe(R-O,0),Q=H(K+$),nt=!_;++E<K;)Q[E]=s[E];for(var lt=E;++G<$;)Q[lt+G]=h[G];for(;++D<O;)(nt||E<R)&&(Q[lt+p[D]]=s[E++]);return Q}function $e(s,h){var p=-1,_=s.length;for(h||(h=H(_));++p<_;)h[p]=s[p];return h}function Zr(s,h,p,_){var E=!p;p||(p={});for(var R=-1,D=h.length;++R<D;){var O=h[R],G=_?_(p[O],s[O],O,p,s):e;G===e&&(G=s[O]),E?li(p,O,G):ho(p,O,G)}return p}function Fv(s,h){return Zr(s,Eu(s),h)}function Ov(s,h){return Zr(s,hp(s),h)}function Ja(s,h){return function(p,_){var E=wt(p)?H_:nv,R=h?h():{};return E(p,s,mt(_,2),R)}}function os(s){return Rt(function(h,p){var _=-1,E=p.length,R=E>1?p[E-1]:e,D=E>2?p[2]:e;for(R=s.length>3&&typeof R=="function"?(E--,R):e,D&&Oe(p[0],p[1],D)&&(R=E<3?e:R,E=1),h=Xt(h);++_<E;){var O=p[_];O&&s(h,O,_,R)}return h})}function Zd(s,h){return function(p,_){if(p==null)return p;if(!je(p))return s(p,_);for(var E=p.length,R=h?E:-1,D=Xt(p);(h?R--:++R<E)&&_(D[R],R,D)!==!1;);return p}}function qd(s){return function(h,p,_){for(var E=-1,R=Xt(h),D=_(h),O=D.length;O--;){var G=D[s?O:++E];if(p(R[G],G,R)===!1)break}return h}}function Nv(s,h,p){var _=h&x,E=po(s);function R(){var D=this&&this!==_e&&this instanceof R?E:s;return D.apply(_?p:this,arguments)}return R}function Jd(s){return function(h){h=Ut(h);var p=ts(h)?Mr(h):e,_=p?p[0]:h.charAt(0),E=p?Hi(p,1).join(""):h.slice(1);return _[s]()+E}}function as(s){return function(h){return kl(Zp(Kp(h).replace(C_,"")),s,"")}}function po(s){return function(){var h=arguments;switch(h.length){case 0:return new s;case 1:return new s(h[0]);case 2:return new s(h[0],h[1]);case 3:return new s(h[0],h[1],h[2]);case 4:return new s(h[0],h[1],h[2],h[3]);case 5:return new s(h[0],h[1],h[2],h[3],h[4]);case 6:return new s(h[0],h[1],h[2],h[3],h[4],h[5]);case 7:return new s(h[0],h[1],h[2],h[3],h[4],h[5],h[6])}var p=ss(s.prototype),_=s.apply(p,h);return Qt(_)?_:p}}function Uv(s,h,p){var _=po(s);function E(){for(var R=arguments.length,D=H(R),O=R,G=hs(E);O--;)D[O]=arguments[O];var $=R<3&&D[0]!==G&&D[R-1]!==G?[]:Fi(D,G);if(R-=$.length,R<p)return ip(s,h,Qa,E.placeholder,e,D,$,e,e,p-R);var K=this&&this!==_e&&this instanceof E?_:s;return ir(K,this,D)}return E}function Qd(s){return function(h,p,_){var E=Xt(h);if(!je(h)){var R=mt(p,3);h=ve(h),p=function(O){return R(E[O],O,E)}}var D=s(h,p,_);return D>-1?E[R?h[D]:D]:e}}function tp(s){return ci(function(h){var p=h.length,_=p,E=yr.prototype.thru;for(s&&h.reverse();_--;){var R=h[_];if(typeof R!="function")throw new vr(n);if(E&&!D&&ih(R)=="wrapper")var D=new yr([],!0)}for(_=D?_:p;++_<p;){R=h[_];var O=ih(R),G=O=="wrapper"?yu(R):e;G&&wu(G[0])&&G[1]==(I|b|v|C)&&!G[4].length&&G[9]==1?D=D[ih(G[0])].apply(D,G[3]):D=R.length==1&&wu(R)?D[O]():D.thru(R)}return function(){var $=arguments,K=$[0];if(D&&$.length==1&&wt(K))return D.plant(K).value();for(var Q=0,nt=p?h[Q].apply(this,$):K;++Q<p;)nt=h[Q].call(this,nt);return nt}})}function Qa(s,h,p,_,E,R,D,O,G,$){var K=h&I,Q=h&x,nt=h&y,lt=h&(b|w),_t=h&P,At=nt?e:po(s);function vt(){for(var It=arguments.length,Mt=H(It),ar=It;ar--;)Mt[ar]=arguments[ar];if(lt)var Ne=hs(vt),hr=Z_(Mt,Ne);if(_&&(Mt=jd(Mt,_,E,lt)),R&&(Mt=Kd(Mt,R,D,lt)),It-=hr,lt&&It<$){var oe=Fi(Mt,Ne);return ip(s,h,Qa,vt.placeholder,p,Mt,oe,O,G,$-It)}var Lr=Q?p:this,mi=nt?Lr[s]:s;return It=Mt.length,O?Mt=ny(Mt,O):_t&&It>1&&Mt.reverse(),K&&G<It&&(Mt.length=G),this&&this!==_e&&this instanceof vt&&(mi=At||po(mi)),mi.apply(Lr,Mt)}return vt}function ep(s,h){return function(p,_){return fv(p,s,h(_),{})}}function th(s,h){return function(p,_){var E;if(p===e&&_===e)return h;if(p!==e&&(E=p),_!==e){if(E===e)return _;typeof p=="string"||typeof _=="string"?(p=sr(p),_=sr(_)):(p=kd(p),_=kd(_)),E=s(p,_)}return E}}function gu(s){return ci(function(h){return h=qt(h,nr(mt())),Rt(function(p){var _=this;return s(h,function(E){return ir(E,_,p)})})})}function eh(s,h){h=h===e?" ":sr(h);var p=h.length;if(p<2)return p?lu(h,s):h;var _=lu(h,Ha(s/es(h)));return ts(h)?Hi(Mr(_),0,s).join(""):_.slice(0,s)}function Gv(s,h,p,_){var E=h&x,R=po(s);function D(){for(var O=-1,G=arguments.length,$=-1,K=_.length,Q=H(K+G),nt=this&&this!==_e&&this instanceof D?R:s;++$<K;)Q[$]=_[$];for(;G--;)Q[$++]=arguments[++O];return ir(nt,E?p:this,Q)}return D}function rp(s){return function(h,p,_){return _&&typeof _!="number"&&Oe(h,p,_)&&(p=_=e),h=pi(h),p===e?(p=h,h=0):p=pi(p),_=_===e?h<p?1:-1:pi(_),wv(h,p,_,s)}}function rh(s){return function(h,p){return typeof h=="string"&&typeof p=="string"||(h=wr(h),p=wr(p)),s(h,p)}}function ip(s,h,p,_,E,R,D,O,G,$){var K=h&b,Q=K?D:e,nt=K?e:D,lt=K?R:e,_t=K?e:R;h|=K?v:T,h&=~(K?T:v),h&S||(h&=~(x|y));var At=[s,h,E,lt,Q,_t,nt,O,G,$],vt=p.apply(e,At);return wu(s)&&mp(vt,At),vt.placeholder=_,gp(vt,s,h)}function xu(s){var h=ce[s];return function(p,_){if(p=wr(p),_=_==null?0:Re(bt(_),292),_&&gd(p)){var E=(Ut(p)+"e").split("e"),R=h(E[0]+"e"+(+E[1]+_));return E=(Ut(R)+"e").split("e"),+(E[0]+"e"+(+E[1]-_))}return h(p)}}var kv=is&&1/Ma(new is([,-0]))[1]==Z?function(s){return new is(s)}:Gu;function np(s){return function(h){var p=Ie(h);return p==Dt?$l(h):p==Ye?i0(h):K_(h,s(h))}}function ui(s,h,p,_,E,R,D,O){var G=h&y;if(!G&&typeof s!="function")throw new vr(n);var $=_?_.length:0;if($||(h&=~(v|T),_=E=e),D=D===e?D:fe(bt(D),0),O=O===e?O:bt(O),$-=E?E.length:0,h&T){var K=_,Q=E;_=E=e}var nt=G?e:yu(s),lt=[s,h,p,_,E,K,Q,R,D,O];if(nt&&ey(lt,nt),s=lt[0],h=lt[1],p=lt[2],_=lt[3],E=lt[4],O=lt[9]=lt[9]===e?G?0:s.length:fe(lt[9]-$,0),!O&&h&(b|w)&&(h&=~(b|w)),!h||h==x)var _t=Nv(s,h,p);else h==b||h==w?_t=Uv(s,h,O):(h==v||h==(x|v))&&!E.length?_t=Gv(s,h,p,_):_t=Qa.apply(e,lt);var At=nt?Ud:mp;return gp(At(_t,lt),s,h)}function sp(s,h,p,_){return s===e||Dr(s,rs[p])&&!kt.call(_,p)?h:s}function op(s,h,p,_,E,R){return Qt(s)&&Qt(h)&&(R.set(h,s),Ka(s,h,e,op,R),R.delete(h)),s}function Hv(s){return xo(s)?e:s}function ap(s,h,p,_,E,R){var D=p&m,O=s.length,G=h.length;if(O!=G&&!(D&&G>O))return!1;var $=R.get(s),K=R.get(h);if($&&K)return $==h&&K==s;var Q=-1,nt=!0,lt=p&g?new xn:e;for(R.set(s,h),R.set(h,s);++Q<O;){var _t=s[Q],At=h[Q];if(_)var vt=D?_(At,_t,Q,h,s,R):_(_t,At,Q,s,h,R);if(vt!==e){if(vt)continue;nt=!1;break}if(lt){if(!Hl(h,function(It,Mt){if(!ro(lt,Mt)&&(_t===It||E(_t,It,p,_,R)))return lt.push(Mt)})){nt=!1;break}}else if(!(_t===At||E(_t,At,p,_,R))){nt=!1;break}}return R.delete(s),R.delete(h),nt}function Vv(s,h,p,_,E,R,D){switch(p){case qn:if(s.byteLength!=h.byteLength||s.byteOffset!=h.byteOffset)return!1;s=s.buffer,h=h.buffer;case eo:return!(s.byteLength!=h.byteLength||!R(new Na(s),new Na(h)));case Bt:case Jt:case Ot:return Dr(+s,+h);case Yt:return s.name==h.name&&s.message==h.message;case rr:case $r:return s==h+"";case Dt:var O=$l;case Ye:var G=_&m;if(O||(O=Ma),s.size!=h.size&&!G)return!1;var $=D.get(s);if($)return $==h;_|=g,D.set(s,h);var K=ap(O(s),O(h),_,E,R,D);return D.delete(s),K;case Kn:if(ao)return ao.call(s)==ao.call(h)}return!1}function Wv(s,h,p,_,E,R){var D=p&m,O=_u(s),G=O.length,$=_u(h),K=$.length;if(G!=K&&!D)return!1;for(var Q=G;Q--;){var nt=O[Q];if(!(D?nt in h:kt.call(h,nt)))return!1}var lt=R.get(s),_t=R.get(h);if(lt&&_t)return lt==h&&_t==s;var At=!0;R.set(s,h),R.set(h,s);for(var vt=D;++Q<G;){nt=O[Q];var It=s[nt],Mt=h[nt];if(_)var ar=D?_(Mt,It,nt,h,s,R):_(It,Mt,nt,s,h,R);if(!(ar===e?It===Mt||E(It,Mt,p,_,R):ar)){At=!1;break}vt||(vt=nt=="constructor")}if(At&&!vt){var Ne=s.constructor,hr=h.constructor;Ne!=hr&&"constructor"in s&&"constructor"in h&&!(typeof Ne=="function"&&Ne instanceof Ne&&typeof hr=="function"&&hr instanceof hr)&&(At=!1)}return R.delete(s),R.delete(h),At}function ci(s){return Au(dp(s,e,Ep),s+"")}function _u(s){return Cd(s,ve,Eu)}function vu(s){return Cd(s,Ke,hp)}var yu=Wa?function(s){return Wa.get(s)}:Gu;function ih(s){for(var h=s.name+"",p=ns[h],_=kt.call(ns,h)?p.length:0;_--;){var E=p[_],R=E.func;if(R==null||R==s)return E.name}return h}function hs(s){var h=kt.call(A,"placeholder")?A:s;return h.placeholder}function mt(){var s=A.iteratee||Nu;return s=s===Nu?Pd:s,arguments.length?s(arguments[0],arguments[1]):s}function nh(s,h){var p=s.__data__;return qv(h)?p[typeof h=="string"?"string":"hash"]:p.map}function Tu(s){for(var h=ve(s),p=h.length;p--;){var _=h[p],E=s[_];h[p]=[_,E,cp(E)]}return h}function yn(s,h){var p=t0(s,h);return Id(p)?p:e}function Xv(s){var h=kt.call(s,mn),p=s[mn];try{s[mn]=e;var _=!0}catch{}var E=Fa.call(s);return _&&(h?s[mn]=p:delete s[mn]),E}var Eu=Kl?function(s){return s==null?[]:(s=Xt(s),Di(Kl(s),function(h){return pd.call(s,h)}))}:ku,hp=Kl?function(s){for(var h=[];s;)Li(h,Eu(s)),s=Ua(s);return h}:ku,Ie=Fe;(Zl&&Ie(new Zl(new ArrayBuffer(1)))!=qn||no&&Ie(new no)!=Dt||ql&&Ie(ql.resolve())!=dn||is&&Ie(new is)!=Ye||so&&Ie(new so)!=jr)&&(Ie=function(s){var h=Fe(s),p=h==Ce?s.constructor:e,_=p?Tn(p):"";if(_)switch(_){case A0:return qn;case C0:return Dt;case R0:return dn;case I0:return Ye;case P0:return jr}return h});function zv(s,h,p){for(var _=-1,E=p.length;++_<E;){var R=p[_],D=R.size;switch(R.type){case"drop":s+=D;break;case"dropRight":h-=D;break;case"take":h=Re(h,s+D);break;case"takeRight":s=fe(s,h-D);break}}return{start:s,end:h}}function Yv(s){var h=s.match(Jx);return h?h[1].split(Qx):[]}function lp(s,h,p){h=ki(h,s);for(var _=-1,E=h.length,R=!1;++_<E;){var D=qr(h[_]);if(!(R=s!=null&&p(s,D)))break;s=s[D]}return R||++_!=E?R:(E=s==null?0:s.length,!!E&&ch(E)&&fi(D,E)&&(wt(s)||En(s)))}function $v(s){var h=s.length,p=new s.constructor(h);return h&&typeof s[0]=="string"&&kt.call(s,"index")&&(p.index=s.index,p.input=s.input),p}function up(s){return typeof s.constructor=="function"&&!mo(s)?ss(Ua(s)):{}}function jv(s,h,p){var _=s.constructor;switch(h){case eo:return mu(s);case Bt:case Jt:return new _(+s);case qn:return Mv(s,p);case Tl:case El:case Sl:case wl:case bl:case Al:case Cl:case Rl:case Il:return Yd(s,p);case Dt:return new _;case Ot:case $r:return new _(s);case rr:return Bv(s);case Ye:return new _;case Kn:return Dv(s)}}function Kv(s,h){var p=h.length;if(!p)return s;var _=p-1;return h[_]=(p>1?"& ":"")+h[_],h=h.join(p>2?", ":" "),s.replace(qx,`{
/* [wrapped with `+h+`] */
`)}function Zv(s){return wt(s)||En(s)||!!(md&&s&&s[md])}function fi(s,h){var p=typeof s;return h=h??j,!!h&&(p=="number"||p!="symbol"&&h_.test(s))&&s>-1&&s%1==0&&s<h}function Oe(s,h,p){if(!Qt(p))return!1;var _=typeof h;return(_=="number"?je(p)&&fi(h,p.length):_=="string"&&h in p)?Dr(p[h],s):!1}function Su(s,h){if(wt(s))return!1;var p=typeof s;return p=="number"||p=="symbol"||p=="boolean"||s==null||or(s)?!0:$x.test(s)||!Yx.test(s)||h!=null&&s in Xt(h)}function qv(s){var h=typeof s;return h=="string"||h=="number"||h=="symbol"||h=="boolean"?s!=="__proto__":s===null}function wu(s){var h=ih(s),p=A[h];if(typeof p!="function"||!(h in Pt.prototype))return!1;if(s===p)return!0;var _=yu(p);return!!_&&s===_[0]}function Jv(s){return!!cd&&cd in s}var Qv=Da?di:Hu;function mo(s){var h=s&&s.constructor,p=typeof h=="function"&&h.prototype||rs;return s===p}function cp(s){return s===s&&!Qt(s)}function fp(s,h){return function(p){return p==null?!1:p[s]===h&&(h!==e||s in Xt(p))}}function ty(s){var h=lh(s,function(_){return p.size===l&&p.clear(),_}),p=h.cache;return h}function ey(s,h){var p=s[1],_=h[1],E=p|_,R=E<(x|y|I),D=_==I&&p==b||_==I&&p==C&&s[7].length<=h[8]||_==(I|C)&&h[7].length<=h[8]&&p==b;if(!(R||D))return s;_&x&&(s[2]=h[2],E|=p&x?0:S);var O=h[3];if(O){var G=s[3];s[3]=G?jd(G,O,h[4]):O,s[4]=G?Fi(s[3],c):h[4]}return O=h[5],O&&(G=s[5],s[5]=G?Kd(G,O,h[6]):O,s[6]=G?Fi(s[5],c):h[6]),O=h[7],O&&(s[7]=O),_&I&&(s[8]=s[8]==null?h[8]:Re(s[8],h[8])),s[9]==null&&(s[9]=h[9]),s[0]=h[0],s[1]=E,s}function ry(s){var h=[];if(s!=null)for(var p in Xt(s))h.push(p);return h}function iy(s){return Fa.call(s)}function dp(s,h,p){return h=fe(h===e?s.length-1:h,0),function(){for(var _=arguments,E=-1,R=fe(_.length-h,0),D=H(R);++E<R;)D[E]=_[h+E];E=-1;for(var O=H(h+1);++E<h;)O[E]=_[E];return O[h]=p(D),ir(s,this,O)}}function pp(s,h){return h.length<2?s:vn(s,Er(h,0,-1))}function ny(s,h){for(var p=s.length,_=Re(h.length,p),E=$e(s);_--;){var R=h[_];s[_]=fi(R,p)?E[R]:e}return s}function bu(s,h){if(!(h==="constructor"&&typeof s[h]=="function")&&h!="__proto__")return s[h]}var mp=xp(Ud),go=v0||function(s,h){return _e.setTimeout(s,h)},Au=xp(Cv);function gp(s,h,p){var _=h+"";return Au(s,Kv(_,sy(Yv(_),p)))}function xp(s){var h=0,p=0;return function(){var _=S0(),E=L-(_-p);if(p=_,E>0){if(++h>=F)return arguments[0]}else h=0;return s.apply(e,arguments)}}function sh(s,h){var p=-1,_=s.length,E=_-1;for(h=h===e?_:h;++p<h;){var R=hu(p,E),D=s[R];s[R]=s[p],s[p]=D}return s.length=h,s}var _p=ty(function(s){var h=[];return s.charCodeAt(0)===46&&h.push(""),s.replace(jx,function(p,_,E,R){h.push(E?R.replace(r_,"$1"):_||p)}),h});function qr(s){if(typeof s=="string"||or(s))return s;var h=s+"";return h=="0"&&1/s==-Z?"-0":h}function Tn(s){if(s!=null){try{return La.call(s)}catch{}try{return s+""}catch{}}return""}function sy(s,h){return _r(Tt,function(p){var _="_."+p[0];h&p[1]&&!Ia(s,_)&&s.push(_)}),s.sort()}function vp(s){if(s instanceof Pt)return s.clone();var h=new yr(s.__wrapped__,s.__chain__);return h.__actions__=$e(s.__actions__),h.__index__=s.__index__,h.__values__=s.__values__,h}function oy(s,h,p){(p?Oe(s,h,p):h===e)?h=1:h=fe(bt(h),0);var _=s==null?0:s.length;if(!_||h<1)return[];for(var E=0,R=0,D=H(Ha(_/h));E<_;)D[R++]=Er(s,E,E+=h);return D}function ay(s){for(var h=-1,p=s==null?0:s.length,_=0,E=[];++h<p;){var R=s[h];R&&(E[_++]=R)}return E}function hy(){var s=arguments.length;if(!s)return[];for(var h=H(s-1),p=arguments[0],_=s;_--;)h[_-1]=arguments[_];return Li(wt(p)?$e(p):[p],Se(h,1))}var ly=Rt(function(s,h){return se(s)?lo(s,Se(h,1,se,!0)):[]}),uy=Rt(function(s,h){var p=Sr(h);return se(p)&&(p=e),se(s)?lo(s,Se(h,1,se,!0),mt(p,2)):[]}),cy=Rt(function(s,h){var p=Sr(h);return se(p)&&(p=e),se(s)?lo(s,Se(h,1,se,!0),e,p):[]});function fy(s,h,p){var _=s==null?0:s.length;return _?(h=p||h===e?1:bt(h),Er(s,h<0?0:h,_)):[]}function dy(s,h,p){var _=s==null?0:s.length;return _?(h=p||h===e?1:bt(h),h=_-h,Er(s,0,h<0?0:h)):[]}function py(s,h){return s&&s.length?qa(s,mt(h,3),!0,!0):[]}function my(s,h){return s&&s.length?qa(s,mt(h,3),!0):[]}function gy(s,h,p,_){var E=s==null?0:s.length;return E?(p&&typeof p!="number"&&Oe(s,h,p)&&(p=0,_=E),hv(s,h,p,_)):[]}function yp(s,h,p){var _=s==null?0:s.length;if(!_)return-1;var E=p==null?0:bt(p);return E<0&&(E=fe(_+E,0)),Pa(s,mt(h,3),E)}function Tp(s,h,p){var _=s==null?0:s.length;if(!_)return-1;var E=_-1;return p!==e&&(E=bt(p),E=p<0?fe(_+E,0):Re(E,_-1)),Pa(s,mt(h,3),E,!0)}function Ep(s){var h=s==null?0:s.length;return h?Se(s,1):[]}function xy(s){var h=s==null?0:s.length;return h?Se(s,Z):[]}function _y(s,h){var p=s==null?0:s.length;return p?(h=h===e?1:bt(h),Se(s,h)):[]}function vy(s){for(var h=-1,p=s==null?0:s.length,_={};++h<p;){var E=s[h];_[E[0]]=E[1]}return _}function Sp(s){return s&&s.length?s[0]:e}function yy(s,h,p){var _=s==null?0:s.length;if(!_)return-1;var E=p==null?0:bt(p);return E<0&&(E=fe(_+E,0)),Qn(s,h,E)}function Ty(s){var h=s==null?0:s.length;return h?Er(s,0,-1):[]}var Ey=Rt(function(s){var h=qt(s,du);return h.length&&h[0]===s[0]?iu(h):[]}),Sy=Rt(function(s){var h=Sr(s),p=qt(s,du);return h===Sr(p)?h=e:p.pop(),p.length&&p[0]===s[0]?iu(p,mt(h,2)):[]}),wy=Rt(function(s){var h=Sr(s),p=qt(s,du);return h=typeof h=="function"?h:e,h&&p.pop(),p.length&&p[0]===s[0]?iu(p,e,h):[]});function by(s,h){return s==null?"":T0.call(s,h)}function Sr(s){var h=s==null?0:s.length;return h?s[h-1]:e}function Ay(s,h,p){var _=s==null?0:s.length;if(!_)return-1;var E=_;return p!==e&&(E=bt(p),E=E<0?fe(_+E,0):Re(E,_-1)),h===h?s0(s,h,E):Pa(s,id,E,!0)}function Cy(s,h){return s&&s.length?Ld(s,bt(h)):e}var Ry=Rt(wp);function wp(s,h){return s&&s.length&&h&&h.length?au(s,h):s}function Iy(s,h,p){return s&&s.length&&h&&h.length?au(s,h,mt(p,2)):s}function Py(s,h,p){return s&&s.length&&h&&h.length?au(s,h,e,p):s}var My=ci(function(s,h){var p=s==null?0:s.length,_=Ql(s,h);return Nd(s,qt(h,function(E){return fi(E,p)?+E:E}).sort($d)),_});function By(s,h){var p=[];if(!(s&&s.length))return p;var _=-1,E=[],R=s.length;for(h=mt(h,3);++_<R;){var D=s[_];h(D,_,s)&&(p.push(D),E.push(_))}return Nd(s,E),p}function Cu(s){return s==null?s:b0.call(s)}function Dy(s,h,p){var _=s==null?0:s.length;return _?(p&&typeof p!="number"&&Oe(s,h,p)?(h=0,p=_):(h=h==null?0:bt(h),p=p===e?_:bt(p)),Er(s,h,p)):[]}function Ly(s,h){return Za(s,h)}function Fy(s,h,p){return uu(s,h,mt(p,2))}function Oy(s,h){var p=s==null?0:s.length;if(p){var _=Za(s,h);if(_<p&&Dr(s[_],h))return _}return-1}function Ny(s,h){return Za(s,h,!0)}function Uy(s,h,p){return uu(s,h,mt(p,2),!0)}function Gy(s,h){var p=s==null?0:s.length;if(p){var _=Za(s,h,!0)-1;if(Dr(s[_],h))return _}return-1}function ky(s){return s&&s.length?Gd(s):[]}function Hy(s,h){return s&&s.length?Gd(s,mt(h,2)):[]}function Vy(s){var h=s==null?0:s.length;return h?Er(s,1,h):[]}function Wy(s,h,p){return s&&s.length?(h=p||h===e?1:bt(h),Er(s,0,h<0?0:h)):[]}function Xy(s,h,p){var _=s==null?0:s.length;return _?(h=p||h===e?1:bt(h),h=_-h,Er(s,h<0?0:h,_)):[]}function zy(s,h){return s&&s.length?qa(s,mt(h,3),!1,!0):[]}function Yy(s,h){return s&&s.length?qa(s,mt(h,3)):[]}var $y=Rt(function(s){return Gi(Se(s,1,se,!0))}),jy=Rt(function(s){var h=Sr(s);return se(h)&&(h=e),Gi(Se(s,1,se,!0),mt(h,2))}),Ky=Rt(function(s){var h=Sr(s);return h=typeof h=="function"?h:e,Gi(Se(s,1,se,!0),e,h)});function Zy(s){return s&&s.length?Gi(s):[]}function qy(s,h){return s&&s.length?Gi(s,mt(h,2)):[]}function Jy(s,h){return h=typeof h=="function"?h:e,s&&s.length?Gi(s,e,h):[]}function Ru(s){if(!(s&&s.length))return[];var h=0;return s=Di(s,function(p){if(se(p))return h=fe(p.length,h),!0}),zl(h,function(p){return qt(s,Vl(p))})}function bp(s,h){if(!(s&&s.length))return[];var p=Ru(s);return h==null?p:qt(p,function(_){return ir(h,e,_)})}var Qy=Rt(function(s,h){return se(s)?lo(s,h):[]}),t1=Rt(function(s){return fu(Di(s,se))}),e1=Rt(function(s){var h=Sr(s);return se(h)&&(h=e),fu(Di(s,se),mt(h,2))}),r1=Rt(function(s){var h=Sr(s);return h=typeof h=="function"?h:e,fu(Di(s,se),e,h)}),i1=Rt(Ru);function n1(s,h){return Wd(s||[],h||[],ho)}function s1(s,h){return Wd(s||[],h||[],fo)}var o1=Rt(function(s){var h=s.length,p=h>1?s[h-1]:e;return p=typeof p=="function"?(s.pop(),p):e,bp(s,p)});function Ap(s){var h=A(s);return h.__chain__=!0,h}function a1(s,h){return h(s),s}function oh(s,h){return h(s)}var h1=ci(function(s){var h=s.length,p=h?s[0]:0,_=this.__wrapped__,E=function(R){return Ql(R,s)};return h>1||this.__actions__.length||!(_ instanceof Pt)||!fi(p)?this.thru(E):(_=_.slice(p,+p+(h?1:0)),_.__actions__.push({func:oh,args:[E],thisArg:e}),new yr(_,this.__chain__).thru(function(R){return h&&!R.length&&R.push(e),R}))});function l1(){return Ap(this)}function u1(){return new yr(this.value(),this.__chain__)}function c1(){this.__values__===e&&(this.__values__=kp(this.value()));var s=this.__index__>=this.__values__.length,h=s?e:this.__values__[this.__index__++];return{done:s,value:h}}function f1(){return this}function d1(s){for(var h,p=this;p instanceof za;){var _=vp(p);_.__index__=0,_.__values__=e,h?E.__wrapped__=_:h=_;var E=_;p=p.__wrapped__}return E.__wrapped__=s,h}function p1(){var s=this.__wrapped__;if(s instanceof Pt){var h=s;return this.__actions__.length&&(h=new Pt(this)),h=h.reverse(),h.__actions__.push({func:oh,args:[Cu],thisArg:e}),new yr(h,this.__chain__)}return this.thru(Cu)}function m1(){return Vd(this.__wrapped__,this.__actions__)}var g1=Ja(function(s,h,p){kt.call(s,p)?++s[p]:li(s,p,1)});function x1(s,h,p){var _=wt(s)?ed:av;return p&&Oe(s,h,p)&&(h=e),_(s,mt(h,3))}function _1(s,h){var p=wt(s)?Di:bd;return p(s,mt(h,3))}var v1=Qd(yp),y1=Qd(Tp);function T1(s,h){return Se(ah(s,h),1)}function E1(s,h){return Se(ah(s,h),Z)}function S1(s,h,p){return p=p===e?1:bt(p),Se(ah(s,h),p)}function Cp(s,h){var p=wt(s)?_r:Ui;return p(s,mt(h,3))}function Rp(s,h){var p=wt(s)?V_:wd;return p(s,mt(h,3))}var w1=Ja(function(s,h,p){kt.call(s,p)?s[p].push(h):li(s,p,[h])});function b1(s,h,p,_){s=je(s)?s:us(s),p=p&&!_?bt(p):0;var E=s.length;return p<0&&(p=fe(E+p,0)),fh(s)?p<=E&&s.indexOf(h,p)>-1:!!E&&Qn(s,h,p)>-1}var A1=Rt(function(s,h,p){var _=-1,E=typeof h=="function",R=je(s)?H(s.length):[];return Ui(s,function(D){R[++_]=E?ir(h,D,p):uo(D,h,p)}),R}),C1=Ja(function(s,h,p){li(s,p,h)});function ah(s,h){var p=wt(s)?qt:Md;return p(s,mt(h,3))}function R1(s,h,p,_){return s==null?[]:(wt(h)||(h=h==null?[]:[h]),p=_?e:p,wt(p)||(p=p==null?[]:[p]),Fd(s,h,p))}var I1=Ja(function(s,h,p){s[p?0:1].push(h)},function(){return[[],[]]});function P1(s,h,p){var _=wt(s)?kl:sd,E=arguments.length<3;return _(s,mt(h,4),p,E,Ui)}function M1(s,h,p){var _=wt(s)?W_:sd,E=arguments.length<3;return _(s,mt(h,4),p,E,wd)}function B1(s,h){var p=wt(s)?Di:bd;return p(s,uh(mt(h,3)))}function D1(s){var h=wt(s)?yd:bv;return h(s)}function L1(s,h,p){(p?Oe(s,h,p):h===e)?h=1:h=bt(h);var _=wt(s)?rv:Av;return _(s,h)}function F1(s){var h=wt(s)?iv:Rv;return h(s)}function O1(s){if(s==null)return 0;if(je(s))return fh(s)?es(s):s.length;var h=Ie(s);return h==Dt||h==Ye?s.size:su(s).length}function N1(s,h,p){var _=wt(s)?Hl:Iv;return p&&Oe(s,h,p)&&(h=e),_(s,mt(h,3))}var U1=Rt(function(s,h){if(s==null)return[];var p=h.length;return p>1&&Oe(s,h[0],h[1])?h=[]:p>2&&Oe(h[0],h[1],h[2])&&(h=[h[0]]),Fd(s,Se(h,1),[])}),hh=_0||function(){return _e.Date.now()};function G1(s,h){if(typeof h!="function")throw new vr(n);return s=bt(s),function(){if(--s<1)return h.apply(this,arguments)}}function Ip(s,h,p){return h=p?e:h,h=s&&h==null?s.length:h,ui(s,I,e,e,e,e,h)}function Pp(s,h){var p;if(typeof h!="function")throw new vr(n);return s=bt(s),function(){return--s>0&&(p=h.apply(this,arguments)),s<=1&&(h=e),p}}var Iu=Rt(function(s,h,p){var _=x;if(p.length){var E=Fi(p,hs(Iu));_|=v}return ui(s,_,h,p,E)}),Mp=Rt(function(s,h,p){var _=x|y;if(p.length){var E=Fi(p,hs(Mp));_|=v}return ui(h,_,s,p,E)});function Bp(s,h,p){h=p?e:h;var _=ui(s,b,e,e,e,e,e,h);return _.placeholder=Bp.placeholder,_}function Dp(s,h,p){h=p?e:h;var _=ui(s,w,e,e,e,e,e,h);return _.placeholder=Dp.placeholder,_}function Lp(s,h,p){var _,E,R,D,O,G,$=0,K=!1,Q=!1,nt=!0;if(typeof s!="function")throw new vr(n);h=wr(h)||0,Qt(p)&&(K=!!p.leading,Q="maxWait"in p,R=Q?fe(wr(p.maxWait)||0,h):R,nt="trailing"in p?!!p.trailing:nt);function lt(oe){var Lr=_,mi=E;return _=E=e,$=oe,D=s.apply(mi,Lr),D}function _t(oe){return $=oe,O=go(It,h),K?lt(oe):D}function At(oe){var Lr=oe-G,mi=oe-$,Qp=h-Lr;return Q?Re(Qp,R-mi):Qp}function vt(oe){var Lr=oe-G,mi=oe-$;return G===e||Lr>=h||Lr<0||Q&&mi>=R}function It(){var oe=hh();if(vt(oe))return Mt(oe);O=go(It,At(oe))}function Mt(oe){return O=e,nt&&_?lt(oe):(_=E=e,D)}function ar(){O!==e&&Xd(O),$=0,_=G=E=O=e}function Ne(){return O===e?D:Mt(hh())}function hr(){var oe=hh(),Lr=vt(oe);if(_=arguments,E=this,G=oe,Lr){if(O===e)return _t(G);if(Q)return Xd(O),O=go(It,h),lt(G)}return O===e&&(O=go(It,h)),D}return hr.cancel=ar,hr.flush=Ne,hr}var k1=Rt(function(s,h){return Sd(s,1,h)}),H1=Rt(function(s,h,p){return Sd(s,wr(h)||0,p)});function V1(s){return ui(s,P)}function lh(s,h){if(typeof s!="function"||h!=null&&typeof h!="function")throw new vr(n);var p=function(){var _=arguments,E=h?h.apply(this,_):_[0],R=p.cache;if(R.has(E))return R.get(E);var D=s.apply(this,_);return p.cache=R.set(E,D)||R,D};return p.cache=new(lh.Cache||hi),p}lh.Cache=hi;function uh(s){if(typeof s!="function")throw new vr(n);return function(){var h=arguments;switch(h.length){case 0:return!s.call(this);case 1:return!s.call(this,h[0]);case 2:return!s.call(this,h[0],h[1]);case 3:return!s.call(this,h[0],h[1],h[2])}return!s.apply(this,h)}}function W1(s){return Pp(2,s)}var X1=Pv(function(s,h){h=h.length==1&&wt(h[0])?qt(h[0],nr(mt())):qt(Se(h,1),nr(mt()));var p=h.length;return Rt(function(_){for(var E=-1,R=Re(_.length,p);++E<R;)_[E]=h[E].call(this,_[E]);return ir(s,this,_)})}),Pu=Rt(function(s,h){var p=Fi(h,hs(Pu));return ui(s,v,e,h,p)}),Fp=Rt(function(s,h){var p=Fi(h,hs(Fp));return ui(s,T,e,h,p)}),z1=ci(function(s,h){return ui(s,C,e,e,e,h)});function Y1(s,h){if(typeof s!="function")throw new vr(n);return h=h===e?h:bt(h),Rt(s,h)}function $1(s,h){if(typeof s!="function")throw new vr(n);return h=h==null?0:fe(bt(h),0),Rt(function(p){var _=p[h],E=Hi(p,0,h);return _&&Li(E,_),ir(s,this,E)})}function j1(s,h,p){var _=!0,E=!0;if(typeof s!="function")throw new vr(n);return Qt(p)&&(_="leading"in p?!!p.leading:_,E="trailing"in p?!!p.trailing:E),Lp(s,h,{leading:_,maxWait:h,trailing:E})}function K1(s){return Ip(s,1)}function Z1(s,h){return Pu(pu(h),s)}function q1(){if(!arguments.length)return[];var s=arguments[0];return wt(s)?s:[s]}function J1(s){return Tr(s,u)}function Q1(s,h){return h=typeof h=="function"?h:e,Tr(s,u,h)}function tT(s){return Tr(s,d|u)}function eT(s,h){return h=typeof h=="function"?h:e,Tr(s,d|u,h)}function rT(s,h){return h==null||Ed(s,h,ve(h))}function Dr(s,h){return s===h||s!==s&&h!==h}var iT=rh(ru),nT=rh(function(s,h){return s>=h}),En=Rd(function(){return arguments}())?Rd:function(s){return re(s)&&kt.call(s,"callee")&&!pd.call(s,"callee")},wt=H.isArray,sT=Kf?nr(Kf):dv;function je(s){return s!=null&&ch(s.length)&&!di(s)}function se(s){return re(s)&&je(s)}function oT(s){return s===!0||s===!1||re(s)&&Fe(s)==Bt}var Vi=y0||Hu,aT=Zf?nr(Zf):pv;function hT(s){return re(s)&&s.nodeType===1&&!xo(s)}function lT(s){if(s==null)return!0;if(je(s)&&(wt(s)||typeof s=="string"||typeof s.splice=="function"||Vi(s)||ls(s)||En(s)))return!s.length;var h=Ie(s);if(h==Dt||h==Ye)return!s.size;if(mo(s))return!su(s).length;for(var p in s)if(kt.call(s,p))return!1;return!0}function uT(s,h){return co(s,h)}function cT(s,h,p){p=typeof p=="function"?p:e;var _=p?p(s,h):e;return _===e?co(s,h,e,p):!!_}function Mu(s){if(!re(s))return!1;var h=Fe(s);return h==Yt||h==xe||typeof s.message=="string"&&typeof s.name=="string"&&!xo(s)}function fT(s){return typeof s=="number"&&gd(s)}function di(s){if(!Qt(s))return!1;var h=Fe(s);return h==Vt||h==jt||h==Ht||h==jn}function Op(s){return typeof s=="number"&&s==bt(s)}function ch(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=j}function Qt(s){var h=typeof s;return s!=null&&(h=="object"||h=="function")}function re(s){return s!=null&&typeof s=="object"}var Np=qf?nr(qf):gv;function dT(s,h){return s===h||nu(s,h,Tu(h))}function pT(s,h,p){return p=typeof p=="function"?p:e,nu(s,h,Tu(h),p)}function mT(s){return Up(s)&&s!=+s}function gT(s){if(Qv(s))throw new Et(i);return Id(s)}function xT(s){return s===null}function _T(s){return s==null}function Up(s){return typeof s=="number"||re(s)&&Fe(s)==Ot}function xo(s){if(!re(s)||Fe(s)!=Ce)return!1;var h=Ua(s);if(h===null)return!0;var p=kt.call(h,"constructor")&&h.constructor;return typeof p=="function"&&p instanceof p&&La.call(p)==p0}var Bu=Jf?nr(Jf):xv;function vT(s){return Op(s)&&s>=-j&&s<=j}var Gp=Qf?nr(Qf):_v;function fh(s){return typeof s=="string"||!wt(s)&&re(s)&&Fe(s)==$r}function or(s){return typeof s=="symbol"||re(s)&&Fe(s)==Kn}var ls=td?nr(td):vv;function yT(s){return s===e}function TT(s){return re(s)&&Ie(s)==jr}function ET(s){return re(s)&&Fe(s)==Zn}var ST=rh(ou),wT=rh(function(s,h){return s<=h});function kp(s){if(!s)return[];if(je(s))return fh(s)?Mr(s):$e(s);if(io&&s[io])return r0(s[io]());var h=Ie(s),p=h==Dt?$l:h==Ye?Ma:us;return p(s)}function pi(s){if(!s)return s===0?s:0;if(s=wr(s),s===Z||s===-Z){var h=s<0?-1:1;return h*rt}return s===s?s:0}function bt(s){var h=pi(s),p=h%1;return h===h?p?h-p:h:0}function Hp(s){return s?_n(bt(s),0,J):0}function wr(s){if(typeof s=="number")return s;if(or(s))return Y;if(Qt(s)){var h=typeof s.valueOf=="function"?s.valueOf():s;s=Qt(h)?h+"":h}if(typeof s!="string")return s===0?s:+s;s=od(s);var p=s_.test(s);return p||a_.test(s)?G_(s.slice(2),p?2:8):n_.test(s)?Y:+s}function Vp(s){return Zr(s,Ke(s))}function bT(s){return s?_n(bt(s),-j,j):s===0?s:0}function Ut(s){return s==null?"":sr(s)}var AT=os(function(s,h){if(mo(h)||je(h)){Zr(h,ve(h),s);return}for(var p in h)kt.call(h,p)&&ho(s,p,h[p])}),Wp=os(function(s,h){Zr(h,Ke(h),s)}),dh=os(function(s,h,p,_){Zr(h,Ke(h),s,_)}),CT=os(function(s,h,p,_){Zr(h,ve(h),s,_)}),RT=ci(Ql);function IT(s,h){var p=ss(s);return h==null?p:Td(p,h)}var PT=Rt(function(s,h){s=Xt(s);var p=-1,_=h.length,E=_>2?h[2]:e;for(E&&Oe(h[0],h[1],E)&&(_=1);++p<_;)for(var R=h[p],D=Ke(R),O=-1,G=D.length;++O<G;){var $=D[O],K=s[$];(K===e||Dr(K,rs[$])&&!kt.call(s,$))&&(s[$]=R[$])}return s}),MT=Rt(function(s){return s.push(e,op),ir(Xp,e,s)});function BT(s,h){return rd(s,mt(h,3),Kr)}function DT(s,h){return rd(s,mt(h,3),eu)}function LT(s,h){return s==null?s:tu(s,mt(h,3),Ke)}function FT(s,h){return s==null?s:Ad(s,mt(h,3),Ke)}function OT(s,h){return s&&Kr(s,mt(h,3))}function NT(s,h){return s&&eu(s,mt(h,3))}function UT(s){return s==null?[]:ja(s,ve(s))}function GT(s){return s==null?[]:ja(s,Ke(s))}function Du(s,h,p){var _=s==null?e:vn(s,h);return _===e?p:_}function kT(s,h){return s!=null&&lp(s,h,lv)}function Lu(s,h){return s!=null&&lp(s,h,uv)}var HT=ep(function(s,h,p){h!=null&&typeof h.toString!="function"&&(h=Fa.call(h)),s[h]=p},Ou(Ze)),VT=ep(function(s,h,p){h!=null&&typeof h.toString!="function"&&(h=Fa.call(h)),kt.call(s,h)?s[h].push(p):s[h]=[p]},mt),WT=Rt(uo);function ve(s){return je(s)?vd(s):su(s)}function Ke(s){return je(s)?vd(s,!0):yv(s)}function XT(s,h){var p={};return h=mt(h,3),Kr(s,function(_,E,R){li(p,h(_,E,R),_)}),p}function zT(s,h){var p={};return h=mt(h,3),Kr(s,function(_,E,R){li(p,E,h(_,E,R))}),p}var YT=os(function(s,h,p){Ka(s,h,p)}),Xp=os(function(s,h,p,_){Ka(s,h,p,_)}),$T=ci(function(s,h){var p={};if(s==null)return p;var _=!1;h=qt(h,function(R){return R=ki(R,s),_||(_=R.length>1),R}),Zr(s,vu(s),p),_&&(p=Tr(p,d|f|u,Hv));for(var E=h.length;E--;)cu(p,h[E]);return p});function jT(s,h){return zp(s,uh(mt(h)))}var KT=ci(function(s,h){return s==null?{}:Ev(s,h)});function zp(s,h){if(s==null)return{};var p=qt(vu(s),function(_){return[_]});return h=mt(h),Od(s,p,function(_,E){return h(_,E[0])})}function ZT(s,h,p){h=ki(h,s);var _=-1,E=h.length;for(E||(E=1,s=e);++_<E;){var R=s==null?e:s[qr(h[_])];R===e&&(_=E,R=p),s=di(R)?R.call(s):R}return s}function qT(s,h,p){return s==null?s:fo(s,h,p)}function JT(s,h,p,_){return _=typeof _=="function"?_:e,s==null?s:fo(s,h,p,_)}var Yp=np(ve),$p=np(Ke);function QT(s,h,p){var _=wt(s),E=_||Vi(s)||ls(s);if(h=mt(h,4),p==null){var R=s&&s.constructor;E?p=_?new R:[]:Qt(s)?p=di(R)?ss(Ua(s)):{}:p={}}return(E?_r:Kr)(s,function(D,O,G){return h(p,D,O,G)}),p}function tE(s,h){return s==null?!0:cu(s,h)}function eE(s,h,p){return s==null?s:Hd(s,h,pu(p))}function rE(s,h,p,_){return _=typeof _=="function"?_:e,s==null?s:Hd(s,h,pu(p),_)}function us(s){return s==null?[]:Yl(s,ve(s))}function iE(s){return s==null?[]:Yl(s,Ke(s))}function nE(s,h,p){return p===e&&(p=h,h=e),p!==e&&(p=wr(p),p=p===p?p:0),h!==e&&(h=wr(h),h=h===h?h:0),_n(wr(s),h,p)}function sE(s,h,p){return h=pi(h),p===e?(p=h,h=0):p=pi(p),s=wr(s),cv(s,h,p)}function oE(s,h,p){if(p&&typeof p!="boolean"&&Oe(s,h,p)&&(h=p=e),p===e&&(typeof h=="boolean"?(p=h,h=e):typeof s=="boolean"&&(p=s,s=e)),s===e&&h===e?(s=0,h=1):(s=pi(s),h===e?(h=s,s=0):h=pi(h)),s>h){var _=s;s=h,h=_}if(p||s%1||h%1){var E=xd();return Re(s+E*(h-s+U_("1e-"+((E+"").length-1))),h)}return hu(s,h)}var aE=as(function(s,h,p){return h=h.toLowerCase(),s+(p?jp(h):h)});function jp(s){return Fu(Ut(s).toLowerCase())}function Kp(s){return s=Ut(s),s&&s.replace(l_,q_).replace(R_,"")}function hE(s,h,p){s=Ut(s),h=sr(h);var _=s.length;p=p===e?_:_n(bt(p),0,_);var E=p;return p-=h.length,p>=0&&s.slice(p,E)==h}function lE(s){return s=Ut(s),s&&Wx.test(s)?s.replace(Af,J_):s}function uE(s){return s=Ut(s),s&&Kx.test(s)?s.replace(Pl,"\\$&"):s}var cE=as(function(s,h,p){return s+(p?"-":"")+h.toLowerCase()}),fE=as(function(s,h,p){return s+(p?" ":"")+h.toLowerCase()}),dE=Jd("toLowerCase");function pE(s,h,p){s=Ut(s),h=bt(h);var _=h?es(s):0;if(!h||_>=h)return s;var E=(h-_)/2;return eh(Va(E),p)+s+eh(Ha(E),p)}function mE(s,h,p){s=Ut(s),h=bt(h);var _=h?es(s):0;return h&&_<h?s+eh(h-_,p):s}function gE(s,h,p){s=Ut(s),h=bt(h);var _=h?es(s):0;return h&&_<h?eh(h-_,p)+s:s}function xE(s,h,p){return p||h==null?h=0:h&&(h=+h),w0(Ut(s).replace(Ml,""),h||0)}function _E(s,h,p){return(p?Oe(s,h,p):h===e)?h=1:h=bt(h),lu(Ut(s),h)}function vE(){var s=arguments,h=Ut(s[0]);return s.length<3?h:h.replace(s[1],s[2])}var yE=as(function(s,h,p){return s+(p?"_":"")+h.toLowerCase()});function TE(s,h,p){return p&&typeof p!="number"&&Oe(s,h,p)&&(h=p=e),p=p===e?J:p>>>0,p?(s=Ut(s),s&&(typeof h=="string"||h!=null&&!Bu(h))&&(h=sr(h),!h&&ts(s))?Hi(Mr(s),0,p):s.split(h,p)):[]}var EE=as(function(s,h,p){return s+(p?" ":"")+Fu(h)});function SE(s,h,p){return s=Ut(s),p=p==null?0:_n(bt(p),0,s.length),h=sr(h),s.slice(p,p+h.length)==h}function wE(s,h,p){var _=A.templateSettings;p&&Oe(s,h,p)&&(h=e),s=Ut(s),h=dh({},h,_,sp);var E=dh({},h.imports,_.imports,sp),R=ve(E),D=Yl(E,R),O,G,$=0,K=h.interpolate||Aa,Q="__p += '",nt=jl((h.escape||Aa).source+"|"+K.source+"|"+(K===Cf?i_:Aa).source+"|"+(h.evaluate||Aa).source+"|$","g"),lt="//# sourceURL="+(kt.call(h,"sourceURL")?(h.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++D_+"]")+`
`;s.replace(nt,function(vt,It,Mt,ar,Ne,hr){return Mt||(Mt=ar),Q+=s.slice($,hr).replace(u_,Q_),It&&(O=!0,Q+=`' +
__e(`+It+`) +
'`),Ne&&(G=!0,Q+=`';
`+Ne+`;
__p += '`),Mt&&(Q+=`' +
((__t = (`+Mt+`)) == null ? '' : __t) +
'`),$=hr+vt.length,vt}),Q+=`';
`;var _t=kt.call(h,"variable")&&h.variable;if(!_t)Q=`with (obj) {
`+Q+`
}
`;else if(e_.test(_t))throw new Et(o);Q=(G?Q.replace(Gx,""):Q).replace(kx,"$1").replace(Hx,"$1;"),Q="function("+(_t||"obj")+`) {
`+(_t?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(O?", __e = _.escape":"")+(G?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Q+`return __p
}`;var At=qp(function(){return Nt(R,lt+"return "+Q).apply(e,D)});if(At.source=Q,Mu(At))throw At;return At}function bE(s){return Ut(s).toLowerCase()}function AE(s){return Ut(s).toUpperCase()}function CE(s,h,p){if(s=Ut(s),s&&(p||h===e))return od(s);if(!s||!(h=sr(h)))return s;var _=Mr(s),E=Mr(h),R=ad(_,E),D=hd(_,E)+1;return Hi(_,R,D).join("")}function RE(s,h,p){if(s=Ut(s),s&&(p||h===e))return s.slice(0,ud(s)+1);if(!s||!(h=sr(h)))return s;var _=Mr(s),E=hd(_,Mr(h))+1;return Hi(_,0,E).join("")}function IE(s,h,p){if(s=Ut(s),s&&(p||h===e))return s.replace(Ml,"");if(!s||!(h=sr(h)))return s;var _=Mr(s),E=ad(_,Mr(h));return Hi(_,E).join("")}function PE(s,h){var p=M,_=B;if(Qt(h)){var E="separator"in h?h.separator:E;p="length"in h?bt(h.length):p,_="omission"in h?sr(h.omission):_}s=Ut(s);var R=s.length;if(ts(s)){var D=Mr(s);R=D.length}if(p>=R)return s;var O=p-es(_);if(O<1)return _;var G=D?Hi(D,0,O).join(""):s.slice(0,O);if(E===e)return G+_;if(D&&(O+=G.length-O),Bu(E)){if(s.slice(O).search(E)){var $,K=G;for(E.global||(E=jl(E.source,Ut(Rf.exec(E))+"g")),E.lastIndex=0;$=E.exec(K);)var Q=$.index;G=G.slice(0,Q===e?O:Q)}}else if(s.indexOf(sr(E),O)!=O){var nt=G.lastIndexOf(E);nt>-1&&(G=G.slice(0,nt))}return G+_}function ME(s){return s=Ut(s),s&&Vx.test(s)?s.replace(bf,o0):s}var BE=as(function(s,h,p){return s+(p?" ":"")+h.toUpperCase()}),Fu=Jd("toUpperCase");function Zp(s,h,p){return s=Ut(s),h=p?e:h,h===e?e0(s)?l0(s):Y_(s):s.match(h)||[]}var qp=Rt(function(s,h){try{return ir(s,e,h)}catch(p){return Mu(p)?p:new Et(p)}}),DE=ci(function(s,h){return _r(h,function(p){p=qr(p),li(s,p,Iu(s[p],s))}),s});function LE(s){var h=s==null?0:s.length,p=mt();return s=h?qt(s,function(_){if(typeof _[1]!="function")throw new vr(n);return[p(_[0]),_[1]]}):[],Rt(function(_){for(var E=-1;++E<h;){var R=s[E];if(ir(R[0],this,_))return ir(R[1],this,_)}})}function FE(s){return ov(Tr(s,d))}function Ou(s){return function(){return s}}function OE(s,h){return s==null||s!==s?h:s}var NE=tp(),UE=tp(!0);function Ze(s){return s}function Nu(s){return Pd(typeof s=="function"?s:Tr(s,d))}function GE(s){return Bd(Tr(s,d))}function kE(s,h){return Dd(s,Tr(h,d))}var HE=Rt(function(s,h){return function(p){return uo(p,s,h)}}),VE=Rt(function(s,h){return function(p){return uo(s,p,h)}});function Uu(s,h,p){var _=ve(h),E=ja(h,_);p==null&&!(Qt(h)&&(E.length||!_.length))&&(p=h,h=s,s=this,E=ja(h,ve(h)));var R=!(Qt(p)&&"chain"in p)||!!p.chain,D=di(s);return _r(E,function(O){var G=h[O];s[O]=G,D&&(s.prototype[O]=function(){var $=this.__chain__;if(R||$){var K=s(this.__wrapped__),Q=K.__actions__=$e(this.__actions__);return Q.push({func:G,args:arguments,thisArg:s}),K.__chain__=$,K}return G.apply(s,Li([this.value()],arguments))})}),s}function WE(){return _e._===this&&(_e._=m0),this}function Gu(){}function XE(s){return s=bt(s),Rt(function(h){return Ld(h,s)})}var zE=gu(qt),YE=gu(ed),$E=gu(Hl);function Jp(s){return Su(s)?Vl(qr(s)):Sv(s)}function jE(s){return function(h){return s==null?e:vn(s,h)}}var KE=rp(),ZE=rp(!0);function ku(){return[]}function Hu(){return!1}function qE(){return{}}function JE(){return""}function QE(){return!0}function tS(s,h){if(s=bt(s),s<1||s>j)return[];var p=J,_=Re(s,J);h=mt(h),s-=J;for(var E=zl(_,h);++p<s;)h(p);return E}function eS(s){return wt(s)?qt(s,qr):or(s)?[s]:$e(_p(Ut(s)))}function rS(s){var h=++d0;return Ut(s)+h}var iS=th(function(s,h){return s+h},0),nS=xu("ceil"),sS=th(function(s,h){return s/h},1),oS=xu("floor");function aS(s){return s&&s.length?$a(s,Ze,ru):e}function hS(s,h){return s&&s.length?$a(s,mt(h,2),ru):e}function lS(s){return nd(s,Ze)}function uS(s,h){return nd(s,mt(h,2))}function cS(s){return s&&s.length?$a(s,Ze,ou):e}function fS(s,h){return s&&s.length?$a(s,mt(h,2),ou):e}var dS=th(function(s,h){return s*h},1),pS=xu("round"),mS=th(function(s,h){return s-h},0);function gS(s){return s&&s.length?Xl(s,Ze):0}function xS(s,h){return s&&s.length?Xl(s,mt(h,2)):0}return A.after=G1,A.ary=Ip,A.assign=AT,A.assignIn=Wp,A.assignInWith=dh,A.assignWith=CT,A.at=RT,A.before=Pp,A.bind=Iu,A.bindAll=DE,A.bindKey=Mp,A.castArray=q1,A.chain=Ap,A.chunk=oy,A.compact=ay,A.concat=hy,A.cond=LE,A.conforms=FE,A.constant=Ou,A.countBy=g1,A.create=IT,A.curry=Bp,A.curryRight=Dp,A.debounce=Lp,A.defaults=PT,A.defaultsDeep=MT,A.defer=k1,A.delay=H1,A.difference=ly,A.differenceBy=uy,A.differenceWith=cy,A.drop=fy,A.dropRight=dy,A.dropRightWhile=py,A.dropWhile=my,A.fill=gy,A.filter=_1,A.flatMap=T1,A.flatMapDeep=E1,A.flatMapDepth=S1,A.flatten=Ep,A.flattenDeep=xy,A.flattenDepth=_y,A.flip=V1,A.flow=NE,A.flowRight=UE,A.fromPairs=vy,A.functions=UT,A.functionsIn=GT,A.groupBy=w1,A.initial=Ty,A.intersection=Ey,A.intersectionBy=Sy,A.intersectionWith=wy,A.invert=HT,A.invertBy=VT,A.invokeMap=A1,A.iteratee=Nu,A.keyBy=C1,A.keys=ve,A.keysIn=Ke,A.map=ah,A.mapKeys=XT,A.mapValues=zT,A.matches=GE,A.matchesProperty=kE,A.memoize=lh,A.merge=YT,A.mergeWith=Xp,A.method=HE,A.methodOf=VE,A.mixin=Uu,A.negate=uh,A.nthArg=XE,A.omit=$T,A.omitBy=jT,A.once=W1,A.orderBy=R1,A.over=zE,A.overArgs=X1,A.overEvery=YE,A.overSome=$E,A.partial=Pu,A.partialRight=Fp,A.partition=I1,A.pick=KT,A.pickBy=zp,A.property=Jp,A.propertyOf=jE,A.pull=Ry,A.pullAll=wp,A.pullAllBy=Iy,A.pullAllWith=Py,A.pullAt=My,A.range=KE,A.rangeRight=ZE,A.rearg=z1,A.reject=B1,A.remove=By,A.rest=Y1,A.reverse=Cu,A.sampleSize=L1,A.set=qT,A.setWith=JT,A.shuffle=F1,A.slice=Dy,A.sortBy=U1,A.sortedUniq=ky,A.sortedUniqBy=Hy,A.split=TE,A.spread=$1,A.tail=Vy,A.take=Wy,A.takeRight=Xy,A.takeRightWhile=zy,A.takeWhile=Yy,A.tap=a1,A.throttle=j1,A.thru=oh,A.toArray=kp,A.toPairs=Yp,A.toPairsIn=$p,A.toPath=eS,A.toPlainObject=Vp,A.transform=QT,A.unary=K1,A.union=$y,A.unionBy=jy,A.unionWith=Ky,A.uniq=Zy,A.uniqBy=qy,A.uniqWith=Jy,A.unset=tE,A.unzip=Ru,A.unzipWith=bp,A.update=eE,A.updateWith=rE,A.values=us,A.valuesIn=iE,A.without=Qy,A.words=Zp,A.wrap=Z1,A.xor=t1,A.xorBy=e1,A.xorWith=r1,A.zip=i1,A.zipObject=n1,A.zipObjectDeep=s1,A.zipWith=o1,A.entries=Yp,A.entriesIn=$p,A.extend=Wp,A.extendWith=dh,Uu(A,A),A.add=iS,A.attempt=qp,A.camelCase=aE,A.capitalize=jp,A.ceil=nS,A.clamp=nE,A.clone=J1,A.cloneDeep=tT,A.cloneDeepWith=eT,A.cloneWith=Q1,A.conformsTo=rT,A.deburr=Kp,A.defaultTo=OE,A.divide=sS,A.endsWith=hE,A.eq=Dr,A.escape=lE,A.escapeRegExp=uE,A.every=x1,A.find=v1,A.findIndex=yp,A.findKey=BT,A.findLast=y1,A.findLastIndex=Tp,A.findLastKey=DT,A.floor=oS,A.forEach=Cp,A.forEachRight=Rp,A.forIn=LT,A.forInRight=FT,A.forOwn=OT,A.forOwnRight=NT,A.get=Du,A.gt=iT,A.gte=nT,A.has=kT,A.hasIn=Lu,A.head=Sp,A.identity=Ze,A.includes=b1,A.indexOf=yy,A.inRange=sE,A.invoke=WT,A.isArguments=En,A.isArray=wt,A.isArrayBuffer=sT,A.isArrayLike=je,A.isArrayLikeObject=se,A.isBoolean=oT,A.isBuffer=Vi,A.isDate=aT,A.isElement=hT,A.isEmpty=lT,A.isEqual=uT,A.isEqualWith=cT,A.isError=Mu,A.isFinite=fT,A.isFunction=di,A.isInteger=Op,A.isLength=ch,A.isMap=Np,A.isMatch=dT,A.isMatchWith=pT,A.isNaN=mT,A.isNative=gT,A.isNil=_T,A.isNull=xT,A.isNumber=Up,A.isObject=Qt,A.isObjectLike=re,A.isPlainObject=xo,A.isRegExp=Bu,A.isSafeInteger=vT,A.isSet=Gp,A.isString=fh,A.isSymbol=or,A.isTypedArray=ls,A.isUndefined=yT,A.isWeakMap=TT,A.isWeakSet=ET,A.join=by,A.kebabCase=cE,A.last=Sr,A.lastIndexOf=Ay,A.lowerCase=fE,A.lowerFirst=dE,A.lt=ST,A.lte=wT,A.max=aS,A.maxBy=hS,A.mean=lS,A.meanBy=uS,A.min=cS,A.minBy=fS,A.stubArray=ku,A.stubFalse=Hu,A.stubObject=qE,A.stubString=JE,A.stubTrue=QE,A.multiply=dS,A.nth=Cy,A.noConflict=WE,A.noop=Gu,A.now=hh,A.pad=pE,A.padEnd=mE,A.padStart=gE,A.parseInt=xE,A.random=oE,A.reduce=P1,A.reduceRight=M1,A.repeat=_E,A.replace=vE,A.result=ZT,A.round=pS,A.runInContext=U,A.sample=D1,A.size=O1,A.snakeCase=yE,A.some=N1,A.sortedIndex=Ly,A.sortedIndexBy=Fy,A.sortedIndexOf=Oy,A.sortedLastIndex=Ny,A.sortedLastIndexBy=Uy,A.sortedLastIndexOf=Gy,A.startCase=EE,A.startsWith=SE,A.subtract=mS,A.sum=gS,A.sumBy=xS,A.template=wE,A.times=tS,A.toFinite=pi,A.toInteger=bt,A.toLength=Hp,A.toLower=bE,A.toNumber=wr,A.toSafeInteger=bT,A.toString=Ut,A.toUpper=AE,A.trim=CE,A.trimEnd=RE,A.trimStart=IE,A.truncate=PE,A.unescape=ME,A.uniqueId=rS,A.upperCase=BE,A.upperFirst=Fu,A.each=Cp,A.eachRight=Rp,A.first=Sp,Uu(A,function(){var s={};return Kr(A,function(h,p){kt.call(A.prototype,p)||(s[p]=h)}),s}(),{chain:!1}),A.VERSION=t,_r(["bind","bindKey","curry","curryRight","partial","partialRight"],function(s){A[s].placeholder=A}),_r(["drop","take"],function(s,h){Pt.prototype[s]=function(p){p=p===e?1:fe(bt(p),0);var _=this.__filtered__&&!h?new Pt(this):this.clone();return _.__filtered__?_.__takeCount__=Re(p,_.__takeCount__):_.__views__.push({size:Re(p,J),type:s+(_.__dir__<0?"Right":"")}),_},Pt.prototype[s+"Right"]=function(p){return this.reverse()[s](p).reverse()}}),_r(["filter","map","takeWhile"],function(s,h){var p=h+1,_=p==V||p==k;Pt.prototype[s]=function(E){var R=this.clone();return R.__iteratees__.push({iteratee:mt(E,3),type:p}),R.__filtered__=R.__filtered__||_,R}}),_r(["head","last"],function(s,h){var p="take"+(h?"Right":"");Pt.prototype[s]=function(){return this[p](1).value()[0]}}),_r(["initial","tail"],function(s,h){var p="drop"+(h?"":"Right");Pt.prototype[s]=function(){return this.__filtered__?new Pt(this):this[p](1)}}),Pt.prototype.compact=function(){return this.filter(Ze)},Pt.prototype.find=function(s){return this.filter(s).head()},Pt.prototype.findLast=function(s){return this.reverse().find(s)},Pt.prototype.invokeMap=Rt(function(s,h){return typeof s=="function"?new Pt(this):this.map(function(p){return uo(p,s,h)})}),Pt.prototype.reject=function(s){return this.filter(uh(mt(s)))},Pt.prototype.slice=function(s,h){s=bt(s);var p=this;return p.__filtered__&&(s>0||h<0)?new Pt(p):(s<0?p=p.takeRight(-s):s&&(p=p.drop(s)),h!==e&&(h=bt(h),p=h<0?p.dropRight(-h):p.take(h-s)),p)},Pt.prototype.takeRightWhile=function(s){return this.reverse().takeWhile(s).reverse()},Pt.prototype.toArray=function(){return this.take(J)},Kr(Pt.prototype,function(s,h){var p=/^(?:filter|find|map|reject)|While$/.test(h),_=/^(?:head|last)$/.test(h),E=A[_?"take"+(h=="last"?"Right":""):h],R=_||/^find/.test(h);E&&(A.prototype[h]=function(){var D=this.__wrapped__,O=_?[1]:arguments,G=D instanceof Pt,$=O[0],K=G||wt(D),Q=function(It){var Mt=E.apply(A,Li([It],O));return _&&nt?Mt[0]:Mt};K&&p&&typeof $=="function"&&$.length!=1&&(G=K=!1);var nt=this.__chain__,lt=!!this.__actions__.length,_t=R&&!nt,At=G&&!lt;if(!R&&K){D=At?D:new Pt(this);var vt=s.apply(D,O);return vt.__actions__.push({func:oh,args:[Q],thisArg:e}),new yr(vt,nt)}return _t&&At?s.apply(this,O):(vt=this.thru(Q),_t?_?vt.value()[0]:vt.value():vt)})}),_r(["pop","push","shift","sort","splice","unshift"],function(s){var h=Ba[s],p=/^(?:push|sort|unshift)$/.test(s)?"tap":"thru",_=/^(?:pop|shift)$/.test(s);A.prototype[s]=function(){var E=arguments;if(_&&!this.__chain__){var R=this.value();return h.apply(wt(R)?R:[],E)}return this[p](function(D){return h.apply(wt(D)?D:[],E)})}}),Kr(Pt.prototype,function(s,h){var p=A[h];if(p){var _=p.name+"";kt.call(ns,_)||(ns[_]=[]),ns[_].push({name:h,func:p})}}),ns[Qa(e,y).name]=[{name:"wrapper",func:e}],Pt.prototype.clone=M0,Pt.prototype.reverse=B0,Pt.prototype.value=D0,A.prototype.at=h1,A.prototype.chain=l1,A.prototype.commit=u1,A.prototype.next=c1,A.prototype.plant=d1,A.prototype.reverse=p1,A.prototype.toJSON=A.prototype.valueOf=A.prototype.value=m1,A.prototype.first=A.prototype.head,io&&(A.prototype[io]=f1),A},Oi=u0();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(_e._=Oi,define(function(){return Oi})):pn?((pn.exports=Oi)._=Oi,Nl._=Oi):_e._=Oi}).call(to)});var lr=(e=>(e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2",e))(lr||{}),Wu=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.WEBGL=1]="WEBGL",e[e.CANVAS=2]="CANVAS",e))(Wu||{}),ph=(e=>(e[e.COLOR=16384]="COLOR",e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL",e))(ph||{}),ft=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR",e))(ft||{}),qe=(e=>(e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e))(qe||{}),tt=(e=>(e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.RG=33319]="RG",e[e.RED=6403]="RED",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e))(tt||{}),gi=(e=>(e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e))(gi||{}),at=(e=>(e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.BYTE=5120]="BYTE",e[e.SHORT=5122]="SHORT",e[e.INT=5124]="INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.HALF_FLOAT=36193]="HALF_FLOAT",e))(at||{}),mh=(e=>(e[e.FLOAT=0]="FLOAT",e[e.INT=1]="INT",e[e.UINT=2]="UINT",e))(mh||{}),br=(e=>(e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR",e))(br||{}),ur=(e=>(e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e))(ur||{}),we=(e=>(e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON",e[e.ON_MANUAL=3]="ON_MANUAL",e))(we||{}),ue=(e=>(e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",e))(ue||{}),cr=(e=>(e[e.NO=0]="NO",e[e.YES=1]="YES",e[e.AUTO=2]="AUTO",e[e.BLEND=0]="BLEND",e[e.CLEAR=1]="CLEAR",e[e.BLIT=2]="BLIT",e))(cr||{}),gh=(e=>(e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL",e))(gh||{}),Ue=(e=>(e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp",e))(Ue||{}),ie=(e=>(e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE",e[e.COLOR=4]="COLOR",e))(ie||{});var Lt=(e=>(e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH",e))(Lt||{}),Je=(e=>(e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e))(Je||{});var Xu={createCanvas:(e,t)=>{let r=document.createElement("canvas");return r.width=e,r.height=t,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>new DOMParser().parseFromString(e,"text/xml")};var W={ADAPTER:Xu,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var zu=/iPhone/i,tm=/iPod/i,em=/iPad/i,rm=/\biOS-universal(?:.+)Mac\b/i,Yu=/\bAndroid(?:.+)Mobile\b/i,im=/Android/i,cs=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,xh=/Silk/i,xi=/Windows Phone/i,nm=/\bWindows(?:.+)ARM\b/i,sm=/BlackBerry/i,om=/BB10/i,am=/Opera Mini/i,hm=/\b(CriOS|Chrome)(?:.+)Mobile/i,lm=/Mobile(?:.+)Firefox\b/i,um=function(e){return typeof e<"u"&&e.platform==="MacIntel"&&typeof e.maxTouchPoints=="number"&&e.maxTouchPoints>1&&typeof MSStream>"u"};function bS(e){return function(t){return t.test(e)}}function _o(e){var t={userAgent:"",platform:"",maxTouchPoints:0};!e&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof e=="string"?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0});var r=t.userAgent,i=r.split("[FBAN");typeof i[1]<"u"&&(r=i[0]),i=r.split("Twitter"),typeof i[1]<"u"&&(r=i[0]);var n=bS(r),o={apple:{phone:n(zu)&&!n(xi),ipod:n(tm),tablet:!n(zu)&&(n(em)||um(t))&&!n(xi),universal:n(rm),device:(n(zu)||n(tm)||n(em)||n(rm)||um(t))&&!n(xi)},amazon:{phone:n(cs),tablet:!n(cs)&&n(xh),device:n(cs)||n(xh)},android:{phone:!n(xi)&&n(cs)||!n(xi)&&n(Yu),tablet:!n(xi)&&!n(cs)&&!n(Yu)&&(n(xh)||n(im)),device:!n(xi)&&(n(cs)||n(xh)||n(Yu)||n(im))||n(/\bokhttp\b/i)},windows:{phone:n(xi),tablet:n(nm),device:n(xi)||n(nm)},other:{blackberry:n(sm),blackberry10:n(om),opera:n(am),firefox:n(lm),chrome:n(hm),device:n(sm)||n(om)||n(am)||n(lm)||n(hm)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}var AS=_o.default??_o,Ar=AS(globalThis.navigator);var et={};SS(et,{BaseTextureCache:()=>ke,BoundingBox:()=>vs,CanvasRenderTarget:()=>Rh,DATA_URI:()=>Ah,EventEmitter:()=>zi.default,ProgramCache:()=>Mo,TextureCache:()=>Te,clearTextureCache:()=>ng,correctBlendMode:()=>Km,createIndicesForQuads:()=>Qm,decomposeDataUri:()=>hg,deprecation:()=>gt,destroyTextureCache:()=>ig,determineCrossOrigin:()=>Mh,earcut:()=>lg.default,getBufferType:()=>Wi,getCanvasBoundingBox:()=>Ih,getResolutionOfUrl:()=>Bo,hex2rgb:()=>zm,hex2string:()=>Ym,interleaveTypedArrays:()=>tg,isMobile:()=>Ar,isPow2:()=>Io,isWebGLSupported:()=>wh,log2:()=>Po,nextPow2:()=>Xi,path:()=>ec,premultiplyBlendMode:()=>Ro,premultiplyRgba:()=>Zm,premultiplyTint:()=>qm,premultiplyTintToRgba:()=>Jm,removeItems:()=>Ch,rgb2hex:()=>jm,sayHello:()=>Bm,sign:()=>eg,skipHello:()=>Mm,string2hex:()=>$m,trimCanvas:()=>ag,uid:()=>ti,url:()=>Sh});W.RETINA_PREFIX=/@([0-9\.]+)x/;W.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var zi=Sn(fm(),1),lg=Sn(xm(),1);var xs=Sn(Im(),1),Sh={parse:xs.parse,format:xs.format,resolve:xs.resolve};function Fr(e){if(typeof e!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(e)}`)}function Ao(e){return e.split("?")[0].split("#")[0]}function iw(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function nw(e,t,r){return e.replace(new RegExp(iw(t),"g"),r)}function sw(e,t){let r="",i=0,n=-1,o=0,a=-1;for(let l=0;l<=e.length;++l){if(l<e.length)a=e.charCodeAt(l);else{if(a===47)break;a=47}if(a===47){if(!(n===l-1||o===1))if(n!==l-1&&o===2){if(r.length<2||i!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){let c=r.lastIndexOf("/");if(c!==r.length-1){c===-1?(r="",i=0):(r=r.slice(0,c),i=r.length-1-r.lastIndexOf("/")),n=l,o=0;continue}}else if(r.length===2||r.length===1){r="",i=0,n=l,o=0;continue}}t&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+=`/${e.slice(n+1,l)}`:r=e.slice(n+1,l),i=l-n-1;n=l,o=0}else a===46&&o!==-1?++o:o=-1}return r}var ec={toPosix(e){return nw(e,"\\","/")},isUrl(e){return/^https?:/.test(this.toPosix(e))},isDataUrl(e){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e)},hasProtocol(e){return/^[^/:]+:\//.test(this.toPosix(e))},getProtocol(e){Fr(e),e=this.toPosix(e);let t="",r=/^file:\/\/\//.exec(e),i=/^[^/:]+:\/\//.exec(e),n=/^[^/:]+:\//.exec(e);if(r||i||n){let o=r?.[0]||i?.[0]||n?.[0];t=o,e=e.slice(o.length)}return t},toAbsolute(e,t,r){if(this.isDataUrl(e))return e;let i=Ao(this.toPosix(t??W.ADAPTER.getBaseUrl())),n=Ao(this.toPosix(r??this.rootname(i)));return Fr(e),e=this.toPosix(e),e.startsWith("/")?ec.join(n,e.slice(1)):this.isAbsolute(e)?e:this.join(i,e)},normalize(e){if(e=this.toPosix(e),Fr(e),e.length===0)return".";let t="",r=e.startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));let i=e.endsWith("/");return e=sw(e,!1),e.length>0&&i&&(e+="/"),r?`/${e}`:t+e},isAbsolute(e){return Fr(e),e=this.toPosix(e),this.hasProtocol(e)?!0:e.startsWith("/")},join(...e){if(e.length===0)return".";let t;for(let r=0;r<e.length;++r){let i=e[r];if(Fr(i),i.length>0)if(t===void 0)t=i;else{let n=e[r-1]??"";this.extname(n)?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(e){if(Fr(e),e.length===0)return".";e=this.toPosix(e);let t=e.charCodeAt(0),r=t===47,i=-1,n=!0,o=this.getProtocol(e),a=e;e=e.slice(o.length);for(let l=e.length-1;l>=1;--l)if(t=e.charCodeAt(l),t===47){if(!n){i=l;break}}else n=!1;return i===-1?r?"/":this.isUrl(a)?o+e:o:r&&i===1?"//":o+e.slice(0,i)},rootname(e){Fr(e),e=this.toPosix(e);let t="";if(e.startsWith("/")?t="/":t=this.getProtocol(e),this.isUrl(e)){let r=e.indexOf("/",t.length);r!==-1?t=e.slice(0,r):t=e,t.endsWith("/")||(t+="/")}return t},basename(e,t){Fr(e),t&&Fr(t),e=Ao(this.toPosix(e));let r=0,i=-1,n=!0,o;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let a=t.length-1,l=-1;for(o=e.length-1;o>=0;--o){let c=e.charCodeAt(o);if(c===47){if(!n){r=o+1;break}}else l===-1&&(n=!1,l=o+1),a>=0&&(c===t.charCodeAt(a)?--a===-1&&(i=o):(a=-1,i=l))}return r===i?i=l:i===-1&&(i=e.length),e.slice(r,i)}for(o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===47){if(!n){r=o+1;break}}else i===-1&&(n=!1,i=o+1);return i===-1?"":e.slice(r,i)},extname(e){Fr(e),e=Ao(this.toPosix(e));let t=-1,r=0,i=-1,n=!0,o=0;for(let a=e.length-1;a>=0;--a){let l=e.charCodeAt(a);if(l===47){if(!n){r=a+1;break}continue}i===-1&&(n=!1,i=a+1),l===46?t===-1?t=a:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||i===-1||o===0||o===1&&t===i-1&&t===r+1?"":e.slice(t,i)},parse(e){Fr(e);let t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;e=Ao(this.toPosix(e));let r=e.charCodeAt(0),i=this.isAbsolute(e),n,o="";t.root=this.rootname(e),i||this.hasProtocol(e)?n=1:n=0;let a=-1,l=0,c=-1,d=!0,f=e.length-1,u=0;for(;f>=n;--f){if(r=e.charCodeAt(f),r===47){if(!d){l=f+1;break}continue}c===-1&&(d=!1,c=f+1),r===46?a===-1?a=f:u!==1&&(u=1):a!==-1&&(u=-1)}return a===-1||c===-1||u===0||u===1&&a===c-1&&a===l+1?c!==-1&&(l===0&&i?t.base=t.name=e.slice(1,c):t.base=t.name=e.slice(l,c)):(l===0&&i?(t.name=e.slice(1,a),t.base=e.slice(1,c)):(t.name=e.slice(l,a),t.base=e.slice(l,c)),t.ext=e.slice(a,c)),t.dir=this.dirname(e),o&&(t.dir=o+t.dir),t},sep:"/",delimiter:":"};var Pm={};function gt(e,t,r=3){if(Pm[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`):(i=i.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${e}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`),console.warn(i))),Pm[t]=!0}function Mm(){gt("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function Bm(){gt("7.0.0",`sayHello is deprecated, please use Renderer's "hello" option`)}var rc;function wh(){return typeof rc>"u"&&(rc=function(){let t={stencil:!0,failIfMajorPerformanceCaveat:W.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!W.ADAPTER.getWebGLRenderingContext())return!1;let r=W.ADAPTER.createCanvas(),i=r.getContext("webgl",t)||r.getContext("experimental-webgl",t),n=!!i?.getContextAttributes()?.stencil;if(i){let o=i.getExtension("WEBGL_lose_context");o&&o.loseContext()}return i=null,n}catch{return!1}}()),rc}var ow={grad:.9,turn:360,rad:360/(2*Math.PI)},_i=function(e){return typeof e=="string"?e.length>0:typeof e=="number"},ye=function(e,t,r){return t===void 0&&(t=0),r===void 0&&(r=Math.pow(10,t)),Math.round(r*e)/r+0},Rr=function(e,t,r){return t===void 0&&(t=0),r===void 0&&(r=1),e>r?r:e>t?e:t},km=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},Dm=function(e){return{r:Rr(e.r,0,255),g:Rr(e.g,0,255),b:Rr(e.b,0,255),a:Rr(e.a)}},ic=function(e){return{r:ye(e.r),g:ye(e.g),b:ye(e.b),a:ye(e.a,3)}},aw=/^#([0-9a-f]{3,8})$/i,bh=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},Hm=function(e){var t=e.r,r=e.g,i=e.b,n=e.a,o=Math.max(t,r,i),a=o-Math.min(t,r,i),l=a?o===t?(r-i)/a:o===r?2+(i-t)/a:4+(t-r)/a:0;return{h:60*(l<0?l+6:l),s:o?a/o*100:0,v:o/255*100,a:n}},Vm=function(e){var t=e.h,r=e.s,i=e.v,n=e.a;t=t/360*6,r/=100,i/=100;var o=Math.floor(t),a=i*(1-r),l=i*(1-(t-o)*r),c=i*(1-(1-t+o)*r),d=o%6;return{r:255*[i,l,a,a,c,i][d],g:255*[c,i,i,l,a,a][d],b:255*[a,a,c,i,i,l][d],a:n}},Lm=function(e){return{h:km(e.h),s:Rr(e.s,0,100),l:Rr(e.l,0,100),a:Rr(e.a)}},Fm=function(e){return{h:ye(e.h),s:ye(e.s),l:ye(e.l),a:ye(e.a,3)}},Om=function(e){return Vm((r=(t=e).s,{h:t.h,s:(r*=((i=t.l)<50?i:100-i)/100)>0?2*r/(i+r)*100:0,v:i+r,a:t.a}));var t,r,i},Co=function(e){return{h:(t=Hm(e)).h,s:(n=(200-(r=t.s))*(i=t.v)/100)>0&&n<200?r*i/100/(n<=100?n:200-n)*100:0,l:n/2,a:t.a};var t,r,i,n},hw=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,lw=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,uw=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,cw=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,oc={string:[[function(e){var t=aw.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:e.length===4?ye(parseInt(e[3]+e[3],16)/255,2):1}:e.length===6||e.length===8?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:e.length===8?ye(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=uw.exec(e)||cw.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:Dm({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=hw.exec(e)||lw.exec(e);if(!t)return null;var r,i,n=Lm({h:(r=t[1],i=t[2],i===void 0&&(i="deg"),Number(r)*(ow[i]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return Om(n)},"hsl"]],object:[[function(e){var t=e.r,r=e.g,i=e.b,n=e.a,o=n===void 0?1:n;return _i(t)&&_i(r)&&_i(i)?Dm({r:Number(t),g:Number(r),b:Number(i),a:Number(o)}):null},"rgb"],[function(e){var t=e.h,r=e.s,i=e.l,n=e.a,o=n===void 0?1:n;if(!_i(t)||!_i(r)||!_i(i))return null;var a=Lm({h:Number(t),s:Number(r),l:Number(i),a:Number(o)});return Om(a)},"hsl"],[function(e){var t=e.h,r=e.s,i=e.v,n=e.a,o=n===void 0?1:n;if(!_i(t)||!_i(r)||!_i(i))return null;var a=function(l){return{h:km(l.h),s:Rr(l.s,0,100),v:Rr(l.v,0,100),a:Rr(l.a)}}({h:Number(t),s:Number(r),v:Number(i),a:Number(o)});return Vm(a)},"hsv"]]},Nm=function(e,t){for(var r=0;r<t.length;r++){var i=t[r][0](e);if(i)return[i,t[r][1]]}return[null,void 0]},fw=function(e){return typeof e=="string"?Nm(e.trim(),oc.string):typeof e=="object"&&e!==null?Nm(e,oc.object):[null,void 0]};var nc=function(e,t){var r=Co(e);return{h:r.h,s:Rr(r.s+100*t,0,100),l:r.l,a:r.a}},sc=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},Um=function(e,t){var r=Co(e);return{h:r.h,s:r.s,l:Rr(r.l+100*t,0,100),a:r.a}},ac=function(){function e(t){this.parsed=fw(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return this.parsed!==null},e.prototype.brightness=function(){return ye(sc(this.rgba),2)},e.prototype.isDark=function(){return sc(this.rgba)<.5},e.prototype.isLight=function(){return sc(this.rgba)>=.5},e.prototype.toHex=function(){return t=ic(this.rgba),r=t.r,i=t.g,n=t.b,a=(o=t.a)<1?bh(ye(255*o)):"","#"+bh(r)+bh(i)+bh(n)+a;var t,r,i,n,o,a},e.prototype.toRgb=function(){return ic(this.rgba)},e.prototype.toRgbString=function(){return t=ic(this.rgba),r=t.r,i=t.g,n=t.b,(o=t.a)<1?"rgba("+r+", "+i+", "+n+", "+o+")":"rgb("+r+", "+i+", "+n+")";var t,r,i,n,o},e.prototype.toHsl=function(){return Fm(Co(this.rgba))},e.prototype.toHslString=function(){return t=Fm(Co(this.rgba)),r=t.h,i=t.s,n=t.l,(o=t.a)<1?"hsla("+r+", "+i+"%, "+n+"%, "+o+")":"hsl("+r+", "+i+"%, "+n+"%)";var t,r,i,n,o},e.prototype.toHsv=function(){return t=Hm(this.rgba),{h:ye(t.h),s:ye(t.s),v:ye(t.v),a:ye(t.a,3)};var t},e.prototype.invert=function(){return Or({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},e.prototype.saturate=function(t){return t===void 0&&(t=.1),Or(nc(this.rgba,t))},e.prototype.desaturate=function(t){return t===void 0&&(t=.1),Or(nc(this.rgba,-t))},e.prototype.grayscale=function(){return Or(nc(this.rgba,-1))},e.prototype.lighten=function(t){return t===void 0&&(t=.1),Or(Um(this.rgba,t))},e.prototype.darken=function(t){return t===void 0&&(t=.1),Or(Um(this.rgba,-t))},e.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},e.prototype.alpha=function(t){return typeof t=="number"?Or({r:(r=this.rgba).r,g:r.g,b:r.b,a:t}):ye(this.rgba.a,3);var r},e.prototype.hue=function(t){var r=Co(this.rgba);return typeof t=="number"?Or({h:t,s:r.s,l:r.l,a:r.a}):ye(r.h)},e.prototype.isEqual=function(t){return this.toHex()===Or(t).toHex()},e}(),Or=function(e){return e instanceof ac?e:new ac(e)},Gm=[],Wm=function(e){e.forEach(function(t){Gm.indexOf(t)<0&&(t(ac,oc),Gm.push(t))})};function Xm(e,t){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var n in r)i[r[n]]=n;var o={};e.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var l,c,d=i[this.toHex()];if(d)return d;if(a?.closest){var f=this.toRgb(),u=1/0,m="black";if(!o.length)for(var g in r)o[g]=new e(r[g]).toRgb();for(var x in r){var y=(l=f,c=o[x],Math.pow(l.r-c.r,2)+Math.pow(l.g-c.g,2)+Math.pow(l.b-c.b,2));y<u&&(u=y,m=x)}return m}},t.string.push([function(a){var l=a.toLowerCase(),c=l==="transparent"?"#0000":r[l];return c?new e(c).toRgb():null},"name"])}Wm([Xm]);var _s=class{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof _s)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,t){let r=typeof e;if(r!==typeof t)return!1;if(r==="number"||r==="string"||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length!==t.length?!1:e.every((n,o)=>n===t[o]);if(e!==null&&t!==null){let n=Object.keys(e),o=Object.keys(t);return n.length!==o.length?!1:n.every(a=>e[a]===t[a])}return e===t}toRgba(){let[e,t,r,i]=this._components;return{r:e,g:t,b:r,a:i}}toRgb(){let[e,t,r]=this._components;return{r:e,g:t,b:r}}toRgbaString(){let[e,t,r]=this.toUint8RgbArray();return`rgba(${e},${t},${r},${this.alpha})`}toUint8RgbArray(e){let[t,r,i]=this._components;return e=e??[],e[0]=Math.round(t*255),e[1]=Math.round(r*255),e[2]=Math.round(i*255),e}toRgbArray(e){e=e??[];let[t,r,i]=this._components;return e[0]=t,e[1]=r,e[2]=i,e}toNumber(){return this._int}toLittleEndianNumber(){let e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){let[t,r,i,n]=_s.temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=r,this._components[2]*=i,this._components[3]*=n,this.refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e){if(e===1)return(e*255<<24)+this._int;if(e===0)return 0;let t=this._int>>16&255,r=this._int>>8&255,i=this._int&255;return t=t*e+.5|0,r=r*e+.5|0,i=i*e+.5|0,(e*255<<24)+(t<<16)+(r<<8)+i}toHex(){let e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){let t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(e){return this._components[3]=e,this}round(e){let[t,r,i]=this._components;return this._components.set([Math.min(255,t/e*e),Math.min(255,r/e*e),Math.min(255,i/e*e)]),this.refreshInt(),this._value=null,this}toArray(e){e=e??[];let[t,r,i,n]=this._components;return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e}normalize(e){let t;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){let r=e;t=[(r>>16&255)/255,(r>>8&255)/255,(r&255)/255,1]}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4&&e.every(r=>r<=1&&r>=0)){let[r,i,n,o=1]=e;t=[r,i,n,o]}else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4){let[r,i,n,o=255]=e;t=[r/255,i/255,n/255,o/255]}else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){let i=_s.HEX_PATTERN.exec(e);i&&(e=`#${i[2]}`)}let r=Or(e);if(r.isValid()){let{r:i,g:n,b:o,a}=r.rgba;t=[i/255,n/255,o/255,a]}}if(t)this._components.set(t),this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._components.forEach((i,n)=>this._components[n]=Math.min(Math.max(i,0),1));let[e,t,r]=this._components;this._int=(e*255<<16)+(t*255<<8)+(r*255|0)}},pt=_s;pt.shared=new _s;pt.temp=new _s;pt.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;function zm(e,t=[]){return gt("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),pt.shared.setValue(e).toRgbArray(t)}function Ym(e){return gt("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),pt.shared.setValue(e).toHex()}function $m(e){return gt("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),pt.shared.setValue(e).toNumber()}function jm(e){return gt("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),pt.shared.setValue(e).toNumber()}function dw(){let e=[],t=[];for(let i=0;i<32;i++)e[i]=i,t[i]=i;e[ft.NORMAL_NPM]=ft.NORMAL,e[ft.ADD_NPM]=ft.ADD,e[ft.SCREEN_NPM]=ft.SCREEN,t[ft.NORMAL]=ft.NORMAL_NPM,t[ft.ADD]=ft.ADD_NPM,t[ft.SCREEN]=ft.SCREEN_NPM;let r=[];return r.push(t),r.push(e),r}var Ro=dw();function Km(e,t){return Ro[t?1:0][e]}function Zm(e,t,r,i=!0){return gt("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),pt.shared.setValue(e).premultiply(t,i).toArray(r??new Float32Array(4))}function qm(e,t){return gt("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),pt.shared.setValue(e).toPremultiplied(t)}function Jm(e,t,r,i=!0){return gt("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),pt.shared.setValue(e).premultiply(t,i).toArray(r??new Float32Array(4))}var Ah=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function Qm(e,t=null){let r=e*6;if(t=t||new Uint16Array(r),t.length!==r)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${r}`);for(let i=0,n=0;i<r;i+=6,n+=4)t[i+0]=n+0,t[i+1]=n+1,t[i+2]=n+2,t[i+3]=n+0,t[i+4]=n+2,t[i+5]=n+3;return t}function Wi(e){if(e.BYTES_PER_ELEMENT===4)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(e.BYTES_PER_ELEMENT===2){if(e instanceof Uint16Array)return"Uint16Array"}else if(e.BYTES_PER_ELEMENT===1&&e instanceof Uint8Array)return"Uint8Array";return null}var pw={Float32Array,Uint32Array,Int32Array,Uint8Array};function tg(e,t){let r=0,i=0,n={};for(let c=0;c<e.length;c++)i+=t[c],r+=e[c].length;let o=new ArrayBuffer(r*4),a=null,l=0;for(let c=0;c<e.length;c++){let d=t[c],f=e[c],u=Wi(f);n[u]||(n[u]=new pw[u](o)),a=n[u];for(let m=0;m<f.length;m++){let g=(m/d|0)*i+l,x=m%d;a[g+x]=f[m]}l+=d}return new Float32Array(o)}function Xi(e){return e+=e===0?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1}function Io(e){return!(e&e-1)&&!!e}function Po(e){let t=(e>65535?1:0)<<4;e>>>=t;let r=(e>255?1:0)<<3;return e>>>=r,t|=r,r=(e>15?1:0)<<2,e>>>=r,t|=r,r=(e>3?1:0)<<1,e>>>=r,t|=r,t|e>>1}function Ch(e,t,r){let i=e.length,n;if(t>=i||r===0)return;r=t+r>i?i-t:r;let o=i-r;for(n=t;n<o;++n)e[n]=e[n+r];e.length=o}function eg(e){return e===0?0:e<0?-1:1}var mw=0;function ti(){return++mw}var rg=class{constructor(e,t,r,i){this.left=e,this.top=t,this.right=r,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}},vs=rg;vs.EMPTY=new rg(0,0,0,0);var Mo={},Te=Object.create(null),ke=Object.create(null);function ig(){let e;for(e in Te)Te[e].destroy();for(e in ke)ke[e].destroy()}function ng(){let e;for(e in Te)delete Te[e];for(e in ke)delete ke[e]}var Rh=class{constructor(t,r,i){this._canvas=W.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||W.RESOLUTION,this.resize(t,r)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,r){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(r*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}};function sg(e,t,r){for(let i=0,n=4*r*t;i<t;++i,n+=4)if(e[n+3]!==0)return!1;return!0}function og(e,t,r,i,n){let o=4*t;for(let a=i,l=i*o+4*r;a<=n;++a,l+=o)if(e[l+3]!==0)return!1;return!0}function Ih(e){let{width:t,height:r}=e,i=e.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");let o=i.getImageData(0,0,t,r).data,a=0,l=0,c=t-1,d=r-1;for(;l<r&&sg(o,t,l);)++l;if(l===r)return vs.EMPTY;for(;sg(o,t,d);)--d;for(;og(o,t,a,l,d);)++a;for(;og(o,t,c,l,d);)--c;return++c,++d,new vs(a,l,c,d)}function ag(e){let t=Ih(e),{width:r,height:i}=t,n=null;if(!t.isEmpty()){let o=e.getContext("2d");if(o===null)throw new TypeError("Failed to get canvas 2D context");n=o.getImageData(t.left,t.top,r,i)}return{width:r,height:i,data:n}}function hg(e){let t=Ah.exec(e);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]}}var Ph;function Mh(e,t=globalThis.location){if(e.startsWith("data:"))return"";t=t||globalThis.location,Ph||(Ph=document.createElement("a")),Ph.href=e;let r=Sh.parse(Ph.href),i=!r.port&&t.port===""||r.port===t.port;return r.hostname!==t.hostname||!i||r.protocol!==t.protocol?"anonymous":""}function Bo(e,t=1){let r=W.RETINA_PREFIX?.exec(e);return r?parseFloat(r[1]):t}var z=(e=>(e.Renderer="renderer",e.Application="application",e.RendererSystem="renderer-webgl-system",e.RendererPlugin="renderer-webgl-plugin",e.CanvasRendererSystem="renderer-canvas-system",e.CanvasRendererPlugin="renderer-canvas-plugin",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e))(z||{}),hc=e=>{if(typeof e=="function"||typeof e=="object"&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");e={...typeof e.extension!="object"?{type:e.extension}:e.extension,ref:e}}if(typeof e=="object")e={...e};else throw new Error("Invalid extension type");return typeof e.type=="string"&&(e.type=[e.type]),e},ug=(e,t)=>hc(e).priority??t,q={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...e){return e.map(hc).forEach(t=>{t.type.forEach(r=>this._removeHandlers[r]?.(t))}),this},add(...e){return e.map(hc).forEach(t=>{t.type.forEach(r=>{let i=this._addHandlers,n=this._queue;i[r]?i[r](t):(n[r]=n[r]||[],n[r].push(t))})}),this},handle(e,t,r){let i=this._addHandlers,n=this._removeHandlers;if(i[e]||n[e])throw new Error(`Extension type ${e} already has a handler`);i[e]=t,n[e]=r;let o=this._queue;return o[e]&&(o[e].forEach(a=>t(a)),delete o[e]),this},handleByMap(e,t){return this.handle(e,r=>{t[r.name]=r.ref},r=>{delete t[r.name]})},handleByList(e,t,r=-1){return this.handle(e,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((n,o)=>ug(o,r)-ug(n,r)))},i=>{let n=t.indexOf(i.ref);n!==-1&&t.splice(n,1)})}};var Yi=class{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}};var gw=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function xw(e){let t="";for(let r=0;r<e;++r)r>0&&(t+=`
else `),r<e-1&&(t+=`if(test == ${r}.0){}`);return t}function Bh(e,t){if(e===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");let r=t.createShader(t.FRAGMENT_SHADER);for(;;){let i=gw.replace(/%forloop%/gi,xw(e));if(t.shaderSource(r,i),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))e=e/2|0;else break}return e}var lc=0,uc=1,cc=2,fc=3,dc=4,pc=5,de=class{constructor(){this.data=0,this.blendMode=ft.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<lc)}set blend(t){!!(this.data&1<<lc)!==t&&(this.data^=1<<lc)}get offsets(){return!!(this.data&1<<uc)}set offsets(t){!!(this.data&1<<uc)!==t&&(this.data^=1<<uc)}get culling(){return!!(this.data&1<<cc)}set culling(t){!!(this.data&1<<cc)!==t&&(this.data^=1<<cc)}get depthTest(){return!!(this.data&1<<fc)}set depthTest(t){!!(this.data&1<<fc)!==t&&(this.data^=1<<fc)}get depthMask(){return!!(this.data&1<<pc)}set depthMask(t){!!(this.data&1<<pc)!==t&&(this.data^=1<<pc)}get clockwiseFrontFace(){return!!(this.data&1<<dc)}set clockwiseFrontFace(t){!!(this.data&1<<dc)!==t&&(this.data^=1<<dc)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==ft.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){let t=new de;return t.depthTest=!1,t.blend=!0,t}};var ys=[];function Ts(e,t){if(!e)return null;let r="";if(typeof e=="string"){let i=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);i&&(r=i[1].toLowerCase())}for(let i=ys.length-1;i>=0;--i){let n=ys[i];if(n.test&&n.test(e,r))return new n(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}var ae=class{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,r,i,n,o,a,l,c){if(arguments.length>8)throw new Error("max arguments reached");let{name:d,items:f}=this;this._aliasCount++;for(let u=0,m=f.length;u<m;u++)f[u][d](t,r,i,n,o,a,l,c);return f===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){let r=this.items.indexOf(t);return r!==-1&&(this.ensureNonAliasedItems(),this.items.splice(r,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}};Object.defineProperties(ae.prototype,{dispatch:{value:ae.prototype.emit},run:{value:ae.prototype.emit}});var fr=class{constructor(t=0,r=0){this._width=t,this._height=r,this.destroyed=!1,this.internal=!1,this.onResize=new ae("setRealSize"),this.onUpdate=new ae("update"),this.onError=new ae("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,r){(t!==this._width||r!==this._height)&&(this._width=t,this._height=r,this.onResize.emit(t,r))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,r,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,r){return!1}};var Qe=class extends fr{constructor(t,r){let{width:i,height:n}=r||{};if(!i||!n)throw new Error("BufferResource width or height invalid");super(i,n),this.data=t}upload(t,r,i){let n=t.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===ue.UNPACK);let o=r.realWidth,a=r.realHeight;return i.width===o&&i.height===a?n.texSubImage2D(r.target,0,0,0,o,a,r.format,i.type,this.data):(i.width=o,i.height=a,n.texImage2D(r.target,0,i.internalFormat,o,a,0,r.format,i.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}};var _w={scaleMode:br.NEAREST,format:tt.RGBA,alphaMode:ue.NPM},Es=class extends zi.default{constructor(e=null,t=null){super(),t=Object.assign({},Es.defaultOptions,t);let{alphaMode:r,mipmap:i,anisotropicLevel:n,scaleMode:o,width:a,height:l,wrapMode:c,format:d,type:f,target:u,resolution:m,resourceOptions:g}=t;e&&!(e instanceof fr)&&(e=Ts(e,g),e.internal=!0),this.resolution=m||W.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=n,this._wrapMode=c,this._scaleMode=o,this.format=d,this.type=f,this.target=u,this.alphaMode=r,this.uid=ti(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let r;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,r=!0),r&&this.dirtyStyleId++,this}setSize(e,t,r){return r=r||this.resolution,this.setRealSize(e*r,t*r,r)}setRealSize(e,t,r){return this.resolution=r||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Io(this.realWidth)&&Io(this.realHeight)}setResolution(e){let t=this.resolution;return t===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete ke[this.cacheId],delete Te[this.cacheId],this.cacheId=null),this.dispose(),Es.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,t,r=W.STRICT_TEXTURE_CACHE){let i=typeof e=="string",n=null;if(i)n=e;else{if(!e._pixiId){let a=t?.pixiIdPrefix||"pixiid";e._pixiId=`${a}_${ti()}`}n=e._pixiId}let o=ke[n];if(i&&r&&!o)throw new Error(`The cacheId "${n}" does not exist in BaseTextureCache.`);return o||(o=new Es(e,t),o.cacheId=n,Es.addToCache(o,n)),o}static fromBuffer(e,t,r,i){e=e||new Float32Array(t*r*4);let n=new Qe(e,{width:t,height:r}),o=e instanceof Float32Array?at.FLOAT:at.UNSIGNED_BYTE;return new Es(n,Object.assign({},_w,i||{width:t,height:r,type:o}))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),ke[t]&&ke[t]!==e&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),ke[t]=e)}static removeFromCache(e){if(typeof e=="string"){let t=ke[e];if(t){let r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete ke[e],t}}else if(e?.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)delete ke[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}},ht=Es;ht.defaultOptions={mipmap:we.POW2,anisotropicLevel:0,scaleMode:br.LINEAR,wrapMode:ur.CLAMP,alphaMode:ue.UNPACK,target:gi.TEXTURE_2D,format:tt.RGBA,type:at.UNSIGNED_BYTE};ht._globalBatch=0;var $i=class{constructor(){this.texArray=null,this.blend=0,this.type=qe.TRIANGLES,this.start=0,this.size=0,this.data=null}};var vw=0,Gt=class{constructor(t,r=!0,i=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=r,this.id=vw++,this.disposeRunner=new ae("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?Je.ELEMENT_ARRAY_BUFFER:Je.ARRAY_BUFFER}get index(){return this.type===Je.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new Gt(t)}};var ji=class{constructor(t,r=0,i=!1,n=at.FLOAT,o,a,l,c=1){this.buffer=t,this.size=r,this.normalized=i,this.type=n,this.stride=o,this.start=a,this.instance=l,this.divisor=c}destroy(){this.buffer=null}static from(t,r,i,n,o){return new ji(t,r,i,n,o)}};var yw={Float32Array,Uint32Array,Int32Array,Uint8Array};function cg(e,t){let r=0,i=0,n={};for(let c=0;c<e.length;c++)i+=t[c],r+=e[c].length;let o=new ArrayBuffer(r*4),a=null,l=0;for(let c=0;c<e.length;c++){let d=t[c],f=e[c],u=Wi(f);n[u]||(n[u]=new yw[u](o)),a=n[u];for(let m=0;m<f.length;m++){let g=(m/d|0)*i+l,x=m%d;a[g+x]=f[m]}l+=d}return new Float32Array(o)}var fg={5126:4,5123:2,5121:1},Tw=0,Ew={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Me=class{constructor(t=[],r={}){this.buffers=t,this.indexBuffer=null,this.attributes=r,this.glVertexArrayObjects={},this.id=Tw++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ae("disposeGeometry"),this.refCount=0}addAttribute(t,r,i=0,n=!1,o,a,l,c=!1){if(!r)throw new Error("You must pass a buffer when creating an attribute");r instanceof Gt||(r instanceof Array&&(r=new Float32Array(r)),r=new Gt(r));let d=t.split("|");if(d.length>1){for(let u=0;u<d.length;u++)this.addAttribute(d[u],r,i,n,o);return this}let f=this.buffers.indexOf(r);return f===-1&&(this.buffers.push(r),f=this.buffers.length-1),this.attributes[t]=new ji(f,i,n,o,a,l,c),this.instanced=this.instanced||c,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Gt||(t instanceof Array&&(t=new Uint16Array(t)),t=new Gt(t)),t.type=Je.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;let t=[],r=[],i=new Gt,n;for(n in this.attributes){let o=this.attributes[n],a=this.buffers[o.buffer];t.push(a.data),r.push(o.size*fg[o.type]/4),o.buffer=0}for(i.data=cg(t,r),n=0;n<this.buffers.length;n++)this.buffers[n]!==this.indexBuffer&&this.buffers[n].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(let t in this.attributes){let r=this.attributes[t];return this.buffers[r.buffer].data.length/(r.stride/4||r.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){let t=new Me;for(let r=0;r<this.buffers.length;r++)t.buffers[r]=new Gt(this.buffers[r].data.slice(0));for(let r in this.attributes){let i=this.attributes[r];t.attributes[r]=new ji(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=Je.ELEMENT_ARRAY_BUFFER),t}static merge(t){let r=new Me,i=[],n=[],o=[],a;for(let l=0;l<t.length;l++){a=t[l];for(let c=0;c<a.buffers.length;c++)n[c]=n[c]||0,n[c]+=a.buffers[c].data.length,o[c]=0}for(let l=0;l<a.buffers.length;l++)i[l]=new Ew[Wi(a.buffers[l].data)](n[l]),r.buffers[l]=new Gt(i[l]);for(let l=0;l<t.length;l++){a=t[l];for(let c=0;c<a.buffers.length;c++)i[c].set(a.buffers[c].data,o[c]),o[c]+=a.buffers[c].data.length}if(r.attributes=a.attributes,a.indexBuffer){r.indexBuffer=r.buffers[a.buffers.indexOf(a.indexBuffer)],r.indexBuffer.type=Je.ELEMENT_ARRAY_BUFFER;let l=0,c=0,d=0,f=0;for(let u=0;u<a.buffers.length;u++)if(a.buffers[u]!==a.indexBuffer){f=u;break}for(let u in a.attributes){let m=a.attributes[u];(m.buffer|0)===f&&(c+=m.size*fg[m.type]/4)}for(let u=0;u<t.length;u++){let m=t[u].indexBuffer.data;for(let g=0;g<m.length;g++)r.indexBuffer.data[g+d]+=l;l+=t[u].buffers[f].data.length/c,d+=m.length}}return r}};var bn=class extends Me{constructor(t=!1){super(),this._buffer=new Gt(null,t,!1),this._indexBuffer=new Gt(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,at.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,at.FLOAT).addAttribute("aColor",this._buffer,4,!0,at.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,at.FLOAT).addIndex(this._indexBuffer)}};var Ki=Math.PI*2,mc=180/Math.PI,gc=Math.PI/180,zt=(e=>(e[e.POLY=0]="POLY",e[e.RECT=1]="RECT",e[e.CIRC=2]="CIRC",e[e.ELIP=3]="ELIP",e[e.RREC=4]="RREC",e))(zt||{});var dt=class{constructor(t=0,r=0){this.x=0,this.y=0,this.x=t,this.y=r}clone(){return new dt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,r=t){return this.x=t,this.y=r,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}};var Dh=[new dt,new dt,new dt,new dt],ut=class{constructor(t=0,r=0,i=0,n=0){this.x=Number(t),this.y=Number(r),this.width=Number(i),this.height=Number(n),this.type=zt.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new ut(0,0,0,0)}clone(){return new ut(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,r){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&r>=this.y&&r<this.y+this.height}intersects(t,r){if(!r){let M=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=M)return!1;let F=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>F}let i=this.left,n=this.right,o=this.top,a=this.bottom;if(n<=i||a<=o)return!1;let l=Dh[0].set(t.left,t.top),c=Dh[1].set(t.left,t.bottom),d=Dh[2].set(t.right,t.top),f=Dh[3].set(t.right,t.bottom);if(d.x<=l.x||c.y<=l.y)return!1;let u=Math.sign(r.a*r.d-r.b*r.c);if(u===0||(r.apply(l,l),r.apply(c,c),r.apply(d,d),r.apply(f,f),Math.max(l.x,c.x,d.x,f.x)<=i||Math.min(l.x,c.x,d.x,f.x)>=n||Math.max(l.y,c.y,d.y,f.y)<=o||Math.min(l.y,c.y,d.y,f.y)>=a))return!1;let m=u*(c.y-l.y),g=u*(l.x-c.x),x=m*i+g*o,y=m*n+g*o,S=m*i+g*a,b=m*n+g*a;if(Math.max(x,y,S,b)<=m*l.x+g*l.y||Math.min(x,y,S,b)>=m*f.x+g*f.y)return!1;let w=u*(l.y-d.y),v=u*(d.x-l.x),T=w*i+v*o,I=w*n+v*o,C=w*i+v*a,P=w*n+v*a;return!(Math.max(T,I,C,P)<=w*l.x+v*l.y||Math.min(T,I,C,P)>=w*f.x+v*f.y)}pad(t=0,r=t){return this.x-=t,this.y-=r,this.width+=t*2,this.height+=r*2,this}fit(t){let r=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),n=Math.max(this.y,t.y),o=Math.min(this.y+this.height,t.y+t.height);return this.x=r,this.width=Math.max(i-r,0),this.y=n,this.height=Math.max(o-n,0),this}ceil(t=1,r=.001){let i=Math.ceil((this.x+this.width-r)*t)/t,n=Math.ceil((this.y+this.height-r)*t)/t;return this.x=Math.floor((this.x+r)*t)/t,this.y=Math.floor((this.y+r)*t)/t,this.width=i-this.x,this.height=n-this.y,this}enlarge(t){let r=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),o=Math.max(this.y+this.height,t.y+t.height);return this.x=r,this.width=i-r,this.y=n,this.height=o-n,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};var An=class{constructor(t=0,r=0,i=0){this.x=t,this.y=r,this.radius=i,this.type=zt.CIRC}clone(){return new An(this.x,this.y,this.radius)}contains(t,r){if(this.radius<=0)return!1;let i=this.radius*this.radius,n=this.x-t,o=this.y-r;return n*=n,o*=o,n+o<=i}getBounds(){return new ut(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}};var Cn=class{constructor(t=0,r=0,i=0,n=0){this.x=t,this.y=r,this.width=i,this.height=n,this.type=zt.ELIP}clone(){return new Cn(this.x,this.y,this.width,this.height)}contains(t,r){if(this.width<=0||this.height<=0)return!1;let i=(t-this.x)/this.width,n=(r-this.y)/this.height;return i*=i,n*=n,i+n<=1}getBounds(){return new ut(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};var Nr=class{constructor(...t){let r=Array.isArray(t[0])?t[0]:t;if(typeof r[0]!="number"){let i=[];for(let n=0,o=r.length;n<o;n++)i.push(r[n].x,r[n].y);r=i}this.points=r,this.type=zt.POLY,this.closeStroke=!0}clone(){let t=this.points.slice(),r=new Nr(t);return r.closeStroke=this.closeStroke,r}contains(t,r){let i=!1,n=this.points.length/2;for(let o=0,a=n-1;o<n;a=o++){let l=this.points[o*2],c=this.points[o*2+1],d=this.points[a*2],f=this.points[a*2+1];c>r!=f>r&&t<(d-l)*((r-c)/(f-c))+l&&(i=!i)}return i}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,r)=>`${t}, ${r}`,"")}]`}};var Rn=class{constructor(t=0,r=0,i=0,n=0,o=20){this.x=t,this.y=r,this.width=i,this.height=n,this.radius=o,this.type=zt.RREC}clone(){return new Rn(this.x,this.y,this.width,this.height,this.radius)}contains(t,r){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){let i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+i&&r<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let n=t-(this.x+i),o=r-(this.y+i),a=i*i;if(n*n+o*o<=a||(n=t-(this.x+this.width-i),n*n+o*o<=a)||(o=r-(this.y+this.height-i),n*n+o*o<=a)||(n=t-(this.x+i),n*n+o*o<=a))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}};var St=class{constructor(t=1,r=0,i=0,n=1,o=0,a=0){this.array=null,this.a=t,this.b=r,this.c=i,this.d=n,this.tx=o,this.ty=a}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,r,i,n,o,a){return this.a=t,this.b=r,this.c=i,this.d=n,this.tx=o,this.ty=a,this}toArray(t,r){this.array||(this.array=new Float32Array(9));let i=r||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,r){r=r||new dt;let i=t.x,n=t.y;return r.x=this.a*i+this.c*n+this.tx,r.y=this.b*i+this.d*n+this.ty,r}applyInverse(t,r){r=r||new dt;let i=1/(this.a*this.d+this.c*-this.b),n=t.x,o=t.y;return r.x=this.d*i*n+-this.c*i*o+(this.ty*this.c-this.tx*this.d)*i,r.y=this.a*i*o+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,r}translate(t,r){return this.tx+=t,this.ty+=r,this}scale(t,r){return this.a*=t,this.d*=r,this.c*=t,this.b*=r,this.tx*=t,this.ty*=r,this}rotate(t){let r=Math.cos(t),i=Math.sin(t),n=this.a,o=this.c,a=this.tx;return this.a=n*r-this.b*i,this.b=n*i+this.b*r,this.c=o*r-this.d*i,this.d=o*i+this.d*r,this.tx=a*r-this.ty*i,this.ty=a*i+this.ty*r,this}append(t){let r=this.a,i=this.b,n=this.c,o=this.d;return this.a=t.a*r+t.b*n,this.b=t.a*i+t.b*o,this.c=t.c*r+t.d*n,this.d=t.c*i+t.d*o,this.tx=t.tx*r+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*o+this.ty,this}setTransform(t,r,i,n,o,a,l,c,d){return this.a=Math.cos(l+d)*o,this.b=Math.sin(l+d)*o,this.c=-Math.sin(l-c)*a,this.d=Math.cos(l-c)*a,this.tx=t-(i*this.a+n*this.c),this.ty=r-(i*this.b+n*this.d),this}prepend(t){let r=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){let i=this.a,n=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=r*t.a+this.ty*t.c+t.tx,this.ty=r*t.b+this.ty*t.d+t.ty,this}decompose(t){let r=this.a,i=this.b,n=this.c,o=this.d,a=t.pivot,l=-Math.atan2(-n,o),c=Math.atan2(i,r),d=Math.abs(l+c);return d<1e-5||Math.abs(Ki-d)<1e-5?(t.rotation=c,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=l,t.skew.y=c),t.scale.x=Math.sqrt(r*r+i*i),t.scale.y=Math.sqrt(n*n+o*o),t.position.x=this.tx+(a.x*r+a.y*n),t.position.y=this.ty+(a.x*i+a.y*o),t}invert(){let t=this.a,r=this.b,i=this.c,n=this.d,o=this.tx,a=t*n-r*i;return this.a=n/a,this.b=-r/a,this.c=-i/a,this.d=t/a,this.tx=(i*this.ty-n*o)/a,this.ty=-(t*this.ty-r*o)/a,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){let t=new St;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new St}static get TEMP_MATRIX(){return new St}};var In=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Pn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Mn=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Bn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],xc=[],dg=[],Lh=Math.sign;function Sw(){for(let e=0;e<16;e++){let t=[];xc.push(t);for(let r=0;r<16;r++){let i=Lh(In[e]*In[r]+Mn[e]*Pn[r]),n=Lh(Pn[e]*In[r]+Bn[e]*Pn[r]),o=Lh(In[e]*Mn[r]+Mn[e]*Bn[r]),a=Lh(Pn[e]*Mn[r]+Bn[e]*Bn[r]);for(let l=0;l<16;l++)if(In[l]===i&&Pn[l]===n&&Mn[l]===o&&Bn[l]===a){t.push(l);break}}}for(let e=0;e<16;e++){let t=new St;t.set(In[e],Pn[e],Mn[e],Bn[e],0,0),dg.push(t)}}Sw();var Zt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:e=>In[e],uY:e=>Pn[e],vX:e=>Mn[e],vY:e=>Bn[e],inv:e=>e&8?e&15:-e&7,add:(e,t)=>xc[e][t],sub:(e,t)=>xc[e][Zt.inv(t)],rotate180:e=>e^4,isVertical:e=>(e&3)===2,byDirection:(e,t)=>Math.abs(e)*2<=Math.abs(t)?t>=0?Zt.S:Zt.N:Math.abs(t)*2<=Math.abs(e)?e>0?Zt.E:Zt.W:t>0?e>0?Zt.SE:Zt.SW:e>0?Zt.NE:Zt.NW,matrixAppendRotationInv:(e,t,r=0,i=0)=>{let n=dg[Zt.inv(t)];n.tx=r,n.ty=i,e.append(n)}};var tr=class{constructor(t,r,i=0,n=0){this._x=i,this._y=n,this.cb=t,this.scope=r}clone(t=this.cb,r=this.scope){return new tr(t,r,this._x,this._y)}set(t=0,r=t){return(this._x!==t||this._y!==r)&&(this._x=t,this._y=r,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}};var pg=class{constructor(){this.worldTransform=new St,this.localTransform=new St,this.position=new tr(this.onChange,this,0,0),this.scale=new tr(this.onChange,this,1,1),this.pivot=new tr(this.onChange,this,0,0),this.skew=new tr(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){let e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(e){let t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){let r=e.worldTransform,i=this.worldTransform;i.a=t.a*r.a+t.b*r.c,i.b=t.a*r.b+t.b*r.d,i.c=t.c*r.a+t.d*r.c,i.d=t.c*r.b+t.d*r.d,i.tx=t.tx*r.a+t.ty*r.c+r.tx,i.ty=t.tx*r.b+t.ty*r.d+r.ty,this._parentID=e._worldID,this._worldID++}}setFromMatrix(e){e.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())}},Dn=pg;Dn.IDENTITY=new pg;var mg=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`;var gg=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Fh(e,t,r){let i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}function _c(e){let t=new Array(e);for(let r=0;r<t.length;r++)t[r]=!1;return t}function Do(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return _c(2*t);case"bvec3":return _c(3*t);case"bvec4":return _c(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var ei=[{test:e=>e.type==="float"&&e.size===1&&!e.isArray,code:e=>`
            if(uv["${e}"] !== ud["${e}"].value)
            {
                ud["${e}"].value = uv["${e}"]
                gl.uniform1f(ud["${e}"].location, uv["${e}"])
            }
            `},{test:(e,t)=>(e.type==="sampler2D"||e.type==="samplerCube"||e.type==="sampler2DArray")&&e.size===1&&!e.isArray&&(t==null||t.castToBaseTexture!==void 0),code:e=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${e}"], t);

            if(ud["${e}"].value !== t)
            {
                ud["${e}"].value = t;
                gl.uniform1i(ud["${e}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(e,t)=>e.type==="mat3"&&e.size===1&&!e.isArray&&t.a!==void 0,code:e=>`
            gl.uniformMatrix3fv(ud["${e}"].location, false, uv["${e}"].toArray(true));
            `,codeUbo:e=>`
                var ${e}_matrix = uv.${e}.toArray(true);

                data[offset] = ${e}_matrix[0];
                data[offset+1] = ${e}_matrix[1];
                data[offset+2] = ${e}_matrix[2];
        
                data[offset + 4] = ${e}_matrix[3];
                data[offset + 5] = ${e}_matrix[4];
                data[offset + 6] = ${e}_matrix[5];
        
                data[offset + 8] = ${e}_matrix[6];
                data[offset + 9] = ${e}_matrix[7];
                data[offset + 10] = ${e}_matrix[8];
            `},{test:(e,t)=>e.type==="vec2"&&e.size===1&&!e.isArray&&t.x!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${e}"].location, v.x, v.y);
                }`,codeUbo:e=>`
                v = uv.${e};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:e=>e.type==="vec2"&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${e}"].location, v[0], v[1]);
                }
            `},{test:(e,t)=>e.type==="vec4"&&e.size===1&&!e.isArray&&t.width!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${e}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(e,t)=>e.type==="vec4"&&e.size===1&&!e.isArray&&t.red!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${e}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(e,t)=>e.type==="vec3"&&e.size===1&&!e.isArray&&t.red!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${e}"].location, v.red, v.green, v.blue)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:e=>e.type==="vec4"&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${e}"].location, v[0], v[1], v[2], v[3])
                }`}];var ww={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},bw={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function vc(e,t){let r=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(let i in e.uniforms){let n=t[i];if(!n){e.uniforms[i]?.group&&(e.uniforms[i].ubo?r.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):r.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}let o=e.uniforms[i],a=!1;for(let l=0;l<ei.length;l++)if(ei[l].test(n,o)){r.push(ei[l].code(i,o)),a=!0;break}if(!a){let c=(n.size===1&&!n.isArray?ww:bw)[n.type].replace("location",`ud["${i}"].location`);r.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${c};`)}}return new Function("ud","uv","renderer","syncData",r.join(`
`))}var xg={},Oh=xg;function Nh(){if(Oh===xg||Oh?.isContextLost()){let e=W.ADAPTER.createCanvas(),t;W.PREFER_ENV>=lr.WEBGL2&&(t=e.getContext("webgl2",{})),t||(t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),Oh=t}return Oh}var Uh;function yc(){if(!Uh){Uh=Ue.MEDIUM;let e=Nh();e&&e.getShaderPrecisionFormat&&(Uh=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision?Ue.HIGH:Ue.MEDIUM)}return Uh}function _g(e,t){let r=e.getShaderSource(t).split(`
`).map((d,f)=>`${f}: ${d}`),i=e.getShaderInfoLog(t),n=i.split(`
`),o={},a=n.map(d=>parseFloat(d.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(d=>d&&!o[d]?(o[d]=!0,!0):!1),l=[""];a.forEach(d=>{r[d-1]=`%c${r[d-1]}%c`,l.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});let c=r.join(`
`);l[0]=c,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...l),console.groupEnd()}function Tc(e,t,r,i){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(r,e.COMPILE_STATUS)||_g(e,r),e.getShaderParameter(i,e.COMPILE_STATUS)||_g(e,i),console.error("PixiJS Error: Could not initialize shader."),e.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(t)))}var Aw={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Lo(e){return Aw[e]}var Gh=null,vg={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Fo(e,t){if(!Gh){let r=Object.keys(vg);Gh={};for(let i=0;i<r.length;++i){let n=r[i];Gh[e[n]]=vg[n]}}return Gh[t]}function kh(e,t,r){if(e.substring(0,9)!=="precision"){let i=t;return t===Ue.HIGH&&r!==Ue.HIGH&&(i=Ue.MEDIUM),`precision ${i} float;
${e}`}else if(r!==Ue.HIGH&&e.substring(0,15)==="precision highp")return e.replace("precision highp","precision mediump");return e}var Oo;function Hh(){if(typeof Oo=="boolean")return Oo;try{Oo=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Oo=!1}return Oo}var Cw=0,Vh={},Ss=class{constructor(e,t,r="pixi-shader",i={}){this.extra={},this.id=Cw++,this.vertexSrc=e||Ss.defaultVertexSrc,this.fragmentSrc=t||Ss.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(r=r.replace(/\s+/g,"-"),Vh[r]?(Vh[r]++,r+=`-${Vh[r]}`):Vh[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${r}
${this.fragmentSrc}`,this.vertexSrc=kh(this.vertexSrc,Ss.defaultVertexPrecision,Ue.HIGH),this.fragmentSrc=kh(this.fragmentSrc,Ss.defaultFragmentPrecision,yc())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return gg}static get defaultFragmentSrc(){return mg}static from(e,t,r){let i=e+t,n=Mo[i];return n||(Mo[i]=n=new Ss(e,t,r)),n}},Ee=Ss;Ee.defaultVertexPrecision=Ue.HIGH;Ee.defaultFragmentPrecision=Ar.apple.device?Ue.HIGH:Ue.MEDIUM;var Rw=0,pe=class{constructor(t,r,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Rw++,this.static=!!r,this.ubo=!!i,t instanceof Gt?(this.buffer=t,this.buffer.type=Je.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Gt(new Float32Array(1)),this.buffer.type=Je.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,r,i){if(!this.ubo)this.uniforms[t]=new pe(r,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,r,i){return new pe(t,r,i)}static uboFrom(t,r){return new pe(t,r??!0,!0)}};var me=class{constructor(t,r){this.uniformBindCount=0,this.program=t,r?r instanceof pe?this.uniformGroup=r:this.uniformGroup=new pe(r):this.uniformGroup=new pe({}),this.disposeRunner=new ae("disposeShader")}checkUniformExists(t,r){if(r.uniforms[t])return!0;for(let i in r.uniforms){let n=r.uniforms[i];if(n.group&&this.checkUniformExists(t,n))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,r,i){let n=Ee.from(t,r);return new me(n,i)}};var No=class{constructor(t,r){if(this.vertexSrc=t,this.fragTemplate=r,this.programCache={},this.defaultGroupCache={},!r.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!r.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){let i=new Int32Array(t);for(let o=0;o<t;o++)i[o]=o;this.defaultGroupCache[t]=pe.from({uSamplers:i},!0);let n=this.fragTemplate;n=n.replace(/%count%/gi,`${t}`),n=n.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Ee(this.vertexSrc,n)}let r={tint:new Float32Array([1,1,1,1]),translationMatrix:new St,default:this.defaultGroupCache[t]};return new me(this.programCache[t],r)}generateSampleSrc(t){let r="";r+=`
`,r+=`
`;for(let i=0;i<t;i++)i>0&&(r+=`
else `),i<t-1&&(r+=`if(vTextureId < ${i}.5)`),r+=`
{`,r+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,r+=`
}`;return r+=`
`,r+=`
`,r}};var Zi=class{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}};function yg(){return!Ar.apple.device}function Tg(e){let t=!0,r=W.ADAPTER.getNavigator();if(Ar.tablet||Ar.phone){if(Ar.apple.device){let i=r.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(t=!1)}if(Ar.android.device){let i=r.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(t=!1)}}return t?e:4}var Ur=class{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}};var Eg=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`;var Sg=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;var Gr=class extends Ur{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=bn,this.vertexSize=6,this.state=de.for2d(),this.size=Gr.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??Tg(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??yg(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return gt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return Sg}static get defaultFragmentTemplate(){return Eg}setShaderGenerator({vertex:e=Gr.defaultVertexSrc,fragment:t=Gr.defaultFragmentTemplate}={}){this.shaderGenerator=new No(e,t)}contextChange(){let e=this.renderer.gl;W.PREFER_ENV===lr.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),Gr.defaultMaxTextures),this.maxTextures=Bh(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){let{_drawCallPool:e,_textureArrayPool:t}=Gr,r=this.size/4,i=Math.floor(r/this.maxTextures)+1;for(;e.length<r;)e.push(new $i);for(;t.length<i;)t.push(new Zi);for(let n=0;n<this.maxTextures;n++)this._tempBoundTextures[n]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){let{_bufferedTextures:e,maxTextures:t}=this,r=Gr._textureArrayPool,i=this.renderer.batch,n=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++ht._globalBatch,l=0,c=r[0],d=0;i.copyBoundTextures(n,t);for(let f=0;f<this._bufferSize;++f){let u=e[f];e[f]=null,u._batchEnabled!==a&&(c.count>=t&&(i.boundArray(c,n,a,t),this.buildDrawCalls(c,d,f),d=f,c=r[++l],++a),u._batchEnabled=a,u.touched=o,c.elements[c.count++]=u)}c.count>0&&(i.boundArray(c,n,a,t),this.buildDrawCalls(c,d,this._bufferSize),++l,++a);for(let f=0;f<n.length;f++)n[f]=null;ht._globalBatch=a}buildDrawCalls(e,t,r){let{_bufferedElements:i,_attributeBuffer:n,_indexBuffer:o,vertexSize:a}=this,l=Gr._drawCallPool,c=this._dcIndex,d=this._aIndex,f=this._iIndex,u=l[c];u.start=this._iIndex,u.texArray=e;for(let m=t;m<r;++m){let g=i[m],x=g._texture.baseTexture,y=Ro[x.alphaMode?1:0][g.blendMode];i[m]=null,t<m&&u.blend!==y&&(u.size=f-u.start,t=m,u=l[++c],u.texArray=e,u.start=f),this.packInterleavedGeometry(g,n,o,d,f),d+=g.vertexData.length/2*a,f+=g.indices.length,u.blend=y}t<r&&(u.size=f-u.start,++c),this._dcIndex=c,this._aIndex=d,this._iIndex=f}bindAndClearTexArray(e){let t=this.renderer.texture;for(let r=0;r<e.count;r++)t.bind(e.elements[r],e.ids[r]),e.elements[r]=null;e.count=0}updateGeometry(){let{_packedGeometries:e,_attributeBuffer:t,_indexBuffer:r}=this;Gr.canUploadSameBuffer?(e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){let e=this._dcIndex,{gl:t,state:r}=this.renderer,i=Gr._drawCallPool,n=null;for(let o=0;o<e;o++){let{texArray:a,type:l,size:c,start:d,blend:f}=i[o];n!==a&&(n=a,this.bindAndClearTexArray(a)),this.state.blendMode=f,r.set(this.state),t.drawElements(l,c,t.UNSIGNED_SHORT,d*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Gr.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){let t=Xi(Math.ceil(e/8)),r=Po(t),i=t*8;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new Yi(i*this.vertexSize*4)),n}getIndexBuffer(e){let t=Xi(Math.ceil(e/12)),r=Po(t),i=t*12;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n}packInterleavedGeometry(e,t,r,i,n){let{uint32View:o,float32View:a}=t,l=i/this.vertexSize,c=e.uvs,d=e.indices,f=e.vertexData,u=e._texture.baseTexture._batchLocation,m=Math.min(e.worldAlpha,1),g=pt.shared.setValue(e._tintRGB).toPremultiplied(m);for(let x=0;x<f.length;x+=2)a[i++]=f[x],a[i++]=f[x+1],a[i++]=c[x],a[i++]=c[x+1],o[i++]=g,a[i++]=u;for(let x=0;x<d.length;x++)r[n++]=l+d[x]}},dr=Gr;dr.defaultBatchSize=4096;dr.extension={name:"batch",type:z.RendererPlugin};dr._drawCallPool=[];dr._textureArrayPool=[];q.add(dr);var wg=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`;var bg=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;var Uo=class extends me{constructor(e,t,r){let i=Ee.from(e||Uo.defaultVertexSrc,t||Uo.defaultFragmentSrc);super(i,r),this.padding=0,this.resolution=Uo.defaultResolution,this.multisample=Uo.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new de}apply(e,t,r,i,n){e.applyFilter(this,t,r,i)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return bg}static get defaultFragmentSrc(){return wg}},Wt=Uo;Wt.defaultResolution=1;Wt.defaultMultisample=Lt.NONE;var vi=class{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new pt(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;let{backgroundColor:r,background:i,backgroundAlpha:n}=t,o=i??r;o!==void 0&&(this.color=o),this.alpha=n}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}};vi.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};vi.extension={type:[z.RendererSystem,z.CanvasRendererSystem],name:"background"};q.add(vi);var ws=class{constructor(t){this.renderer=t,this.emptyRenderer=new Ur(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,r){let{boundTextures:i}=this.renderer.texture;for(let n=r-1;n>=0;--n)t[n]=i[n]||null,t[n]&&(t[n]._batchLocation=n)}boundArray(t,r,i,n){let{elements:o,ids:a,count:l}=t,c=0;for(let d=0;d<l;d++){let f=o[d],u=f._batchLocation;if(u>=0&&u<n&&r[u]===f){a[d]=u;continue}for(;c<n;){let m=r[c];if(m&&m._batchEnabled===i&&m._batchLocation===c){c++;continue}a[d]=c,f._batchLocation=c,r[c]=f;break}}}destroy(){this.renderer=null}};ws.extension={type:z.RendererSystem,name:"batch"};q.add(ws);var Ag=0,yi=class{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Ag++}init(t){if(t.context)this.initFromContext(t.context);else{let r=this.renderer.background.alpha<1,i=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:r,premultipliedAlpha:i,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Ag++,this.renderer.runners.contextChange.emit(t);let r=this.renderer.view;r.addEventListener!==void 0&&(r.addEventListener("webglcontextlost",this.handleContextLost,!1),r.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){let r=this.createContext(this.renderer.view,t);this.initFromContext(r)}createContext(t,r){let i;if(W.PREFER_ENV>=lr.WEBGL2&&(i=t.getContext("webgl2",r)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=t.getContext("webgl",r)||t.getContext("experimental-webgl",r),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){let{gl:t}=this,r={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,r,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,r,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){let t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){let r=t.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),r&&!r.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");let n=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}};yi.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"};yi.extension={type:z.RendererSystem,name:"context"};q.add(yi);var Wh=class extends Qe{upload(t,r,i){let n=t.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===ue.UNPACK);let o=r.realWidth,a=r.realHeight;return i.width===o&&i.height===a?n.texSubImage2D(r.target,0,0,0,o,a,r.format,i.type,this.data):(i.width=o,i.height=a,n.texImage2D(r.target,0,i.internalFormat,o,a,0,r.format,i.type,this.data)),!0}};var qi=class{constructor(t,r){this.width=Math.round(t||100),this.height=Math.round(r||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ae("disposeFramebuffer"),this.multisample=Lt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,r){return this.colorTextures[t]=r||new ht(null,{scaleMode:br.NEAREST,resolution:1,mipmap:we.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new ht(new Wh(null,{width:this.width,height:this.height}),{scaleMode:br.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:we.OFF,format:tt.DEPTH_COMPONENT,type:at.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,r){if(t=Math.round(t),r=Math.round(r),!(t===this.width&&r===this.height)){this.width=t,this.height=r,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){let n=this.colorTextures[i],o=n.resolution;n.setSize(t/o,r/o)}if(this.depthTexture){let i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,r/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}};var Ln=class extends ht{constructor(t={}){if(typeof t=="number"){let r=arguments[0],i=arguments[1],n=arguments[2],o=arguments[3];t={width:r,height:i,scaleMode:n,resolution:o}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=Lt.NONE),super(null,t),this.mipmap=we.OFF,this.valid=!0,this._clear=new pt([0,0,0,0]),this.framebuffer=new qi(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}resize(t,r){this.framebuffer.resize(t*this.resolution,r*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}};var be=class extends fr{constructor(t){let r=t,i=r.naturalWidth||r.videoWidth||r.width,n=r.naturalHeight||r.videoHeight||r.height;super(i,n),this.source=t,this.noSubImage=!1}static crossOrigin(t,r,i){i===void 0&&!r.startsWith("data:")?t.crossOrigin=Mh(r):i!==!1&&(t.crossOrigin=typeof i=="string"?i:"anonymous")}upload(t,r,i,n){let o=t.gl,a=r.realWidth,l=r.realHeight;if(n=n||this.source,typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement){if(!n.complete||n.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement&&n.readyState<=1&&n.buffered.length===0)return!1;return o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===ue.UNPACK),!this.noSubImage&&r.target===o.TEXTURE_2D&&i.width===a&&i.height===l?o.texSubImage2D(o.TEXTURE_2D,0,0,0,r.format,i.type,n):(i.width=a,i.height=l,o.texImage2D(r.target,0,i.internalFormat,r.format,i.type,n)),!0}update(){if(this.destroyed)return;let t=this.source,r=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(r,i),super.update()}dispose(){this.source=null}};var Ji=class extends be{constructor(t,r){if(r=r||{},typeof t=="string"){let i=new Image;be.crossOrigin(i,t,r.crossorigin),i.src=t,t=i}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(r.createBitmap??W.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.bitmap=null,this._load=null,r.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((r,i)=>{let n=this.source;this.url=n.src;let o=()=>{this.destroyed||(n.onload=null,n.onerror=null,this.resize(n.width,n.height),this._load=null,this.createBitmap?r(this.process()):r(this))};n.complete&&n.src?o():(n.onload=o,n.onerror=a=>{i(a),this.onError.emit(a)})}),this._load)}process(){let t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);let r=globalThis.createImageBitmap,i=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:i?"cors":"no-cors"}).then(n=>n.blob()).then(n=>r(n,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ue.UNPACK?"premultiply":"none"})).then(n=>this.destroyed?Promise.reject():(this.bitmap=n,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,r,i){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,r,i,this.bitmap),!this.preserveBitmap){let n=!0,o=r._glTextures;for(let a in o){let l=o[a];if(l!==i&&l.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}};var bs=class{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,r,i){let n=r.width,o=r.height;if(i){let a=t.width/2/n,l=t.height/2/o,c=t.x/n+a,d=t.y/o+l;i=Zt.add(i,Zt.NW),this.x0=c+a*Zt.uX(i),this.y0=d+l*Zt.uY(i),i=Zt.add(i,2),this.x1=c+a*Zt.uX(i),this.y1=d+l*Zt.uY(i),i=Zt.add(i,2),this.x2=c+a*Zt.uX(i),this.y2=d+l*Zt.uY(i),i=Zt.add(i,2),this.x3=c+a*Zt.uX(i),this.y3=d+l*Zt.uY(i)}else this.x0=t.x/n,this.y0=t.y/o,this.x1=(t.x+t.width)/n,this.y1=t.y/o,this.x2=(t.x+t.width)/n,this.y2=(t.y+t.height)/o,this.x3=t.x/n,this.y3=(t.y+t.height)/o;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}};var Cg=new bs;function Xh(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}var it=class extends zi.default{constructor(t,r,i,n,o,a,l){if(super(),this.noFrame=!1,r||(this.noFrame=!0,r=new ut(0,0,1,1)),t instanceof it&&(t=t.baseTexture),this.baseTexture=t,this._frame=r,this.trim=n,this.valid=!1,this._uvs=Cg,this.uvMatrix=null,this.orig=i||r,this._rotate=Number(o||0),o===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new dt(a.x,a.y):new dt(0,0),this.defaultBorders=l,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=r:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){let{resource:r}=this.baseTexture;r?.url&&Te[r.url]&&it.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,it.removeFromCache(this),this.textureCacheIds=null}clone(){let t=this._frame.clone(),r=this._frame===this.orig?t:this.orig.clone(),i=new it(this.baseTexture,!this.noFrame&&t,r,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=t),i}updateUvs(){this._uvs===Cg&&(this._uvs=new bs),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,r={},i=W.STRICT_TEXTURE_CACHE){let n=typeof t=="string",o=null;if(n)o=t;else if(t instanceof ht){if(!t.cacheId){let l=r?.pixiIdPrefix||"pixiid";t.cacheId=`${l}-${ti()}`,ht.addToCache(t,t.cacheId)}o=t.cacheId}else{if(!t._pixiId){let l=r?.pixiIdPrefix||"pixiid";t._pixiId=`${l}_${ti()}`}o=t._pixiId}let a=Te[o];if(n&&i&&!a)throw new Error(`The cacheId "${o}" does not exist in TextureCache.`);return!a&&!(t instanceof ht)?(r.resolution||(r.resolution=Bo(t)),a=new it(new ht(t,r)),a.baseTexture.cacheId=o,ht.addToCache(a.baseTexture,o),it.addToCache(a,o)):!a&&t instanceof ht&&(a=new it(t),it.addToCache(a,o)),a}static fromURL(t,r){let i=Object.assign({autoLoad:!1},r?.resourceOptions),n=it.from(t,Object.assign({resourceOptions:i},r),!1),o=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):o.load().then(()=>Promise.resolve(n))}static fromBuffer(t,r,i,n){return new it(ht.fromBuffer(t,r,i,n))}static fromLoader(t,r,i,n){let o=new ht(t,Object.assign({scaleMode:ht.defaultOptions.scaleMode,resolution:Bo(r)},n)),{resource:a}=o;a instanceof Ji&&(a.url=r);let l=new it(o);return i||(i=r),ht.addToCache(l.baseTexture,i),it.addToCache(l,i),i!==r&&(ht.addToCache(l.baseTexture,r),it.addToCache(l,r)),l.baseTexture.valid?Promise.resolve(l):new Promise(c=>{l.baseTexture.once("loaded",()=>c(l))})}static addToCache(t,r){r&&(t.textureCacheIds.includes(r)||t.textureCacheIds.push(r),Te[r]&&Te[r]!==t&&console.warn(`Texture added to the cache with an id [${r}] that already had an entry`),Te[r]=t)}static removeFromCache(t){if(typeof t=="string"){let r=Te[t];if(r){let i=r.textureCacheIds.indexOf(t);return i>-1&&r.textureCacheIds.splice(i,1),delete Te[t],r}}else if(t?.textureCacheIds){for(let r=0;r<t.textureCacheIds.length;++r)Te[t.textureCacheIds[r]]===t&&delete Te[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;let{x:r,y:i,width:n,height:o}=t,a=r+n>this.baseTexture.width,l=i+o>this.baseTexture.height;if(a||l){let c=a&&l?"and":"or",d=`X: ${r} + ${n} = ${r+n} > ${this.baseTexture.width}`,f=`Y: ${i} + ${o} = ${i+o} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${d} ${c} ${f}`)}this.valid=n&&o&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return it._EMPTY||(it._EMPTY=new it(new ht),Xh(it._EMPTY),Xh(it._EMPTY.baseTexture)),it._EMPTY}static get WHITE(){if(!it._WHITE){let t=W.ADAPTER.createCanvas(16,16),r=t.getContext("2d");t.width=16,t.height=16,r.fillStyle="white",r.fillRect(0,0,16,16),it._WHITE=new it(ht.from(t)),Xh(it._WHITE),Xh(it._WHITE.baseTexture)}return it._WHITE}};var He=class extends it{constructor(t,r){super(t,r),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,r,i=!0){let n=this.baseTexture.resolution,o=Math.round(t*n)/n,a=Math.round(r*n)/n;this.valid=o>0&&a>0,this._frame.width=this.orig.width=o,this._frame.height=this.orig.height=a,i&&this.baseTexture.resize(o,a),this.updateUvs()}setResolution(t){let{baseTexture:r}=this;r.resolution!==t&&(r.setResolution(t),this.resize(r.width,r.height,!1))}static create(t){return new He(new Ln(t))}};var As=class{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,r,i=Lt.NONE){let n=new Ln(Object.assign({width:t,height:r,resolution:1,multisample:i},this.textureOptions));return new He(n)}getOptimalTexture(t,r,i=1,n=Lt.NONE){let o;t=Math.ceil(t*i-1e-6),r=Math.ceil(r*i-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||r!==this._pixelsHeight?(t=Xi(t),r=Xi(r),o=((t&65535)<<16|r&65535)>>>0,n>1&&(o+=n*4294967296)):o=n>1?-n:-1,this.texturePool[o]||(this.texturePool[o]=[]);let a=this.texturePool[o].pop();return a||(a=this.createTexture(t,r,n)),a.filterPoolKey=o,a.setResolution(i),a}getFilterTexture(t,r,i){let n=this.getOptimalTexture(t.width,t.height,r||t.resolution,i||Lt.NONE);return n.filterFrame=t.filterFrame,n}returnTexture(t){let r=t.filterPoolKey;t.filterFrame=null,this.texturePool[r].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(let r in this.texturePool){let i=this.texturePool[r];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(let r in this.texturePool){if(!(Number(r)<0))continue;let i=this.texturePool[r];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0);this.texturePool[r]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}};As.SCREEN_KEY=-1;var Go=class extends Me{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}};var Fn=class extends Me{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Gt(this.vertices),this.uvBuffer=new Gt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,r){let i=0,n=0;return this.uvs[0]=i,this.uvs[1]=n,this.uvs[2]=i+r.width/t.width,this.uvs[3]=n,this.uvs[4]=i+r.width/t.width,this.uvs[5]=n+r.height/t.height,this.uvs[6]=i,this.uvs[7]=n+r.height/t.height,i=r.x,n=r.y,this.vertices[0]=i,this.vertices[1]=n,this.vertices[2]=i+r.width,this.vertices[3]=n,this.vertices[4]=i+r.width,this.vertices[5]=n+r.height,this.vertices[6]=i,this.vertices[7]=n+r.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}};var ko=class{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Lt.NONE,this.sourceFrame=new ut,this.destinationFrame=new ut,this.bindingSourceFrame=new ut,this.bindingDestinationFrame=new ut,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}};var zh=[new dt,new dt,new dt,new dt],Ec=new St,Cs=class{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new As,this.statePool=[],this.quad=new Go,this.quadUv=new Fn,this.tempRect=new ut,this.activeState={},this.globalUniforms=new pe({outputFrame:new ut,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,r){let i=this.renderer,n=this.defaultFilterStack,o=this.statePool.pop()||new ko,a=this.renderer.renderTexture,l=r[0].resolution,c=r[0].multisample,d=r[0].padding,f=r[0].autoFit,u=r[0].legacy??!0;for(let x=1;x<r.length;x++){let y=r[x];l=Math.min(l,y.resolution),c=Math.min(c,y.multisample),d=this.useMaxPadding?Math.max(d,y.padding):d+y.padding,f=f&&y.autoFit,u=u||(y.legacy??!0)}n.length===1&&(this.defaultFilterStack[0].renderTexture=a.current),n.push(o),o.resolution=l,o.multisample=c,o.legacy=u,o.target=t,o.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),o.sourceFrame.pad(d);let m=this.tempRect.copyFrom(a.sourceFrame);i.projection.transform&&this.transformAABB(Ec.copyFrom(i.projection.transform).invert(),m),f?(o.sourceFrame.fit(m),(o.sourceFrame.width<=0||o.sourceFrame.height<=0)&&(o.sourceFrame.width=0,o.sourceFrame.height=0)):o.sourceFrame.intersects(m)||(o.sourceFrame.width=0,o.sourceFrame.height=0),this.roundFrame(o.sourceFrame,a.current?a.current.resolution:i.resolution,a.sourceFrame,a.destinationFrame,i.projection.transform),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,l,c),o.filters=r,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;let g=this.tempRect;g.x=0,g.y=0,g.width=o.sourceFrame.width,g.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,o.bindingSourceFrame.copyFrom(a.sourceFrame),o.bindingDestinationFrame.copyFrom(a.destinationFrame),o.transform=i.projection.transform,i.projection.transform=null,a.bind(o.renderTexture,o.sourceFrame,g),i.framebuffer.clear(0,0,0,0)}pop(){let t=this.defaultFilterStack,r=t.pop(),i=r.filters;this.activeState=r;let n=this.globalUniforms.uniforms;n.outputFrame=r.sourceFrame,n.resolution=r.resolution;let o=n.inputSize,a=n.inputPixel,l=n.inputClamp;if(o[0]=r.destinationFrame.width,o[1]=r.destinationFrame.height,o[2]=1/o[0],o[3]=1/o[1],a[0]=Math.round(o[0]*r.resolution),a[1]=Math.round(o[1]*r.resolution),a[2]=1/a[0],a[3]=1/a[1],l[0]=.5*a[2],l[1]=.5*a[3],l[2]=r.sourceFrame.width*o[2]-.5*a[2],l[3]=r.sourceFrame.height*o[3]-.5*a[3],r.legacy){let d=n.filterArea;d[0]=r.destinationFrame.width,d[1]=r.destinationFrame.height,d[2]=r.sourceFrame.x,d[3]=r.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();let c=t[t.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,r.renderTexture,c.renderTexture,cr.BLEND,r),this.returnFilterTexture(r.renderTexture);else{let d=r.renderTexture,f=this.getOptimalFilterTexture(d.width,d.height,r.resolution);f.filterFrame=d.filterFrame;let u=0;for(u=0;u<i.length-1;++u){u===1&&r.multisample>1&&(f=this.getOptimalFilterTexture(d.width,d.height,r.resolution),f.filterFrame=d.filterFrame),i[u].apply(this,d,f,cr.CLEAR,r);let m=d;d=f,f=m}i[u].apply(this,d,c.renderTexture,cr.BLEND,r),u>1&&r.multisample>1&&this.returnFilterTexture(r.renderTexture),this.returnFilterTexture(d),this.returnFilterTexture(f)}r.clear(),this.statePool.push(r)}bindAndClear(t,r=cr.CLEAR){let{renderTexture:i,state:n}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t?.filterFrame){let a=this.tempRect;a.x=0,a.y=0,a.width=t.filterFrame.width,a.height=t.filterFrame.height,i.bind(t,t.filterFrame,a)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);let o=n.stateId&1||this.forceClear;(r===cr.CLEAR||r===cr.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,r,i,n){let o=this.renderer;o.state.set(t.state),this.bindAndClear(i,n),t.uniforms.uSampler=r,t.uniforms.filterGlobals=this.globalUniforms,o.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(r._frame,r.filterFrame),o.geometry.bind(this.quadUv),o.geometry.draw(qe.TRIANGLES)):(o.geometry.bind(this.quad),o.geometry.draw(qe.TRIANGLE_STRIP))}calculateSpriteMatrix(t,r){let{sourceFrame:i,destinationFrame:n}=this.activeState,{orig:o}=r._texture,a=t.set(n.width,0,0,n.height,i.x,i.y),l=r.worldTransform.copyTo(St.TEMP_MATRIX);return l.invert(),a.prepend(l),a.scale(1/o.width,1/o.height),a.translate(r.anchor.x,r.anchor.y),a}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,r,i=1,n=Lt.NONE){return this.texturePool.getOptimalTexture(t,r,i,n)}getFilterTexture(t,r,i){if(typeof t=="number"){let o=t;t=r,r=o}t=t||this.activeState.renderTexture;let n=this.texturePool.getOptimalTexture(t.width,t.height,r||t.resolution,i||Lt.NONE);return n.filterFrame=t.filterFrame,n}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,r){let i=zh[0],n=zh[1],o=zh[2],a=zh[3];i.set(r.left,r.top),n.set(r.left,r.bottom),o.set(r.right,r.top),a.set(r.right,r.bottom),t.apply(i,i),t.apply(n,n),t.apply(o,o),t.apply(a,a);let l=Math.min(i.x,n.x,o.x,a.x),c=Math.min(i.y,n.y,o.y,a.y),d=Math.max(i.x,n.x,o.x,a.x),f=Math.max(i.y,n.y,o.y,a.y);r.x=l,r.y=c,r.width=d-l,r.height=f-c}roundFrame(t,r,i,n,o){if(!(t.width<=0||t.height<=0||i.width<=0||i.height<=0)){if(o){let{a,b:l,c,d}=o;if((Math.abs(l)>1e-4||Math.abs(c)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(d)>1e-4))return}o=o?Ec.copyFrom(o):Ec.identity(),o.translate(-i.x,-i.y).scale(n.width/i.width,n.height/i.height).translate(n.x,n.y),this.transformAABB(o,t),t.ceil(r),this.transformAABB(o.invert(),t)}}};Cs.extension={type:z.RendererSystem,name:"filter"};q.add(Cs);var Ho=class{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Lt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}};var Iw=new ut,Rs=class{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new qi(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);let t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new ut,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let r=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;W.PREFER_ENV===lr.WEBGL_LEGACY&&(r=null,i=null),r?t.drawBuffers=n=>r.drawBuffersWEBGL(n):(this.hasMRT=!1,t.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,r,i=0){let{gl:n}=this;if(t){let o=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,n.bindFramebuffer(n.FRAMEBUFFER,o.framebuffer)),o.mipLevel!==i&&(t.dirtyId++,t.dirtyFormat++,o.mipLevel=i),o.dirtyId!==t.dirtyId&&(o.dirtyId=t.dirtyId,o.dirtyFormat!==t.dirtyFormat?(o.dirtyFormat=t.dirtyFormat,o.dirtySize=t.dirtySize,this.updateFramebuffer(t,i)):o.dirtySize!==t.dirtySize&&(o.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let a=0;a<t.colorTextures.length;a++){let l=t.colorTextures[a];this.renderer.texture.unbind(l.parentTextureArray||l)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),r){let a=r.width>>i,l=r.height>>i,c=a/r.width;this.setViewport(r.x*c,r.y*c,a,l)}else{let a=t.width>>i,l=t.height>>i;this.setViewport(0,0,a,l)}}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,r,i,n){let o=this.viewport;t=Math.round(t),r=Math.round(r),i=Math.round(i),n=Math.round(n),(o.width!==i||o.height!==n||o.x!==t||o.y!==r)&&(o.x=t,o.y=r,o.width=i,o.height=n,this.gl.viewport(t,r,i,n))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,r,i,n,o=ph.COLOR|ph.DEPTH){let{gl:a}=this;a.clearColor(t,r,i,n),a.clear(o)}initFramebuffer(t){let{gl:r}=this,i=new Ho(r.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i}resizeFramebuffer(t){let{gl:r}=this,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(r.bindRenderbuffer(r.RENDERBUFFER,i.stencil),i.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,r.DEPTH24_STENCIL8,t.width,t.height):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,t.width,t.height));let n=t.colorTextures,o=n.length;r.drawBuffers||(o=Math.min(o,1));for(let a=0;a<o;a++){let l=n[a],c=l.parentTextureArray||l;this.renderer.texture.bind(c,0),a===0&&i.msaaBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,i.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,r){let{gl:i}=this,n=t.glFramebuffers[this.CONTEXT_UID],o=t.colorTextures,a=o.length;i.drawBuffers||(a=Math.min(a,1)),n.multisample>1&&this.canMultisampleFramebuffer(t)?n.msaaBuffer=n.msaaBuffer||i.createRenderbuffer():n.msaaBuffer&&(i.deleteRenderbuffer(n.msaaBuffer),n.msaaBuffer=null,n.blitFramebuffer&&(n.blitFramebuffer.dispose(),n.blitFramebuffer=null));let l=[];for(let c=0;c<a;c++){let d=o[c],f=d.parentTextureArray||d;this.renderer.texture.bind(f,0),c===0&&n.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,n.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,f._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,n.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+c,d.target,f._glTextures[this.CONTEXT_UID].texture,r),l.push(i.COLOR_ATTACHMENT0+c))}if(l.length>1&&i.drawBuffers(l),t.depthTexture&&this.writeDepthTexture){let d=t.depthTexture;this.renderer.texture.bind(d,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,d._glTextures[this.CONTEXT_UID].texture,r)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(n.stencil=n.stencil||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,n.stencil),n.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,i.DEPTH24_STENCIL8,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,n.stencil)):n.stencil&&(i.deleteRenderbuffer(n.stencil),n.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){let{msaaSamples:r}=this,i=Lt.NONE;if(t<=1||r===null)return i;for(let n=0;n<r.length;n++)if(r[n]<=t){i=r[n];break}return i===1&&(i=Lt.NONE),i}blit(t,r,i){let{current:n,renderer:o,gl:a,CONTEXT_UID:l}=this;if(o.context.webGLVersion!==2||!n)return;let c=n.glFramebuffers[l];if(!c)return;if(!t){if(!c.msaaBuffer)return;let f=n.colorTextures[0];if(!f)return;c.blitFramebuffer||(c.blitFramebuffer=new qi(n.width,n.height),c.blitFramebuffer.addColorTexture(0,f)),t=c.blitFramebuffer,t.colorTextures[0]!==f&&(t.colorTextures[0]=f,t.dirtyId++,t.dirtyFormat++),(t.width!==n.width||t.height!==n.height)&&(t.width=n.width,t.height=n.height,t.dirtyId++,t.dirtySize++)}r||(r=Iw,r.width=n.width,r.height=n.height),i||(i=r);let d=r.width===i.width&&r.height===i.height;this.bind(t),a.bindFramebuffer(a.READ_FRAMEBUFFER,c.framebuffer),a.blitFramebuffer(r.left,r.top,r.right,r.bottom,i.left,i.top,i.right,i.bottom,a.COLOR_BUFFER_BIT,d?a.NEAREST:a.LINEAR)}disposeFramebuffer(t,r){let i=t.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(!i)return;delete t.glFramebuffers[this.CONTEXT_UID];let o=this.managedFramebuffers.indexOf(t);o>=0&&this.managedFramebuffers.splice(o,1),t.disposeRunner.remove(this),r||(n.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&n.deleteRenderbuffer(i.msaaBuffer),i.stencil&&n.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,r)}disposeAll(t){let r=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<r.length;i++)this.disposeFramebuffer(r[i],t)}forceStencil(){let t=this.current;if(!t)return;let r=t.glFramebuffers[this.CONTEXT_UID];if(!r||r.stencil)return;t.stencil=!0;let i=t.width,n=t.height,o=this.gl,a=o.createRenderbuffer();o.bindRenderbuffer(o.RENDERBUFFER,a),r.msaaBuffer?o.renderbufferStorageMultisample(o.RENDERBUFFER,r.multisample,o.DEPTH24_STENCIL8,i,n):o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,i,n),r.stencil=a,o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,a)}reset(){this.current=this.unknownFramebuffer,this.viewport=new ut}destroy(){this.renderer=null}};Rs.extension={type:z.RendererSystem,name:"framebuffer"};q.add(Rs);var Sc={5126:4,5123:2,5121:1},Is=class{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);let t=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;W.PREFER_ENV===lr.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=()=>i.createVertexArrayOES(),t.bindVertexArray=n=>i.bindVertexArrayOES(n),t.deleteVertexArray=n=>i.deleteVertexArrayOES(n)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(r.webGLVersion!==2){let i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=(n,o)=>i.vertexAttribDivisorANGLE(n,o),t.drawElementsInstanced=(n,o,a,l,c)=>i.drawElementsInstancedANGLE(n,o,a,l,c),t.drawArraysInstanced=(n,o,a,l)=>i.drawArraysInstancedANGLE(n,o,a,l)):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex}bind(t,r){r=r||this.renderer.shader.shader;let{gl:i}=this,n=t.glVertexArrayObjects[this.CONTEXT_UID],o=!1;n||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=n={},o=!0);let a=n[r.program.id]||this.initGeometryVao(t,r,o);this._activeGeometry=t,this._activeVao!==a&&(this._activeVao=a,this.hasVao?i.bindVertexArray(a):this.activateVao(t,r.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){let t=this._activeGeometry,r=this.renderer.buffer;for(let i=0;i<t.buffers.length;i++){let n=t.buffers[i];r.update(n)}}checkCompatibility(t,r){let i=t.attributes,n=r.attributeData;for(let o in n)if(!i[o])throw new Error(`shader and geometry incompatible, geometry missing the "${o}" attribute`)}getSignature(t,r){let i=t.attributes,n=r.attributeData,o=["g",t.id];for(let a in i)n[a]&&o.push(a,n[a].location);return o.join("-")}initGeometryVao(t,r,i=!0){let n=this.gl,o=this.CONTEXT_UID,a=this.renderer.buffer,l=r.program;l.glPrograms[o]||this.renderer.shader.generateProgram(r),this.checkCompatibility(t,l);let c=this.getSignature(t,l),d=t.glVertexArrayObjects[this.CONTEXT_UID],f=d[c];if(f)return d[l.id]=f,f;let u=t.buffers,m=t.attributes,g={},x={};for(let y in u)g[y]=0,x[y]=0;for(let y in m)!m[y].size&&l.attributeData[y]?m[y].size=l.attributeData[y].size:m[y].size||console.warn(`PIXI Geometry attribute '${y}' size cannot be determined (likely the bound shader does not have the attribute)`),g[m[y].buffer]+=m[y].size*Sc[m[y].type];for(let y in m){let S=m[y],b=S.size;S.stride===void 0&&(g[S.buffer]===b*Sc[S.type]?S.stride=0:S.stride=g[S.buffer]),S.start===void 0&&(S.start=x[S.buffer],x[S.buffer]+=b*Sc[S.type])}f=n.createVertexArray(),n.bindVertexArray(f);for(let y=0;y<u.length;y++){let S=u[y];a.bind(S),i&&S._glBuffers[o].refCount++}return this.activateVao(t,l),d[l.id]=f,d[c]=f,n.bindVertexArray(null),a.unbind(Je.ARRAY_BUFFER),f}disposeGeometry(t,r){if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];let i=t.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,o=t.buffers,a=this.renderer?.buffer;if(t.disposeRunner.remove(this),!!i){if(a)for(let l=0;l<o.length;l++){let c=o[l]._glBuffers[this.CONTEXT_UID];c&&(c.refCount--,c.refCount===0&&!r&&a.dispose(o[l],r))}if(!r){for(let l in i)if(l[0]==="g"){let c=i[l];this._activeVao===c&&this.unbind(),n.deleteVertexArray(c)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){let r=Object.keys(this.managedGeometries);for(let i=0;i<r.length;i++)this.disposeGeometry(this.managedGeometries[r[i]],t)}activateVao(t,r){let i=this.gl,n=this.CONTEXT_UID,o=this.renderer.buffer,a=t.buffers,l=t.attributes;t.indexBuffer&&o.bind(t.indexBuffer);let c=null;for(let d in l){let f=l[d],u=a[f.buffer],m=u._glBuffers[n];if(r.attributeData[d]){c!==m&&(o.bind(u),c=m);let g=r.attributeData[d].location;if(i.enableVertexAttribArray(g),i.vertexAttribPointer(g,f.size,f.type||i.FLOAT,f.normalized,f.stride,f.start),f.instance)if(this.hasInstance)i.vertexAttribDivisor(g,f.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,r,i,n){let{gl:o}=this,a=this._activeGeometry;if(a.indexBuffer){let l=a.indexBuffer.data.BYTES_PER_ELEMENT,c=l===2?o.UNSIGNED_SHORT:o.UNSIGNED_INT;l===2||l===4&&this.canUseUInt32ElementIndex?a.instanced?o.drawElementsInstanced(t,r||a.indexBuffer.data.length,c,(i||0)*l,n||1):o.drawElements(t,r||a.indexBuffer.data.length,c,(i||0)*l):console.warn("unsupported index buffer type: uint32")}else a.instanced?o.drawArraysInstanced(t,i,r||a.getSize(),n||1):o.drawArrays(t,i,r||a.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}};Is.extension={type:z.RendererSystem,name:"geometry"};q.add(Is);var Rg=new St,Qi=class{constructor(t,r){this._texture=t,this.mapCoord=new St,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof r>"u"?.5:r,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,r){r===void 0&&(r=t);let i=this.mapCoord;for(let n=0;n<t.length;n+=2){let o=t[n],a=t[n+1];r[n]=o*i.a+a*i.c+i.tx,r[n+1]=o*i.b+a*i.d+i.ty}return r}update(t){let r=this._texture;if(!r||!r.valid||!t&&this._textureID===r._updateID)return!1;this._textureID=r._updateID,this._updateID++;let i=r._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);let n=r.orig,o=r.trim;o&&(Rg.set(n.width/o.width,0,0,n.height/o.height,-o.x/o.width,-o.y/o.height),this.mapCoord.append(Rg));let a=r.baseTexture,l=this.uClampFrame,c=this.clampMargin/a.resolution,d=this.clampOffset;return l[0]=(r._frame.x+c+d)/a.width,l[1]=(r._frame.y+c+d)/a.height,l[2]=(r._frame.x+r._frame.width-c+d)/a.width,l[3]=(r._frame.y+r._frame.height-c+d)/a.height,this.uClampOffset[0]=d/a.realWidth,this.uClampOffset[1]=d/a.realHeight,this.isSimple=r._frame.width===a.width&&r._frame.height===a.height&&r.rotate===0,!0}};var Ig=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`;var Pg=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;var Vo=class extends Wt{constructor(t,r,i){let n=null;typeof t!="string"&&r===void 0&&i===void 0&&(n=t,t=void 0,r=void 0,i=void 0),super(t||Pg,r||Ig,i),this.maskSprite=n,this.maskMatrix=new St}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,r,i,n){let o=this._maskSprite,a=o._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new Qi(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,o).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=o.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,t.applyFilter(this,r,i,n))}};var Wo=class{constructor(t=null){this.type=ie.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Wt.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=ie.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}};var Ps=class{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,r){let i=r;if(!i.isMaskData){let o=this.maskDataPool.pop()||new Wo;o.pooled=!0,o.maskObject=r,i=o}let n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(n),i._colorMask=n?n._colorMask:15,i.autoDetect&&this.detect(i),i._target=t,i.type!==ie.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case ie.SCISSOR:this.renderer.scissor.push(i);break;case ie.STENCIL:this.renderer.stencil.push(i);break;case ie.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case ie.COLOR:this.pushColorMask(i);break;default:break}i.type===ie.SPRITE&&this.maskStack.push(i)}pop(t){let r=this.maskStack.pop();if(!(!r||r._target!==t)){if(r.enabled)switch(r.type){case ie.SCISSOR:this.renderer.scissor.pop(r);break;case ie.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case ie.SPRITE:this.popSpriteMask(r);break;case ie.COLOR:this.popColorMask(r);break;default:break}if(r.reset(),r.pooled&&this.maskDataPool.push(r),this.maskStack.length!==0){let i=this.maskStack[this.maskStack.length-1];i.type===ie.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(t){let r=t.maskObject;r?r.isSprite?t.type=ie.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=ie.SCISSOR:t.type=ie.STENCIL:t.type=ie.COLOR}pushSpriteMask(t){let{maskObject:r}=t,i=t._target,n=t._filters;n||(n=this.alphaMaskPool[this.alphaMaskIndex],n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new Vo]));let o=this.renderer,a=o.renderTexture,l,c;if(a.current){let f=a.current;l=t.resolution||f.resolution,c=t.multisample??f.multisample}else l=t.resolution||o.resolution,c=t.multisample??o.multisample;n[0].resolution=l,n[0].multisample=c,n[0].maskSprite=r;let d=i.filterArea;i.filterArea=r.getBounds(!0),o.filter.push(i,n),i.filterArea=d,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){let r=t._colorMask,i=t._colorMask=r&t.colorMask;i!==r&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(t){let r=t._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==r&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}};Ps.extension={type:z.RendererSystem,name:"mask"};q.add(Ps);var Ms=class{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){let{gl:r}=this.renderer,i=this.getStackLength();this.maskStack=t;let n=this.getStackLength();n!==i&&(n===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}};var Mg=new St,Bg=[],Yh=class extends Ms{constructor(e){super(e),this.glConst=W.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){let e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;let t=e._scissorRect,{maskObject:r}=e,{renderer:i}=this,n=i.renderTexture,o=r.getBounds(!0,Bg.pop()??new ut);this.roundFrameToPixels(o,n.current?n.current.resolution:i.resolution,n.sourceFrame,n.destinationFrame,i.projection.transform),t&&o.fit(t),e._scissorRectLocal=o}static isMatrixRotated(e){if(!e)return!1;let{a:t,b:r,c:i,d:n}=e;return(Math.abs(r)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(n)>1e-4)}testScissor(e){let{maskObject:t}=e;if(!t.isFastRect||!t.isFastRect()||Yh.isMatrixRotated(t.worldTransform)||Yh.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);let r=e._scissorRectLocal;return r.width>0&&r.height>0}roundFrameToPixels(e,t,r,i,n){Yh.isMatrixRotated(n)||(n=n?Mg.copyFrom(n):Mg.identity(),n.translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.renderer.filter.transformAABB(n,e),e.fit(i),e.x=Math.round(e.x*t),e.y=Math.round(e.y*t),e.width=Math.round(e.width*t),e.height=Math.round(e.height*t))}push(e){e._scissorRectLocal||this.calcScissorRect(e);let{gl:t}=this.renderer;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){let{gl:t}=this.renderer;e&&Bg.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){let e=this.maskStack[this.maskStack.length-1]._scissorRect,t;this.renderer.renderTexture.current?t=e.y:t=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}},$h=Yh;$h.extension={type:z.RendererSystem,name:"scissor"};q.add($h);var Bs=class extends Ms{constructor(t){super(t),this.glConst=W.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){let t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){let r=t.maskObject,{gl:i}=this.renderer,n=t._stencilCounter;n===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),t._stencilCounter++;let o=t._colorMask;o!==0&&(t._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,n,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,o!==0&&(t._colorMask=o,i.colorMask((o&1)!==0,(o&2)!==0,(o&4)!==0,(o&8)!==0)),this._useCurrent()}pop(t){let r=this.renderer.gl;if(this.getStackLength()===0)r.disable(r.STENCIL_TEST);else{let i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,n=i?i._colorMask:15;n!==0&&(i._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilOp(r.KEEP,r.KEEP,r.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,n!==0&&(i._colorMask=n,r.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}}_useCurrent(){let t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}};Bs.extension={type:z.RendererSystem,name:"stencil"};q.add(Bs);var Ds=class{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return gt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return gt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return gt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){let t=this.rendererPlugins;for(let r in t)this.plugins[r]=new t[r](this.renderer)}destroy(){for(let t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}};Ds.extension={type:[z.RendererSystem,z.CanvasRendererSystem],name:"_plugin"};q.add(Ds);var Ls=class{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new St,this.transform=null}update(t,r,i,n){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,n),this.transform&&this.projectionMatrix.append(this.transform);let o=this.renderer;o.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,o.globalUniforms.update(),o.shader.shader&&o.shader.syncUniformGroup(o.shader.shader.uniforms.globals)}calculateProjection(t,r,i,n){let o=this.projectionMatrix,a=n?-1:1;o.identity(),o.a=1/r.width*2,o.d=a*(1/r.height*2),o.tx=-1-r.x*o.a,o.ty=-a-r.y*o.d}setTransform(t){}destroy(){this.renderer=null}};Ls.extension={type:z.RendererSystem,name:"projection"};q.add(Ls);var Pw=new Dn,Fs=class{constructor(t){this.renderer=t,this._tempMatrix=new St}generateTexture(t,r){let{region:i,...n}=r||{},o=i||t.getLocalBounds(null,!0);o.width===0&&(o.width=1),o.height===0&&(o.height=1);let a=He.create({width:o.width,height:o.height,...n});this._tempMatrix.tx=-o.x,this._tempMatrix.ty=-o.y;let l=t.transform;return t.transform=Pw,this.renderer.render(t,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=l,a}destroy(){}};Fs.extension={type:[z.RendererSystem,z.CanvasRendererSystem],name:"textureGenerator"};q.add(Fs);var On=new ut,Xo=new ut,Os=class{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new ut,this.destinationFrame=new ut,this.viewportFrame=new ut}bind(t=null,r,i){let n=this.renderer;this.current=t;let o,a,l;t?(o=t.baseTexture,l=o.resolution,r||(On.width=t.frame.width,On.height=t.frame.height,r=On),i||(Xo.x=t.frame.x,Xo.y=t.frame.y,Xo.width=r.width,Xo.height=r.height,i=Xo),a=o.framebuffer):(l=n.resolution,r||(On.width=n._view.screen.width,On.height=n._view.screen.height,r=On),i||(i=On,i.width=r.width,i.height=r.height));let c=this.viewportFrame;c.x=i.x*l,c.y=i.y*l,c.width=i.width*l,c.height=i.height*l,t||(c.y=n.view.height-(c.y+c.height)),c.ceil(),this.renderer.framebuffer.bind(a,c),this.renderer.projection.update(i,r,l,!a),t?this.renderer.mask.setMaskStack(o.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(i)}clear(t,r){let i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,n=t?pt.shared.setValue(t):i,o=this.destinationFrame,a=this.current?this.current.baseTexture:this.renderer._view.screen,l=o.width!==a.width||o.height!==a.height;if(l){let{x:c,y:d,width:f,height:u}=this.viewportFrame;c=Math.round(c),d=Math.round(d),f=Math.round(f),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(c,d,f,u)}this.renderer.framebuffer.clear(n.red,n.green,n.blue,n.alpha,r),l&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}};Os.extension={type:z.RendererSystem,name:"renderTexture"};q.add(Os);var zo=class{constructor(t,r){this.program=t,this.uniformData=r,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}};function Dg(e,t){let r={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let n=0;n<i;n++){let o=t.getActiveAttrib(e,n);if(o.name.startsWith("gl_"))continue;let a=Fo(t,o.type),l={type:a,name:o.name,size:Lo(a),location:t.getAttribLocation(e,o.name)};r[o.name]=l}return r}function Lg(e,t){let r={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let n=0;n<i;n++){let o=t.getActiveUniform(e,n),a=o.name.replace(/\[.*?\]$/,""),l=!!o.name.match(/\[.*?\]$/),c=Fo(t,o.type);r[a]={name:a,index:n,type:c,size:o.size,isArray:l,value:Do(c,o.size)}}return r}function wc(e,t){let r=Fh(e,e.VERTEX_SHADER,t.vertexSrc),i=Fh(e,e.FRAGMENT_SHADER,t.fragmentSrc),n=e.createProgram();e.attachShader(n,r),e.attachShader(n,i);let o=t.extra?.transformFeedbackVaryings;if(o&&(typeof e.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):e.transformFeedbackVaryings(n,o.names,o.bufferMode==="separate"?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS)),e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS)||Tc(e,n,r,i),t.attributeData=Dg(n,e),t.uniformData=Lg(n,e),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){let c=Object.keys(t.attributeData);c.sort((d,f)=>d>f?1:-1);for(let d=0;d<c.length;d++)t.attributeData[c[d]].location=d,e.bindAttribLocation(n,d,c[d]);e.linkProgram(n)}e.deleteShader(r),e.deleteShader(i);let a={};for(let c in t.uniformData){let d=t.uniformData[c];a[c]={location:e.getUniformLocation(n,c),value:Do(d.type,d.size)}}return new zo(n,a)}function Mw(e,t,r,i,n){r.buffer.update(n)}var Bw={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Fg={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function Og(e){let t=e.map(o=>({data:o,offset:0,dataLen:0,dirty:0})),r=0,i=0,n=0;for(let o=0;o<t.length;o++){let a=t[o];if(r=Fg[a.data.type],a.data.size>1&&(r=Math.max(r,16)*a.data.size),a.dataLen=r,i%r!==0&&i<16){let l=i%r%16;i+=l,n+=l}i+r>16?(n=Math.ceil(n/16)*16,a.offset=n,n+=r,i=r):(a.offset=n,i+=r,n+=r)}return n=Math.ceil(n/16)*16,{uboElements:t,size:n}}function Ng(e,t){let r=[];for(let i in e)t[i]&&r.push(t[i]);return r.sort((i,n)=>i.index-n.index),r}function bc(e,t){if(!e.autoManage)return{size:0,syncFunc:Mw};let r=Ng(e.uniforms,t),{uboElements:i,size:n}=Og(r),o=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let a=0;a<i.length;a++){let l=i[a],c=e.uniforms[l.data.name],d=l.data.name,f=!1;for(let u=0;u<ei.length;u++){let m=ei[u];if(m.codeUbo&&m.test(l.data,c)){o.push(`offset = ${l.offset/4};`,ei[u].codeUbo(l.data.name,c)),f=!0;break}}if(!f)if(l.data.size>1){let u=Lo(l.data.type),m=Math.max(Fg[l.data.type]/16,1),g=u/m,x=(4-g%4)%4;o.push(`
                cv = ud.${d}.value;
                v = uv.${d};
                offset = ${l.offset/4};

                t = 0;

                for(var i=0; i < ${l.data.size*m}; i++)
                {
                    for(var j = 0; j < ${g}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${x};
                }

                `)}else{let u=Bw[l.data.type];o.push(`
                cv = ud.${d}.value;
                v = uv.${d};
                offset = ${l.offset/4};
                ${u};
                `)}}return o.push(`
       renderer.buffer.update(buffer);
    `),{size:n,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join(`
`))}}var Dw=0,jh={textureCount:0,uboCount:0},Ns=class{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=Dw++}systemCheck(){if(!Hh())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,r){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;let i=t.program,n=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(n.program)),r||(jh.textureCount=0,jh.uboCount=0,this.syncUniformGroup(t.uniformGroup,jh)),n}setUniforms(t){let r=this.shader.program,i=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(i.uniformData,t,this.renderer)}syncUniformGroup(t,r){let i=this.getGlProgram();(!t.static||t.dirtyId!==i.uniformDirtyGroups[t.id])&&(i.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,r))}syncUniforms(t,r,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(r.uniformData,t.uniforms,this.renderer,i)}createSyncGroups(t){let r=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[r]||(this.cache[r]=vc(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[r],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,r){let i=this.getGlProgram();if(!t.static||t.dirtyId!==0||!i.uniformGroups[t.id]){t.dirtyId=0;let n=i.uniformGroups[t.id]||this.createSyncBufferGroup(t,i,r);t.buffer.update(),n(i.uniformData,t.uniforms,this.renderer,jh,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,i.uniformBufferBindings[r])}createSyncBufferGroup(t,r,i){let{gl:n}=this.renderer;this.renderer.buffer.bind(t.buffer);let o=this.gl.getUniformBlockIndex(r.program,i);r.uniformBufferBindings[i]=this.shader.uniformBindCount,n.uniformBlockBinding(r.program,o,this.shader.uniformBindCount),this.shader.uniformBindCount++;let a=this.getSignature(t,this.shader.program.uniformData,"ubo"),l=this._uboCache[a];if(l||(l=this._uboCache[a]=bc(t,this.shader.program.uniformData)),t.autoManage){let c=new Float32Array(l.size/4);t.buffer.update(c)}return r.uniformGroups[t.id]=l.syncFunc,r.uniformGroups[t.id]}getSignature(t,r,i){let n=t.uniforms,o=[`${i}-`];for(let a in n)o.push(a),r[a]&&o.push(r[a].type);return o.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){let r=this.gl,i=t.program,n=wc(r,i);return i.glPrograms[this.renderer.CONTEXT_UID]=n,n}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}};Ns.extension={type:z.RendererSystem,name:"shader"};q.add(Ns);var Ti=class{constructor(t){this.renderer=t}run(t){let{renderer:r}=this;r.runners.init.emit(r.options),t.hello&&console.log(`PixiJS 7.2.2 - ${r.rendererLogId} - https://pixijs.com`),r.resize(r.screen.width,r.screen.height)}destroy(){}};Ti.defaultOptions={hello:!1};Ti.extension={type:[z.RendererSystem,z.CanvasRendererSystem],name:"startup"};q.add(Ti);function Ug(e,t=[]){return t[ft.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.ADD]=[e.ONE,e.ONE],t[ft.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.NONE]=[0,0],t[ft.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[ft.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[ft.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[ft.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[ft.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[ft.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[ft.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[ft.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[ft.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[ft.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}var Lw=0,Fw=1,Ow=2,Nw=3,Uw=4,Gw=5,Ac=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=ft.NONE,this._blendEq=!1,this.map=[],this.map[Lw]=this.setBlend,this.map[Fw]=this.setOffset,this.map[Ow]=this.setCullFace,this.map[Nw]=this.setDepthTest,this.map[Uw]=this.setFrontFace,this.map[Gw]=this.setDepthMask,this.checks=[],this.defaultState=new de,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=Ug(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,r=0;for(;t;)t&1&&this.map[r].call(this,!!(e.data&1<<r)),t=t>>1,r++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(Ac.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(Ac.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;let t=this.blendModes[e],r=this.gl;t.length===2?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){let r=this.checks.indexOf(e);t&&r===-1?this.checks.push(e):!t&&r!==-1&&this.checks.splice(r,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}},Kh=Ac;Kh.extension={type:z.RendererSystem,name:"state"};q.add(Kh);var Us=class extends zi.default{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);let r=(t.priority??[]).filter(n=>t.systems[n]),i=[...r,...Object.keys(t.systems).filter(n=>!r.includes(n))];for(let n of i)this.addSystem(t.systems[n],n)}addRunners(...t){t.forEach(r=>{this.runners[r]=new ae(r)})}addSystem(t,r){let i=new t(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=i,this._systemsHash[r]=i;for(let n in this.runners)this.runners[n].add(i);return this}emitWithCustomOptions(t,r){let i=Object.keys(this._systemsHash);t.items.forEach(n=>{let o=i.find(a=>this._systemsHash[a]===n);n[t.name](r[o])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}};var Zh=class{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=Zh.defaultMaxIdle,this.checkCountMax=Zh.defaultCheckCountMax,this.mode=Zh.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==gh.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){let e=this.renderer.texture,t=e.managedTextures,r=!1;for(let i=0;i<t.length;i++){let n=t[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(e.destroyTexture(n,!0),t[i]=null,r=!0)}if(r){let i=0;for(let n=0;n<t.length;n++)t[n]!==null&&(t[i++]=t[n]);t.length=i}}unload(e){let t=this.renderer.texture,r=e._texture;r&&!r.framebuffer&&t.destroyTexture(r);for(let i=e.children.length-1;i>=0;i--)this.unload(e.children[i])}destroy(){this.renderer=null}},er=Zh;er.defaultMode=gh.AUTO;er.defaultMaxIdle=60*60;er.defaultCheckCountMax=60*10;er.extension={type:z.RendererSystem,name:"textureGC"};q.add(er);var Nn=class{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=at.UNSIGNED_BYTE,this.internalFormat=tt.RGBA,this.samplerType=0}};function Gg(e){let t;return"WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?t={[at.UNSIGNED_BYTE]:{[tt.RGBA]:e.RGBA8,[tt.RGB]:e.RGB8,[tt.RG]:e.RG8,[tt.RED]:e.R8,[tt.RGBA_INTEGER]:e.RGBA8UI,[tt.RGB_INTEGER]:e.RGB8UI,[tt.RG_INTEGER]:e.RG8UI,[tt.RED_INTEGER]:e.R8UI,[tt.ALPHA]:e.ALPHA,[tt.LUMINANCE]:e.LUMINANCE,[tt.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[at.BYTE]:{[tt.RGBA]:e.RGBA8_SNORM,[tt.RGB]:e.RGB8_SNORM,[tt.RG]:e.RG8_SNORM,[tt.RED]:e.R8_SNORM,[tt.RGBA_INTEGER]:e.RGBA8I,[tt.RGB_INTEGER]:e.RGB8I,[tt.RG_INTEGER]:e.RG8I,[tt.RED_INTEGER]:e.R8I},[at.UNSIGNED_SHORT]:{[tt.RGBA_INTEGER]:e.RGBA16UI,[tt.RGB_INTEGER]:e.RGB16UI,[tt.RG_INTEGER]:e.RG16UI,[tt.RED_INTEGER]:e.R16UI,[tt.DEPTH_COMPONENT]:e.DEPTH_COMPONENT16},[at.SHORT]:{[tt.RGBA_INTEGER]:e.RGBA16I,[tt.RGB_INTEGER]:e.RGB16I,[tt.RG_INTEGER]:e.RG16I,[tt.RED_INTEGER]:e.R16I},[at.UNSIGNED_INT]:{[tt.RGBA_INTEGER]:e.RGBA32UI,[tt.RGB_INTEGER]:e.RGB32UI,[tt.RG_INTEGER]:e.RG32UI,[tt.RED_INTEGER]:e.R32UI,[tt.DEPTH_COMPONENT]:e.DEPTH_COMPONENT24},[at.INT]:{[tt.RGBA_INTEGER]:e.RGBA32I,[tt.RGB_INTEGER]:e.RGB32I,[tt.RG_INTEGER]:e.RG32I,[tt.RED_INTEGER]:e.R32I},[at.FLOAT]:{[tt.RGBA]:e.RGBA32F,[tt.RGB]:e.RGB32F,[tt.RG]:e.RG32F,[tt.RED]:e.R32F,[tt.DEPTH_COMPONENT]:e.DEPTH_COMPONENT32F},[at.HALF_FLOAT]:{[tt.RGBA]:e.RGBA16F,[tt.RGB]:e.RGB16F,[tt.RG]:e.RG16F,[tt.RED]:e.R16F},[at.UNSIGNED_SHORT_5_6_5]:{[tt.RGB]:e.RGB565},[at.UNSIGNED_SHORT_4_4_4_4]:{[tt.RGBA]:e.RGBA4},[at.UNSIGNED_SHORT_5_5_5_1]:{[tt.RGBA]:e.RGB5_A1},[at.UNSIGNED_INT_2_10_10_10_REV]:{[tt.RGBA]:e.RGB10_A2,[tt.RGBA_INTEGER]:e.RGB10_A2UI},[at.UNSIGNED_INT_10F_11F_11F_REV]:{[tt.RGB]:e.R11F_G11F_B10F},[at.UNSIGNED_INT_5_9_9_9_REV]:{[tt.RGB]:e.RGB9_E5},[at.UNSIGNED_INT_24_8]:{[tt.DEPTH_STENCIL]:e.DEPTH24_STENCIL8},[at.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[tt.DEPTH_STENCIL]:e.DEPTH32F_STENCIL8}}:t={[at.UNSIGNED_BYTE]:{[tt.RGBA]:e.RGBA,[tt.RGB]:e.RGB,[tt.ALPHA]:e.ALPHA,[tt.LUMINANCE]:e.LUMINANCE,[tt.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[at.UNSIGNED_SHORT_5_6_5]:{[tt.RGB]:e.RGB},[at.UNSIGNED_SHORT_4_4_4_4]:{[tt.RGBA]:e.RGBA},[at.UNSIGNED_SHORT_5_5_5_1]:{[tt.RGBA]:e.RGBA}},t}var Gs=class{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new ht,this.hasIntegerTextures=!1}contextChange(){let t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=Gg(t);let r=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(let n=0;n<r;n++)this.boundTextures[n]=null;this.emptyTextures={};let i=new Nn(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Nn(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let n=0;n<this.boundTextures.length;n++)this.bind(null,n)}bind(t,r=0){let{gl:i}=this;if(t=t?.castToBaseTexture(),t?.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;let n=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[r]!==t&&(this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),i.bindTexture(t.target,n.texture)),n.dirtyId!==t.dirtyId?(this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),this.updateTexture(t)):n.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[r]=t}else this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[r]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){let{gl:r,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let n=0;n<i.length;n++)i[n]===this.unknownTexture&&this.bind(null,n)}for(let n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(r.activeTexture(r.TEXTURE0+n),this.currentLocation=n),r.bindTexture(t.target,this.emptyTextures[t.target].texture),i[n]=null)}ensureSamplerType(t){let{boundTextures:r,hasIntegerTextures:i,CONTEXT_UID:n}=this;if(i)for(let o=t-1;o>=0;--o){let a=r[o];a&&a._glTextures[n].samplerType!==mh.FLOAT&&this.renderer.texture.unbind(a)}}initTexture(t){let r=new Nn(this.gl.createTexture());return r.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),r}initTextureType(t,r){r.internalFormat=this.internalFormats[t.type]?.[t.format]??t.format,this.webGLVersion===2&&t.type===at.HALF_FLOAT?r.type=this.gl.HALF_FLOAT:r.type=t.type}updateTexture(t){let r=t._glTextures[this.CONTEXT_UID];if(!r)return;let i=this.renderer;if(this.initTextureType(t,r),t.resource?.upload(i,t,r))r.samplerType!==mh.FLOAT&&(this.hasIntegerTextures=!0);else{let n=t.realWidth,o=t.realHeight,a=i.gl;(r.width!==n||r.height!==o||r.dirtyId<0)&&(r.width=n,r.height=o,a.texImage2D(t.target,0,r.internalFormat,n,o,0,t.format,r.type,null))}t.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(t),r.dirtyId=t.dirtyId}destroyTexture(t,r){let{gl:i}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!r)){let n=this.managedTextures.indexOf(t);n!==-1&&Ch(this.managedTextures,n,1)}}updateTextureStyle(t){let r=t._glTextures[this.CONTEXT_UID];r&&((t.mipmap===we.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?r.mipmap=!1:r.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?r.wrapMode=ur.CLAMP:r.wrapMode=t.wrapMode,t.resource?.style(this.renderer,t,r)||this.setStyle(t,r),r.dirtyStyleId=t.dirtyStyleId)}setStyle(t,r){let i=this.gl;if(r.mipmap&&t.mipmap!==we.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,r.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===br.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);let n=this.renderer.context.extensions.anisotropicFiltering;if(n&&t.anisotropicLevel>0&&t.scaleMode===br.LINEAR){let o=Math.min(t.anisotropicLevel,i.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,n.TEXTURE_MAX_ANISOTROPY_EXT,o)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===br.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===br.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}};Gs.extension={type:z.RendererSystem,name:"texture"};q.add(Gs);var ks=class{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){let{gl:r,CONTEXT_UID:i}=this,n=t._glTransformFeedbacks[i]||this.createGLTransformFeedback(t);r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,n)}unbind(){let{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,r){let{gl:i,renderer:n}=this;r&&n.shader.bind(r),i.beginTransformFeedback(t)}endTransformFeedback(){let{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){let{gl:r,renderer:i,CONTEXT_UID:n}=this,o=r.createTransformFeedback();t._glTransformFeedbacks[n]=o,r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,o);for(let a=0;a<t.buffers.length;a++){let l=t.buffers[a];l&&(i.buffer.update(l),l._glBuffers[n].refCount++,r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,a,l._glBuffers[n].buffer||null))}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),o}disposeTransformFeedback(t,r){let i=t._glTransformFeedbacks[this.CONTEXT_UID],n=this.gl;t.disposeRunner.remove(this);let o=this.renderer.buffer;if(o)for(let a=0;a<t.buffers.length;a++){let l=t.buffers[a];if(!l)continue;let c=l._glBuffers[this.CONTEXT_UID];c&&(c.refCount--,c.refCount===0&&!r&&o.dispose(l,r))}i&&(r||n.deleteTransformFeedback(i),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}};ks.extension={type:z.RendererSystem,name:"transformFeedback"};q.add(ks);var Ei=class{constructor(t){this.renderer=t}init(t){this.screen=new ut(0,0,t.width,t.height),this.element=t.view||W.ADAPTER.createCanvas(),this.resolution=t.resolution||W.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,r){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(r*this.resolution);let i=this.element.width/this.resolution,n=this.element.height/this.resolution;this.screen.width=i,this.screen.height=n,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${n}px`),this.renderer.emit("resize",i,n),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){t&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}};Ei.defaultOptions={width:800,height:600,resolution:W.RESOLUTION,autoDensity:!1};Ei.extension={type:[z.RendererSystem,z.CanvasRendererSystem],name:"_view"};q.add(Ei);W.PREFER_ENV=lr.WEBGL2;W.STRICT_TEXTURE_CACHE=!1;W.RENDER_OPTIONS={...yi.defaultOptions,...vi.defaultOptions,...Ei.defaultOptions,...Ti.defaultOptions};Object.defineProperties(W,{WRAP_MODE:{get(){return ht.defaultOptions.wrapMode},set(e){gt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),ht.defaultOptions.wrapMode=e}},SCALE_MODE:{get(){return ht.defaultOptions.scaleMode},set(e){gt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),ht.defaultOptions.scaleMode=e}},MIPMAP_TEXTURES:{get(){return ht.defaultOptions.mipmap},set(e){gt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),ht.defaultOptions.mipmap=e}},ANISOTROPIC_LEVEL:{get(){return ht.defaultOptions.anisotropicLevel},set(e){gt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),ht.defaultOptions.anisotropicLevel=e}},FILTER_RESOLUTION:{get(){return gt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Wt.defaultResolution},set(e){Wt.defaultResolution=e}},FILTER_MULTISAMPLE:{get(){return gt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Wt.defaultMultisample},set(e){Wt.defaultMultisample=e}},SPRITE_MAX_TEXTURES:{get(){return dr.defaultMaxTextures},set(e){gt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),dr.defaultMaxTextures=e}},SPRITE_BATCH_SIZE:{get(){return dr.defaultBatchSize},set(e){gt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),dr.defaultBatchSize=e}},CAN_UPLOAD_SAME_BUFFER:{get(){return dr.canUploadSameBuffer},set(e){gt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),dr.canUploadSameBuffer=e}},GC_MODE:{get(){return er.defaultMode},set(e){gt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),er.defaultMode=e}},GC_MAX_IDLE:{get(){return er.defaultMaxIdle},set(e){gt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),er.defaultMaxIdle=e}},GC_MAX_CHECK_COUNT:{get(){return er.defaultCheckCountMax},set(e){gt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),er.defaultCheckCountMax=e}},PRECISION_VERTEX:{get(){return Ee.defaultVertexPrecision},set(e){gt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Ee.defaultVertexPrecision=e}},PRECISION_FRAGMENT:{get(){return Ee.defaultFragmentPrecision},set(e){gt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Ee.defaultFragmentPrecision=e}}});var pr=(e=>(e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e))(pr||{});var Hs=class{constructor(t,r=null,i=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=r,this.priority=i,this.once=n}match(t,r=null){return this.fn===t&&this.context===r}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));let r=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);let r=this.next;return this.next=t?null:r,this.previous=null,r}};var mr=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Hs(null,null,1/0),this.deltaMS=1/mr.targetFPMS,this.elapsedMS=1/mr.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,r=pr.NORMAL){return this._addListener(new Hs(e,t,r))}addOnce(e,t,r=pr.NORMAL){return this._addListener(new Hs(e,t,r,!0))}_addListener(e){let t=this._head.next,r=this._head;if(!t)e.connect(r);else{for(;t;){if(e.priority>t.priority){e.connect(r);break}r=t,t=t.next}e.previous||e.connect(r)}return this._startIfPossible(),this}remove(e,t){let r=this._head.next;for(;r;)r.match(e,t)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){let n=e-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=e-n%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*mr.targetFPMS;let r=this._head,i=r.next;for(;i;)i=i.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){let t=Math.min(this.maxFPS,e),r=Math.min(Math.max(0,t)/1e3,mr.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{let t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!mr._shared){let e=mr._shared=new mr;e.autoStart=!0,e._protected=!0}return mr._shared}static get system(){if(!mr._system){let e=mr._system=new mr;e.autoStart=!0,e._protected=!0}return mr._system}},ee=mr;ee.targetFPMS=.06;Object.defineProperties(W,{TARGET_FPMS:{get(){return ee.targetFPMS},set(e){gt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),ee.targetFPMS=e}}});var Yo=class{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,pr.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?ee.shared:new ee,t.autoStart&&this.start()}static destroy(){if(this._ticker){let t=this._ticker;this.ticker=null,t.destroy()}}};Yo.extension=z.Application;q.add(Yo);var kg=[];q.handleByList(z.Renderer,kg);function Cc(e){for(let t of kg)if(t.test(e))return new t(e);throw new Error("Unable to auto-detect a suitable renderer.")}var Hg=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`;var Vg=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;var Rc=Hg,$o=Vg;var jo=class{constructor(t){this.renderer=t}contextChange(t){let r;if(this.renderer.context.webGLVersion===1){let i=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),r=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,i)}else{let i=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),r=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,i)}r>=Lt.HIGH?this.multisample=Lt.HIGH:r>=Lt.MEDIUM?this.multisample=Lt.MEDIUM:r>=Lt.LOW?this.multisample=Lt.LOW:this.multisample=Lt.NONE}destroy(){}};jo.extension={type:z.RendererSystem,name:"_multisample"};q.add(jo);var qh=class{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}};var Ko=class{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){let{gl:r,CONTEXT_UID:i}=this,n=t._glBuffers[i]||this.createGLBuffer(t);r.bindBuffer(t.type,n.buffer)}unbind(t){let{gl:r}=this;r.bindBuffer(t,null)}bindBufferBase(t,r){let{gl:i,CONTEXT_UID:n}=this;if(this.boundBufferBases[r]!==t){let o=t._glBuffers[n]||this.createGLBuffer(t);this.boundBufferBases[r]=t,i.bindBufferBase(i.UNIFORM_BUFFER,r,o.buffer)}}bindBufferRange(t,r,i){let{gl:n,CONTEXT_UID:o}=this;i=i||0;let a=t._glBuffers[o]||this.createGLBuffer(t);n.bindBufferRange(n.UNIFORM_BUFFER,r||0,a.buffer,i*256,256)}update(t){let{gl:r,CONTEXT_UID:i}=this,n=t._glBuffers[i]||this.createGLBuffer(t);if(t._updateID!==n.updateID)if(n.updateID=t._updateID,r.bindBuffer(t.type,n.buffer),n.byteLength>=t.data.byteLength)r.bufferSubData(t.type,0,t.data);else{let o=t.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;n.byteLength=t.data.byteLength,r.bufferData(t.type,t.data,o)}}dispose(t,r){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];let i=t._glBuffers[this.CONTEXT_UID],n=this.gl;t.disposeRunner.remove(this),i&&(r||n.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){let r=Object.keys(this.managedBuffers);for(let i=0;i<r.length;i++)this.dispose(this.managedBuffers[r[i]],t)}createGLBuffer(t){let{CONTEXT_UID:r,gl:i}=this;return t._glBuffers[r]=new qh(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[r]}};Ko.extension={type:z.RendererSystem,name:"buffer"};q.add(Ko);var Zo=class{constructor(t){this.renderer=t}render(t,r){let i=this.renderer,n,o,a,l;if(r&&(n=r.renderTexture,o=r.clear,a=r.transform,l=r.skipUpdateTransform),this.renderingToScreen=!n,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=a,!i.context.isLost){if(n||(this.lastObjectRendered=t),!l){let c=t.enableTempParent();t.updateTransform(),t.disableTempParent(c)}i.renderTexture.bind(n),i.batch.currentRenderer.start(),(o??i.background.clearBeforeRender)&&i.renderTexture.clear(),t.render(i),i.batch.currentRenderer.flush(),n&&(r.blit&&i.framebuffer.blit(),n.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}};Zo.extension={type:z.RendererSystem,name:"objectRenderer"};q.add(Zo);var Ic=class extends Us{constructor(e){super(),this.type=Wu.WEBGL,e=Object.assign({},W.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new pe({projectionMatrix:new St},!0);let t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Ic.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in e&&(gt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=Ic.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e?.forceCanvas?!1:wh()}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return gt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return gt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return gt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return gt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){gt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return gt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){gt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return gt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}},Un=Ic;Un.extension={type:z.Renderer,priority:1};Un.__plugins={};Un.__systems={};q.handleByMap(z.RendererPlugin,Un.__plugins);q.handleByMap(z.RendererSystem,Un.__systems);q.add(Un);var tn=class extends fr{constructor(t,r){let{width:i,height:n}=r||{};super(i,n),this.items=[],this.itemDirtyIds=[];for(let o=0;o<t;o++){let a=new ht;this.items.push(a),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,r){for(let i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof fr?this.addResourceAt(t[i],i):this.addResourceAt(Ts(t[i],r),i))}dispose(){for(let t=0,r=this.length;t<r;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,r){if(!this.items[r])throw new Error(`Index ${r} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[r].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=t,this.items[r].on("update",t.update,t)}unbind(t){super.unbind(t);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",t.update,t)}load(){if(this._load)return this._load;let r=this.items.map(i=>i.resource).filter(i=>i).map(i=>i.load());return this._load=Promise.all(r).then(()=>{let{realWidth:i,realHeight:n}=this.items[0];return this.resize(i,n),Promise.resolve(this)}),this._load}};var Vs=class extends tn{constructor(t,r){let{width:i,height:n}=r||{},o,a;Array.isArray(t)?(o=t,a=t.length):a=t,super(a,{width:i,height:n}),o&&this.initFromArray(o,r)}addBaseTextureAt(t,r){if(t.resource)this.addResourceAt(t.resource,r);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=gi.TEXTURE_2D_ARRAY}upload(t,r,i){let{length:n,itemDirtyIds:o,items:a}=this,{gl:l}=t;i.dirtyId<0&&l.texImage3D(l.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,n,0,r.format,i.type,null);for(let c=0;c<n;c++){let d=a[c];o[c]<d.dirtyId&&(o[c]=d.dirtyId,d.valid&&l.texSubImage3D(l.TEXTURE_2D_ARRAY,0,0,0,c,d.resource.width,d.resource.height,1,r.format,i.type,d.resource.source))}return!0}};var Ws=class extends be{constructor(t){super(t)}static test(t){let{OffscreenCanvas:r}=globalThis;return r&&t instanceof r?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}};var qo=class extends tn{constructor(e,t){let{width:r,height:i,autoLoad:n,linkBaseTexture:o}=t||{};if(e&&e.length!==qo.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:r,height:i});for(let a=0;a<qo.SIDES;a++)this.items[a].target=gi.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=o!==!1,e&&this.initFromArray(e,t),n!==!1&&this.load()}bind(e){super.bind(e),e.target=gi.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,r){if(r===void 0&&(r=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=gi.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(e,t,r){let i=this.itemDirtyIds;for(let n=0;n<qo.SIDES;n++){let o=this.items[n];(i[n]<o.dirtyId||r.dirtyId<t.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(e,o,r),i[n]=o.dirtyId):i[n]<-1&&(e.gl.texImage2D(o.target,0,r.internalFormat,t.realWidth,t.realHeight,0,t.format,r.type,null),i[n]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===qo.SIDES}},Jo=qo;Jo.SIDES=6;var kr=class extends be{constructor(t,r){r=r||{};let i,n;typeof t=="string"?(i=kr.EMPTY,n=t):(i=t,n=null),super(i),this.url=n,this.crossOrigin=r.crossOrigin??!0,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,r)=>{if(this.url===null){t(this);return}try{let i=await W.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;let n=await i.blob();if(this.destroyed)return;let o=await createImageBitmap(n,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ue.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=o,this.update(),t(this)}catch(i){if(this.destroyed)return;r(i),this.onError.emit(i)}}),this._load)}upload(t,r,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),super.upload(t,r,i)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return kr._EMPTY=kr._EMPTY??W.ADAPTER.createCanvas(0,0),kr._EMPTY}};var Jh=class extends be{constructor(e,t){t=t||{},super(W.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),e(this)},Jh.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){let e=new Image;be.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=t=>{this._resolve&&(e.onerror=null,this.onError.emit(t))},e.onload=()=>{if(!this._resolve)return;let t=e.width,r=e.height;if(!t||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=t*this.scale,n=r*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/r*t,n=this._overrideHeight||this._overrideWidth/t*r),i=Math.round(i),n=Math.round(n);let o=this.source;o.width=i,o.height=n,o._pixiId=`canvas_${ti()}`,o.getContext("2d").drawImage(e,0,0,t,r,0,0,i,n),this._resolve(),this._resolve=null}}static getSize(e){let t=Jh.SVG_SIZE.exec(e),r={};return t&&(r[t[1]]=Math.round(parseFloat(t[3])),r[t[5]]=Math.round(parseFloat(t[7]))),r}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,t){return t==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&Jh.SVG_XML.test(e)}},Si=Jh;Si.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;Si.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var Pc=class extends be{constructor(e,t){if(t=t||{},!(e instanceof HTMLVideoElement)){let r=document.createElement("video");r.setAttribute("preload","auto"),r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline",""),typeof e=="string"&&(e=[e]);let i=e[0].src||e[0];be.crossOrigin(r,i,t.crossorigin);for(let n=0;n<e.length;++n){let o=document.createElement("source"),{src:a,mime:l}=e[n];a=a||e[n];let c=a.split("?").shift().toLowerCase(),d=c.slice(c.lastIndexOf(".")+1);l=l||Pc.MIME_TYPES[d]||`video/${d}`,o.src=a,o.type=l,r.appendChild(o)}e=r}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){let t=ee.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;let e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)}_isSourcePlaying(){let e=this.source;return!e.paused&&!e.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(ee.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(ee.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){let e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);let t=this.valid;this.resize(e.videoWidth,e.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._isConnectedToTicker&&(ee.shared.remove(this.update,this),this._isConnectedToTicker=!1);let e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(ee.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(ee.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e)}static test(e,t){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||Pc.TYPES.includes(t)}},Xs=Pc;Xs.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];Xs.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};ys.push(kr,Ji,Ws,Xs,Si,Qe,Jo,Vs);var ri=class{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?ut.EMPTY:(t=t||new ut(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,r){let{a:i,b:n,c:o,d:a,tx:l,ty:c}=t,d=i*r.x+o*r.y+l,f=n*r.x+a*r.y+c;this.minX=Math.min(this.minX,d),this.maxX=Math.max(this.maxX,d),this.minY=Math.min(this.minY,f),this.maxY=Math.max(this.maxY,f)}addQuad(t){let r=this.minX,i=this.minY,n=this.maxX,o=this.maxY,a=t[0],l=t[1];r=a<r?a:r,i=l<i?l:i,n=a>n?a:n,o=l>o?l:o,a=t[2],l=t[3],r=a<r?a:r,i=l<i?l:i,n=a>n?a:n,o=l>o?l:o,a=t[4],l=t[5],r=a<r?a:r,i=l<i?l:i,n=a>n?a:n,o=l>o?l:o,a=t[6],l=t[7],r=a<r?a:r,i=l<i?l:i,n=a>n?a:n,o=l>o?l:o,this.minX=r,this.minY=i,this.maxX=n,this.maxY=o}addFrame(t,r,i,n,o){this.addFrameMatrix(t.worldTransform,r,i,n,o)}addFrameMatrix(t,r,i,n,o){let a=t.a,l=t.b,c=t.c,d=t.d,f=t.tx,u=t.ty,m=this.minX,g=this.minY,x=this.maxX,y=this.maxY,S=a*r+c*i+f,b=l*r+d*i+u;m=S<m?S:m,g=b<g?b:g,x=S>x?S:x,y=b>y?b:y,S=a*n+c*i+f,b=l*n+d*i+u,m=S<m?S:m,g=b<g?b:g,x=S>x?S:x,y=b>y?b:y,S=a*r+c*o+f,b=l*r+d*o+u,m=S<m?S:m,g=b<g?b:g,x=S>x?S:x,y=b>y?b:y,S=a*n+c*o+f,b=l*n+d*o+u,m=S<m?S:m,g=b<g?b:g,x=S>x?S:x,y=b>y?b:y,this.minX=m,this.minY=g,this.maxX=x,this.maxY=y}addVertexData(t,r,i){let n=this.minX,o=this.minY,a=this.maxX,l=this.maxY;for(let c=r;c<i;c+=2){let d=t[c],f=t[c+1];n=d<n?d:n,o=f<o?f:o,a=d>a?d:a,l=f>l?f:l}this.minX=n,this.minY=o,this.maxX=a,this.maxY=l}addVertices(t,r,i,n){this.addVerticesMatrix(t.worldTransform,r,i,n)}addVerticesMatrix(t,r,i,n,o=0,a=o){let l=t.a,c=t.b,d=t.c,f=t.d,u=t.tx,m=t.ty,g=this.minX,x=this.minY,y=this.maxX,S=this.maxY;for(let b=i;b<n;b+=2){let w=r[b],v=r[b+1],T=l*w+d*v+u,I=f*v+c*w+m;g=Math.min(g,T-o),y=Math.max(y,T+o),x=Math.min(x,I-a),S=Math.max(S,I+a)}this.minX=g,this.minY=x,this.maxX=y,this.maxY=S}addBounds(t){let r=this.minX,i=this.minY,n=this.maxX,o=this.maxY;this.minX=t.minX<r?t.minX:r,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>n?t.maxX:n,this.maxY=t.maxY>o?t.maxY:o}addBoundsMask(t,r){let i=t.minX>r.minX?t.minX:r.minX,n=t.minY>r.minY?t.minY:r.minY,o=t.maxX<r.maxX?t.maxX:r.maxX,a=t.maxY<r.maxY?t.maxY:r.maxY;if(i<=o&&n<=a){let l=this.minX,c=this.minY,d=this.maxX,f=this.maxY;this.minX=i<l?i:l,this.minY=n<c?n:c,this.maxX=o>d?o:d,this.maxY=a>f?a:f}}addBoundsMatrix(t,r){this.addFrameMatrix(r,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,r){let i=t.minX>r.x?t.minX:r.x,n=t.minY>r.y?t.minY:r.y,o=t.maxX<r.x+r.width?t.maxX:r.x+r.width,a=t.maxY<r.y+r.height?t.maxY:r.y+r.height;if(i<=o&&n<=a){let l=this.minX,c=this.minY,d=this.maxX,f=this.maxY;this.minX=i<l?i:l,this.minY=n<c?n:c,this.maxX=o>d?o:d,this.maxY=a>f?a:f}}pad(t=0,r=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=r,this.maxY+=r)}addFramePad(t,r,i,n,o,a){t-=o,r-=a,i+=o,n+=a,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<r?this.minY:r,this.maxY=this.maxY>n?this.maxY:n}};var Ft=class extends et.EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Dn,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new ri,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){let r=Object.keys(t);for(let i=0;i<r.length;++i){let n=r[i];Object.defineProperty(Ft.prototype,n,Object.getOwnPropertyDescriptor(t,n))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,r){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new ut),r=this._boundsRect),this._bounds.getRectangle(r)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new ut),t=this._localBoundsRect),this._localBounds||(this._localBounds=new ri);let r=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;let n=this._bounds,o=this._boundsID;this._bounds=this._localBounds;let a=this.getBounds(!1,t);return this.parent=i,this.transform=r,this._bounds=n,this._bounds.updateID+=this._boundsID-o,a}toGlobal(t,r,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,r)}toLocal(t,r,i,n){return r&&(t=r.toGlobal(t,i,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){this.parent?.removeChild(this)}setTransform(t=0,r=0,i=1,n=1,o=0,a=0,l=0,c=0,d=0){return this.position.x=t,this.position.y=r,this.scale.x=i||1,this.scale.y=n||1,this.rotation=o,this.skew.x=a,this.skew.y=l,this.pivot.x=c,this.pivot.y=d,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Qh),this.tempDisplayObjectParent}enableTempParent(){let t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*mc}set angle(t){this.transform.rotation=t*gc}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){let r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount--,r._maskRefCount===0&&(r.renderable=!0,r.isMask=!1))}if(this._mask=t,this._mask){let r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount===0&&(r.renderable=!1,r.isMask=!0),r._maskRefCount++)}}}},Qh=class extends Ft{constructor(){super(...arguments),this.sortDirty=null}};Ft.prototype.displayObjectUpdateTransform=Ft.prototype.updateTransform;var kw=new St;function Hw(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}var Mc=class extends Ft{constructor(){super(),this.children=[],this.sortableChildren=Mc.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.addChild(e[t]);else{let t=e[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return e[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}swapChildren(e,t){if(e===t)return;let r=this.getChildIndex(e),i=this.getChildIndex(t);this.children[r]=t,this.children[i]=e,this.onChildrenChange(r<i?r:i)}getChildIndex(e){let t=this.children.indexOf(e);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);let r=this.getChildIndex(e);et.removeItems(this.children,r,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.removeChild(e[t]);else{let t=e[0],r=this.children.indexOf(t);if(r===-1)return null;t.parent=null,t.transform._parentID=-1,et.removeItems(this.children,r,1),this._boundsID++,this.onChildrenChange(r),t.emit("removed",this),this.emit("childRemoved",t,this,r)}return e[0]}removeChildAt(e){let t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,et.removeItems(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}removeChildren(e=0,t=this.children.length){let r=e,i=t,n=i-r,o;if(n>0&&n<=i){o=this.children.splice(r,n);for(let a=0;a<o.length;++a)o[a].parent=null,o[a].transform&&(o[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let a=0;a<o.length;++a)o[a].emit("removed",this),this.emit("childRemoved",o[a],this,a);return o}else if(n===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let t=0,r=this.children.length;t<r;++t){let i=this.children[t];i._lastSortedIndex=t,!e&&i.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(Hw),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){let r=this.children[e];r.visible&&r.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){let t=this.children[e];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){let r=t._mask.isMaskData?t._mask.maskObject:t._mask;r?(r.calculateBounds(),this._bounds.addBoundsMask(t._bounds,r._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){let r=super.getLocalBounds(e);if(!t)for(let i=0,n=this.children.length;i<n;++i){let o=this.children[i];o.visible&&o.updateTransform()}return r}_calculateBounds(){}_renderWithCulling(e){let t=e.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let r,i;this.cullArea?(r=this.cullArea,i=this.worldTransform):this._render!==Mc.prototype._render&&(r=this.getBounds(!0));let n=e.projection.transform;if(n&&(i?(i=kw.copyFrom(i),i.prepend(n)):i=n),r&&t.intersects(r,i))this._render(e);else if(this.cullArea)return;for(let o=0,a=this.children.length;o<a;++o){let l=this.children[o],c=l.cullable;l.cullable=c||!this.cullArea,l.render(e),l.cullable=c}}render(e){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters?.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let t=0,r=this.children.length;t<r;++t)this.children[t].render(e)}}renderAdvanced(e){let t=this.filters,r=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let n=0;n<t.length;n++)t[n].enabled&&this._enabledFilters.push(t[n])}let i=t&&this._enabledFilters?.length||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==ie.NONE));if(i&&e.batch.flush(),t&&this._enabledFilters?.length&&e.filter.push(this,this._enabledFilters),r&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let n=0,o=this.children.length;n<o;++n)this.children[n].render(e)}i&&e.batch.flush(),r&&e.mask.pop(this),t&&this._enabledFilters?.length&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;let t=typeof e=="boolean"?e:e?.children,r=this.removeChildren(0,this.children.length);if(t)for(let i=0;i<r.length;++i)r[i].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){let t=this.getLocalBounds().width;t!==0?this.scale.x=e/t:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){let t=this.getLocalBounds().height;t!==0?this.scale.y=e/t:this.scale.y=1,this._height=e}},ne=Mc;ne.defaultSortableChildren=!1;ne.prototype.containerUpdateTransform=ne.prototype.updateTransform;Object.defineProperties(W,{SORTABLE_CHILDREN:{get(){return ne.defaultSortableChildren},set(e){et.deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),ne.defaultSortableChildren=e}}});var Qo=new dt,Vw=new Uint16Array([0,1,2,0,2,3]),Be=class extends ne{constructor(t){super(),this._anchor=new tr(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new pt(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=ft.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||it.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=Vw,this.pluginName="batch",this.isSprite=!0,this._roundPixels=W.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=et.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=et.sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){let t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;let r=this.transform.worldTransform,i=r.a,n=r.b,o=r.c,a=r.d,l=r.tx,c=r.ty,d=this.vertexData,f=t.trim,u=t.orig,m=this._anchor,g=0,x=0,y=0,S=0;if(f?(x=f.x-m._x*u.width,g=x+f.width,S=f.y-m._y*u.height,y=S+f.height):(x=-m._x*u.width,g=x+u.width,S=-m._y*u.height,y=S+u.height),d[0]=i*x+o*S+l,d[1]=a*S+n*x+c,d[2]=i*g+o*S+l,d[3]=a*S+n*g+c,d[4]=i*g+o*y+l,d[5]=a*y+n*g+c,d[6]=i*x+o*y+l,d[7]=a*y+n*x+c,this._roundPixels){let b=W.RESOLUTION;for(let w=0;w<d.length;++w)d[w]=Math.round(d[w]*b)/b}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;let t=this._texture,r=this.vertexTrimmedData,i=t.orig,n=this._anchor,o=this.transform.worldTransform,a=o.a,l=o.b,c=o.c,d=o.d,f=o.tx,u=o.ty,m=-n._x*i.width,g=m+i.width,x=-n._y*i.height,y=x+i.height;r[0]=a*m+c*x+f,r[1]=d*x+l*m+u,r[2]=a*g+c*x+f,r[3]=d*x+l*g+u,r[4]=a*g+c*y+f,r[5]=d*y+l*g+u,r[6]=a*m+c*y+f,r[7]=d*y+l*m+u}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){let t=this._texture.trim,r=this._texture.orig;!t||t.width===r.width&&t.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new ri),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new ut),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Qo);let r=this._texture.orig.width,i=this._texture.orig.height,n=-r*this.anchor.x,o=0;return Qo.x>=n&&Qo.x<n+r&&(o=-i*this.anchor.y,Qo.y>=o&&Qo.y<o+i)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t?.texture){let i=typeof t=="boolean"?t:t?.baseTexture;this._texture.destroy(!!i)}this._texture=null}static from(t,r){let i=t instanceof it?t:it.from(t,r);return new Be(i)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){let r=et.sign(this.scale.x)||1;this.scale.x=r*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){let r=et.sign(this.scale.y)||1;this.scale.y=r*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||it.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}};var Wg=new St;Ft.prototype._cacheAsBitmap=!1;Ft.prototype._cacheData=null;Ft.prototype._cacheAsBitmapResolution=null;Ft.prototype._cacheAsBitmapMultisample=null;var Bc=class{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}};Object.defineProperties(Ft.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(e){e!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(e){e!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(e){if(this._cacheAsBitmap===e)return;this._cacheAsBitmap=e;let t;e?(this._cacheData||(this._cacheData=new Bc),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});Ft.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};Ft.prototype._initCachedDisplayObject=function(t){if(this._cacheData?.sprite)return;let r=this.alpha;this.alpha=1,t.batch.flush();let i=this.getLocalBounds(null,!0).clone();if(this.filters?.length){let m=this.filters[0].padding;i.pad(m)}i.ceil(W.RESOLUTION);let n=t.renderTexture.current,o=t.renderTexture.sourceFrame.clone(),a=t.renderTexture.destinationFrame.clone(),l=t.projection.transform,c=He.create({width:i.width,height:i.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:this.cacheAsBitmapMultisample??t.multisample}),d=`cacheAsBitmap_${et.uid()}`;this._cacheData.textureCacheId=d,ht.addToCache(c.baseTexture,d),it.addToCache(c,d);let f=this.transform.localTransform.copyTo(Wg).invert().translate(-i.x,-i.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:c,clear:!0,transform:f,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=l,t.renderTexture.bind(n,o,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;let u=new Be(c);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(i.x/i.width),u.anchor.y=-(i.y/i.height),u.alpha=r,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=u.containsPoint.bind(u)};Ft.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};Ft.prototype._initCachedDisplayObjectCanvas=function(t){if(this._cacheData?.sprite)return;let r=this.getLocalBounds(null,!0),i=this.alpha;this.alpha=1;let n=t.canvasContext.activeContext,o=t._projTransform;r.ceil(W.RESOLUTION);let a=He.create({width:r.width,height:r.height}),l=`cacheAsBitmap_${et.uid()}`;this._cacheData.textureCacheId=l,ht.addToCache(a.baseTexture,l),it.addToCache(a,l);let c=Wg;this.transform.localTransform.copyTo(c),c.invert(),c.tx-=r.x,c.ty-=r.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:a,clear:!0,transform:c,skipUpdateTransform:!1}),t.canvasContext.activeContext=n,t._projTransform=o,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;let d=new Be(a);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-(r.x/r.width),d.anchor.y=-(r.y/r.height),d.alpha=i,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=d.containsPoint.bind(d)};Ft.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Ft.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Ft.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,ht.removeFromCache(this._cacheData.textureCacheId),it.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Ft.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};Ft.prototype.name=null;ne.prototype.getChildByName=function(t,r){for(let i=0,n=this.children.length;i<n;i++)if(this.children[i].name===t)return this.children[i];if(r)for(let i=0,n=this.children.length;i<n;i++){let o=this.children[i];if(!o.getChildByName)continue;let a=o.getChildByName(t,!0);if(a)return a}return null};Ft.prototype.getGlobalPosition=function(t=new dt,r=!1){return this.parent?this.parent.toGlobal(this.position,t,r):(t.x=this.position.x,t.y=this.position.y),t};var Xg=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;var ta=class extends Wt{constructor(t=1){super(Rc,Xg,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}};var Ww={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Xw=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function zg(e){let t=Ww[e],r=t.length,i=Xw,n="",o="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;",a;for(let l=0;l<e;l++){let c=o.replace("%index%",l.toString());a=l,l>=r&&(a=e-l-1),c=c.replace("%value%",t[a].toString()),n+=c,n+=`
`}return i=i.replace("%blur%",n),i=i.replace("%size%",e.toString()),i}var zw=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function Yg(e,t){let r=Math.ceil(e/2),i=zw,n="",o;t?o="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":o="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let a=0;a<e;a++){let l=o.replace("%index%",a.toString());l=l.replace("%sampleIndex%",`${a-(r-1)}.0`),n+=l,n+=`
`}return i=i.replace("%blur%",n),i=i.replace("%size%",e.toString()),i}var en=class extends Wt{constructor(t,r=8,i=4,n=Wt.defaultResolution,o=5){let a=Yg(o,t),l=zg(o);super(a,l),this.horizontal=t,this.resolution=n,this._quality=0,this.quality=i,this.blur=r}apply(t,r,i,n){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/r.width):this.uniforms.strength=1/i.height*(i.height/r.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/r.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,r,i,n);else{let o=t.getFilterTexture(),a=t.renderer,l=r,c=o;this.state.blend=!1,t.applyFilter(this,l,c,cr.CLEAR);for(let d=1;d<this.passes-1;d++){t.bindAndClear(l,cr.BLIT),this.uniforms.uSampler=c;let f=c;c=l,l=f,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,c,i,n),t.returnFilterTexture(o)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}};var ea=class extends Wt{constructor(t=8,r=4,i=Wt.defaultResolution,n=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new en(!0,t,r,i,n),this.blurYFilter=new en(!1,t,r,i,n),this.resolution=i,this.quality=r,this.blur=t,this.repeatEdgePixels=!1}apply(t,r,i,n){let o=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(o&&a){let l=t.getFilterTexture();this.blurXFilter.apply(t,r,l,cr.CLEAR),this.blurYFilter.apply(t,l,i,n),t.returnFilterTexture(l)}else a?this.blurYFilter.apply(t,r,i,n):this.blurXFilter.apply(t,r,i,n)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}};var $g=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;var Gn=class extends Wt{constructor(){let t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super($o,$g,t),this.alpha=1}_loadMatrix(t,r=!1){let i=t;r&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(t,r,i){return t[0]=r[0]*i[0]+r[1]*i[5]+r[2]*i[10]+r[3]*i[15],t[1]=r[0]*i[1]+r[1]*i[6]+r[2]*i[11]+r[3]*i[16],t[2]=r[0]*i[2]+r[1]*i[7]+r[2]*i[12]+r[3]*i[17],t[3]=r[0]*i[3]+r[1]*i[8]+r[2]*i[13]+r[3]*i[18],t[4]=r[0]*i[4]+r[1]*i[9]+r[2]*i[14]+r[3]*i[19]+r[4],t[5]=r[5]*i[0]+r[6]*i[5]+r[7]*i[10]+r[8]*i[15],t[6]=r[5]*i[1]+r[6]*i[6]+r[7]*i[11]+r[8]*i[16],t[7]=r[5]*i[2]+r[6]*i[7]+r[7]*i[12]+r[8]*i[17],t[8]=r[5]*i[3]+r[6]*i[8]+r[7]*i[13]+r[8]*i[18],t[9]=r[5]*i[4]+r[6]*i[9]+r[7]*i[14]+r[8]*i[19]+r[9],t[10]=r[10]*i[0]+r[11]*i[5]+r[12]*i[10]+r[13]*i[15],t[11]=r[10]*i[1]+r[11]*i[6]+r[12]*i[11]+r[13]*i[16],t[12]=r[10]*i[2]+r[11]*i[7]+r[12]*i[12]+r[13]*i[17],t[13]=r[10]*i[3]+r[11]*i[8]+r[12]*i[13]+r[13]*i[18],t[14]=r[10]*i[4]+r[11]*i[9]+r[12]*i[14]+r[13]*i[19]+r[14],t[15]=r[15]*i[0]+r[16]*i[5]+r[17]*i[10]+r[18]*i[15],t[16]=r[15]*i[1]+r[16]*i[6]+r[17]*i[11]+r[18]*i[16],t[17]=r[15]*i[2]+r[16]*i[7]+r[17]*i[12]+r[18]*i[17],t[18]=r[15]*i[3]+r[16]*i[8]+r[17]*i[13]+r[18]*i[18],t[19]=r[15]*i[4]+r[16]*i[9]+r[17]*i[14]+r[18]*i[19]+r[19],t}_colorMatrix(t){let r=new Float32Array(t);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r}brightness(t,r){let i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,r)}tint(t,r){let[i,n,o]=pt.shared.setValue(t).toArray(),a=[i,0,0,0,0,0,n,0,0,0,0,0,o,0,0,0,0,0,1,0];this._loadMatrix(a,r)}greyscale(t,r){let i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,r)}blackAndWhite(t){let r=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(r,t)}hue(t,r){t=(t||0)/180*Math.PI;let i=Math.cos(t),n=Math.sin(t),o=Math.sqrt,a=1/3,l=o(a),c=i+(1-i)*a,d=a*(1-i)-l*n,f=a*(1-i)+l*n,u=a*(1-i)+l*n,m=i+a*(1-i),g=a*(1-i)-l*n,x=a*(1-i)-l*n,y=a*(1-i)+l*n,S=i+a*(1-i),b=[c,d,f,0,0,u,m,g,0,0,x,y,S,0,0,0,0,0,1,0];this._loadMatrix(b,r)}contrast(t,r){let i=(t||0)+1,n=-.5*(i-1),o=[i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0];this._loadMatrix(o,r)}saturate(t=0,r){let i=t*2/3+1,n=(i-1)*-.5,o=[i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0];this._loadMatrix(o,r)}desaturate(){this.saturate(-1)}negative(t){let r=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(r,t)}sepia(t){let r=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(r,t)}technicolor(t){let r=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(r,t)}polaroid(t){let r=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(r,t)}toBGR(t){let r=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(r,t)}kodachrome(t){let r=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(r,t)}browni(t){let r=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(r,t)}vintage(t){let r=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(r,t)}colorTone(t,r,i,n,o){t=t||.2,r=r||.15,i=i||16770432,n=n||3375104;let a=pt.shared,[l,c,d]=a.setValue(i).toArray(),[f,u,m]=a.setValue(n).toArray(),g=[.3,.59,.11,0,0,l,c,d,t,0,f,u,m,r,0,l-f,c-u,d-m,0,0];this._loadMatrix(g,o)}night(t,r){t=t||.1;let i=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(i,r)}predator(t,r){let i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,r)}lsd(t){let r=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(r,t)}reset(){let t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}};Gn.prototype.grayscale=Gn.prototype.greyscale;var jg=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`;var Kg=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;var ra=class extends Wt{constructor(t,r){let i=new St;t.renderable=!1,super(Kg,jg,{mapSampler:t._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=i,r==null&&(r=20),this.scale=new dt(r,r)}apply(t,r,i,n){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;let o=this.maskSprite.worldTransform,a=Math.sqrt(o.a*o.a+o.b*o.b),l=Math.sqrt(o.c*o.c+o.d*o.d);a!==0&&l!==0&&(this.uniforms.rotation[0]=o.a/a,this.uniforms.rotation[1]=o.b/a,this.uniforms.rotation[2]=o.c/l,this.uniforms.rotation[3]=o.d/l),t.applyFilter(this,r,i,n)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}};var Zg=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`;var qg=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;var ia=class extends Wt{constructor(){super(qg,Zg)}};var Jg=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;var na=class extends Wt{constructor(t=.5,r=Math.random()){super($o,Jg,{uNoise:0,uSeed:0}),this.noise=t,this.seed=r}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}};var Dc={AlphaFilter:ta,BlurFilter:ea,BlurFilterPass:en,ColorMatrixFilter:Gn,DisplacementFilter:ra,FXAAFilter:ia,NoiseFilter:na};Object.entries(Dc).forEach(([e,t])=>{Object.defineProperty(Dc,e,{get(){return et.deprecation("7.1.0",`filters.${e} has moved to ${e}`),t}})});var Lc=class{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(ee.system.add(this.tickerUpdate,this,pr.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(ee.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}let t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}},wi=new Lc;var Hr=class{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Hr.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new dt,this.page=new dt,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,r,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,r,i,n,o){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}};var ii=class extends Hr{constructor(){super(...arguments),this.client=new dt,this.movement=new dt,this.offset=new dt,this.global=new dt,this.screen=new dt}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,r,i){return t.worldTransform.applyInverse(i||this.global,r)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,r,i,n,o,a,l,c,d,f,u,m,g,x,y){throw new Error("Method not implemented.")}};var De=class extends ii{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}};var Vr=class extends ii{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}};Vr.DOM_DELTA_PIXEL=0;Vr.DOM_DELTA_LINE=1;Vr.DOM_DELTA_PAGE=2;var Yw=2048,$w=new dt,Fc=new dt,sa=class{constructor(t){this.dispatch=new et.EventEmitter,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._collectInteractiveElements=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,r){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:r,priority:0}),this.mappingTable[t].sort((i,n)=>i.priority-n.priority)}dispatchEvent(t,r){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,r),this.dispatch.emit(r||t.type,t)}mapEvent(t){if(!this.rootTarget)return;let r=this.mappingTable[t.type];if(r)for(let i=0,n=r.length;i<n;i++)r[i].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,r){wi.pauseUpdate=!0;let i=this.hitTestRecursive(this.rootTarget,this.rootTarget.eventMode,$w.set(t,r),this.hitTestFn,this.hitPruneFn);return i&&i[0]}propagate(t,r){if(!t.target)return;let i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let n=0,o=i.length-1;n<o;n++)if(t.currentTarget=i[n],this.notifyTarget(t,r),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,r),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let n=i.length-2;n>=0;n--)if(t.currentTarget=i[n],this.notifyTarget(t,r),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,r,i=this._allInteractiveElements){if(i.length===0)return;t.eventPhase=t.BUBBLING_PHASE;let n=Array.isArray(r)?r:[r];for(let o=i.length-1;o>=0;o--)n.forEach(a=>{t.currentTarget=i[o],this.notifyTarget(t,a)})}propagationPath(t){let r=[t];for(let i=0;i<Yw&&t!==this.rootTarget;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");r.push(t.parent),t=t.parent}return r.reverse(),r}hitTestRecursive(t,r,i,n,o){if(o(t,i))return null;if((t.eventMode==="dynamic"||r==="dynamic")&&(wi.pauseUpdate=!1),t.interactiveChildren&&t.children){let c=t.children;for(let d=c.length-1;d>=0;d--){let f=c[d],u=this.hitTestRecursive(f,this._isInteractive(r)?r:f.eventMode,i,n,o);if(u){if(u.length>0&&!u[u.length-1].parent)continue;let m=t.isInteractive();if((u.length>0||m)&&(this._collectInteractiveElements&&m&&this._allInteractiveElements.push(t),u.push(t)),this._collectInteractiveElements&&this._hitElements.length===0&&(this._hitElements=u),!this._collectInteractiveElements)return u}}}let a=this._isInteractive(r),l=t.isInteractive();return this._collectInteractiveElements&&(a&&l&&this._allInteractiveElements.push(t),this._hitElements.length>0)?null:a&&n(t,i)?l?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}hitPruneFn(t,r){if(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)return!0;if(this._collectInteractiveElements)return!1;if(t.hitArea&&(t.worldTransform.applyInverse(r,Fc),!t.hitArea.contains(Fc.x,Fc.y)))return!0;if(t._mask){let i=t._mask.isMaskData?t._mask.maskObject:t._mask;if(i&&!i.containsPoint?.(r))return!0}return!1}hitTestFn(t,r){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(r):!1}notifyTarget(t,r){r=r??t.type;let i=`on${r}`;t.currentTarget[i]?.(t);let n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${r}capture`:r;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,r)}mapPointerDown(t){if(!(t instanceof De)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.createPointerEvent(t);if(this.dispatchEvent(r,"pointerdown"),r.pointerType==="touch")this.dispatchEvent(r,"touchstart");else if(r.pointerType==="mouse"||r.pointerType==="pen"){let n=r.button===2;this.dispatchEvent(r,n?"rightdown":"mousedown")}let i=this.trackingData(t.pointerId);i.pressTargetsByButton[t.button]=r.composedPath(),this.freeEvent(r)}mapPointerMove(t){if(!(t instanceof De)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._collectInteractiveElements=!0;let r=this.createPointerEvent(t);this._collectInteractiveElements=!1;let i=r.pointerType==="mouse"||r.pointerType==="pen",n=this.trackingData(t.pointerId),o=this.findMountedTarget(n.overTargets);if(n.overTargets?.length>0&&o!==r.target){let c=t.type==="mousemove"?"mouseout":"pointerout",d=this.createPointerEvent(t,c,o);if(this.dispatchEvent(d,"pointerout"),i&&this.dispatchEvent(d,"mouseout"),!r.composedPath().includes(o)){let f=this.createPointerEvent(t,"pointerleave",o);for(f.eventPhase=f.AT_TARGET;f.target&&!r.composedPath().includes(f.target);)f.currentTarget=f.target,this.notifyTarget(f),i&&this.notifyTarget(f,"mouseleave"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(d)}if(o!==r.target){let c=t.type==="mousemove"?"mouseover":"pointerover",d=this.clonePointerEvent(r,c);this.dispatchEvent(d,"pointerover"),i&&this.dispatchEvent(d,"mouseover");let f=o?.parent;for(;f&&f!==this.rootTarget.parent&&f!==r.target;)f=f.parent;if(!f||f===this.rootTarget.parent){let m=this.clonePointerEvent(r,"pointerenter");for(m.eventPhase=m.AT_TARGET;m.target&&m.target!==o&&m.target!==this.rootTarget.parent;)m.currentTarget=m.target,this.notifyTarget(m),i&&this.notifyTarget(m,"mouseenter"),m.target=m.target.parent;this.freeEvent(m)}this.freeEvent(d)}let a=[],l=this.enableGlobalMoveEvents??!0;this.moveOnAll?a.push("pointermove"):this.dispatchEvent(r,"pointermove"),l&&a.push("globalpointermove"),r.pointerType==="touch"&&(this.moveOnAll?a.splice(1,0,"touchmove"):this.dispatchEvent(r,"touchmove"),l&&a.push("globaltouchmove")),i&&(this.moveOnAll?a.splice(1,0,"mousemove"):this.dispatchEvent(r,"mousemove"),l&&a.push("globalmousemove"),this.cursor=r.target?.cursor),a.length>0&&this.all(r,a),this._allInteractiveElements.length=0,this._hitElements.length=0,n.overTargets=r.composedPath(),this.freeEvent(r)}mapPointerOver(t){if(!(t instanceof De)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.trackingData(t.pointerId),i=this.createPointerEvent(t),n=i.pointerType==="mouse"||i.pointerType==="pen";this.dispatchEvent(i,"pointerover"),n&&this.dispatchEvent(i,"mouseover"),i.pointerType==="mouse"&&(this.cursor=i.target?.cursor);let o=this.clonePointerEvent(i,"pointerenter");for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),n&&this.notifyTarget(o,"mouseenter"),o.target=o.target.parent;r.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(o)}mapPointerOut(t){if(!(t instanceof De)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.trackingData(t.pointerId);if(r.overTargets){let i=t.pointerType==="mouse"||t.pointerType==="pen",n=this.findMountedTarget(r.overTargets),o=this.createPointerEvent(t,"pointerout",n);this.dispatchEvent(o),i&&this.dispatchEvent(o,"mouseout");let a=this.createPointerEvent(t,"pointerleave",n);for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),i&&this.notifyTarget(a,"mouseleave"),a.target=a.target.parent;r.overTargets=null,this.freeEvent(o),this.freeEvent(a)}this.cursor=null}mapPointerUp(t){if(!(t instanceof De)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=performance.now(),i=this.createPointerEvent(t);if(this.dispatchEvent(i,"pointerup"),i.pointerType==="touch")this.dispatchEvent(i,"touchend");else if(i.pointerType==="mouse"||i.pointerType==="pen"){let l=i.button===2;this.dispatchEvent(i,l?"rightup":"mouseup")}let n=this.trackingData(t.pointerId),o=this.findMountedTarget(n.pressTargetsByButton[t.button]),a=o;if(o&&!i.composedPath().includes(o)){let l=o;for(;l&&!i.composedPath().includes(l);){if(i.currentTarget=l,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch")this.notifyTarget(i,"touchendoutside");else if(i.pointerType==="mouse"||i.pointerType==="pen"){let c=i.button===2;this.notifyTarget(i,c?"rightupoutside":"mouseupoutside")}l=l.parent}delete n.pressTargetsByButton[t.button],a=l}if(a){let l=this.clonePointerEvent(i,"click");l.target=a,l.path=null,n.clicksByButton[t.button]||(n.clicksByButton[t.button]={clickCount:0,target:l.target,timeStamp:r});let c=n.clicksByButton[t.button];if(c.target===l.target&&r-c.timeStamp<200?++c.clickCount:c.clickCount=1,c.target=l.target,c.timeStamp=r,l.detail=c.clickCount,l.pointerType==="mouse"){let d=l.button===2;this.dispatchEvent(l,d?"rightclick":"click")}else l.pointerType==="touch"&&this.dispatchEvent(l,"tap");this.dispatchEvent(l,"pointertap"),this.freeEvent(l)}this.freeEvent(i)}mapPointerUpOutside(t){if(!(t instanceof De)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.trackingData(t.pointerId),i=this.findMountedTarget(r.pressTargetsByButton[t.button]),n=this.createPointerEvent(t);if(i){let o=i;for(;o;)n.currentTarget=o,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch"?this.notifyTarget(n,"touchendoutside"):(n.pointerType==="mouse"||n.pointerType==="pen")&&this.notifyTarget(n,n.button===2?"rightupoutside":"mouseupoutside"),o=o.parent;delete r.pressTargetsByButton[t.button]}this.freeEvent(n)}mapWheel(t){if(!(t instanceof Vr)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}let r=this.createWheelEvent(t);this.dispatchEvent(r),this.freeEvent(r)}findMountedTarget(t){if(!t)return null;let r=t[0];for(let i=1;i<t.length&&t[i].parent===r;i++)r=t[i];return r}createPointerEvent(t,r,i){let n=this.allocateEvent(De);return this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.nativeEvent=t.nativeEvent,n.originalEvent=t,n.target=i??this.hitTest(n.global.x,n.global.y)??this._hitElements[0],typeof r=="string"&&(n.type=r),n}createWheelEvent(t){let r=this.allocateEvent(Vr);return this.copyWheelData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=this.hitTest(r.global.x,r.global.y),r}clonePointerEvent(t,r){let i=this.allocateEvent(De);return i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice(),i.type=r??i.type,i}copyWheelData(t,r){r.deltaMode=t.deltaMode,r.deltaX=t.deltaX,r.deltaY=t.deltaY,r.deltaZ=t.deltaZ}copyPointerData(t,r){t instanceof De&&r instanceof De&&(r.pointerId=t.pointerId,r.width=t.width,r.height=t.height,r.isPrimary=t.isPrimary,r.pointerType=t.pointerType,r.pressure=t.pressure,r.tangentialPressure=t.tangentialPressure,r.tiltX=t.tiltX,r.tiltY=t.tiltY,r.twist=t.twist)}copyMouseData(t,r){t instanceof ii&&r instanceof ii&&(r.altKey=t.altKey,r.button=t.button,r.buttons=t.buttons,r.client.copyFrom(t.client),r.ctrlKey=t.ctrlKey,r.metaKey=t.metaKey,r.movement.copyFrom(t.movement),r.screen.copyFrom(t.screen),r.shiftKey=t.shiftKey,r.global.copyFrom(t.global))}copyData(t,r){r.isTrusted=t.isTrusted,r.srcElement=t.srcElement,r.timeStamp=performance.now(),r.type=t.type,r.detail=t.detail,r.view=t.view,r.which=t.which,r.layer.copyFrom(t.layer),r.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);let r=this.eventPool.get(t).pop()||new t(this);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=null,r.target=null,r}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");let r=t.constructor;this.eventPool.has(r)||this.eventPool.set(r,[]),this.eventPool.get(r).push(t)}notifyListeners(t,r){let i=t.currentTarget._events[r];if(i&&t.currentTarget.isInteractive())if("fn"in i)i.once&&t.currentTarget.removeListener(r,i.fn,void 0,!0),i.fn.call(i.context,t);else for(let n=0,o=i.length;n<o&&!t.propagationImmediatelyStopped;n++)i[n].once&&t.currentTarget.removeListener(r,i[n].fn,void 0,!0),i[n].fn.call(i[n].context,t)}};var jw=1,Kw={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Oc=class{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new sa(null),wi.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new De(null),this.rootWheelEvent=new Vr(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...Oc.defaultEventFeatures},{set:(t,r,i)=>(r==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=i),t[r]=i,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){let{view:t,resolution:r}=this.renderer;this.setTargetElement(t),this.resolution=r,Oc._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===e)return;this.currentCursor=e;let r=this.cursorStyles[e];if(r)switch(typeof r){case"string":t&&(this.domElement.style.cursor=r);break;case"function":r(e);break;case"object":t&&Object.assign(this.domElement.style,r);break}else t&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;let t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let r=0,i=t.length;r<i;r++){let n=t[r],o=this.bootstrapEvent(this.rootPointerEvent,n);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;wi.pointerMoved();let t=this.normalizeToPointerData(e);for(let r=0,i=t.length;r<i;r++){let n=this.bootstrapEvent(this.rootPointerEvent,t[r]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);let r=t!==this.domElement?"outside":"",i=this.normalizeToPointerData(e);for(let n=0,o=i.length;n<o;n++){let a=this.bootstrapEvent(this.rootPointerEvent,i[n]);a.type+=r,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;let t=this.normalizeToPointerData(e);for(let r=0,i=t.length;r<i;r++){let n=this.bootstrapEvent(this.rootPointerEvent,t[r]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;let t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this.removeEvents(),this.domElement=e,wi.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;wi.addTickerListener();let e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;wi.removeTickerListener();let e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,t,r){let i;this.domElement.parentElement?i=this.domElement.getBoundingClientRect():i={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};let n=1/this.resolution;e.x=(t-i.left)*(this.domElement.width/i.width)*n,e.y=(r-i.top)*(this.domElement.height/i.height)*n}normalizeToPointerData(e){let t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let r=0,i=e.changedTouches.length;r<i;r++){let n=e.changedTouches[r];typeof n.button>"u"&&(n.button=0),typeof n.buttons>"u"&&(n.buttons=1),typeof n.isPrimary>"u"&&(n.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof n.width>"u"&&(n.width=n.radiusX||1),typeof n.height>"u"&&(n.height=n.radiusY||1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="touch"),typeof n.pointerId>"u"&&(n.pointerId=n.identifier||0),typeof n.pressure>"u"&&(n.pressure=n.force||.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),typeof n.layerX>"u"&&(n.layerX=n.offsetX=n.clientX),typeof n.layerY>"u"&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,n.type=e.type,t.push(n)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){let r=e;typeof r.isPrimary>"u"&&(r.isPrimary=!0),typeof r.width>"u"&&(r.width=1),typeof r.height>"u"&&(r.height=1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="mouse"),typeof r.pointerId>"u"&&(r.pointerId=jw),typeof r.pressure>"u"&&(r.pressure=.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),r.isNormalized=!0,t.push(r)}else t.push(e);return t}normalizeWheelEvent(e){let t=this.rootWheelEvent;return this.transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=Kw[e.type]||e.type),e}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}},kn=Oc;kn.extension={name:"events",type:[z.RendererSystem,z.CanvasRendererSystem]};kn.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};q.add(kn);function Qg(e){return e==="dynamic"||e==="static"}var tx={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??Qg(kn.defaultEventMode)},set interactive(e){gt("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=e,this.eventMode=e?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??kn.defaultEventMode},set eventMode(e){this._internalInteractive=Qg(e),this._internalEventMode=e},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(e,t,r){let i=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,n=typeof t=="function"?void 0:t;e=i?`${e}capture`:e,t=typeof t=="function"?t:t.handleEvent,this.on(e,t,n)},removeEventListener(e,t,r){let i=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,n=typeof t=="function"?void 0:t;e=i?`${e}capture`:e,t=typeof t=="function"?t:t.handleEvent,this.off(e,t,n)},dispatchEvent(e){if(!(e instanceof Hr))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return e.defaultPrevented=!1,e.path=null,e.target=this,e.manager.dispatchEvent(e),!e.defaultPrevented}};Ft.mixin(tx);var Nc={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Ft.mixin(Nc);var Zw=9,tl=100,qw=0,Jw=0,ex=2,rx=1,Qw=-1e3,tb=-1e3,eb=2,oa=class{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(et.isMobile.tablet||et.isMobile.phone)&&this.createTouchHook();let r=document.createElement("div");r.style.width=`${tl}px`,r.style.height=`${tl}px`,r.style.position="absolute",r.style.top=`${qw}px`,r.style.left=`${Jw}px`,r.style.zIndex=ex.toString(),this.div=r,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){let t=document.createElement("button");t.style.width=`${rx}px`,t.style.height=`${rx}px`,t.style.position="absolute",t.style.top=`${Qw}px`,t.style.left=`${tb}px`,t.style.zIndex=eb.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);let r=t.children;if(r)for(let i=0;i<r.length;i++)this.updateAccessibleObjects(r[i])}update(){let t=performance.now();if(et.isMobile.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);let{x:r,y:i,width:n,height:o}=this.renderer.view.getBoundingClientRect(),{width:a,height:l,resolution:c}=this.renderer,d=n/a*c,f=o/l*c,u=this.div;u.style.left=`${r}px`,u.style.top=`${i}px`,u.style.width=`${a}px`,u.style.height=`${l}px`;for(let m=0;m<this.children.length;m++){let g=this.children[m];if(g.renderId!==this.renderId)g._accessibleActive=!1,et.removeItems(this.children,m,1),this.div.removeChild(g._accessibleDiv),this.pool.push(g._accessibleDiv),g._accessibleDiv=null,m--;else{u=g._accessibleDiv;let x=g.hitArea,y=g.worldTransform;g.hitArea?(u.style.left=`${(y.tx+x.x*y.a)*d}px`,u.style.top=`${(y.ty+x.y*y.d)*f}px`,u.style.width=`${x.width*y.a*d}px`,u.style.height=`${x.height*y.d*f}px`):(x=g.getBounds(),this.capHitArea(x),u.style.left=`${x.x*d}px`,u.style.top=`${x.y*f}px`,u.style.width=`${x.width*d}px`,u.style.height=`${x.height*f}px`,u.title!==g.accessibleTitle&&g.accessibleTitle!==null&&(u.title=g.accessibleTitle),u.getAttribute("aria-label")!==g.accessibleHint&&g.accessibleHint!==null&&u.setAttribute("aria-label",g.accessibleHint)),(g.accessibleTitle!==u.title||g.tabIndex!==u.tabIndex)&&(u.title=g.accessibleTitle,u.tabIndex=g.tabIndex,this.debug&&this.updateDebugHTML(u))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);let{width:r,height:i}=this.renderer;t.x+t.width>r&&(t.width=r-t.x),t.y+t.height>i&&(t.height=i-t.y)}addChild(t){let r=this.pool.pop();r||(r=document.createElement("button"),r.style.width=`${tl}px`,r.style.height=`${tl}px`,r.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",r.style.position="absolute",r.style.zIndex=ex.toString(),r.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?r.setAttribute("aria-live","off"):r.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?r.setAttribute("aria-relevant","additions"):r.setAttribute("aria-relevant","text"),r.addEventListener("click",this._onClick.bind(this)),r.addEventListener("focus",this._onFocus.bind(this)),r.addEventListener("focusout",this._onFocusOut.bind(this))),r.style.pointerEvents=t.accessiblePointerEvents,r.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?r.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(r.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&r.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(r),t._accessibleActive=!0,t._accessibleDiv=r,r.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,r){let{displayObject:i}=t.target,n=this.renderer.events.rootBoundary,o=Object.assign(new Hr(n),{target:i});n.rootTarget=this.renderer.lastObjectRendered,r.forEach(a=>n.dispatchEvent(o,a))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===Zw&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}};oa.extension={name:"accessibility",type:[z.RendererPlugin,z.CanvasRendererPlugin]};q.add(oa);var Uc=class{constructor(e){this.stage=new ne,e=Object.assign({forceCanvas:!1},e),this.renderer=Cc(e),Uc._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(e,t){let r=Uc._plugins.slice(0);r.reverse(),r.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}},aa=Uc;aa._plugins=[];q.handleByList(z.Application,aa._plugins);var ha=class{static init(t){Object.defineProperty(this,"resizeTo",{set(r){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let r,i;if(this._resizeTo===globalThis.window)r=globalThis.innerWidth,i=globalThis.innerHeight;else{let{clientWidth:n,clientHeight:o}=this._resizeTo;r=n,i=o}this.renderer.resize(r,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}};ha.extension=z.Application;q.add(ha);var ix={loader:z.LoadParser,resolver:z.ResolveParser,cache:z.CacheParser,detection:z.DetectionParser};q.handle(z.Asset,e=>{let t=e.ref;Object.entries(ix).filter(([r])=>!!t[r]).forEach(([r,i])=>q.add(Object.assign(t[r],{extension:t[r].extension??i})))},e=>{let t=e.ref;Object.keys(ix).filter(r=>!!t[r]).forEach(r=>q.remove(t[r]))});var el=class{constructor(t,r=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(t){t.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;let t=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<r;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}};function Ir(e,t){if(Array.isArray(t)){for(let r of t)if(e.startsWith(`data:${r}`))return!0;return!1}return e.startsWith(`data:${t}`)}function Le(e,t){let r=e.split("?")[0],i=et.path.extname(r).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}var Ve=(e,t)=>(Array.isArray(e)||(e=[e]),t?e.map(r=>typeof r=="string"?t(r):r):e);var Hn=(e,t)=>{let r=t.split("?")[1];return r&&(e+=`?${r}`),e};function nx(e,t,r,i,n){let o=t[r];for(let a=0;a<o.length;a++){let l=o[a];r<t.length-1?nx(e.replace(i[r],l),t,r+1,i,n):n.push(e.replace(i[r],l))}}function rl(e){let t=/\{(.*?)\}/g,r=e.match(t),i=[];if(r){let n=[];r.forEach(o=>{let a=o.substring(1,o.length-1).split(",");n.push(a)}),nx(e,n,0,r,i)}else i.push(e);return i}var bi=e=>!Array.isArray(e);var Gc=class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){let r=this._cache.get(t);return r||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),r}set(t,r){let i=Ve(t),n;for(let l=0;l<this.parsers.length;l++){let c=this.parsers[l];if(c.test(r)){n=c.getCacheableAssets(i,r);break}}n||(n={},i.forEach(l=>{n[l]=r}));let o=Object.keys(n),a={cacheKeys:o,keys:i};if(i.forEach(l=>{this._cacheMap.set(l,a)}),o.forEach(l=>{this._cache.has(l)&&this._cache.get(l)!==r&&console.warn("[Cache] already has key:",l),this._cache.set(l,n[l])}),r instanceof it){let l=r;i.forEach(c=>{l.baseTexture!==it.EMPTY.baseTexture&&ht.addToCache(l.baseTexture,c),it.addToCache(l,c)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}let r=this._cacheMap.get(t);r.cacheKeys.forEach(n=>{this._cache.delete(n)}),r.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}},rn=new Gc;var il=class{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,r,i)=>(this._parsersValidated=!1,t[r]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,r){let i={promise:null,parser:null};return i.promise=(async()=>{let n=null,o=null;if(r.loadParser&&(o=this._parserHash[r.loadParser],o||console.warn(`[Assets] specified load parser "${r.loadParser}" not found while loading ${t}`)),!o){for(let a=0;a<this.parsers.length;a++){let l=this.parsers[a];if(l.load&&l.test?.(t,r,this)){o=l;break}}if(!o)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await o.load(t,r,this),i.parser=o;for(let a=0;a<this.parsers.length;a++){let l=this.parsers[a];l.parse&&l.parse&&await l.testParse?.(n,r,this)&&(n=await l.parse(n,r,this)||n,i.parser=l)}return n})(),i}async load(t,r){this._parsersValidated||this._validateParsers();let i=0,n={},o=bi(t),a=Ve(t,d=>({src:d})),l=a.length,c=a.map(async d=>{let f=et.path.toAbsolute(d.src);if(!n[d.src])try{this.promiseCache[f]||(this.promiseCache[f]=this._getLoadPromiseAndParser(f,d)),n[d.src]=await this.promiseCache[f].promise,r&&r(++i/l)}catch(u){throw delete this.promiseCache[f],delete n[d.src],new Error(`[Loader.load] Failed to load ${f}.
${u}`)}});return await Promise.all(c),o?n[a[0].src]:n}async unload(t){let i=Ve(t,n=>({src:n})).map(async n=>{let o=et.path.toAbsolute(n.src),a=this.promiseCache[o];if(a){let l=await a.promise;a.parser?.unload?.(l,n,this),delete this.promiseCache[o]}});await Promise.all(i)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,r)=>(t[r.name]&&console.warn(`[Assets] loadParser name conflict "${r.name}"`),{...t,[r.name]:r}),{})}};var he=(e=>(e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e))(he||{});var rb=".json",ib="application/json",kc={extension:{type:z.LoadParser,priority:he.Low},name:"loadJson",test(e){return Ir(e,ib)||Le(e,rb)},async load(e){return await(await W.ADAPTER.fetch(e)).json()}};q.add(kc);var nb=".txt",sb="text/plain",Hc={name:"loadTxt",extension:{type:z.LoadParser,priority:he.Low},test(e){return Ir(e,sb)||Le(e,nb)},async load(e){return await(await W.ADAPTER.fetch(e)).text()}};q.add(Hc);var ob=["normal","bold","100","200","300","400","500","600","700","800","900"],ab=[".ttf",".otf",".woff",".woff2"],hb=["font/ttf","font/otf","font/woff","font/woff2"];function Vc(e){let t=et.path.extname(e);return et.path.basename(e,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ")}var Wc={extension:{type:z.LoadParser,priority:he.Low},name:"loadWebFont",test(e){return Ir(e,hb)||Le(e,ab)},async load(e,t){let r=W.ADAPTER.getFontFaceSet();if(r){let i=[],n=t.data?.family??Vc(e),o=t.data?.weights?.filter(l=>ob.includes(l))??["normal"],a=t.data??{};for(let l=0;l<o.length;l++){let c=o[l],d=new FontFace(n,`url(${encodeURI(e)})`,{...a,weight:c});await d.load(),r.add(d),i.push(d)}return i.length===1?i[0]:i}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(e){(Array.isArray(e)?e:[e]).forEach(t=>W.ADAPTER.getFontFaceSet().delete(t))}};q.add(Wc);var sx=0,Xc,lb="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",ub={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${lb}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},cb={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`},zc,Yc=class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{let r=URL.createObjectURL(new Blob([ub.code],{type:"application/javascript"})),i=new Worker(r);i.addEventListener("message",n=>{i.terminate(),URL.revokeObjectURL(r),t(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Xc===void 0&&(Xc=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<Xc&&(zc||(zc=URL.createObjectURL(new Blob([cb.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(zc),t.addEventListener("message",r=>{this.complete(r.data),this.returnWorker(r.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,r){await this._initWorkers();let i=new Promise((n,o)=>{this.queue.push({id:t,arguments:r,resolve:n,reject:o})});return this.next(),i}next(){if(!this.queue.length)return;let t=this.getWorker();if(!t)return;let r=this.queue.pop(),i=r.id;this.resolveHash[sx]={resolve:r.resolve,reject:r.reject},t.postMessage({data:r.arguments,uuid:sx++,id:i})}},$c=new Yc;function ni(e,t,r){let i=new it(e);return i.baseTexture.on("dispose",()=>{delete t.promiseCache[r]}),i}var fb=[".jpeg",".jpg",".png",".webp",".avif"],db=["image/jpeg","image/png","image/webp","image/avif"];async function jc(e){let t=await W.ADAPTER.fetch(e);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${e}: ${t.status} ${t.statusText}`);let r=await t.blob();return await createImageBitmap(r)}var Ai={name:"loadTextures",extension:{type:z.LoadParser,priority:he.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(e){return Ir(e,db)||Le(e,fb)},async load(e,t,r){let i=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await $c.isImageBitmapSupported()?i=await $c.loadImageBitmap(e):i=await jc(e):i=await new Promise(o=>{i=new Image,i.crossOrigin=this.config.crossOrigin,i.src=e,i.complete?o(i):i.onload=()=>{o(i)}});let n=new ht(i,{resolution:et.getResolutionOfUrl(e),...t.data});return n.resource.src=e,ni(n,r,e)},unload(e){e.destroy(!0)}};q.add(Ai);var pb=".svg",mb="image/svg+xml",Kc={extension:{type:z.LoadParser,priority:he.High},name:"loadSVG",test(e){return Ir(e,mb)||Le(e,pb)},async testParse(e){return Si.test(e)},async parse(e,t,r){let i=new Si(e,t?.data?.resourceOptions),n=new ht(i,{resolution:et.getResolutionOfUrl(e),...t?.data});n.resource.src=e;let o=ni(n,r,e);return t?.data?.resourceOptions?.autoLoad||await i.load(),o},async load(e,t){return(await W.ADAPTER.fetch(e)).text()},unload:Ai.unload};q.add(Kc);var nl=class{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,r)=>`${t}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(t,r)=>r.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{let r=t;this._defaultSearchParams=Object.keys(r).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(r[i])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(t,r){let i=[];Array.isArray(r)?r.forEach(n=>{if(typeof n.name=="string"){let o=this._createBundleAssetId(t,n.name);i.push(o),this.add([n.name,o],n.srcs,n.data)}else{let o=n.name.map(a=>this._createBundleAssetId(t,a));o.forEach(a=>{i.push(a)}),this.add([...n.name,...o],n.srcs)}}):Object.keys(r).forEach(n=>{i.push(this._createBundleAssetId(t,n)),this.add([n,this._createBundleAssetId(t,n)],r[n])}),this._bundles[t]=i}add(t,r,i){let n=Ve(t);n.forEach(a=>{this.hasKey(a)&&console.warn(`[Resolver] already has key: ${a} overwriting`)}),Array.isArray(r)||(typeof r=="string"?r=rl(r):r=[r]);let o=r.map(a=>{let l=a;if(typeof a=="string"){let c=!1;for(let d=0;d<this._parsers.length;d++){let f=this._parsers[d];if(f.test(a)){l=f.parse(a),c=!0;break}}c||(l={src:a})}return l.format||(l.format=l.src.split(".").pop()),l.alias||(l.alias=n),(this._basePath||this._rootPath)&&(l.src=et.path.toAbsolute(l.src,this._basePath,this._rootPath)),l.src=this._appendDefaultSearchParams(l.src),l.data=l.data??i,l});n.forEach(a=>{this._assetMap[a]=o})}resolveBundle(t){let r=bi(t);t=Ve(t);let i={};return t.forEach(n=>{let o=this._bundles[n];if(o){let a=this.resolve(o),l={};for(let c in a){let d=a[c];l[this._extractAssetIdFromBundle(n,c)]=d}i[n]=l}}),r?i[t[0]]:i}resolveUrl(t){let r=this.resolve(t);if(typeof t!="string"){let i={};for(let n in r)i[n]=r[n].src;return i}return r.src}resolve(t){let r=bi(t);t=Ve(t);let i={};return t.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let o=this._assetMap[n],a=this._getPreferredOrder(o),l=o[0];a?.priority.forEach(c=>{a.params[c].forEach(d=>{let f=o.filter(u=>u[c]?u[c]===d:!1);f.length&&(o=f)})}),this._resolverHash[n]=o[0]??l}else{let o=n;(this._basePath||this._rootPath)&&(o=et.path.toAbsolute(o,this._basePath,this._rootPath)),o=this._appendDefaultSearchParams(o),this._resolverHash[n]={src:o}}i[n]=this._resolverHash[n]}),r?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let r=0;r<t.length;r++){let i=t[0],n=this._preferredOrder.find(o=>o.params.format.includes(i.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;let r=/\?/.test(t)?"&":"?";return`${t}${r}${this._defaultSearchParams}`}};var sl=class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new nl,this.loader=new il,this.cache=rn,this._backgroundLoader=new el(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let o=t.manifest;typeof o=="string"&&(o=await this.load(o)),this.resolver.addManifest(o)}let r=t.texturePreference?.resolution??1,i=typeof r=="number"?[r]:r,n=[];if(t.texturePreference?.format){let o=t.texturePreference?.format;n=typeof o=="string"?[o]:o;for(let a of this._detections)await a.test()||(n=await a.remove(n))}else for(let o of this._detections)await o.test()&&(n=await o.add(n));this.resolver.prefer({params:{format:n,resolution:i}}),t.preferences&&this.setPreferences(t.preferences)}add(t,r,i){this.resolver.add(t,r,i)}async load(t,r){this._initialized||await this.init();let i=bi(t),n=Ve(t).map(l=>typeof l!="string"?(this.resolver.add(l.src,l),l.src):(this.resolver.hasKey(l)||this.resolver.add(l,l),l)),o=this.resolver.resolve(n),a=await this._mapLoadToResolve(o,r);return i?a[n[0]]:a}addBundle(t,r){this.resolver.addBundle(t,r)}async loadBundle(t,r){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);let n=this.resolver.resolveBundle(t),o={},a=Object.keys(n),l=0,c=0,d=()=>{r?.(++l/c)},f=a.map(u=>{let m=n[u];return c+=Object.keys(m).length,this._mapLoadToResolve(m,d).then(g=>{o[u]=g})});return await Promise.all(f),i?o[t[0]]:o}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);let r=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);let r=this.resolver.resolveBundle(t);Object.values(r).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return rn.get(t);let r={};for(let i=0;i<t.length;i++)r[i]=rn.get(t[i]);return r}async _mapLoadToResolve(t,r){let i=Object.values(t),n=Object.keys(t);this._backgroundLoader.active=!1;let o=await this.loader.load(i,r);this._backgroundLoader.active=!0;let a={};return i.forEach((l,c)=>{let d=o[l.src],f=[l.src];l.alias&&f.push(...l.alias),a[n[c]]=d,rn.set(f,d)}),a}async unload(t){this._initialized||await this.init();let r=Ve(t).map(n=>typeof n!="string"?n.src:n),i=this.resolver.resolve(r);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=Ve(t);let r=this.resolver.resolveBundle(t),i=Object.keys(r).map(n=>this._unloadFromResolved(r[n]));await Promise.all(i)}async _unloadFromResolved(t){let r=Object.values(t);r.forEach(i=>{rn.remove(i.src)}),await this.loader.unload(r)}get detections(){return this._detections}get preferWorkers(){return Ai.config.preferWorkers}set preferWorkers(t){gt("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(i=>i in t).forEach(i=>{r.config[i]=t[i]})})}},la=new sl;q.handleByList(z.LoadParser,la.loader.parsers).handleByList(z.ResolveParser,la.resolver.parsers).handleByList(z.CacheParser,la.cache.parsers).handleByList(z.DetectionParser,la.detections);var Zc={extension:z.CacheParser,test:e=>Array.isArray(e)&&e.every(t=>t instanceof it),getCacheableAssets:(e,t)=>{let r={};return e.forEach(i=>{t.forEach((n,o)=>{r[i+(o===0?"":o+1)]=n})}),r}};q.add(Zc);var qc={extension:{type:z.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;let e="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=await W.ADAPTER.fetch(e).then(r=>r.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async e=>[...e,"avif"],remove:async e=>e.filter(t=>t!=="avif")};q.add(qc);var Jc={extension:{type:z.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;let e="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=await W.ADAPTER.fetch(e).then(r=>r.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async e=>[...e,"webp"],remove:async e=>e.filter(t=>t!=="webp")};q.add(Jc);var ox=["png","jpg","jpeg"],Qc={extension:{type:z.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...ox],remove:async e=>e.filter(t=>!ox.includes(t))};q.add(Qc);var tf={extension:z.ResolveParser,test:Ai.test,parse:e=>({resolution:parseFloat(W.RETINA_PREFIX.exec(e)?.[1]??"1"),format:e.split(".").pop(),src:e})};q.add(tf);var We=(e=>(e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e))(We||{}),nn={[33776]:.5,[33777]:.5,[33778]:1,[33779]:1,[35916]:.5,[35917]:.5,[35918]:1,[35919]:1,[37488]:.5,[37489]:.5,[37490]:1,[37491]:1,[37492]:.5,[37496]:1,[37493]:.5,[37497]:1,[37494]:.5,[37495]:.5,[35840]:.5,[35842]:.5,[35841]:.25,[35843]:.25,[36196]:.5,[35986]:.5,[35986]:1,[34798]:1,[37808]:1};var Ci,zs;function ax(){zs={s3tc:Ci.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Ci.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:Ci.getExtension("WEBGL_compressed_texture_etc"),etc1:Ci.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:Ci.getExtension("WEBGL_compressed_texture_pvrtc")||Ci.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:Ci.getExtension("WEBGL_compressed_texture_atc"),astc:Ci.getExtension("WEBGL_compressed_texture_astc")}}var ef={extension:{type:z.DetectionParser,priority:2},test:async()=>{let t=W.ADAPTER.createCanvas().getContext("webgl");return t?(Ci=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async e=>{zs||ax();let t=[];for(let r in zs)zs[r]&&t.push(r);return[...t,...e]},remove:async e=>(zs||ax(),e.filter(t=>!(t in zs)))};q.add(ef);var Ys=class extends Qe{constructor(t,r={width:1,height:1,autoLoad:!0}){let i,n;typeof t=="string"?(i=t,n=new Uint8Array):(i=null,n=t),super(n,r),this.origin=i,this.buffer=n?new Yi(n):null,this.origin&&r.autoLoad!==!1&&this.load(),n?.length&&(this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}async load(){let i=await(await(await fetch(this.origin)).blob()).arrayBuffer();return this.data=new Uint32Array(i),this.buffer=new Yi(i),this.loaded=!0,this.onBlobLoaded(i),this.update(),this}};var gr=class extends Ys{constructor(t,r){super(t,r),this.format=r.format,this.levels=r.levels||1,this._width=r.width,this._height=r.height,this._extension=gr._formatToExtension(this.format),(r.levelBuffers||this.buffer)&&(this._levelBuffers=r.levelBuffers||gr._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,r,i){let n=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let a=0,l=this.levels;a<l;a++){let{levelID:c,levelWidth:d,levelHeight:f,levelBuffer:u}=this._levelBuffers[a];n.compressedTexImage2D(n.TEXTURE_2D,c,this.format,d,f,0,u)}return!0}onBlobLoaded(){this._levelBuffers=gr._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,r,i,n,o,a,l){let c=new Array(i),d=t.byteOffset,f=a,u=l,m=f+n-1&~(n-1),g=u+o-1&~(o-1),x=m*g*nn[r];for(let y=0;y<i;y++)c[y]={levelID:y,levelWidth:i>1?f:m,levelHeight:i>1?u:g,levelBuffer:new Uint8Array(t.buffer,d,x)},d+=x,f=f>>1||1,u=u>>1||1,m=f+n-1&~(n-1),g=u+o-1&~(o-1),x=m*g*nn[r];return c}};var rf=4,ol=124,gb=32,hx=20,xb=542327876,al={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},_b={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},hl={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4};var vb=1,yb=2,Tb=4,Eb=64,Sb=512,wb=131072,bb=827611204,Ab=861165636,Cb=894720068,Rb=808540228,Ib=4,Pb={[bb]:We.COMPRESSED_RGBA_S3TC_DXT1_EXT,[Ab]:We.COMPRESSED_RGBA_S3TC_DXT3_EXT,[Cb]:We.COMPRESSED_RGBA_S3TC_DXT5_EXT},Mb={[70]:We.COMPRESSED_RGBA_S3TC_DXT1_EXT,[71]:We.COMPRESSED_RGBA_S3TC_DXT1_EXT,[73]:We.COMPRESSED_RGBA_S3TC_DXT3_EXT,[74]:We.COMPRESSED_RGBA_S3TC_DXT3_EXT,[76]:We.COMPRESSED_RGBA_S3TC_DXT5_EXT,[77]:We.COMPRESSED_RGBA_S3TC_DXT5_EXT,[72]:We.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,[75]:We.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,[78]:We.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function ll(e){let t=new Uint32Array(e);if(t[0]!==xb)throw new Error("Invalid DDS file magic word");let i=new Uint32Array(e,0,ol/Uint32Array.BYTES_PER_ELEMENT),n=i[al.HEIGHT],o=i[al.WIDTH],a=i[al.MIPMAP_COUNT],l=new Uint32Array(e,al.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,gb/Uint32Array.BYTES_PER_ELEMENT),c=l[vb];if(c&Tb){let d=l[_b.FOURCC];if(d!==Rb){let v=Pb[d],T=rf+ol,I=new Uint8Array(e,T);return[new gr(I,{format:v,width:o,height:n,levels:a})]}let f=rf+ol,u=new Uint32Array(t.buffer,f,hx/Uint32Array.BYTES_PER_ELEMENT),m=u[hl.DXGI_FORMAT],g=u[hl.RESOURCE_DIMENSION],x=u[hl.MISC_FLAG],y=u[hl.ARRAY_SIZE],S=Mb[m];if(S===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${m}`);if(x===Ib)throw new Error("DDSParser does not support cubemap textures");if(g===6)throw new Error("DDSParser does not supported 3D texture data");let b=new Array,w=rf+ol+hx;if(y===1)b.push(new Uint8Array(e,w));else{let v=nn[S],T=0,I=o,C=n;for(let M=0;M<a;M++){let B=Math.max(1,I+3&-4),F=Math.max(1,C+3&-4),L=B*F*v;T+=L,I=I>>>1,C=C>>>1}let P=w;for(let M=0;M<y;M++)b.push(new Uint8Array(e,P,T)),P+=T}return b.map(v=>new gr(v,{format:S,width:o,height:n,levels:a}))}throw c&Eb?new Error("DDSParser does not support uncompressed texture data."):c&Sb?new Error("DDSParser does not supported YUV uncompressed texture data."):c&wb?new Error("DDSParser does not support single-channel (lumninance) texture data!"):c&yb?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}var lx=[171,75,84,88,32,49,49,187,13,10,26,10],Bb=67305985,Wr={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},nf=64,ul={[at.UNSIGNED_BYTE]:1,[at.UNSIGNED_SHORT]:2,[at.INT]:4,[at.UNSIGNED_INT]:4,[at.FLOAT]:4,[at.HALF_FLOAT]:8},sf={[tt.RGBA]:4,[tt.RGB]:3,[tt.RG]:2,[tt.RED]:1,[tt.LUMINANCE]:1,[tt.LUMINANCE_ALPHA]:2,[tt.ALPHA]:1},of={[at.UNSIGNED_SHORT_4_4_4_4]:2,[at.UNSIGNED_SHORT_5_5_5_1]:2,[at.UNSIGNED_SHORT_5_6_5]:2};function cl(e,t,r=!1){let i=new DataView(t);if(!Db(e,i))return null;let n=i.getUint32(Wr.ENDIANNESS,!0)===Bb,o=i.getUint32(Wr.GL_TYPE,n),a=i.getUint32(Wr.GL_FORMAT,n),l=i.getUint32(Wr.GL_INTERNAL_FORMAT,n),c=i.getUint32(Wr.PIXEL_WIDTH,n),d=i.getUint32(Wr.PIXEL_HEIGHT,n)||1,f=i.getUint32(Wr.PIXEL_DEPTH,n)||1,u=i.getUint32(Wr.NUMBER_OF_ARRAY_ELEMENTS,n)||1,m=i.getUint32(Wr.NUMBER_OF_FACES,n),g=i.getUint32(Wr.NUMBER_OF_MIPMAP_LEVELS,n),x=i.getUint32(Wr.BYTES_OF_KEY_VALUE_DATA,n);if(d===0||f!==1)throw new Error("Only 2D textures are supported");if(m!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(u!==1)throw new Error("WebGL does not support array textures");let y=4,S=4,b=c+3&-4,w=d+3&-4,v=new Array(u),T=c*d;o===0&&(T=b*w);let I;if(o!==0?ul[o]?I=ul[o]*sf[a]:I=of[o]:I=nn[l],I===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");let C=r?Fb(i,x,n):null,M=T*I,B=c,F=d,L=b,V=w,N=nf+x;for(let k=0;k<g;k++){let Z=i.getUint32(N,n),j=N+4;for(let rt=0;rt<u;rt++){let Y=v[rt];Y||(Y=v[rt]=new Array(g)),Y[k]={levelID:k,levelWidth:g>1||o!==0?B:L,levelHeight:g>1||o!==0?F:V,levelBuffer:new Uint8Array(t,j,M)},j+=M}N+=Z+4,N=N%4!==0?N+4-N%4:N,B=B>>1||1,F=F>>1||1,L=B+y-1&~(y-1),V=F+S-1&~(S-1),M=L*V*I}return o!==0?{uncompressed:v.map(k=>{let Z=k[0].levelBuffer,j=!1;return o===at.FLOAT?Z=new Float32Array(k[0].levelBuffer.buffer,k[0].levelBuffer.byteOffset,k[0].levelBuffer.byteLength/4):o===at.UNSIGNED_INT?(j=!0,Z=new Uint32Array(k[0].levelBuffer.buffer,k[0].levelBuffer.byteOffset,k[0].levelBuffer.byteLength/4)):o===at.INT&&(j=!0,Z=new Int32Array(k[0].levelBuffer.buffer,k[0].levelBuffer.byteOffset,k[0].levelBuffer.byteLength/4)),{resource:new Qe(Z,{width:k[0].levelWidth,height:k[0].levelHeight}),type:o,format:j?Lb(a):a}}),kvData:C}:{compressed:v.map(k=>new gr(null,{format:l,width:c,height:d,levels:g,levelBuffers:k})),kvData:C}}function Db(e,t){for(let r=0;r<lx.length;r++)if(t.getUint8(r)!==lx[r])return console.error(`${e} is not a valid *.ktx file!`),!1;return!0}function Lb(e){switch(e){case tt.RGBA:return tt.RGBA_INTEGER;case tt.RGB:return tt.RGB_INTEGER;case tt.RG:return tt.RG_INTEGER;case tt.RED:return tt.RED_INTEGER;default:return e}}function Fb(e,t,r){let i=new Map,n=0;for(;n<t;){let o=e.getUint32(nf+n,r),a=nf+n+4,l=3-(o+3)%4;if(o===0||o>t-n){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let c=0;for(;c<o&&e.getUint8(a+c)!==0;c++);if(c===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}let d=new TextDecoder().decode(new Uint8Array(e.buffer,a,c)),f=new DataView(e.buffer,a+c+1,o-c-1);i.set(d,f),n+=4+o+l}return i}var af={extension:{type:z.LoadParser,priority:he.High},name:"loadDDS",test(e){return Le(e,".dds")},async load(e,t,r){let n=await(await W.ADAPTER.fetch(e)).arrayBuffer(),a=ll(n).map(l=>{let c=new ht(l,{mipmap:we.OFF,alphaMode:ue.NO_PREMULTIPLIED_ALPHA,resolution:et.getResolutionOfUrl(e),...t.data});return ni(c,r,e)});return a.length===1?a[0]:a},unload(e){Array.isArray(e)?e.forEach(t=>t.destroy(!0)):e.destroy(!0)}};q.add(af);var hf={extension:{type:z.LoadParser,priority:he.High},name:"loadKTX",test(e){return Le(e,".ktx")},async load(e,t,r){let n=await(await W.ADAPTER.fetch(e)).arrayBuffer(),{compressed:o,uncompressed:a,kvData:l}=cl(e,n),c=o??a,d={mipmap:we.OFF,alphaMode:ue.NO_PREMULTIPLIED_ALPHA,resolution:et.getResolutionOfUrl(e),...t.data},f=c.map(u=>{c===a&&Object.assign(d,{type:u.type,format:u.format});let m=new ht(u,d);return m.ktxKeyValueData=l,ni(m,r,e)});return f.length===1?f[0]:f},unload(e){Array.isArray(e)?e.forEach(t=>t.destroy(!0)):e.destroy(!0)}};q.add(hf);var lf={extension:z.ResolveParser,test:e=>{let r=e.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(r)},parse:e=>{if(e.split("?")[0].split(".").pop()==="ktx"){let i=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(i.some(n=>e.endsWith(n)))return{resolution:parseFloat(W.RETINA_PREFIX.exec(e)?.[1]??"1"),format:i.find(n=>e.endsWith(n)),src:e}}return{resolution:parseFloat(W.RETINA_PREFIX.exec(e)?.[1]??"1"),format:e.split(".").pop(),src:e}}};q.add(lf);var Ob=new ut,Nb=4,uf=class{constructor(e){this.renderer=e}async image(e,t,r){let i=new Image;return i.src=await this.base64(e,t,r),i}async base64(e,t,r){let i=this.canvas(e);if(i.toDataURL!==void 0)return i.toDataURL(t,r);if(i.convertToBlob!==void 0){let n=await i.convertToBlob({type:t,quality:r});return await new Promise(o=>{let a=new FileReader;a.onload=()=>o(a.result),a.readAsDataURL(n)})}throw new Error("Extract.base64() requires ICanvas.toDataURL or ICanvas.convertToBlob to be implemented")}canvas(e,t){let{pixels:r,width:i,height:n,flipY:o}=this._rawPixels(e,t),a=new et.CanvasRenderTarget(i,n,1),l=a.context.getImageData(0,0,i,n);if(uf.arrayPostDivide(r,l.data),a.context.putImageData(l,0,0),o){let c=new et.CanvasRenderTarget(a.width,a.height,1);c.context.scale(1,-1),c.context.drawImage(a.canvas,0,-n),a.destroy(),a=c}return a.canvas}pixels(e,t){let{pixels:r}=this._rawPixels(e,t);return uf.arrayPostDivide(r,r),r}_rawPixels(e,t){let r=this.renderer;if(!r)throw new Error("The Extract has already been destroyed");let i,n=!1,o,a=!1;if(e)if(e instanceof He)o=e;else{let u=r.context.webGLVersion>=2?r.multisample:Lt.NONE;if(o=r.generateTexture(e,{multisample:u}),u!==Lt.NONE){let m=He.create({width:o.width,height:o.height});r.framebuffer.bind(o.framebuffer),r.framebuffer.blit(m.framebuffer),r.framebuffer.bind(),o.destroy(!0),o=m}a=!0}o?(i=o.baseTexture.resolution,t=t??o.frame,n=!1,r.renderTexture.bind(o)):(i=r.resolution,t||(t=Ob,t.width=r.width,t.height=r.height),n=!0,r.renderTexture.bind());let l=Math.round(t.width*i),c=Math.round(t.height*i),d=new Uint8Array(Nb*l*c),f=r.gl;return f.readPixels(Math.round(t.x*i),Math.round(t.y*i),l,c,f.RGBA,f.UNSIGNED_BYTE,d),a&&o?.destroy(!0),{pixels:d,width:l,height:c,flipY:n}}destroy(){this.renderer=null}static arrayPostDivide(e,t){for(let r=0;r<e.length;r+=4){let i=t[r+3]=e[r+3];i!==0?(t[r]=Math.round(Math.min(e[r]*255/i,255)),t[r+1]=Math.round(Math.min(e[r+1]*255/i,255)),t[r+2]=Math.round(Math.min(e[r+2]*255/i,255))):(t[r]=e[r],t[r+1]=e[r+1],t[r+2]=e[r+2])}}},cf=uf;cf.extension={name:"extract",type:z.RendererSystem};q.add(cf);var sn={build(e){let t=e.points,r,i,n,o,a,l;if(e.type===zt.CIRC){let x=e.shape;r=x.x,i=x.y,a=l=x.radius,n=o=0}else if(e.type===zt.ELIP){let x=e.shape;r=x.x,i=x.y,a=x.width,l=x.height,n=o=0}else{let x=e.shape,y=x.width/2,S=x.height/2;r=x.x+y,i=x.y+S,a=l=Math.max(0,Math.min(x.radius,Math.min(y,S))),n=y-a,o=S-l}if(!(a>=0&&l>=0&&n>=0&&o>=0)){t.length=0;return}let c=Math.ceil(2.3*Math.sqrt(a+l)),d=c*8+(n?4:0)+(o?4:0);if(t.length=d,d===0)return;if(c===0){t.length=8,t[0]=t[6]=r+n,t[1]=t[3]=i+o,t[2]=t[4]=r-n,t[5]=t[7]=i-o;return}let f=0,u=c*4+(n?2:0)+2,m=u,g=d;{let x=n+a,y=o,S=r+x,b=r-x,w=i+y;if(t[f++]=S,t[f++]=w,t[--u]=w,t[--u]=b,o){let v=i-y;t[m++]=b,t[m++]=v,t[--g]=v,t[--g]=S}}for(let x=1;x<c;x++){let y=Math.PI/2*(x/c),S=n+Math.cos(y)*a,b=o+Math.sin(y)*l,w=r+S,v=r-S,T=i+b,I=i-b;t[f++]=w,t[f++]=T,t[--u]=T,t[--u]=v,t[m++]=v,t[m++]=I,t[--g]=I,t[--g]=w}{let x=n,y=o+l,S=r+x,b=r-x,w=i+y,v=i-y;t[f++]=S,t[f++]=w,t[--g]=v,t[--g]=S,n&&(t[f++]=b,t[f++]=w,t[--g]=v,t[--g]=b)}},triangulate(e,t){let r=e.points,i=t.points,n=t.indices;if(r.length===0)return;let o=i.length/2,a=o,l,c;if(e.type!==zt.RREC){let f=e.shape;l=f.x,c=f.y}else{let f=e.shape;l=f.x+f.width/2,c=f.y+f.height/2}let d=e.matrix;i.push(e.matrix?d.a*l+d.c*c+d.tx:l,e.matrix?d.b*l+d.d*c+d.ty:c),o++,i.push(r[0],r[1]);for(let f=2;f<r.length;f+=2)i.push(r[f],r[f+1]),n.push(o++,a,o);n.push(a+1,a,o)}};function ux(e,t=!1){let r=e.length;if(r<6)return;let i=0;for(let n=0,o=e[r-2],a=e[r-1];n<r;n+=2){let l=e[n],c=e[n+1];i+=(l-o)*(c+a),o=l,a=c}if(!t&&i>0||t&&i<=0){let n=r/2;for(let o=n+n%2;o<r;o+=2){let a=r-o-2,l=r-o-1,c=o,d=o+1;[e[a],e[c]]=[e[c],e[a]],[e[l],e[d]]=[e[d],e[l]]}}}var $s={build(e){e.points=e.shape.points.slice()},triangulate(e,t){let r=e.points,i=e.holes,n=t.points,o=t.indices;if(r.length>=6){ux(r,!1);let a=[];for(let d=0;d<i.length;d++){let f=i[d];ux(f.points,!0),a.push(r.length/2),r=r.concat(f.points)}let l=et.earcut(r,a,2);if(!l)return;let c=n.length/2;for(let d=0;d<l.length;d+=3)o.push(l[d]+c),o.push(l[d+1]+c),o.push(l[d+2]+c);for(let d=0;d<r.length;d++)n.push(r[d])}}};var fl={build(e){let t=e.shape,r=t.x,i=t.y,n=t.width,o=t.height,a=e.points;a.length=0,n>=0&&o>=0&&a.push(r,i,r+n,i,r+n,i+o,r,i+o)},triangulate(e,t){let r=e.points,i=t.points;if(r.length===0)return;let n=i.length/2;i.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),t.indices.push(n,n+1,n+2,n+1,n+2,n+3)}};var dl={build(e){sn.build(e)},triangulate(e,t){sn.triangulate(e,t)}};var Xe=(e=>(e.MITER="miter",e.BEVEL="bevel",e.ROUND="round",e))(Xe||{}),Xr=(e=>(e.BUTT="butt",e.ROUND="round",e.SQUARE="square",e))(Xr||{}),Pr={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(e,t=20){if(!this.adaptive||!e||isNaN(e))return t;let r=Math.ceil(e/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}};var Vn=class{static curveTo(t,r,i,n,o,a){let l=a[a.length-2],d=a[a.length-1]-r,f=l-t,u=n-r,m=i-t,g=Math.abs(d*m-f*u);if(g<1e-8||o===0)return(a[a.length-2]!==t||a[a.length-1]!==r)&&a.push(t,r),null;let x=d*d+f*f,y=u*u+m*m,S=d*u+f*m,b=o*Math.sqrt(x)/g,w=o*Math.sqrt(y)/g,v=b*S/x,T=w*S/y,I=b*m+w*f,C=b*u+w*d,P=f*(w+v),M=d*(w+v),B=m*(b+T),F=u*(b+T),L=Math.atan2(M-C,P-I),V=Math.atan2(F-C,B-I);return{cx:I+t,cy:C+r,radius:o,startAngle:L,endAngle:V,anticlockwise:f*u>m*d}}static arc(t,r,i,n,o,a,l,c,d){let f=l-a,u=Pr._segmentsCount(Math.abs(f)*o,Math.ceil(Math.abs(f)/Ki)*40),m=f/(u*2),g=m*2,x=Math.cos(m),y=Math.sin(m),S=u-1,b=S%1/S;for(let w=0;w<=S;++w){let v=w+b*w,T=m+a+g*v,I=Math.cos(T),C=-Math.sin(T);d.push((x*I+y*C)*o+i,(x*-C+y*I)*o+n)}}};var js=class{constructor(){this.reset()}begin(t,r,i){this.reset(),this.style=t,this.start=r,this.attribStart=i}end(t,r){this.attribSize=r-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}};var on=class{static curveLength(t,r,i,n,o,a,l,c){let f=0,u=0,m=0,g=0,x=0,y=0,S=0,b=0,w=0,v=0,T=0,I=t,C=r;for(let P=1;P<=10;++P)u=P/10,m=u*u,g=m*u,x=1-u,y=x*x,S=y*x,b=S*t+3*y*u*i+3*x*m*o+g*l,w=S*r+3*y*u*n+3*x*m*a+g*c,v=I-b,T=C-w,I=b,C=w,f+=Math.sqrt(v*v+T*T);return f}static curveTo(t,r,i,n,o,a,l){let c=l[l.length-2],d=l[l.length-1];l.length-=2;let f=Pr._segmentsCount(on.curveLength(c,d,t,r,i,n,o,a)),u=0,m=0,g=0,x=0,y=0;l.push(c,d);for(let S=1,b=0;S<=f;++S)b=S/f,u=1-b,m=u*u,g=m*u,x=b*b,y=x*b,l.push(g*c+3*m*b*t+3*u*x*i+y*o,g*d+3*m*b*r+3*u*x*n+y*a)}};function cx(e,t,r,i,n,o,a,l){let c=e-r*n,d=t-i*n,f=e+r*o,u=t+i*o,m,g;a?(m=i,g=-r):(m=-i,g=r);let x=c+m,y=d+g,S=f+m,b=u+g;return l.push(x,y,S,b),2}function Wn(e,t,r,i,n,o,a,l){let c=r-e,d=i-t,f=Math.atan2(c,d),u=Math.atan2(n-e,o-t);l&&f<u?f+=Math.PI*2:!l&&f>u&&(u+=Math.PI*2);let m=f,g=u-f,x=Math.abs(g),y=Math.sqrt(c*c+d*d),S=(15*x*Math.sqrt(y)/Math.PI>>0)+1,b=g/S;if(m+=b,l){a.push(e,t,r,i);for(let w=1,v=m;w<S;w++,v+=b)a.push(e,t,e+Math.sin(v)*y,t+Math.cos(v)*y);a.push(e,t,n,o)}else{a.push(r,i,e,t);for(let w=1,v=m;w<S;w++,v+=b)a.push(e+Math.sin(v)*y,t+Math.cos(v)*y,e,t);a.push(n,o,e,t)}return S*2}function Ub(e,t){let r=e.shape,i=e.points||r.points.slice(),n=t.closePointEps;if(i.length===0)return;let o=e.lineStyle,a=new dt(i[0],i[1]),l=new dt(i[i.length-2],i[i.length-1]),c=r.type!==zt.POLY||r.closeStroke,d=Math.abs(a.x-l.x)<n&&Math.abs(a.y-l.y)<n;if(c){i=i.slice(),d&&(i.pop(),i.pop(),l.set(i[i.length-2],i[i.length-1]));let rt=(a.x+l.x)*.5,Y=(l.y+a.y)*.5;i.unshift(rt,Y),i.push(rt,Y)}let f=t.points,u=i.length/2,m=i.length,g=f.length/2,x=o.width/2,y=x*x,S=o.miterLimit*o.miterLimit,b=i[0],w=i[1],v=i[2],T=i[3],I=0,C=0,P=-(w-T),M=b-v,B=0,F=0,L=Math.sqrt(P*P+M*M);P/=L,M/=L,P*=x,M*=x;let V=o.alignment,N=(1-V)*2,k=V*2;c||(o.cap===Xr.ROUND?m+=Wn(b-P*(N-k)*.5,w-M*(N-k)*.5,b-P*N,w-M*N,b+P*k,w+M*k,f,!0)+2:o.cap===Xr.SQUARE&&(m+=cx(b,w,P,M,N,k,!0,f))),f.push(b-P*N,w-M*N,b+P*k,w+M*k);for(let rt=1;rt<u-1;++rt){b=i[(rt-1)*2],w=i[(rt-1)*2+1],v=i[rt*2],T=i[rt*2+1],I=i[(rt+1)*2],C=i[(rt+1)*2+1],P=-(w-T),M=b-v,L=Math.sqrt(P*P+M*M),P/=L,M/=L,P*=x,M*=x,B=-(T-C),F=v-I,L=Math.sqrt(B*B+F*F),B/=L,F/=L,B*=x,F*=x;let Y=v-b,J=w-T,st=v-I,xt=C-T,Tt=Y*st+J*xt,Ct=J*st-xt*Y,yt=Ct<0;if(Math.abs(Ct)<.001*Math.abs(Tt)){f.push(v-P*N,T-M*N,v+P*k,T+M*k),Tt>=0&&(o.join===Xe.ROUND?m+=Wn(v,T,v-P*N,T-M*N,v-B*N,T-F*N,f,!1)+4:m+=2,f.push(v-B*k,T-F*k,v+B*N,T+F*N));continue}let Ht=(-P+b)*(-M+T)-(-P+v)*(-M+w),Bt=(-B+I)*(-F+T)-(-B+v)*(-F+C),Jt=(Y*Bt-st*Ht)/Ct,xe=(xt*Ht-J*Bt)/Ct,Yt=(Jt-v)*(Jt-v)+(xe-T)*(xe-T),Vt=v+(Jt-v)*N,jt=T+(xe-T)*N,Dt=v-(Jt-v)*k,Ot=T-(xe-T)*k,Yr=Math.min(Y*Y+J*J,st*st+xt*xt),Ce=yt?N:k,dn=Yr+Ce*Ce*y,jn=Yt<=dn,rr=o.join;if(rr===Xe.MITER&&Yt/y>S&&(rr=Xe.BEVEL),jn)switch(rr){case Xe.MITER:{f.push(Vt,jt,Dt,Ot);break}case Xe.BEVEL:{yt?f.push(Vt,jt,v+P*k,T+M*k,Vt,jt,v+B*k,T+F*k):f.push(v-P*N,T-M*N,Dt,Ot,v-B*N,T-F*N,Dt,Ot),m+=2;break}case Xe.ROUND:{yt?(f.push(Vt,jt,v+P*k,T+M*k),m+=Wn(v,T,v+P*k,T+M*k,v+B*k,T+F*k,f,!0)+4,f.push(Vt,jt,v+B*k,T+F*k)):(f.push(v-P*N,T-M*N,Dt,Ot),m+=Wn(v,T,v-P*N,T-M*N,v-B*N,T-F*N,f,!1)+4,f.push(v-B*N,T-F*N,Dt,Ot));break}}else{switch(f.push(v-P*N,T-M*N,v+P*k,T+M*k),rr){case Xe.MITER:{yt?f.push(Dt,Ot,Dt,Ot):f.push(Vt,jt,Vt,jt),m+=2;break}case Xe.ROUND:{yt?m+=Wn(v,T,v+P*k,T+M*k,v+B*k,T+F*k,f,!0)+2:m+=Wn(v,T,v-P*N,T-M*N,v-B*N,T-F*N,f,!1)+2;break}}f.push(v-B*N,T-F*N,v+B*k,T+F*k),m+=2}}b=i[(u-2)*2],w=i[(u-2)*2+1],v=i[(u-1)*2],T=i[(u-1)*2+1],P=-(w-T),M=b-v,L=Math.sqrt(P*P+M*M),P/=L,M/=L,P*=x,M*=x,f.push(v-P*N,T-M*N,v+P*k,T+M*k),c||(o.cap===Xr.ROUND?m+=Wn(v-P*(N-k)*.5,T-M*(N-k)*.5,v-P*N,T-M*N,v+P*k,T+M*k,f,!1)+2:o.cap===Xr.SQUARE&&(m+=cx(v,T,P,M,N,k,!1,f)));let Z=t.indices,j=Pr.epsilon*Pr.epsilon;for(let rt=g;rt<m+g-2;++rt)b=f[rt*2],w=f[rt*2+1],v=f[(rt+1)*2],T=f[(rt+1)*2+1],I=f[(rt+2)*2],C=f[(rt+2)*2+1],!(Math.abs(b*(T-C)+v*(C-w)+I*(w-T))<j)&&Z.push(rt,rt+1,rt+2)}function Gb(e,t){let r=0,i=e.shape,n=e.points||i.points,o=i.type!==zt.POLY||i.closeStroke;if(n.length===0)return;let a=t.points,l=t.indices,c=n.length/2,d=a.length/2,f=d;for(a.push(n[0],n[1]),r=1;r<c;r++)a.push(n[r*2],n[r*2+1]),l.push(f,f+1),f++;o&&l.push(f,d)}function ua(e,t){e.lineStyle.native?Gb(e,t):Ub(e,t)}var an=class{static curveLength(t,r,i,n,o,a){let l=t-2*i+o,c=r-2*n+a,d=2*i-2*t,f=2*n-2*r,u=4*(l*l+c*c),m=4*(l*d+c*f),g=d*d+f*f,x=2*Math.sqrt(u+m+g),y=Math.sqrt(u),S=2*u*y,b=2*Math.sqrt(g),w=m/y;return(S*x+y*m*(x-b)+(4*g*u-m*m)*Math.log((2*y+w+x)/(w+b)))/(4*S)}static curveTo(t,r,i,n,o){let a=o[o.length-2],l=o[o.length-1],c=Pr._segmentsCount(an.curveLength(a,l,t,r,i,n)),d=0,f=0;for(let u=1;u<=c;++u){let m=u/c;d=a+(t-a)*m,f=l+(r-l)*m,o.push(d+(t+(i-t)*m-d)*m,f+(r+(n-r)*m-f)*m)}}};var ca={[zt.POLY]:$s,[zt.CIRC]:sn,[zt.ELIP]:sn,[zt.RECT]:fl,[zt.RREC]:dl},pl=[],Ks=[];var hn=class{constructor(t,r=null,i=null,n=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=i,this.fillStyle=r,this.matrix=n,this.type=t.type}clone(){return new hn(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}};var Zs=new dt,fx=class extends bn{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new ri,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Ks.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){let t=this.batches[e];t.reset(),pl.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,r=null,i=null){let n=new hn(e,t,r,i);return this.graphicsData.push(n),this.dirty++,this}drawHole(e,t=null){if(!this.graphicsData.length)return null;let r=new hn(e,null,null,t),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){let t=this.graphicsData;for(let r=0;r<t.length;++r){let i=t[r];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(e,Zs):Zs.copyFrom(e),i.shape.contains(Zs.x,Zs.y))){let n=!1;if(i.holes){for(let o=0;o<i.holes.length;o++)if(i.holes[o].shape.contains(Zs.x,Zs.y)){n=!0;break}}if(!n)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;let e=this.uvs,t=this.graphicsData,r=null,i=null;this.batches.length>0&&(r=this.batches[this.batches.length-1],i=r.style);for(let l=this.shapeIndex;l<t.length;l++){this.shapeIndex++;let c=t[l],d=c.fillStyle,f=c.lineStyle;ca[c.type].build(c),c.matrix&&this.transformPoints(c.points,c.matrix),(d.visible||f.visible)&&this.processHoles(c.holes);for(let m=0;m<2;m++){let g=m===0?d:f;if(!g.visible)continue;let x=g.texture.baseTexture,y=this.indices.length,S=this.points.length/2;x.wrapMode=ur.REPEAT,m===0?this.processFill(c):this.processLine(c);let b=this.points.length/2-S;b!==0&&(r&&!this._compareStyles(i,g)&&(r.end(y,S),r=null),r||(r=pl.pop()||new js,r.begin(g,y,S),this.batches.push(r),i=g),this.addUvs(this.points,e,g.texture,S,b,g.matrix))}}let n=this.indices.length,o=this.points.length/2;if(r&&r.end(n,o),this.batches.length===0){this.batchable=!0;return}let a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){let r=this.graphicsData[e],i=r.fillStyle,n=r.lineStyle;if(i&&!i.texture.baseTexture.valid||n&&!n.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);let e=this.batches;for(let t=0,r=e.length;t<r;t++){let i=e[t];for(let n=0;n<i.size;n++){let o=i.start+n;this.indicesUint16[o]=this.indicesUint16[o]-i.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;let e=this.batches;for(let t=0;t<e.length;t++)if(e[t].style.native)return!1;return this.points.length<fx.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++ht._globalBatch;for(let f=0;f<this.drawCalls.length;f++)this.drawCalls[f].texArray.clear(),Ks.push(this.drawCalls[f]);this.drawCalls.length=0;let t=this.colors,r=this.textureIds,i=Ks.pop();i||(i=new $i,i.texArray=new Zi),i.texArray.count=0,i.start=0,i.size=0,i.type=qe.TRIANGLES;let n=0,o=null,a=0,l=!1,c=qe.TRIANGLES,d=0;this.drawCalls.push(i);for(let f=0;f<this.batches.length;f++){let u=this.batches[f],m=8,g=u.style,x=g.texture.baseTexture;l!==!!g.native&&(l=!!g.native,c=l?qe.LINES:qe.TRIANGLES,o=null,n=m,e++),o!==x&&(o=x,x._batchEnabled!==e&&(n===m&&(e++,n=0,i.size>0&&(i=Ks.pop(),i||(i=new $i,i.texArray=new Zi),this.drawCalls.push(i)),i.start=d,i.size=0,i.texArray.count=0,i.type=c),x.touched=1,x._batchEnabled=e,x._batchLocation=n,x.wrapMode=ur.REPEAT,i.texArray.elements[i.texArray.count++]=x,n++)),i.size+=u.size,d+=u.size,a=x._batchLocation,this.addColors(t,g.color,g.alpha,u.attribSize,u.attribStart),this.addTextureIds(r,a,u.attribSize,u.attribStart)}ht._globalBatch=e,this.packAttributes()}packAttributes(){let e=this.points,t=this.uvs,r=this.colors,i=this.textureIds,n=new ArrayBuffer(e.length*3*4),o=new Float32Array(n),a=new Uint32Array(n),l=0;for(let c=0;c<e.length/2;c++)o[l++]=e[c*2],o[l++]=e[c*2+1],o[l++]=t[c*2],o[l++]=t[c*2+1],a[l++]=r[c],o[l++]=i[c];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?$s.triangulate(e,this):ca[e.type].triangulate(e,this)}processLine(e){ua(e,this);for(let t=0;t<e.holes.length;t++)ua(e.holes[t],this)}processHoles(e){for(let t=0;t<e.length;t++){let r=e[t];ca[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){let e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,t){for(let r=0;r<e.length/2;r++){let i=e[r*2],n=e[r*2+1];e[r*2]=t.a*i+t.c*n+t.tx,e[r*2+1]=t.b*i+t.d*n+t.ty}}addColors(e,t,r,i,n=0){let o=pt.shared.setValue(t).toLittleEndianNumber(),a=pt.shared.setValue(o).toPremultiplied(r);e.length=Math.max(e.length,n+i);for(let l=0;l<i;l++)e[n+l]=a}addTextureIds(e,t,r,i=0){e.length=Math.max(e.length,i+r);for(let n=0;n<r;n++)e[i+n]=t}addUvs(e,t,r,i,n,o=null){let a=0,l=t.length,c=r.frame;for(;a<n;){let f=e[(i+a)*2],u=e[(i+a)*2+1];if(o){let m=o.a*f+o.c*u+o.tx;u=o.b*f+o.d*u+o.ty,f=m}a++,t.push(f/c.width,u/c.height)}let d=r.baseTexture;(c.width<d.width||c.height<d.height)&&this.adjustUvs(t,r,l,n)}adjustUvs(e,t,r,i){let n=t.baseTexture,o=1e-6,a=r+i*2,l=t.frame,c=l.width/n.width,d=l.height/n.height,f=l.x/l.width,u=l.y/l.height,m=Math.floor(e[r]+o),g=Math.floor(e[r+1]+o);for(let x=r+2;x<a;x+=2)m=Math.min(m,Math.floor(e[x]+o)),g=Math.min(g,Math.floor(e[x+1]+o));f-=m,u-=g;for(let x=r;x<a;x+=2)e[x]=(e[x]+f)*c,e[x+1]=(e[x+1]+u)*d}},ml=fx;ml.BATCHABLE_SIZE=100;var Ri=class{constructor(){this.color=16777215,this.alpha=1,this.texture=it.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){let t=new Ri;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=it.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}};var Xn=class extends Ri{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Xr.BUTT,this.join=Xe.MITER,this.miterLimit=10}clone(){let t=new Xn;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}};var ff={},gl=class extends ne{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Ri,this._lineStyle=new Xn,this._matrix=null,this._holeMode=!1,this.state=de.for2d(),this._geometry=e||new ml,this._geometry.refCount++,this._transformID=-1,this._tintColor=new pt(16777215),this.blendMode=ft.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new gl(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,r,i=.5,n=!1){return typeof e=="number"&&(e={width:e,color:t,alpha:r,alignment:i,native:n}),this.lineTextureStyle(e)}lineTextureStyle(e){let t={width:0,texture:it.WHITE,color:e?.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Xr.BUTT,join:Xe.MITER,miterLimit:10};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();let r=e.width>0&&e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:r},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){let e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new Nr,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new Nr,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);let r=this.currentPath.points,i=r[r.length-2],n=r[r.length-1];return(i!==e||n!==t)&&r.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,r,i){this._initCurve();let n=this.currentPath.points;return n.length===0&&this.moveTo(0,0),an.curveTo(e,t,r,i,n),this}bezierCurveTo(e,t,r,i,n,o){return this._initCurve(),on.curveTo(e,t,r,i,n,o,this.currentPath.points),this}arcTo(e,t,r,i,n){this._initCurve(e,t);let o=this.currentPath.points,a=Vn.curveTo(e,t,r,i,n,o);if(a){let{cx:l,cy:c,radius:d,startAngle:f,endAngle:u,anticlockwise:m}=a;this.arc(l,c,d,f,u,m)}return this}arc(e,t,r,i,n,o=!1){if(i===n)return this;if(!o&&n<=i?n+=Ki:o&&i<=n&&(i+=Ki),n-i===0)return this;let l=e+Math.cos(i)*r,c=t+Math.sin(i)*r,d=this._geometry.closePointEps,f=this.currentPath?this.currentPath.points:null;if(f){let u=Math.abs(f[f.length-2]-l),m=Math.abs(f[f.length-1]-c);u<d&&m<d||f.push(l,c)}else this.moveTo(l,c),f=this.currentPath.points;return Vn.arc(l,c,e,t,r,i,n,o,f),this}beginFill(e=0,t){return this.beginTextureFill({texture:it.WHITE,color:e,alpha:t})}normalizeColor(e){let t=pt.shared.setValue(e.color??0);e.color=t.toNumber(),e.alpha??(e.alpha=t.alpha)}beginTextureFill(e){let t={texture:it.WHITE,color:16777215,matrix:null};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();let r=e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:r},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,r,i){return this.drawShape(new ut(e,t,r,i))}drawRoundedRect(e,t,r,i,n){return this.drawShape(new Rn(e,t,r,i,n))}drawCircle(e,t,r){return this.drawShape(new An(e,t,r))}drawEllipse(e,t,r,i){return this.drawShape(new Cn(e,t,r,i))}drawPolygon(...e){let t,r=!0,i=e[0];i.points?(r=i.closeStroke,t=i.points):Array.isArray(e[0])?t=e[0]:t=e;let n=new Nr(t);return n.closeStroke=r,this.drawShape(n),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){let e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===zt.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();let t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){let e=this._geometry,t=this.blendMode,r=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(e.points);for(let i=0;i<r;i++){let n=e.batches[i],o=n.style.color,a=new Float32Array(this.vertexData.buffer,n.attribStart*4*2,n.attribSize*2),l=new Float32Array(e.uvsFloat32.buffer,n.attribStart*4*2,n.attribSize*2),c=new Uint16Array(e.indicesUint16.buffer,n.start*2,n.size),d={vertexData:a,blendMode:t,indices:c,uvs:l,_batchRGB:pt.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[i]=d}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,r=this.batches.length;t<r;t++){let i=this.batches[t];i.worldAlpha=this.worldAlpha*i.alpha,e.plugins[this.pluginName].render(i)}}}_renderDirect(e){let t=this._resolveDirectShader(e),r=this._geometry,i=this.worldAlpha,n=t.uniforms,o=r.drawCalls;n.translationMatrix=this.transform.worldTransform,pt.shared.setValue(this._tintColor).multiply([i,i,i]).setAlpha(i).toArray(n.tint),e.shader.bind(t),e.geometry.bind(r,t),e.state.set(this.state);for(let a=0,l=o.length;a<l;a++)this._renderDrawCallDirect(e,r.drawCalls[a])}_renderDrawCallDirect(e,t){let{texArray:r,type:i,size:n,start:o}=t,a=r.count;for(let l=0;l<a;l++)e.texture.bind(r.elements[l],l);e.geometry.draw(i,n,o)}_resolveDirectShader(e){let t=this.shader,r=this.pluginName;if(!t){if(!ff[r]){let{maxTextures:i}=e.plugins[r],n=new Int32Array(i);for(let l=0;l<i;l++)n[l]=l;let o={tint:new Float32Array([1,1,1,1]),translationMatrix:new St,default:pe.from({uSamplers:n},!0)},a=e.plugins[r]._shader.program;ff[r]=new me(a,o)}t=ff[r]}return t}_calculateBounds(){this.finishPoly();let e=this._geometry;if(!e.graphicsData.length)return;let{minX:t,minY:r,maxX:i,maxY:n}=e.bounds;this._bounds.addFrame(this.transform,t,r,i,n)}containsPoint(e){return this.worldTransform.applyInverse(e,gl._TEMP_POINT),this._geometry.containsPoint(gl._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){let t=this.batches[e];t._tintRGB=pt.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){let e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;let t=this.transform.worldTransform,r=t.a,i=t.b,n=t.c,o=t.d,a=t.tx,l=t.ty,c=this._geometry.points,d=this.vertexData,f=0;for(let u=0;u<c.length;u+=2){let m=c[u],g=c[u+1];d[f++]=r*m+n*g+a,d[f++]=o*g+i*m+l}}closePath(){let e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}},ln=gl;ln.curves=Pr;ln._TEMP_POINT=new dt;var fa=class{constructor(t,r){this.uvBuffer=t,this.uvMatrix=r,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;let r=this.uvBuffer.data;(!this.data||this.data.length!==r.length)&&(this.data=new Float32Array(r.length)),this.uvMatrix.multiplyUvs(r,this.data),this._updateID++}};var df=new dt,dx=new Nr,px=class extends ne{constructor(e,t,r,i=qe.TRIANGLES){super(),this.geometry=e,this.shader=t,this.state=r||de.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=W.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){let t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===qe.TRIANGLES&&t.length<px.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){let t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){let t=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;let i=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[i]),e.plugins[i].render(this)}calculateVertices(){let t=this.geometry.buffers[0],r=t.data,i=t._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));let n=this.transform.worldTransform,o=n.a,a=n.b,l=n.c,c=n.d,d=n.tx,f=n.ty,u=this.vertexData;for(let m=0;m<u.length/2;m++){let g=r[m*2],x=r[m*2+1];u[m*2]=o*g+l*x+d,u[m*2+1]=a*g+c*x+f}if(this._roundPixels){let m=W.RESOLUTION;for(let g=0;g<u.length;++g)u[g]=Math.round(u[g]*m)/m}this.vertexDirty=i}calculateUvs(){let e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new fa(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,df);let t=this.geometry.getBuffer("aVertexPosition").data,r=dx.points,i=this.geometry.getIndex().data,n=i.length,o=this.drawMode===4?3:1;for(let a=0;a+2<n;a+=o){let l=i[a]*2,c=i[a+1]*2,d=i[a+2]*2;if(r[0]=t[l],r[1]=t[l+1],r[2]=t[c],r[3]=t[c+1],r[4]=t[d],r[5]=t[d+1],dx.contains(df.x,df.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}},un=px;un.BATCHABLE_SIZE=100;var cn=class extends Me{constructor(t,r,i){super();let n=new Gt(t),o=new Gt(r,!0),a=new Gt(i,!0,!0);this.addAttribute("aVertexPosition",n,2,!1,at.FLOAT).addAttribute("aTextureCoord",o,2,!1,at.FLOAT).addIndex(a),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}};var mx=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`;var gx=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;var Ii=class extends me{constructor(t,r){let i={uSampler:t,alpha:1,uTextureMatrix:St.IDENTITY,uColor:new Float32Array([1,1,1,1])};r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r),r.uniforms&&Object.assign(i,r.uniforms),super(r.program||Ee.from(gx,mx),i),this._colorDirty=!1,this.uvMatrix=new Qi(t),this.batchable=r.program===void 0,this.pluginName=r.pluginName,this._tintColor=new pt(r.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=r.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;let r=this.texture.baseTexture.alphaMode;pt.shared.setValue(this._tintColor).premultiply(this._alpha,r).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}};var da=class{constructor(t,r,i){this.geometry=new Me,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let n=0;n<t.length;++n){let o=t[n];o={attributeName:o.attributeName,size:o.size,uploadFunction:o.uploadFunction,type:o.type||at.FLOAT,offset:o.offset},r[n]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){let t=this.geometry,r=0;this.indexBuffer=new Gt(et.createIndicesForQuads(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let a=0;a<this.dynamicProperties.length;++a){let l=this.dynamicProperties[a];l.offset=r,r+=l.size,this.dynamicStride+=l.size}let i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new Gt(this.dynamicData,!1,!1);let n=0;this.staticStride=0;for(let a=0;a<this.staticProperties.length;++a){let l=this.staticProperties[a];l.offset=n,n+=l.size,this.staticStride+=l.size}let o=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(o),this.staticDataUint32=new Uint32Array(o),this.staticBuffer=new Gt(this.staticData,!0,!1);for(let a=0;a<this.dynamicProperties.length;++a){let l=this.dynamicProperties[a];t.addAttribute(l.attributeName,this.dynamicBuffer,0,l.type===at.UNSIGNED_BYTE,l.type,this.dynamicStride*4,l.offset*4)}for(let a=0;a<this.staticProperties.length;++a){let l=this.staticProperties[a];t.addAttribute(l.attributeName,this.staticBuffer,0,l.type===at.UNSIGNED_BYTE,l.type,this.staticStride*4,l.offset*4)}}uploadDynamic(t,r,i){for(let n=0;n<this.dynamicProperties.length;n++){let o=this.dynamicProperties[n];o.uploadFunction(t,r,i,o.type===at.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,o.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,r,i){for(let n=0;n<this.staticProperties.length;n++){let o=this.staticProperties[n];o.uploadFunction(t,r,i,o.type===at.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,o.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}};var xx=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`;var _x=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;var pa=class extends Ur{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new St,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:at.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=me.from(_x,xx,{}),this.state=de.for2d()}render(t){let r=t.children,i=t._maxSize,n=t._batchSize,o=this.renderer,a=r.length;if(a===0)return;a>i&&!t.autoResize&&(a=i);let l=t._buffers;l||(l=t._buffers=this.generateBuffers(t));let c=r[0]._texture.baseTexture,d=c.alphaMode>0;this.state.blendMode=et.correctBlendMode(t.blendMode,d),o.state.set(this.state);let f=o.gl,u=t.worldTransform.copyTo(this.tempMatrix);u.prepend(o.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=u.toArray(!0),this.shader.uniforms.uColor=pt.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,d).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=c,this.renderer.shader.bind(this.shader);let m=!1;for(let g=0,x=0;g<a;g+=n,x+=1){let y=a-g;y>n&&(y=n),x>=l.length&&l.push(this._generateOneMoreBuffer(t));let S=l[x];S.uploadDynamic(r,g,y);let b=t._bufferUpdateIDs[x]||0;m=m||S._updateID<b,m&&(S._updateID=t._updateID,S.uploadStatic(r,g,y)),o.geometry.bind(S.geometry),f.drawElements(f.TRIANGLES,y*6,f.UNSIGNED_SHORT,0)}}generateBuffers(t){let r=[],i=t._maxSize,n=t._batchSize,o=t._properties;for(let a=0;a<i;a+=n)r.push(new da(this.properties,o,n));return r}_generateOneMoreBuffer(t){let r=t._batchSize,i=t._properties;return new da(this.properties,i,r)}uploadVertices(t,r,i,n,o,a){let l=0,c=0,d=0,f=0;for(let u=0;u<i;++u){let m=t[r+u],g=m._texture,x=m.scale.x,y=m.scale.y,S=g.trim,b=g.orig;S?(c=S.x-m.anchor.x*b.width,l=c+S.width,f=S.y-m.anchor.y*b.height,d=f+S.height):(l=b.width*(1-m.anchor.x),c=b.width*-m.anchor.x,d=b.height*(1-m.anchor.y),f=b.height*-m.anchor.y),n[a]=c*x,n[a+1]=f*y,n[a+o]=l*x,n[a+o+1]=f*y,n[a+o*2]=l*x,n[a+o*2+1]=d*y,n[a+o*3]=c*x,n[a+o*3+1]=d*y,a+=o*4}}uploadPosition(t,r,i,n,o,a){for(let l=0;l<i;l++){let c=t[r+l].position;n[a]=c.x,n[a+1]=c.y,n[a+o]=c.x,n[a+o+1]=c.y,n[a+o*2]=c.x,n[a+o*2+1]=c.y,n[a+o*3]=c.x,n[a+o*3+1]=c.y,a+=o*4}}uploadRotation(t,r,i,n,o,a){for(let l=0;l<i;l++){let c=t[r+l].rotation;n[a]=c,n[a+o]=c,n[a+o*2]=c,n[a+o*3]=c,a+=o*4}}uploadUvs(t,r,i,n,o,a){for(let l=0;l<i;++l){let c=t[r+l]._texture._uvs;c?(n[a]=c.x0,n[a+1]=c.y0,n[a+o]=c.x1,n[a+o+1]=c.y1,n[a+o*2]=c.x2,n[a+o*2+1]=c.y2,n[a+o*3]=c.x3,n[a+o*3+1]=c.y3,a+=o*4):(n[a]=0,n[a+1]=0,n[a+o]=0,n[a+o+1]=0,n[a+o*2]=0,n[a+o*2+1]=0,n[a+o*3]=0,n[a+o*3+1]=0,a+=o*4)}}uploadTint(t,r,i,n,o,a){for(let l=0;l<i;++l){let c=t[r+l],d=pt.shared.setValue(c._tintRGB).toPremultiplied(c.alpha);n[a]=d,n[a+o]=d,n[a+o*2]=d,n[a+o*3]=d,a+=o*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}};pa.extension={name:"particle",type:z.RendererPlugin};q.add(pa);var fn=(e=>(e[e.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",e[e.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",e))(fn||{});var xl={willReadFrequently:!0},ct=class{static get experimentalLetterSpacingSupported(){let e=ct._experimentalLetterSpacingSupported;if(e!==void 0){let t=W.ADAPTER.getCanvasRenderingContext2D().prototype;e=ct._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,r,i,n,o,a,l,c){this.text=e,this.style=t,this.width=r,this.height=i,this.lines=n,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=c}static measureText(e,t,r,i=ct._canvas){r=r??t.wordWrap;let n=t.toFontString(),o=ct.measureFont(n);o.fontSize===0&&(o.fontSize=t.fontSize,o.ascent=t.fontSize);let a=i.getContext("2d",xl);a.font=n;let c=(r?ct.wordWrap(e,t,i):e).split(/(?:\r\n|\r|\n)/),d=new Array(c.length),f=0;for(let x=0;x<c.length;x++){let y=ct._measureText(c[x],t.letterSpacing,a);d[x]=y,f=Math.max(f,y)}let u=f+t.strokeThickness;t.dropShadow&&(u+=t.dropShadowDistance);let m=t.lineHeight||o.fontSize+t.strokeThickness,g=Math.max(m,o.fontSize+t.strokeThickness*2)+(c.length-1)*(m+t.leading);return t.dropShadow&&(g+=t.dropShadowDistance),new ct(e,t,u,g,c,d,m+t.leading,f,o)}static _measureText(e,t,r){let i=!1;ct.experimentalLetterSpacingSupported&&(ct.experimentalLetterSpacing?(r.letterSpacing=`${t}px`,r.textLetterSpacing=`${t}px`,i=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));let n=r.measureText(e).width;return n>0&&(i?n-=t:n+=(ct.graphemeSegmenter(e).length-1)*t),n}static wordWrap(e,t,r=ct._canvas){let i=r.getContext("2d",xl),n=0,o="",a="",l=Object.create(null),{letterSpacing:c,whiteSpace:d}=t,f=ct.collapseSpaces(d),u=ct.collapseNewlines(d),m=!f,g=t.wordWrapWidth+c,x=ct.tokenize(e);for(let y=0;y<x.length;y++){let S=x[y];if(ct.isNewline(S)){if(!u){a+=ct.addLine(o),m=!f,o="",n=0;continue}S=" "}if(f){let w=ct.isBreakingSpace(S),v=ct.isBreakingSpace(o[o.length-1]);if(w&&v)continue}let b=ct.getFromCache(S,c,l,i);if(b>g)if(o!==""&&(a+=ct.addLine(o),o="",n=0),ct.canBreakWords(S,t.breakWords)){let w=ct.wordWrapSplit(S);for(let v=0;v<w.length;v++){let T=w[v],I=T,C=1;for(;w[v+C];){let M=w[v+C];if(!ct.canBreakChars(I,M,S,v,t.breakWords))T+=M;else break;I=M,C++}v+=C-1;let P=ct.getFromCache(T,c,l,i);P+n>g&&(a+=ct.addLine(o),m=!1,o="",n=0),o+=T,n+=P}}else{o.length>0&&(a+=ct.addLine(o),o="",n=0);let w=y===x.length-1;a+=ct.addLine(S,!w),m=!1,o="",n=0}else b+n>g&&(m=!1,a+=ct.addLine(o),o="",n=0),(o.length>0||!ct.isBreakingSpace(S)||m)&&(o+=S,n+=b)}return a+=ct.addLine(o,!1),a}static addLine(e,t=!0){return e=ct.trimRight(e),e=t?`${e}
`:e,e}static getFromCache(e,t,r,i){let n=r[e];return typeof n!="number"&&(n=ct._measureText(e,t,i)+t,r[e]=n),n}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){let r=e[t];if(!ct.isBreakingSpace(r))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:ct._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:ct._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){let t=[],r="";if(typeof e!="string")return t;for(let i=0;i<e.length;i++){let n=e[i],o=e[i+1];if(ct.isBreakingSpace(n,o)||ct.isNewline(n)){r!==""&&(t.push(r),r=""),t.push(n);continue}r+=n}return r!==""&&t.push(r),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,r,i,n){return!0}static wordWrapSplit(e){return ct.graphemeSegmenter(e)}static measureFont(e){if(ct._fonts[e])return ct._fonts[e];let t={ascent:0,descent:0,fontSize:0},r=ct._canvas,i=ct._context;i.font=e;let n=ct.METRICS_STRING+ct.BASELINE_SYMBOL,o=Math.ceil(i.measureText(n).width),a=Math.ceil(i.measureText(ct.BASELINE_SYMBOL).width),l=Math.ceil(ct.HEIGHT_MULTIPLIER*a);if(a=a*ct.BASELINE_MULTIPLIER|0,o===0||l===0)return ct._fonts[e]=t,t;r.width=o,r.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(n,0,a);let c=i.getImageData(0,0,o,l).data,d=c.length,f=o*4,u=0,m=0,g=!1;for(u=0;u<a;++u){for(let x=0;x<f;x+=4)if(c[m+x]!==255){g=!0;break}if(!g)m+=f;else break}for(t.ascent=a-u,m=d-f,g=!1,u=l;u>a;--u){for(let x=0;x<f;x+=4)if(c[m+x]!==255){g=!0;break}if(!g)m-=f;else break}return t.descent=u-a,t.fontSize=t.ascent+t.descent,ct._fonts[e]=t,t}static clearMetrics(e=""){e?delete ct._fonts[e]:ct._fonts={}}static get _canvas(){if(!ct.__canvas){let e;try{let t=new OffscreenCanvas(0,0);if(t.getContext("2d",xl)?.measureText)return ct.__canvas=t,t;e=W.ADAPTER.createCanvas()}catch{e=W.ADAPTER.createCanvas()}e.width=e.height=10,ct.__canvas=e}return ct.__canvas}static get _context(){return ct.__context||(ct.__context=ct._canvas.getContext("2d",xl)),ct.__context}},le=ct;le.METRICS_STRING="|\xC9q\xC5";le.BASELINE_SYMBOL="M";le.BASELINE_MULTIPLIER=1.4;le.HEIGHT_MULTIPLIER=2;le.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){let e=new Intl.Segmenter;return t=>[...e.segment(t)].map(r=>r.segment)}return e=>[...e]})();le.experimentalLetterSpacing=!1;le._fonts={};le._newlines=[10,13];le._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var Wb=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],ma=class{constructor(e){this.styleID=0,this.reset(),mf(this,e,e)}clone(){let e={};return mf(e,this,ma.defaultStyle),new ma(e)}reset(){mf(this,ma.defaultStyle,ma.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){let t=pf(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){let t=pf(e);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){Xb(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){let t=pf(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){let e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize,t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let r=t.length-1;r>=0;r--){let i=t[r].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!Wb.includes(i)&&(i=`"${i}"`),t[r]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${t.join(",")}`}},ze=ma;ze.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:fn.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function pf(e){let t=pt.shared;return Array.isArray(e)?e.map(r=>t.setValue(r).toHex()):t.setValue(e).toHex()}function Xb(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}function mf(e,t,r){for(let i in r)Array.isArray(t[i])?e[i]=t[i].slice():e[i]=t[i]}var zb={texture:!0,children:!1,baseTexture:!0},gf=class extends Be{constructor(e,t,r){let i=!1;r||(r=W.ADAPTER.createCanvas(),i=!0),r.width=3,r.height=3;let n=it.from(r);n.orig=new ut,n.trim=new ut,super(n),this._ownCanvas=i,this.canvas=r,this.context=r.getContext("2d",{willReadFrequently:!0}),this._resolution=gf.defaultResolution??W.RESOLUTION,this._autoResolution=gf.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return le.experimentalLetterSpacing}static set experimentalLetterSpacing(e){et.deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),le.experimentalLetterSpacing=e}updateText(e){let t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();let r=this.context,i=le.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),n=i.width,o=i.height,a=i.lines,l=i.lineHeight,c=i.lineWidths,d=i.maxLineWidth,f=i.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,n)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+t.padding*2)*this._resolution),r.scale(this._resolution,this._resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.lineWidth=t.strokeThickness,r.textBaseline=t.textBaseline,r.lineJoin=t.lineJoin,r.miterLimit=t.miterLimit;let u,m,g=t.dropShadow?2:1;for(let x=0;x<g;++x){let y=t.dropShadow&&x===0,S=y?Math.ceil(Math.max(1,o)+t.padding*2):0,b=S*this._resolution;if(y){r.fillStyle="black",r.strokeStyle="black";let v=t.dropShadowColor,T=t.dropShadowBlur*this._resolution,I=t.dropShadowDistance*this._resolution;r.shadowColor=pt.shared.setValue(v).setAlpha(t.dropShadowAlpha).toRgbaString(),r.shadowBlur=T,r.shadowOffsetX=Math.cos(t.dropShadowAngle)*I,r.shadowOffsetY=Math.sin(t.dropShadowAngle)*I+b}else r.fillStyle=this._generateFillStyle(t,a,i),r.strokeStyle=t.stroke,r.shadowColor="black",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0;let w=(l-f.fontSize)/2;l-f.fontSize<0&&(w=0);for(let v=0;v<a.length;v++)u=t.strokeThickness/2,m=t.strokeThickness/2+v*l+f.ascent+w,t.align==="right"?u+=d-c[v]:t.align==="center"&&(u+=(d-c[v])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(a[v],u+t.padding,m+t.padding-S,!0),t.fill&&this.drawLetterSpacing(a[v],u+t.padding,m+t.padding-S)}this.updateTexture()}drawLetterSpacing(e,t,r,i=!1){let o=this._style.letterSpacing,a=!1;if(le.experimentalLetterSpacingSupported&&(le.experimentalLetterSpacing?(this.context.letterSpacing=`${o}px`,this.context.textLetterSpacing=`${o}px`,a=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),o===0||a){i?this.context.strokeText(e,t,r):this.context.fillText(e,t,r);return}let l=t,c=le.graphemeSegmenter(e),d=this.context.measureText(e).width,f=0;for(let u=0;u<c.length;++u){let m=c[u];i?this.context.strokeText(m,l,r):this.context.fillText(m,l,r);let g="";for(let x=u+1;x<c.length;++x)g+=c[x];f=this.context.measureText(g).width,l+=d-f+o,d=f}}updateTexture(){let e=this.canvas;if(this._style.trim){let o=et.trimCanvas(e);o.data&&(e.width=o.width,e.height=o.height,this.context.putImageData(o.data,0,0))}let t=this._texture,r=this._style,i=r.trim?0:r.padding,n=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-i,t.trim.y=-i,t.orig.width=t._frame.width-i*2,t.orig.height=t._frame.height-i*2,this._onTextureUpdate(),n.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,t,r){let i=e.fill;if(Array.isArray(i)){if(i.length===1)return i[0]}else return i;let n,o=e.dropShadow?e.dropShadowDistance:0,a=e.padding||0,l=this.canvas.width/this._resolution-o-a*2,c=this.canvas.height/this._resolution-o-a*2,d=i.slice(),f=e.fillGradientStops.slice();if(!f.length){let u=d.length+1;for(let m=1;m<u;++m)f.push(m/u)}if(d.unshift(i[0]),f.unshift(0),d.push(i[i.length-1]),f.push(1),e.fillGradientType===fn.LINEAR_VERTICAL){n=this.context.createLinearGradient(l/2,a,l/2,c+a);let u=r.fontProperties.fontSize+e.strokeThickness;for(let m=0;m<t.length;m++){let g=r.lineHeight*(m-1)+u,x=r.lineHeight*m,y=x;m>0&&g>x&&(y=(x+g)/2);let S=x+u,b=r.lineHeight*(m+1),w=S;m+1<t.length&&b<S&&(w=(S+b)/2);let v=(w-y)/c;for(let T=0;T<d.length;T++){let I=0;typeof f[T]=="number"?I=f[T]:I=T/d.length;let C=Math.min(1,Math.max(0,y/c+I*v));C=Number(C.toFixed(5)),n.addColorStop(C,d[T])}}}else{n=this.context.createLinearGradient(a,c/2,l+a,c/2);let u=d.length+1,m=1;for(let g=0;g<d.length;g++){let x;typeof f[g]=="number"?x=f[g]:x=m/u,n.addColorStop(x,d[g]),m++}}return n}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},zb,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);let t=et.sign(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);let t=et.sign(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof ze?this._style=e:this._style=new ze(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}},ga=gf;ga.defaultAutoResolution=!0;var xa=class{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}};function Yb(e,t){let r=!1;if(e?._textures?.length){for(let i=0;i<e._textures.length;i++)if(e._textures[i]instanceof it){let n=e._textures[i].baseTexture;t.includes(n)||(t.push(n),r=!0)}}return r}function $b(e,t){if(e.baseTexture instanceof ht){let r=e.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function jb(e,t){if(e._texture&&e._texture instanceof it){let r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function Kb(e,t){return t instanceof ga?(t.updateText(!0),!0):!1}function Zb(e,t){if(t instanceof ze){let r=t.toFontString();return le.measureFont(r),!0}return!1}function qb(e,t){if(e instanceof ga){t.includes(e.style)||t.push(e.style),t.includes(e)||t.push(e);let r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function Jb(e,t){return e instanceof ze?(t.includes(e)||t.push(e),!0):!1}var vx=class{constructor(e){this.limiter=new xa(vx.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(qb),this.registerFindHook(Jb),this.registerFindHook(Yb),this.registerFindHook($b),this.registerFindHook(jb),this.registerUploadHook(Kb),this.registerUploadHook(Zb)}upload(e){return new Promise(t=>{e&&this.add(e),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,ee.system.addOnce(this.tick,this,pr.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){let e=this.queue[0],t=!1;if(e&&!e._destroyed){for(let r=0,i=this.uploadHooks.length;r<i;r++)if(this.uploadHooks[r](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)ee.system.addOnce(this.tick,this,pr.UTILITY);else{this.ticking=!1;let e=this.completes.slice(0);this.completes.length=0;for(let t=0,r=e.length;t<r;t++)e[t]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let t=0,r=this.addHooks.length;t<r&&!this.addHooks[t](e,this.queue);t++);if(e instanceof ne)for(let t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this}destroy(){this.ticking&&ee.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}},zn=vx;zn.uploadsPerFrame=4;Object.defineProperties(W,{UPLOADS_PER_FRAME:{get(){return zn.uploadsPerFrame},set(e){et.deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),zn.uploadsPerFrame=e}}});function yx(e,t){return t instanceof ht?(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0):!1}function Qb(e,t){if(!(t instanceof ln))return!1;let{geometry:r}=t;t.finishPoly(),r.updateBatches();let{batches:i}=r;for(let n=0;n<i.length;n++){let{texture:o}=i[n].style;o&&yx(e,o.baseTexture)}return r.batchable||e.geometry.bind(r,t._resolveDirectShader(e)),!0}function tA(e,t){return e instanceof ln?(t.push(e),!0):!1}var _a=class extends zn{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(tA),this.registerUploadHook(yx),this.registerUploadHook(Qb)}};_a.extension={name:"prepare",type:z.RendererSystem};q.add(_a);var gV=new dt;var Tx=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`;var Ex=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`;var Sx=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`;var xf=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`;var wx=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;var _l=new St,va=class extends Ur{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new Fn,this.state=de.for2d()}contextChange(){let t=this.renderer,r={globals:t.globalUniforms};this.simpleShader=me.from(xf,wx,r),this.shader=t.context.webGLVersion>1?me.from(Ex,Tx,r):me.from(xf,Sx,r)}render(t){let r=this.renderer,i=this.quad,n=i.vertices;n[0]=n[6]=t._width*-t.anchor.x,n[1]=n[3]=t._height*-t.anchor.y,n[2]=n[4]=t._width*(1-t.anchor.x),n[5]=n[7]=t._height*(1-t.anchor.y);let o=t.uvRespectAnchor?t.anchor.x:0,a=t.uvRespectAnchor?t.anchor.y:0;n=i.uvs,n[0]=n[6]=-o,n[1]=n[3]=-a,n[2]=n[4]=1-o,n[5]=n[7]=1-a,i.invalidate();let l=t._texture,c=l.baseTexture,d=c.alphaMode>0,f=t.tileTransform.localTransform,u=t.uvMatrix,m=c.isPowerOfTwo&&l.frame.width===c.width&&l.frame.height===c.height;m&&(c._glTextures[r.CONTEXT_UID]?m=c.wrapMode!==ur.CLAMP:c.wrapMode===ur.CLAMP&&(c.wrapMode=ur.REPEAT));let g=m?this.simpleShader:this.shader,x=l.width,y=l.height,S=t._width,b=t._height;_l.set(f.a*x/S,f.b*x/b,f.c*y/S,f.d*y/b,f.tx/S,f.ty/b),_l.invert(),m?_l.prepend(u.mapCoord):(g.uniforms.uMapCoord=u.mapCoord.toArray(!0),g.uniforms.uClampFrame=u.uClampFrame,g.uniforms.uClampOffset=u.uClampOffset),g.uniforms.uTransform=_l.toArray(!0),g.uniforms.uColor=pt.shared.setValue(t.tint).premultiply(t.worldAlpha,d).toArray(g.uniforms.uColor),g.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),g.uniforms.uSampler=l,r.shader.bind(g),r.geometry.bind(i),this.state.blendMode=et.correctBlendMode(t.blendMode,d),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}};va.extension={name:"tilingSprite",type:z.RendererPlugin};q.add(va);var ya=class{constructor(e,t,r=null){this.linkedSheets=[],this._texture=e instanceof it?e:null,this.baseTexture=e instanceof ht?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;let i=this.baseTexture.resource;this.resolution=this._updateResolution(r||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){let{scale:t}=this.data.meta,r=et.getResolutionOfUrl(e,null);return r===null&&(r=parseFloat(t??"1")),r!==1&&this.baseTexture.setResolution(r),r}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=ya.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e,r=ya.BATCH_SIZE;for(;t-e<r&&t<this._frameKeys.length;){let i=this._frameKeys[t],n=this._frames[i],o=n.frame;if(o){let a=null,l=null,c=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,d=new ut(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);n.rotated?a=new ut(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new ut(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(l=new ut(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new it(this.baseTexture,a,d,l,n.rotated?2:0,n.anchor,n.borders),it.addToCache(this.textures[i],i)}t++}}_processAnimations(){let e=this.data.animations||{};for(let t in e){this.animations[t]=[];for(let r=0;r<e[t].length;r++){let i=e[t][r];this.animations[t].push(this.textures[i])}}}_parseComplete(){let e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*ya.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*ya.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(let t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}},Ta=ya;Ta.BATCH_SIZE=1e3;var eA=["jpg","png","jpeg","avif","webp"];function bx(e,t,r){let i={};if(e.forEach(n=>{i[n]=t}),Object.keys(t.textures).forEach(n=>{i[n]=t.textures[n]}),!r){let n=et.path.dirname(e[0]);t.linkedSheets.forEach((o,a)=>{let l=bx([`${n}/${t.data.meta.related_multi_packs[a]}`],o,!0);Object.assign(i,l)})}return i}var Ax={extension:z.Asset,cache:{test:e=>e instanceof Ta,getCacheableAssets:(e,t)=>bx(e,t,!1)},resolver:{test:e=>{let r=e.split("?")[0].split("."),i=r.pop(),n=r.pop();return i==="json"&&eA.includes(n)},parse:e=>{let t=e.split(".");return{resolution:parseFloat(W.RETINA_PREFIX.exec(e)?.[1]??"1"),format:t[t.length-2],src:e}}},loader:{name:"spritesheetLoader",extension:{type:z.LoadParser,priority:he.Normal},async testParse(e,t){return et.path.extname(t.src).toLowerCase()===".json"&&!!e.frames},async parse(e,t,r){let i=et.path.dirname(t.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");let n=i+e.meta.image;n=Hn(n,t.src);let a=(await r.load([n]))[n],l=new Ta(a.baseTexture,e,t.src);await l.parse();let c=e?.meta?.related_multi_packs;if(Array.isArray(c)){let d=[];for(let u of c){if(typeof u!="string")continue;let m=i+u;t.data?.ignoreMultiPack||(m=Hn(m,t.src),d.push(r.load({src:m,data:{ignoreMultiPack:!0}})))}let f=await Promise.all(d);l.linkedSheets=f,f.forEach(u=>{u.linkedSheets=[l].concat(l.linkedSheets.filter(m=>m!==u))})}return l},unload(e){e.destroy(!0)}}};q.add(Ax);var si=class{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}};var oi=class{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){let r=t.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(let o in r){let a=r[o].match(/^[a-z]+/gm)[0],l=r[o].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),c={};for(let d in l){let f=l[d].split("="),u=f[0],m=f[1].replace(/"/gm,""),g=parseFloat(m),x=isNaN(g)?m:g;c[u]=x}i[a].push(c)}let n=new si;return i.info.forEach(o=>n.info.push({face:o.face,size:parseInt(o.size,10)})),i.common.forEach(o=>n.common.push({lineHeight:parseInt(o.lineHeight,10)})),i.page.forEach(o=>n.page.push({id:parseInt(o.id,10),file:o.file})),i.char.forEach(o=>n.char.push({id:parseInt(o.id,10),page:parseInt(o.page,10),x:parseInt(o.x,10),y:parseInt(o.y,10),width:parseInt(o.width,10),height:parseInt(o.height,10),xoffset:parseInt(o.xoffset,10),yoffset:parseInt(o.yoffset,10),xadvance:parseInt(o.xadvance,10)})),i.kerning.forEach(o=>n.kerning.push({first:parseInt(o.first,10),second:parseInt(o.second,10),amount:parseInt(o.amount,10)})),i.distanceField.forEach(o=>n.distanceField.push({distanceRange:parseInt(o.distanceRange,10),fieldType:o.fieldType})),n}};var Pi=class{static test(t){let r=t;return"getElementsByTagName"in r&&r.getElementsByTagName("page").length&&r.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){let r=new si,i=t.getElementsByTagName("info"),n=t.getElementsByTagName("common"),o=t.getElementsByTagName("page"),a=t.getElementsByTagName("char"),l=t.getElementsByTagName("kerning"),c=t.getElementsByTagName("distanceField");for(let d=0;d<i.length;d++)r.info.push({face:i[d].getAttribute("face"),size:parseInt(i[d].getAttribute("size"),10)});for(let d=0;d<n.length;d++)r.common.push({lineHeight:parseInt(n[d].getAttribute("lineHeight"),10)});for(let d=0;d<o.length;d++)r.page.push({id:parseInt(o[d].getAttribute("id"),10)||0,file:o[d].getAttribute("file")});for(let d=0;d<a.length;d++){let f=a[d];r.char.push({id:parseInt(f.getAttribute("id"),10),page:parseInt(f.getAttribute("page"),10)||0,x:parseInt(f.getAttribute("x"),10),y:parseInt(f.getAttribute("y"),10),width:parseInt(f.getAttribute("width"),10),height:parseInt(f.getAttribute("height"),10),xoffset:parseInt(f.getAttribute("xoffset"),10),yoffset:parseInt(f.getAttribute("yoffset"),10),xadvance:parseInt(f.getAttribute("xadvance"),10)})}for(let d=0;d<l.length;d++)r.kerning.push({first:parseInt(l[d].getAttribute("first"),10),second:parseInt(l[d].getAttribute("second"),10),amount:parseInt(l[d].getAttribute("amount"),10)});for(let d=0;d<c.length;d++)r.distanceField.push({fieldType:c[d].getAttribute("fieldType"),distanceRange:parseInt(c[d].getAttribute("distanceRange"),10)});return r}};var Mi=class{static test(t){return typeof t=="string"&&t.includes("<font>")?Pi.test(W.ADAPTER.parseXML(t)):!1}static parse(t){return Pi.parse(W.ADAPTER.parseXML(t))}};var _f=[oi,Pi,Mi];function vf(e){for(let t=0;t<_f.length;t++)if(_f[t].test(e))return _f[t];return null}function yf(e,t,r,i,n,o){let a=r.fill;if(Array.isArray(a)){if(a.length===1)return a[0]}else return a;let l,c=r.dropShadow?r.dropShadowDistance:0,d=r.padding||0,f=e.width/i-c-d*2,u=e.height/i-c-d*2,m=a.slice(),g=r.fillGradientStops.slice();if(!g.length){let x=m.length+1;for(let y=1;y<x;++y)g.push(y/x)}if(m.unshift(a[0]),g.unshift(0),m.push(a[a.length-1]),g.push(1),r.fillGradientType===fn.LINEAR_VERTICAL){l=t.createLinearGradient(f/2,d,f/2,u+d);let x=0,S=(o.fontProperties.fontSize+r.strokeThickness)/u;for(let b=0;b<n.length;b++){let w=o.lineHeight*b;for(let v=0;v<m.length;v++){let T=0;typeof g[v]=="number"?T=g[v]:T=v/m.length;let I=w/u+T*S,C=Math.max(x,I);C=Math.min(C,1),l.addColorStop(C,m[v]),x=C}}}else{l=t.createLinearGradient(d,u/2,f+d,u/2);let x=m.length+1,y=1;for(let S=0;S<m.length;S++){let b;typeof g[S]=="number"?b=g[S]:b=y/x,l.addColorStop(b,m[S]),y++}}return l}function Tf(e,t,r,i,n,o,a){let l=r.text,c=r.fontProperties;t.translate(i,n),t.scale(o,o);let d=a.strokeThickness/2,f=-(a.strokeThickness/2);if(t.font=a.toFontString(),t.lineWidth=a.strokeThickness,t.textBaseline=a.textBaseline,t.lineJoin=a.lineJoin,t.miterLimit=a.miterLimit,t.fillStyle=yf(e,t,a,o,[l],r),t.strokeStyle=a.stroke,a.dropShadow){let u=a.dropShadowColor,m=a.dropShadowBlur*o,g=a.dropShadowDistance*o;t.shadowColor=pt.shared.setValue(u).setAlpha(a.dropShadowAlpha).toRgbaString(),t.shadowBlur=m,t.shadowOffsetX=Math.cos(a.dropShadowAngle)*g,t.shadowOffsetY=Math.sin(a.dropShadowAngle)*g}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;a.stroke&&a.strokeThickness&&t.strokeText(l,d,f+r.lineHeight-c.descent),a.fill&&t.fillText(l,d,f+r.lineHeight-c.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function Yn(e){return e.codePointAt?e.codePointAt(0):e.charCodeAt(0)}function Ea(e){return Array.from?Array.from(e):e.split("")}function Ef(e){typeof e=="string"&&(e=[e]);let t=[];for(let r=0,i=e.length;r<i;r++){let n=e[r];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);let o=n[0].charCodeAt(0),a=n[1].charCodeAt(0);if(a<o)throw new Error("[BitmapFont]: Invalid character range.");for(let l=o,c=a;l<=c;l++)t.push(String.fromCharCode(l))}else t.push(...Ea(n))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}var zr=class{constructor(e,t,r){let[i]=e.info,[n]=e.common,[o]=e.page,[a]=e.distanceField,l=et.getResolutionOfUrl(o.file),c={};this._ownsTextures=r,this.font=i.face,this.size=i.size,this.lineHeight=n.lineHeight/l,this.chars={},this.pageTextures=c;for(let d=0;d<e.page.length;d++){let{id:f,file:u}=e.page[d];c[f]=t instanceof Array?t[d]:t[u],a?.fieldType&&a.fieldType!=="none"&&(c[f].baseTexture.alphaMode=ue.NO_PREMULTIPLIED_ALPHA,c[f].baseTexture.mipmap=we.OFF)}for(let d=0;d<e.char.length;d++){let{id:f,page:u}=e.char[d],{x:m,y:g,width:x,height:y,xoffset:S,yoffset:b,xadvance:w}=e.char[d];m/=l,g/=l,x/=l,y/=l,S/=l,b/=l,w/=l;let v=new ut(m+c[u].frame.x/l,g+c[u].frame.y/l,x,y);this.chars[f]={xOffset:S,yOffset:b,xAdvance:w,kerning:{},texture:new it(c[u].baseTexture,v),page:u}}for(let d=0;d<e.kerning.length;d++){let{first:f,second:u,amount:m}=e.kerning[d];f/=l,u/=l,m/=l,this.chars[u]&&(this.chars[u].kerning[f]=m)}this.distanceFieldRange=a?.distanceRange,this.distanceFieldType=a?.fieldType?.toLowerCase()??"none"}destroy(){for(let e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(let e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,t,r){let i;if(e instanceof si)i=e;else{let o=vf(e);if(!o)throw new Error("Unrecognized data format for font.");i=o.parse(e)}t instanceof it&&(t=[t]);let n=new zr(i,t,r);return zr.available[n.font]=n,n}static uninstall(e){let t=zr.available[e];if(!t)throw new Error(`No font found named '${e}'`);t.destroy(),delete zr.available[e]}static from(e,t,r){if(!e)throw new Error("[BitmapFont] Property `name` is required.");let{chars:i,padding:n,resolution:o,textureWidth:a,textureHeight:l,...c}=Object.assign({},zr.defaultOptions,r),d=Ef(i),f=t instanceof ze?t:new ze(t),u=a,m=new si;m.info[0]={face:f.fontFamily,size:f.fontSize},m.common[0]={lineHeight:f.fontSize};let g=0,x=0,y,S,b,w=0,v=[],T=[];for(let C=0;C<d.length;C++){y||(y=W.ADAPTER.createCanvas(),y.width=a,y.height=l,S=y.getContext("2d"),b=new ht(y,{resolution:o,...c}),v.push(b),T.push(new it(b)),m.page.push({id:T.length-1,file:""}));let P=d[C],M=le.measureText(P,f,!1,y),B=M.width,F=Math.ceil(M.height),L=Math.ceil((f.fontStyle==="italic"?2:1)*B);if(x>=l-F*o){if(x===0)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${f.fontFamily}', fontSize: ${f.fontSize}px, char: '${P}')`);--C,y=null,S=null,b=null,x=0,g=0,w=0;continue}if(w=Math.max(F+M.fontProperties.descent,w),L*o+g>=u){if(g===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${f.fontFamily}', fontSize: ${f.fontSize}px, char: '${P}')`);--C,x+=w*o,x=Math.ceil(x),g=0,w=0;continue}Tf(y,S,M,g,x,o,f);let V=Yn(M.text);m.char.push({id:V,page:T.length-1,x:g/o,y:x/o,width:L,height:F,xoffset:0,yoffset:0,xadvance:B-(f.dropShadow?f.dropShadowDistance:0)-(f.stroke?f.strokeThickness:0)}),g+=(L+2*n)*o,g=Math.ceil(g)}for(let C=0,P=d.length;C<P;C++){let M=d[C];for(let B=0;B<P;B++){let F=d[B],L=S.measureText(M).width,V=S.measureText(F).width,k=S.measureText(M+F).width-(L+V);k&&m.kerning.push({first:Yn(M),second:Yn(F),amount:k})}}let I=new zr(m,T,!0);return zr.available[e]!==void 0&&zr.uninstall(e),zr.available[e]=I,I}},Ae=zr;Ae.ALPHA=[["a","z"],["A","Z"]," "];Ae.NUMERIC=[["0","9"]];Ae.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];Ae.ASCII=[[" ","~"]];Ae.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:zr.ALPHANUMERIC};Ae.available={};var Cx=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`;var Rx=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;var Ix=[],Px=[],Mx=[],Bx=class extends ne{constructor(e,t={}){super();let{align:r,tint:i,maxWidth:n,letterSpacing:o,fontName:a,fontSize:l}=Object.assign({},Bx.styleDefaults,t);if(!Ae.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=r,this._tintColor=new pt(i),this._font=void 0,this._fontName=a,this._fontSize=l,this.text=e,this._maxWidth=n,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new tr(()=>{this.dirty=!0},this,0,0),this._roundPixels=W.ROUND_PIXELS,this.dirty=!0,this._resolution=W.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){let e=Ae.available[this._fontName],t=this.fontSize,r=t/e.size,i=new dt,n=[],o=[],a=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",c=Ea(l),d=this._maxWidth*e.size/t,f=e.distanceFieldType==="none"?Ix:Px,u=null,m=0,g=0,x=0,y=-1,S=0,b=0,w=0,v=0;for(let F=0;F<c.length;F++){let L=c[F],V=Yn(L);if(/(?:\s)/.test(L)&&(y=F,S=m,v++),L==="\r"||L===`
`){o.push(m),a.push(-1),g=Math.max(g,m),++x,++b,i.x=0,i.y+=e.lineHeight,u=null,v=0;continue}let N=e.chars[V];if(!N)continue;u&&N.kerning[u]&&(i.x+=N.kerning[u]);let k=Mx.pop()||{texture:it.EMPTY,line:0,charCode:0,prevSpaces:0,position:new dt};k.texture=N.texture,k.line=x,k.charCode=V,k.position.x=Math.round(i.x+N.xOffset+this._letterSpacing/2),k.position.y=Math.round(i.y+N.yOffset),k.prevSpaces=v,n.push(k),m=k.position.x+Math.max(N.xAdvance-N.xOffset,N.texture.orig.width),i.x+=N.xAdvance+this._letterSpacing,w=Math.max(w,N.yOffset+N.texture.height),u=V,y!==-1&&d>0&&i.x>d&&(++b,et.removeItems(n,1+y-b,1+F-y),F=y,y=-1,o.push(S),a.push(n.length>0?n[n.length-1].prevSpaces:0),g=Math.max(g,S),x++,i.x=0,i.y+=e.lineHeight,u=null,v=0)}let T=c[c.length-1];T!=="\r"&&T!==`
`&&(/(?:\s)/.test(T)&&(m=S),o.push(m),g=Math.max(g,m),a.push(-1));let I=[];for(let F=0;F<=x;F++){let L=0;this._align==="right"?L=g-o[F]:this._align==="center"?L=(g-o[F])/2:this._align==="justify"&&(L=a[F]<0?0:(g-o[F])/a[F]),I.push(L)}let C=n.length,P={},M=[],B=this._activePagesMeshData;f.push(...B);for(let F=0;F<C;F++){let L=n[F].texture,V=L.baseTexture.uid;if(!P[V]){let N=f.pop();if(!N){let Z=new cn,j,rt;e.distanceFieldType==="none"?(j=new Ii(it.EMPTY),rt=ft.NORMAL):(j=new Ii(it.EMPTY,{program:Ee.from(Rx,Cx),uniforms:{uFWidth:0}}),rt=ft.NORMAL_NPM);let Y=new un(Z,j);Y.blendMode=rt,N={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:Y,vertices:null,uvs:null,indices:null}}N.index=0,N.indexCount=0,N.vertexCount=0,N.uvsCount=0,N.total=0;let{_textureCache:k}=this;k[V]=k[V]||new it(L.baseTexture),N.mesh.texture=k[V],N.mesh.tint=this._tintColor.value,M.push(N),P[V]=N}P[V].total++}for(let F=0;F<B.length;F++)M.includes(B[F])||this.removeChild(B[F].mesh);for(let F=0;F<M.length;F++)M[F].mesh.parent!==this&&this.addChild(M[F].mesh);this._activePagesMeshData=M;for(let F in P){let L=P[F],V=L.total;if(!(L.indices?.length>6*V)||L.vertices.length<un.BATCHABLE_SIZE*2)L.vertices=new Float32Array(4*2*V),L.uvs=new Float32Array(4*2*V),L.indices=new Uint16Array(6*V);else{let N=L.total,k=L.vertices;for(let Z=N*4*2;Z<k.length;Z++)k[Z]=0}L.mesh.size=6*V}for(let F=0;F<C;F++){let L=n[F],V=L.position.x+I[L.line]*(this._align==="justify"?L.prevSpaces:1);this._roundPixels&&(V=Math.round(V));let N=V*r,k=L.position.y*r,Z=L.texture,j=P[Z.baseTexture.uid],rt=Z.frame,Y=Z._uvs,J=j.index++;j.indices[J*6+0]=0+J*4,j.indices[J*6+1]=1+J*4,j.indices[J*6+2]=2+J*4,j.indices[J*6+3]=0+J*4,j.indices[J*6+4]=2+J*4,j.indices[J*6+5]=3+J*4,j.vertices[J*8+0]=N,j.vertices[J*8+1]=k,j.vertices[J*8+2]=N+rt.width*r,j.vertices[J*8+3]=k,j.vertices[J*8+4]=N+rt.width*r,j.vertices[J*8+5]=k+rt.height*r,j.vertices[J*8+6]=N,j.vertices[J*8+7]=k+rt.height*r,j.uvs[J*8+0]=Y.x0,j.uvs[J*8+1]=Y.y0,j.uvs[J*8+2]=Y.x1,j.uvs[J*8+3]=Y.y1,j.uvs[J*8+4]=Y.x2,j.uvs[J*8+5]=Y.y2,j.uvs[J*8+6]=Y.x3,j.uvs[J*8+7]=Y.y3}this._textWidth=g*r,this._textHeight=(i.y+e.lineHeight)*r;for(let F in P){let L=P[F];if(this.anchor.x!==0||this.anchor.y!==0){let Z=0,j=this._textWidth*this.anchor.x,rt=this._textHeight*this.anchor.y;for(let Y=0;Y<L.total;Y++)L.vertices[Z++]-=j,L.vertices[Z++]-=rt,L.vertices[Z++]-=j,L.vertices[Z++]-=rt,L.vertices[Z++]-=j,L.vertices[Z++]-=rt,L.vertices[Z++]-=j,L.vertices[Z++]-=rt}this._maxLineHeight=w*r;let V=L.mesh.geometry.getBuffer("aVertexPosition"),N=L.mesh.geometry.getBuffer("aTextureCoord"),k=L.mesh.geometry.getIndex();V.data=L.vertices,N.data=L.uvs,k.data=L.indices,V.update(),N.update(),k.update()}for(let F=0;F<n.length;F++)Mx.push(n[F]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);let{distanceFieldRange:t,distanceFieldType:r,size:i}=Ae.available[this._fontName];if(r!=="none"){let{a:n,b:o,c:a,d:l}=this.worldTransform,c=Math.sqrt(n*n+o*o),d=Math.sqrt(a*a+l*l),f=(Math.abs(c)+Math.abs(d))/2,u=this.fontSize/i,m=e._view.resolution;for(let g of this._activePagesMeshData)g.mesh.shader.uniforms.uFWidth=f*t*u*m}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){let e=Ae.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!Ae.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??Ae.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){let{_textureCache:t}=this,i=Ae.available[this._fontName].distanceFieldType==="none"?Ix:Px;i.push(...this._activePagesMeshData);for(let n of this._activePagesMeshData)this.removeChild(n.mesh);this._activePagesMeshData=[],i.filter(n=>t[n.mesh.texture.baseTexture.uid]).forEach(n=>{n.mesh.texture=it.EMPTY});for(let n in t)t[n].destroy(),delete t[n];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}},Dx=Bx;Dx.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};var rA=[".xml",".fnt"],Lx={extension:{type:z.LoadParser,priority:he.Normal},name:"loadBitmapFont",test(e){return rA.includes(et.path.extname(e).toLowerCase())},async testParse(e){return oi.test(e)||Mi.test(e)},async parse(e,t,r){let i=oi.test(e)?oi.parse(e):Mi.parse(e),{src:n}=t,{page:o}=i,a=[];for(let d=0;d<o.length;++d){let f=o[d].file,u=et.path.join(et.path.dirname(n),f);u=Hn(u,n),a.push(u)}let l=await r.load(a),c=a.map(d=>l[d]);return Ae.install(i,c,!0)},async load(e,t){return(await W.ADAPTER.fetch(e)).text()},unload(e){e.destroy()}};q.add(Lx);var qs=class extends ze{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new qs(Object.keys(qs.defaultOptions).reduce((t,r)=>({...t,[r]:e[r]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete qs.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,t={}){let{availableFonts:r}=qs;if(r[e]){let i=r[e];return this._fonts.push(i),i.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return W.ADAPTER.fetch(e).then(i=>i.blob()).then(async i=>new Promise((n,o)=>{let a=URL.createObjectURL(i),l=new FileReader;l.onload=()=>n([a,l.result]),l.onerror=o,l.readAsDataURL(i)})).then(async([i,n])=>{let o=Object.assign({family:et.path.basename(e,et.path.extname(e)),weight:"normal",style:"normal",src:i,dataSrc:n,refs:1,originalUrl:e,fontFace:null},t);r[e]=o,this._fonts.push(o),this.styleID++;let a=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style});o.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){let t=e.filter(r=>!this._overrides.includes(r));t.length>0&&(this._overrides.push(...t),this.styleID++)}removeOverride(...e){let t=e.filter(r=>this._overrides.includes(r));t.length>0&&(this._overrides=this._overrides.filter(r=>!t.includes(r)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,t)=>`${e}
            @font-face {
                font-family: "${t.family}";
                src: url('${t.dataSrc}');
                font-weight: ${t.weight};
                font-style: ${t.style}; 
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=et.rgb2hex(e)),typeof e=="number"?et.hex2string(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor),t=this.dropShadowAlpha,r=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),i=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&t<1&&(e+=(t*255|0).toString(16).padStart(2,"0"));let n=`${r}px ${i}px`;return this.dropShadowBlur>0?`text-shadow: ${n} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${n} ${e}`}reset(){Object.assign(this,qs.defaultOptions)}onBeforeDraw(){let{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(t=>setTimeout(t,100)):Promise.resolve()}get isSafari(){let{userAgent:e}=W.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}},$n=qs;$n.availableFonts={};$n.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};var Js=class extends Be{constructor(e="",t={}){super(it.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this._loading=!1,this.localStyleID=-1,this.dirty=!1,this.ownsStyle=!1;let r=new Image,i=it.from(r,{scaleMode:W.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new ut,i.trim=new ut,this.texture=i;let n="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(n,"svg"),l=document.createElementNS(n,"foreignObject"),c=document.createElementNS(o,"div"),d=document.createElementNS(o,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",a.appendChild(l),this.maxWidth=Js.defaultMaxWidth,this.maxHeight=Js.defaultMaxHeight,this._domElement=c,this._styleElement=d,this._svgRoot=a,this._foreignObject=l,this._foreignObject.appendChild(d),this._foreignObject.appendChild(c),this._image=r,this._loadImage=new Image,this._autoResolution=Js.defaultAutoResolution,this._resolution=Js.defaultResolution??W.RESOLUTION,this.text=e,this.style=t}measureText(e){let{text:t,style:r,resolution:i}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:t,style:r.toCSS(i)}),this._styleElement.textContent=r.toGlobalCSS(),document.body.appendChild(this._svgRoot);let n=this._domElement.getBoundingClientRect();this._svgRoot.remove();let o=Math.min(this.maxWidth,Math.ceil(n.width)),a=Math.min(this.maxHeight,Math.ceil(n.height));return this._svgRoot.setAttribute("width",o.toString()),this._svgRoot.setAttribute("height",a.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),r!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(i)}),this._styleElement.textContent=this._style?.toGlobalCSS()),{width:o+r.padding*2,height:a+r.padding*2}}async updateText(e=!0){let{style:t,_image:r,_loadImage:i}=this;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;let{width:n,height:o}=this.measureText();r.width=i.width=Math.ceil(Math.max(1,n)),r.height=i.height=Math.ceil(Math.max(1,o)),this._loading||(this._loading=!0,await new Promise(a=>{i.onload=async()=>{await t.onBeforeDraw(),this._loading=!1,r.src=i.src,i.onload=null,i.src="",this.updateTexture(),a()};let l=new XMLSerializer().serializeToString(this._svgRoot);i.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(l)}`}))}get source(){return this._image}updateTexture(){let{style:e,texture:t,_image:r,resolution:i}=this,{padding:n}=e,{baseTexture:o}=t;t.trim.width=t._frame.width=r.width/i,t.trim.height=t._frame.height=r.height/i,t.trim.x=-n,t.trim.y=-n,t.orig.width=t._frame.width-n*2,t.orig.height=t._frame.height-n*2,this._onTextureUpdate(),o.setRealSize(r.width,r.height,i),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},Js.defaultDestroyOptions,e),super.destroy(e);let t=null;this.ownsStyle&&this._style?.cleanFonts(),this._style=t,this._svgRoot?.remove(),this._svgRoot=t,this._domElement?.remove(),this._domElement=t,this._foreignObject?.remove(),this._foreignObject=t,this._styleElement?.remove(),this._styleElement=t,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=t,this._image.src="",this._image=t}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);let t=et.sign(this.scale.x)||1;this.scale.x=t*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);let t=et.sign(this.scale.y)||1;this.scale.y=t*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof $n?(this.ownsStyle=!1,this._style=e):e instanceof ze?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=$n.from(e)):(this.ownsStyle=!0,this._style=new $n(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}},Sa=Js;Sa.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0};Sa.defaultMaxWidth=2024;Sa.defaultMaxHeight=2024;Sa.defaultAutoResolution=!0;var ge=Sn(vl(),1);var Fx=Sn(vl(),1);function Ox(e,t){return e.anchor.set(.5),e.width=t.w,e.height=t.h,{sprite:e,body:Fx.default.Bodies.rectangle(t.x,t.y,t.w,t.h),update(){this.sprite.x=this.body.position.x,this.sprite.y=this.body.position.y,this.sprite.rotation=this.body.angle}}}var Bi=Sn(vl(),1),Qs=class{constructor(t){this.entity=t}hasJumped=!1;color=16711680;alpha=1;jumpStrength=1;static forceVector(t,r){let i=Bi.default.Vector.create(r.x-t.x,r.y-t.y),n=Math.max(Bi.default.Vector.magnitude(i),400),o=Bi.default.Vector.div(Bi.default.Vector.normalise(i),10);return Bi.default.Vector.mult(o,n/400)}slice(t){Bi.default.Body.applyForce(this.entity.body,this.entity.body.position,Qs.forceVector(this.entity.body.position,t))}jump(){if(!this.hasJumped){let t=Bi.default.Vector.create(0,-.1*this.jumpStrength);Bi.default.Body.applyForce(this.entity.body,this.entity.body.position,t),this.hasJumped=!0}}update(){this.entity.sprite.x=this.entity.body.position.x,this.entity.sprite.y=this.entity.body.position.y,this.entity.sprite.rotation=this.entity.body.angle,this.entity.body.position.y&&(this.hasJumped?this.entity.sprite.alpha=.5:this.entity.sprite.alpha=1)}};var wf=Sn(Nx(),1),nA={C4:new Audio("assets/sfx/C4.wav"),C5:new Audio("assets/sfx/C5.wav"),C6:new Audio("assets/sfx/C6.wav"),B4:new Audio("assets/sfx/B4.wav"),B5:new Audio("assets/sfx/B5.wav"),B6:new Audio("assets/sfx/B6.wav"),G4:new Audio("assets/sfx/G4.wav"),G5:new Audio("assets/sfx/G5.wav"),G6:new Audio("assets/sfx/G6.wav")};function Ux(){wf.default.sample(wf.default.values(nA)).cloneNode(!0).play()}async function sA(){let e=ge.default.Vector.create(0,.5),t=new aa({resizeTo:window,autoDensity:!0,antialias:!1}),r=new ln;document.body.appendChild(t.view),t.renderer.plugins.interaction.cursorStyles.default="crosshair";let i=ge.default.World.create({gravity:{x:e.x,y:e.y,scale:1}}),n=ge.default.Engine.create({world:i}),o=Ox(Be.from("assets/gfx/sprite.png"),{x:0,y:0,w:40,h:40}),a=new Qs(o);t.stage.addChild(o.sprite),t.stage.addChild(r);function l(m){return ge.default.Composite.create({bodies:[ge.default.Bodies.rectangle(t.view.width/2,-m/2,t.view.width,m,{isStatic:!0}),ge.default.Bodies.rectangle(t.view.width/2,t.view.height+m/2,t.view.width,m,{isStatic:!0}),ge.default.Bodies.rectangle(-m/2,t.view.height/2,m,t.view.height,{isStatic:!0}),ge.default.Bodies.rectangle(t.view.width+m/2,t.view.height/2,m,t.view.height,{isStatic:!0})]})}let c=1e3,d=l(c);ge.default.Composite.add(n.world,[d,o.body]);let f=ge.default.Vector.create();window.addEventListener("resize",m=>{ge.default.Composite.remove(n.world,d),d=l(c),ge.default.Composite.add(n.world,d)}),window.addEventListener("mousemove",m=>{f.x=m.x,f.y=m.y}),window.addEventListener("keydown",m=>{m.key===" "&&a.jump()});let u=(m,g)=>{Ux(),a.slice(ge.default.Vector.create(m,g))};window.addEventListener("touchstart",m=>{let g=m.touches[0],x=g.pageX,y=g.pageY;u(x,y)}),window.addEventListener("click",m=>{u(m.x,m.y)}),t.ticker.add(()=>{ge.default.Engine.update(n,Math.floor(t.ticker.deltaMS));let m=a.entity.body.position;(m.x<0||m.x>t.view.width)&&(ge.default.Body.set(a.entity.body,"position",{x:0,y:0}),ge.default.Body.setVelocity(a.entity.body,{x:0,y:0})),(m.y<0||m.y>t.view.height)&&(ge.default.Body.set(a.entity.body,"position",{x:0,y:0}),ge.default.Body.setVelocity(a.entity.body,{x:0,y:0})),a.update()})}window.onload=()=>{sA()};})();
/*! Bundled license information:

punycode/punycode.js:
  (*! https://mths.be/punycode v1.3.2 by @mathias *)

matter-js/build/matter.js:
  (*!
   * matter-js 0.19.0 by @liabru
   * http://brm.io/matter-js/
   * License MIT
   * 
   * The MIT License (MIT)
   * 
   * Copyright (c) Liam Brummitt and contributors.
   * 
   * Permission is hereby granted, free of charge, to any person obtaining a copy
   * of this software and associated documentation files (the "Software"), to deal
   * in the Software without restriction, including without limitation the rights
   * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
   * copies of the Software, and to permit persons to whom the Software is
   * furnished to do so, subject to the following conditions:
   * 
   * The above copyright notice and this permission notice shall be included in
   * all copies or substantial portions of the Software.
   * 
   * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
   * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
   * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
   * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
   * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
   * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
   * THE SOFTWARE.
   *)

lodash/lodash.js:
  (**
   * @license
   * Lodash <https://lodash.com/>
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/
