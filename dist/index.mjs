"use strict";(()=>{var SE=Object.create;var $u=Object.defineProperty;var bE=Object.getOwnPropertyDescriptor;var AE=Object.getOwnPropertyNames;var CE=Object.getPrototypeOf,IE=Object.prototype.hasOwnProperty;var Fr=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),RE=(e,t)=>{for(var r in t)$u(e,r,{get:t[r],enumerable:!0})},PE=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of AE(t))!IE.call(e,n)&&n!==r&&$u(e,n,{get:()=>t[n],enumerable:!(i=bE(t,n))||i.enumerable});return e};var _i=(e,t,r)=>(r=e!=null?SE(CE(e)):{},PE(t||!e||!e.__esModule?$u(r,"default",{value:e,enumerable:!0}):r,e));var _m=Fr((PA,Zu)=>{"use strict";var DE=Object.prototype.hasOwnProperty,ke="~";function To(){}Object.create&&(To.prototype=Object.create(null),new To().__proto__||(ke=!1));function LE(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function gm(e,t,r,i,n){if(typeof r!="function")throw new TypeError("The listener must be a function");var o=new LE(r,i||e,n),a=ke?ke+t:t;return e._events[a]?e._events[a].fn?e._events[a]=[e._events[a],o]:e._events[a].push(o):(e._events[a]=o,e._eventsCount++),e}function yl(e,t){--e._eventsCount===0?e._events=new To:delete e._events[t]}function Pe(){this._events=new To,this._eventsCount=0}Pe.prototype.eventNames=function(){var t=[],r,i;if(this._eventsCount===0)return t;for(i in r=this._events)DE.call(r,i)&&t.push(ke?i.slice(1):i);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};Pe.prototype.listeners=function(t){var r=ke?ke+t:t,i=this._events[r];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,o=i.length,a=new Array(o);n<o;n++)a[n]=i[n].fn;return a};Pe.prototype.listenerCount=function(t){var r=ke?ke+t:t,i=this._events[r];return i?i.fn?1:i.length:0};Pe.prototype.emit=function(t,r,i,n,o,a){var c=ke?ke+t:t;if(!this._events[c])return!1;var f=this._events[c],p=arguments.length,l,h;if(f.fn){switch(f.once&&this.removeListener(t,f.fn,void 0,!0),p){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,r),!0;case 3:return f.fn.call(f.context,r,i),!0;case 4:return f.fn.call(f.context,r,i,n),!0;case 5:return f.fn.call(f.context,r,i,n,o),!0;case 6:return f.fn.call(f.context,r,i,n,o,a),!0}for(h=1,l=new Array(p-1);h<p;h++)l[h-1]=arguments[h];f.fn.apply(f.context,l)}else{var d=f.length,m;for(h=0;h<d;h++)switch(f[h].once&&this.removeListener(t,f[h].fn,void 0,!0),p){case 1:f[h].fn.call(f[h].context);break;case 2:f[h].fn.call(f[h].context,r);break;case 3:f[h].fn.call(f[h].context,r,i);break;case 4:f[h].fn.call(f[h].context,r,i,n);break;default:if(!l)for(m=1,l=new Array(p-1);m<p;m++)l[m-1]=arguments[m];f[h].fn.apply(f[h].context,l)}}return!0};Pe.prototype.on=function(t,r,i){return gm(this,t,r,i,!1)};Pe.prototype.once=function(t,r,i){return gm(this,t,r,i,!0)};Pe.prototype.removeListener=function(t,r,i,n){var o=ke?ke+t:t;if(!this._events[o])return this;if(!r)return yl(this,o),this;var a=this._events[o];if(a.fn)a.fn===r&&(!n||a.once)&&(!i||a.context===i)&&yl(this,o);else{for(var c=0,f=[],p=a.length;c<p;c++)(a[c].fn!==r||n&&!a[c].once||i&&a[c].context!==i)&&f.push(a[c]);f.length?this._events[o]=f.length===1?f[0]:f:yl(this,o)}return this};Pe.prototype.removeAllListeners=function(t){var r;return t?(r=ke?ke+t:t,this._events[r]&&yl(this,r)):(this._events=new To,this._eventsCount=0),this};Pe.prototype.off=Pe.prototype.removeListener;Pe.prototype.addListener=Pe.prototype.on;Pe.prefixed=ke;Pe.EventEmitter=Pe;typeof Zu<"u"&&(Zu.exports=Pe)});var wm=Fr((MA,ec)=>{"use strict";ec.exports=El;ec.exports.default=El;function El(e,t,r){r=r||2;var i=t&&t.length,n=i?t[0]*r:e.length,o=vm(e,0,n,r,!0),a=[];if(!o||o.next===o.prev)return a;var c,f,p,l,h,d,m;if(i&&(o=kE(e,t,o,r)),e.length>80*r){c=p=e[0],f=l=e[1];for(var _=r;_<n;_+=r)h=e[_],d=e[_+1],h<c&&(c=h),d<f&&(f=d),h>p&&(p=h),d>l&&(l=d);m=Math.max(p-c,l-f),m=m!==0?32767/m:0}return wo(o,a,r,c,f,m,0),a}function vm(e,t,r,i,n){var o,a;if(n===tc(e,t,r,i)>0)for(o=t;o<r;o+=i)a=xm(o,e[o],e[o+1],a);else for(o=r-i;o>=t;o-=i)a=xm(o,e[o],e[o+1],a);return a&&Sl(a,a.next)&&(So(a),a=a.next),a}function Sn(e,t){if(!e)return e;t||(t=e);var r=e,i;do if(i=!1,!r.steiner&&(Sl(r,r.next)||te(r.prev,r,r.next)===0)){if(So(r),r=t=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==t);return t}function wo(e,t,r,i,n,o,a){if(e){!a&&o&&XE(e,i,n,o);for(var c=e,f,p;e.prev!==e.next;){if(f=e.prev,p=e.next,o?OE(e,i,n,o):FE(e)){t.push(f.i/r|0),t.push(e.i/r|0),t.push(p.i/r|0),So(e),e=p.next,c=p.next;continue}if(e=p,e===c){a?a===1?(e=NE(Sn(e),t,r),wo(e,t,r,i,n,o,2)):a===2&&UE(e,t,r,i,n,o):wo(Sn(e),t,r,i,n,o,1);break}}}}function FE(e){var t=e.prev,r=e,i=e.next;if(te(t,r,i)>=0)return!1;for(var n=t.x,o=r.x,a=i.x,c=t.y,f=r.y,p=i.y,l=n<o?n<a?n:a:o<a?o:a,h=c<f?c<p?c:p:f<p?f:p,d=n>o?n>a?n:a:o>a?o:a,m=c>f?c>p?c:p:f>p?f:p,_=i.next;_!==t;){if(_.x>=l&&_.x<=d&&_.y>=h&&_.y<=m&&ds(n,c,o,f,a,p,_.x,_.y)&&te(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function OE(e,t,r,i){var n=e.prev,o=e,a=e.next;if(te(n,o,a)>=0)return!1;for(var c=n.x,f=o.x,p=a.x,l=n.y,h=o.y,d=a.y,m=c<f?c<p?c:p:f<p?f:p,_=l<h?l<d?l:d:h<d?h:d,x=c>f?c>p?c:p:f>p?f:p,T=l>h?l>d?l:d:h>d?h:d,S=Qu(m,_,t,r,i),b=Qu(x,T,t,r,i),y=e.prevZ,w=e.nextZ;y&&y.z>=S&&w&&w.z<=b;){if(y.x>=m&&y.x<=x&&y.y>=_&&y.y<=T&&y!==n&&y!==a&&ds(c,l,f,h,p,d,y.x,y.y)&&te(y.prev,y,y.next)>=0||(y=y.prevZ,w.x>=m&&w.x<=x&&w.y>=_&&w.y<=T&&w!==n&&w!==a&&ds(c,l,f,h,p,d,w.x,w.y)&&te(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;y&&y.z>=S;){if(y.x>=m&&y.x<=x&&y.y>=_&&y.y<=T&&y!==n&&y!==a&&ds(c,l,f,h,p,d,y.x,y.y)&&te(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;w&&w.z<=b;){if(w.x>=m&&w.x<=x&&w.y>=_&&w.y<=T&&w!==n&&w!==a&&ds(c,l,f,h,p,d,w.x,w.y)&&te(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function NE(e,t,r){var i=e;do{var n=i.prev,o=i.next.next;!Sl(n,o)&&ym(n,i,i.next,o)&&Eo(n,o)&&Eo(o,n)&&(t.push(n.i/r|0),t.push(i.i/r|0),t.push(o.i/r|0),So(i),So(i.next),i=e=o),i=i.next}while(i!==e);return Sn(i)}function UE(e,t,r,i,n,o){var a=e;do{for(var c=a.next.next;c!==a.prev;){if(a.i!==c.i&&YE(a,c)){var f=Tm(a,c);a=Sn(a,a.next),f=Sn(f,f.next),wo(a,t,r,i,n,o,0),wo(f,t,r,i,n,o,0);return}c=c.next}a=a.next}while(a!==e)}function kE(e,t,r,i){var n=[],o,a,c,f,p;for(o=0,a=t.length;o<a;o++)c=t[o]*i,f=o<a-1?t[o+1]*i:e.length,p=vm(e,c,f,i,!1),p===p.next&&(p.steiner=!0),n.push($E(p));for(n.sort(GE),o=0;o<n.length;o++)r=HE(n[o],r);return r}function GE(e,t){return e.x-t.x}function HE(e,t){var r=VE(e,t);if(!r)return t;var i=Tm(r,e);return Sn(i,i.next),Sn(r,r.next)}function VE(e,t){var r=t,i=e.x,n=e.y,o=-1/0,a;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){var c=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(c<=i&&c>o&&(o=c,a=r.x<r.next.x?r:r.next,c===i))return a}r=r.next}while(r!==t);if(!a)return null;var f=a,p=a.x,l=a.y,h=1/0,d;r=a;do i>=r.x&&r.x>=p&&i!==r.x&&ds(n<l?i:o,n,p,l,n<l?o:i,n,r.x,r.y)&&(d=Math.abs(n-r.y)/(i-r.x),Eo(r,e)&&(d<h||d===h&&(r.x>a.x||r.x===a.x&&WE(a,r)))&&(a=r,h=d)),r=r.next;while(r!==f);return a}function WE(e,t){return te(e.prev,e,t.prev)<0&&te(t.next,e,e.next)<0}function XE(e,t,r,i){var n=e;do n.z===0&&(n.z=Qu(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,zE(n)}function zE(e){var t,r,i,n,o,a,c,f,p=1;do{for(r=e,e=null,o=null,a=0;r;){for(a++,i=r,c=0,t=0;t<p&&(c++,i=i.nextZ,!!i);t++);for(f=p;c>0||f>0&&i;)c!==0&&(f===0||!i||r.z<=i.z)?(n=r,r=r.nextZ,c--):(n=i,i=i.nextZ,f--),o?o.nextZ=n:e=n,n.prevZ=o,o=n;r=i}o.nextZ=null,p*=2}while(a>1);return e}function Qu(e,t,r,i,n){return e=(e-r)*n|0,t=(t-i)*n|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function $E(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function ds(e,t,r,i,n,o,a,c){return(n-a)*(t-c)>=(e-a)*(o-c)&&(e-a)*(i-c)>=(r-a)*(t-c)&&(r-a)*(o-c)>=(n-a)*(i-c)}function YE(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!jE(e,t)&&(Eo(e,t)&&Eo(t,e)&&KE(e,t)&&(te(e.prev,e,t.prev)||te(e,t.prev,t))||Sl(e,t)&&te(e.prev,e,e.next)>0&&te(t.prev,t,t.next)>0)}function te(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Sl(e,t){return e.x===t.x&&e.y===t.y}function ym(e,t,r,i){var n=wl(te(e,t,r)),o=wl(te(e,t,i)),a=wl(te(r,i,e)),c=wl(te(r,i,t));return!!(n!==o&&a!==c||n===0&&Tl(e,r,t)||o===0&&Tl(e,i,t)||a===0&&Tl(r,e,i)||c===0&&Tl(r,t,i))}function Tl(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function wl(e){return e>0?1:e<0?-1:0}function jE(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&ym(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function Eo(e,t){return te(e.prev,e,e.next)<0?te(e,t,e.next)>=0&&te(e,e.prev,t)>=0:te(e,t,e.prev)<0||te(e,e.next,t)<0}function KE(e,t){var r=e,i=!1,n=(e.x+t.x)/2,o=(e.y+t.y)/2;do r.y>o!=r.next.y>o&&r.next.y!==r.y&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e);return i}function Tm(e,t){var r=new Ju(e.i,e.x,e.y),i=new Ju(t.i,t.x,t.y),n=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,o.next=i,i.prev=o,i}function xm(e,t,r,i){var n=new Ju(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function So(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Ju(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}El.deviation=function(e,t,r,i){var n=t&&t.length,o=n?t[0]*r:e.length,a=Math.abs(tc(e,0,o,r));if(n)for(var c=0,f=t.length;c<f;c++){var p=t[c]*r,l=c<f-1?t[c+1]*r:e.length;a-=Math.abs(tc(e,p,l,r))}var h=0;for(c=0;c<i.length;c+=3){var d=i[c]*r,m=i[c+1]*r,_=i[c+2]*r;h+=Math.abs((e[d]-e[_])*(e[m+1]-e[d+1])-(e[d]-e[m])*(e[_+1]-e[d+1]))}return a===0&&h===0?0:Math.abs((h-a)/a)};function tc(e,t,r,i){for(var n=0,o=t,a=r-i;o<r;o+=i)n+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return n}El.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,n=0;n<e.length;n++){for(var o=0;o<e[n].length;o++)for(var a=0;a<t;a++)r.vertices.push(e[n][o][a]);n>0&&(i+=e[n-1].length,r.holes.push(i))}return r}});var Em=Fr((ps,ms)=>{(function(e){var t=typeof ps=="object"&&ps&&!ps.nodeType&&ps,r=typeof ms=="object"&&ms&&!ms.nodeType&&ms,i=typeof global=="object"&&global;(i.global===i||i.window===i||i.self===i)&&(e=i);var n,o=2147483647,a=36,c=1,f=26,p=38,l=700,h=72,d=128,m="-",_=/^xn--/,x=/[^\x20-\x7E]/,T=/[\x2E\u3002\uFF0E\uFF61]/g,S={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},b=a-c,y=Math.floor,w=String.fromCharCode,I;function C($){throw RangeError(S[$])}function P($,Q){for(var st=$.length,_t=[];st--;)_t[st]=Q($[st]);return _t}function M($,Q){var st=$.split("@"),_t="";st.length>1&&(_t=st[0]+"@",$=st[1]),$=$.replace(T,".");var Tt=$.split("."),Ct=P(Tt,Q).join(".");return _t+Ct}function B($){for(var Q=[],st=0,_t=$.length,Tt,Ct;st<_t;)Tt=$.charCodeAt(st++),Tt>=55296&&Tt<=56319&&st<_t?(Ct=$.charCodeAt(st++),(Ct&64512)==56320?Q.push(((Tt&1023)<<10)+(Ct&1023)+65536):(Q.push(Tt),st--)):Q.push(Tt);return Q}function F($){return P($,function(Q){var st="";return Q>65535&&(Q-=65536,st+=w(Q>>>10&1023|55296),Q=56320|Q&1023),st+=w(Q),st}).join("")}function L($){return $-48<10?$-22:$-65<26?$-65:$-97<26?$-97:a}function H($,Q){return $+22+75*($<26)-((Q!=0)<<5)}function N($,Q,st){var _t=0;for($=st?y($/l):$>>1,$+=y($/Q);$>b*f>>1;_t+=a)$=y($/b);return y(_t+(b+1)*$/($+p))}function G($){var Q=[],st=$.length,_t,Tt=0,Ct=d,yt=h,Ht,Bt,Qt,_e,$t,Vt,jt,Dt,Ot;for(Ht=$.lastIndexOf(m),Ht<0&&(Ht=0),Bt=0;Bt<Ht;++Bt)$.charCodeAt(Bt)>=128&&C("not-basic"),Q.push($.charCodeAt(Bt));for(Qt=Ht>0?Ht+1:0;Qt<st;){for(_e=Tt,$t=1,Vt=a;Qt>=st&&C("invalid-input"),jt=L($.charCodeAt(Qt++)),(jt>=a||jt>y((o-Tt)/$t))&&C("overflow"),Tt+=jt*$t,Dt=Vt<=yt?c:Vt>=yt+f?f:Vt-yt,!(jt<Dt);Vt+=a)Ot=a-Dt,$t>y(o/Ot)&&C("overflow"),$t*=Ot;_t=Q.length+1,yt=N(Tt-_e,_t,_e==0),y(Tt/_t)>o-Ct&&C("overflow"),Ct+=y(Tt/_t),Tt%=_t,Q.splice(Tt++,0,Ct)}return F(Q)}function q($){var Q,st,_t,Tt,Ct,yt,Ht,Bt,Qt,_e,$t,Vt=[],jt,Dt,Ot,Yr;for($=B($),jt=$.length,Q=d,st=0,Ct=h,yt=0;yt<jt;++yt)$t=$[yt],$t<128&&Vt.push(w($t));for(_t=Tt=Vt.length,Tt&&Vt.push(m);_t<jt;){for(Ht=o,yt=0;yt<jt;++yt)$t=$[yt],$t>=Q&&$t<Ht&&(Ht=$t);for(Dt=_t+1,Ht-Q>y((o-st)/Dt)&&C("overflow"),st+=(Ht-Q)*Dt,Q=Ht,yt=0;yt<jt;++yt)if($t=$[yt],$t<Q&&++st>o&&C("overflow"),$t==Q){for(Bt=st,Qt=a;_e=Qt<=Ct?c:Qt>=Ct+f?f:Qt-Ct,!(Bt<_e);Qt+=a)Yr=Bt-_e,Ot=a-_e,Vt.push(w(H(_e+Yr%Ot,0))),Bt=y(Yr/Ot);Vt.push(w(H(Bt,0))),Ct=N(st,Dt,_t==Tt),st=0,++_t}++st,++Q}return Vt.join("")}function j($){return M($,function(Q){return _.test(Q)?G(Q.slice(4).toLowerCase()):Q})}function rt($){return M($,function(Q){return x.test(Q)?"xn--"+q(Q):Q})}if(n={version:"1.3.2",ucs2:{decode:B,encode:F},decode:G,encode:q,toASCII:rt,toUnicode:j},typeof define=="function"&&typeof define.amd=="object"&&define.amd)define("punycode",function(){return n});else if(t&&r)if(ms.exports==t)r.exports=n;else for(I in n)n.hasOwnProperty(I)&&(t[I]=n[I]);else e.punycode=n})(ps)});var bm=Fr((BA,Sm)=>{"use strict";Sm.exports={isString:function(e){return typeof e=="string"},isObject:function(e){return typeof e=="object"&&e!==null},isNull:function(e){return e===null},isNullOrUndefined:function(e){return e==null}}});var Cm=Fr((DA,Am)=>{"use strict";function qE(e,t){return Object.prototype.hasOwnProperty.call(e,t)}Am.exports=function(e,t,r,i){t=t||"&",r=r||"=";var n={};if(typeof e!="string"||e.length===0)return n;var o=/\+/g;e=e.split(t);var a=1e3;i&&typeof i.maxKeys=="number"&&(a=i.maxKeys);var c=e.length;a>0&&c>a&&(c=a);for(var f=0;f<c;++f){var p=e[f].replace(o,"%20"),l=p.indexOf(r),h,d,m,_;l>=0?(h=p.substr(0,l),d=p.substr(l+1)):(h=p,d=""),m=decodeURIComponent(h),_=decodeURIComponent(d),qE(n,m)?Array.isArray(n[m])?n[m].push(_):n[m]=[n[m],_]:n[m]=_}return n}});var Rm=Fr((LA,Im)=>{"use strict";var bo=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};Im.exports=function(e,t,r,i){return t=t||"&",r=r||"=",e===null&&(e=void 0),typeof e=="object"?Object.keys(e).map(function(n){var o=encodeURIComponent(bo(n))+r;return Array.isArray(e[n])?e[n].map(function(a){return o+encodeURIComponent(bo(a))}).join(t):o+encodeURIComponent(bo(e[n]))}).join(t):i?encodeURIComponent(bo(i))+r+encodeURIComponent(bo(e)):""}});var Pm=Fr(Ao=>{"use strict";Ao.decode=Ao.parse=Cm();Ao.encode=Ao.stringify=Rm()});var Lm=Fr(_s=>{"use strict";var ZE=Em(),Jr=bm();_s.parse=Co;_s.resolve=aS;_s.resolveObject=lS;_s.format=oS;_s.Url=Cr;function Cr(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var QE=/^([a-z0-9.+-]+:)/i,JE=/:[0-9]*$/,tS=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,eS=["<",">",'"',"`"," ","\r",`
`,"	"],rS=["{","}","|","\\","^","`"].concat(eS),rc=["'"].concat(rS),Mm=["%","/","?",";","#"].concat(rc),Bm=["/","?","#"],iS=255,Dm=/^[+a-z0-9A-Z_-]{0,63}$/,nS=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,sS={javascript:!0,"javascript:":!0},ic={javascript:!0,"javascript:":!0},gs={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},nc=Pm();function Co(e,t,r){if(e&&Jr.isObject(e)&&e instanceof Cr)return e;var i=new Cr;return i.parse(e,t,r),i}Cr.prototype.parse=function(e,t,r){if(!Jr.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),n=i!==-1&&i<e.indexOf("#")?"?":"#",o=e.split(n),a=/\\/g;o[0]=o[0].replace(a,"/"),e=o.join(n);var c=e;if(c=c.trim(),!r&&e.split("#").length===1){var f=tS.exec(c);if(f)return this.path=c,this.href=c,this.pathname=f[1],f[2]?(this.search=f[2],t?this.query=nc.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var p=QE.exec(c);if(p){p=p[0];var l=p.toLowerCase();this.protocol=l,c=c.substr(p.length)}if(r||p||c.match(/^\/\/[^@\/]+@[^@\/]+/)){var h=c.substr(0,2)==="//";h&&!(p&&ic[p])&&(c=c.substr(2),this.slashes=!0)}if(!ic[p]&&(h||p&&!gs[p])){for(var d=-1,m=0;m<Bm.length;m++){var _=c.indexOf(Bm[m]);_!==-1&&(d===-1||_<d)&&(d=_)}var x,T;d===-1?T=c.lastIndexOf("@"):T=c.lastIndexOf("@",d),T!==-1&&(x=c.slice(0,T),c=c.slice(T+1),this.auth=decodeURIComponent(x)),d=-1;for(var m=0;m<Mm.length;m++){var _=c.indexOf(Mm[m]);_!==-1&&(d===-1||_<d)&&(d=_)}d===-1&&(d=c.length),this.host=c.slice(0,d),c=c.slice(d),this.parseHost(),this.hostname=this.hostname||"";var S=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!S)for(var b=this.hostname.split(/\./),m=0,y=b.length;m<y;m++){var w=b[m];if(w&&!w.match(Dm)){for(var I="",C=0,P=w.length;C<P;C++)w.charCodeAt(C)>127?I+="x":I+=w[C];if(!I.match(Dm)){var M=b.slice(0,m),B=b.slice(m+1),F=w.match(nS);F&&(M.push(F[1]),B.unshift(F[2])),B.length&&(c="/"+B.join(".")+c),this.hostname=M.join(".");break}}}this.hostname.length>iS?this.hostname="":this.hostname=this.hostname.toLowerCase(),S||(this.hostname=ZE.toASCII(this.hostname));var L=this.port?":"+this.port:"",H=this.hostname||"";this.host=H+L,this.href+=this.host,S&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),c[0]!=="/"&&(c="/"+c))}if(!sS[l])for(var m=0,y=rc.length;m<y;m++){var N=rc[m];if(c.indexOf(N)!==-1){var G=encodeURIComponent(N);G===N&&(G=escape(N)),c=c.split(N).join(G)}}var q=c.indexOf("#");q!==-1&&(this.hash=c.substr(q),c=c.slice(0,q));var j=c.indexOf("?");if(j!==-1?(this.search=c.substr(j),this.query=c.substr(j+1),t&&(this.query=nc.parse(this.query)),c=c.slice(0,j)):t&&(this.search="",this.query={}),c&&(this.pathname=c),gs[l]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var L=this.pathname||"",rt=this.search||"";this.path=L+rt}return this.href=this.format(),this};function oS(e){return Jr.isString(e)&&(e=Co(e)),e instanceof Cr?e.format():Cr.prototype.format.call(e)}Cr.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",i=this.hash||"",n=!1,o="";this.host?n=e+this.host:this.hostname&&(n=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&Jr.isObject(this.query)&&Object.keys(this.query).length&&(o=nc.stringify(this.query));var a=this.search||o&&"?"+o||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||gs[t])&&n!==!1?(n="//"+(n||""),r&&r.charAt(0)!=="/"&&(r="/"+r)):n||(n=""),i&&i.charAt(0)!=="#"&&(i="#"+i),a&&a.charAt(0)!=="?"&&(a="?"+a),r=r.replace(/[?#]/g,function(c){return encodeURIComponent(c)}),a=a.replace("#","%23"),t+n+r+a+i};function aS(e,t){return Co(e,!1,!0).resolve(t)}Cr.prototype.resolve=function(e){return this.resolveObject(Co(e,!1,!0)).format()};function lS(e,t){return e?Co(e,!1,!0).resolveObject(t):t}Cr.prototype.resolveObject=function(e){if(Jr.isString(e)){var t=new Cr;t.parse(e,!1,!0),e=t}for(var r=new Cr,i=Object.keys(this),n=0;n<i.length;n++){var o=i[n];r[o]=this[o]}if(r.hash=e.hash,e.href==="")return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var a=Object.keys(e),c=0;c<a.length;c++){var f=a[c];f!=="protocol"&&(r[f]=e[f])}return gs[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!gs[e.protocol]){for(var p=Object.keys(e),l=0;l<p.length;l++){var h=p[l];r[h]=e[h]}return r.href=r.format(),r}if(r.protocol=e.protocol,!e.host&&!ic[e.protocol]){for(var y=(e.pathname||"").split("/");y.length&&!(e.host=y.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),y[0]!==""&&y.unshift(""),y.length<2&&y.unshift(""),r.pathname=y.join("/")}else r.pathname=e.pathname;if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var d=r.pathname||"",m=r.search||"";r.path=d+m}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var _=r.pathname&&r.pathname.charAt(0)==="/",x=e.host||e.pathname&&e.pathname.charAt(0)==="/",T=x||_||r.host&&e.pathname,S=T,b=r.pathname&&r.pathname.split("/")||[],y=e.pathname&&e.pathname.split("/")||[],w=r.protocol&&!gs[r.protocol];if(w&&(r.hostname="",r.port=null,r.host&&(b[0]===""?b[0]=r.host:b.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(y[0]===""?y[0]=e.host:y.unshift(e.host)),e.host=null),T=T&&(y[0]===""||b[0]==="")),x)r.host=e.host||e.host===""?e.host:r.host,r.hostname=e.hostname||e.hostname===""?e.hostname:r.hostname,r.search=e.search,r.query=e.query,b=y;else if(y.length)b||(b=[]),b.pop(),b=b.concat(y),r.search=e.search,r.query=e.query;else if(!Jr.isNullOrUndefined(e.search)){if(w){r.hostname=r.host=b.shift();var I=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;I&&(r.auth=I.shift(),r.host=r.hostname=I.shift())}return r.search=e.search,r.query=e.query,(!Jr.isNull(r.pathname)||!Jr.isNull(r.search))&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!b.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var C=b.slice(-1)[0],P=(r.host||e.host||b.length>1)&&(C==="."||C==="..")||C==="",M=0,B=b.length;B>=0;B--)C=b[B],C==="."?b.splice(B,1):C===".."?(b.splice(B,1),M++):M&&(b.splice(B,1),M--);if(!T&&!S)for(;M--;M)b.unshift("..");T&&b[0]!==""&&(!b[0]||b[0].charAt(0)!=="/")&&b.unshift(""),P&&b.join("/").substr(-1)!=="/"&&b.push("");var F=b[0]===""||b[0]&&b[0].charAt(0)==="/";if(w){r.hostname=r.host=F?"":b.length?b.shift():"";var I=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;I&&(r.auth=I.shift(),r.host=r.hostname=I.shift())}return T=T||r.host&&b.length,T&&!F&&b.unshift(""),b.length?r.pathname=b.join("/"):(r.pathname=null,r.path=null),(!Jr.isNull(r.pathname)||!Jr.isNull(r.search))&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r};Cr.prototype.parseHost=function(){var e=this.host,t=JE.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}});var Th=Fr((Aa,Cf)=>{(function(t,r){typeof Aa=="object"&&typeof Cf=="object"?Cf.exports=r():typeof define=="function"&&define.amd?define("Matter",[],r):typeof Aa=="object"?Aa.Matter=r():t.Matter=r()})(Aa,function(){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(i,n,o){r.o(i,n)||Object.defineProperty(i,n,{enumerable:!0,get:o})},r.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},r.t=function(i,n){if(n&1&&(i=r(i)),n&8||n&4&&typeof i=="object"&&i&&i.__esModule)return i;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:i}),n&2&&typeof i!="string")for(var a in i)r.d(o,a,function(c){return i[c]}.bind(null,a));return o},r.n=function(i){var n=i&&i.__esModule?function(){return i.default}:function(){return i};return r.d(n,"a",n),n},r.o=function(i,n){return Object.prototype.hasOwnProperty.call(i,n)},r.p="",r(r.s=20)}([function(e,t){var r={};e.exports=r,function(){r._baseDelta=1e3/60,r._nextId=0,r._seed=0,r._nowStartTime=+new Date,r._warnedOnce={},r._decomp=null,r.extend=function(n,o){var a,c,f;typeof o=="boolean"?(a=2,f=o):(a=1,f=!0);for(var p=a;p<arguments.length;p++){var l=arguments[p];if(l)for(var h in l)f&&l[h]&&l[h].constructor===Object&&(!n[h]||n[h].constructor===Object)?(n[h]=n[h]||{},r.extend(n[h],f,l[h])):n[h]=l[h]}return n},r.clone=function(n,o){return r.extend({},o,n)},r.keys=function(n){if(Object.keys)return Object.keys(n);var o=[];for(var a in n)o.push(a);return o},r.values=function(n){var o=[];if(Object.keys){for(var a=Object.keys(n),c=0;c<a.length;c++)o.push(n[a[c]]);return o}for(var f in n)o.push(n[f]);return o},r.get=function(n,o,a,c){o=o.split(".").slice(a,c);for(var f=0;f<o.length;f+=1)n=n[o[f]];return n},r.set=function(n,o,a,c,f){var p=o.split(".").slice(c,f);return r.get(n,o,0,-1)[p[p.length-1]]=a,a},r.shuffle=function(n){for(var o=n.length-1;o>0;o--){var a=Math.floor(r.random()*(o+1)),c=n[o];n[o]=n[a],n[a]=c}return n},r.choose=function(n){return n[Math.floor(r.random()*n.length)]},r.isElement=function(n){return typeof HTMLElement<"u"?n instanceof HTMLElement:!!(n&&n.nodeType&&n.nodeName)},r.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"},r.isFunction=function(n){return typeof n=="function"},r.isPlainObject=function(n){return typeof n=="object"&&n.constructor===Object},r.isString=function(n){return toString.call(n)==="[object String]"},r.clamp=function(n,o,a){return n<o?o:n>a?a:n},r.sign=function(n){return n<0?-1:1},r.now=function(){if(typeof window<"u"&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-r._nowStartTime},r.random=function(n,o){return n=typeof n<"u"?n:0,o=typeof o<"u"?o:1,n+i()*(o-n)};var i=function(){return r._seed=(r._seed*9301+49297)%233280,r._seed/233280};r.colorToNumber=function(n){return n=n.replace("#",""),n.length==3&&(n=n.charAt(0)+n.charAt(0)+n.charAt(1)+n.charAt(1)+n.charAt(2)+n.charAt(2)),parseInt(n,16)},r.logLevel=1,r.log=function(){console&&r.logLevel>0&&r.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.info=function(){console&&r.logLevel>0&&r.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.warn=function(){console&&r.logLevel>0&&r.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.warnOnce=function(){var n=Array.prototype.slice.call(arguments).join(" ");r._warnedOnce[n]||(r.warn(n),r._warnedOnce[n]=!0)},r.deprecated=function(n,o,a){n[o]=r.chain(function(){r.warnOnce("\u{1F505} deprecated \u{1F505}",a)},n[o])},r.nextId=function(){return r._nextId++},r.indexOf=function(n,o){if(n.indexOf)return n.indexOf(o);for(var a=0;a<n.length;a++)if(n[a]===o)return a;return-1},r.map=function(n,o){if(n.map)return n.map(o);for(var a=[],c=0;c<n.length;c+=1)a.push(o(n[c]));return a},r.topologicalSort=function(n){var o=[],a=[],c=[];for(var f in n)!a[f]&&!c[f]&&r._topologicalSort(f,a,c,n,o);return o},r._topologicalSort=function(n,o,a,c,f){var p=c[n]||[];a[n]=!0;for(var l=0;l<p.length;l+=1){var h=p[l];a[h]||o[h]||r._topologicalSort(h,o,a,c,f)}a[n]=!1,o[n]=!0,f.push(n)},r.chain=function(){for(var n=[],o=0;o<arguments.length;o+=1){var a=arguments[o];a._chained?n.push.apply(n,a._chained):n.push(a)}var c=function(){for(var f,p=new Array(arguments.length),l=0,h=arguments.length;l<h;l++)p[l]=arguments[l];for(l=0;l<n.length;l+=1){var d=n[l].apply(f,p);typeof d<"u"&&(f=d)}return f};return c._chained=n,c},r.chainPathBefore=function(n,o,a){return r.set(n,o,r.chain(a,r.get(n,o)))},r.chainPathAfter=function(n,o,a){return r.set(n,o,r.chain(r.get(n,o),a))},r.setDecomp=function(n){r._decomp=n},r.getDecomp=function(){var n=r._decomp;try{!n&&typeof window<"u"&&(n=window.decomp),!n&&typeof global<"u"&&(n=global.decomp)}catch{n=null}return n}}()},function(e,t){var r={};e.exports=r,function(){r.create=function(i){var n={min:{x:0,y:0},max:{x:0,y:0}};return i&&r.update(n,i),n},r.update=function(i,n,o){i.min.x=1/0,i.max.x=-1/0,i.min.y=1/0,i.max.y=-1/0;for(var a=0;a<n.length;a++){var c=n[a];c.x>i.max.x&&(i.max.x=c.x),c.x<i.min.x&&(i.min.x=c.x),c.y>i.max.y&&(i.max.y=c.y),c.y<i.min.y&&(i.min.y=c.y)}o&&(o.x>0?i.max.x+=o.x:i.min.x+=o.x,o.y>0?i.max.y+=o.y:i.min.y+=o.y)},r.contains=function(i,n){return n.x>=i.min.x&&n.x<=i.max.x&&n.y>=i.min.y&&n.y<=i.max.y},r.overlaps=function(i,n){return i.min.x<=n.max.x&&i.max.x>=n.min.x&&i.max.y>=n.min.y&&i.min.y<=n.max.y},r.translate=function(i,n){i.min.x+=n.x,i.max.x+=n.x,i.min.y+=n.y,i.max.y+=n.y},r.shift=function(i,n){var o=i.max.x-i.min.x,a=i.max.y-i.min.y;i.min.x=n.x,i.max.x=n.x+o,i.min.y=n.y,i.max.y=n.y+a}}()},function(e,t){var r={};e.exports=r,function(){r.create=function(i,n){return{x:i||0,y:n||0}},r.clone=function(i){return{x:i.x,y:i.y}},r.magnitude=function(i){return Math.sqrt(i.x*i.x+i.y*i.y)},r.magnitudeSquared=function(i){return i.x*i.x+i.y*i.y},r.rotate=function(i,n,o){var a=Math.cos(n),c=Math.sin(n);o||(o={});var f=i.x*a-i.y*c;return o.y=i.x*c+i.y*a,o.x=f,o},r.rotateAbout=function(i,n,o,a){var c=Math.cos(n),f=Math.sin(n);a||(a={});var p=o.x+((i.x-o.x)*c-(i.y-o.y)*f);return a.y=o.y+((i.x-o.x)*f+(i.y-o.y)*c),a.x=p,a},r.normalise=function(i){var n=r.magnitude(i);return n===0?{x:0,y:0}:{x:i.x/n,y:i.y/n}},r.dot=function(i,n){return i.x*n.x+i.y*n.y},r.cross=function(i,n){return i.x*n.y-i.y*n.x},r.cross3=function(i,n,o){return(n.x-i.x)*(o.y-i.y)-(n.y-i.y)*(o.x-i.x)},r.add=function(i,n,o){return o||(o={}),o.x=i.x+n.x,o.y=i.y+n.y,o},r.sub=function(i,n,o){return o||(o={}),o.x=i.x-n.x,o.y=i.y-n.y,o},r.mult=function(i,n){return{x:i.x*n,y:i.y*n}},r.div=function(i,n){return{x:i.x/n,y:i.y/n}},r.perp=function(i,n){return n=n===!0?-1:1,{x:n*-i.y,y:n*i.x}},r.neg=function(i){return{x:-i.x,y:-i.y}},r.angle=function(i,n){return Math.atan2(n.y-i.y,n.x-i.x)},r._temp=[r.create(),r.create(),r.create(),r.create(),r.create(),r.create()]}()},function(e,t,r){var i={};e.exports=i;var n=r(2),o=r(0);(function(){i.create=function(a,c){for(var f=[],p=0;p<a.length;p++){var l=a[p],h={x:l.x,y:l.y,index:p,body:c,isInternal:!1};f.push(h)}return f},i.fromPath=function(a,c){var f=/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/ig,p=[];return a.replace(f,function(l,h,d){p.push({x:parseFloat(h),y:parseFloat(d)})}),i.create(p,c)},i.centre=function(a){for(var c=i.area(a,!0),f={x:0,y:0},p,l,h,d=0;d<a.length;d++)h=(d+1)%a.length,p=n.cross(a[d],a[h]),l=n.mult(n.add(a[d],a[h]),p),f=n.add(f,l);return n.div(f,6*c)},i.mean=function(a){for(var c={x:0,y:0},f=0;f<a.length;f++)c.x+=a[f].x,c.y+=a[f].y;return n.div(c,a.length)},i.area=function(a,c){for(var f=0,p=a.length-1,l=0;l<a.length;l++)f+=(a[p].x-a[l].x)*(a[p].y+a[l].y),p=l;return c?f/2:Math.abs(f)/2},i.inertia=function(a,c){for(var f=0,p=0,l=a,h,d,m=0;m<l.length;m++)d=(m+1)%l.length,h=Math.abs(n.cross(l[d],l[m])),f+=h*(n.dot(l[d],l[d])+n.dot(l[d],l[m])+n.dot(l[m],l[m])),p+=h;return c/6*(f/p)},i.translate=function(a,c,f){f=typeof f<"u"?f:1;var p=a.length,l=c.x*f,h=c.y*f,d;for(d=0;d<p;d++)a[d].x+=l,a[d].y+=h;return a},i.rotate=function(a,c,f){if(c!==0){var p=Math.cos(c),l=Math.sin(c),h=f.x,d=f.y,m=a.length,_,x,T,S;for(S=0;S<m;S++)_=a[S],x=_.x-h,T=_.y-d,_.x=h+(x*p-T*l),_.y=d+(x*l+T*p);return a}},i.contains=function(a,c){for(var f=c.x,p=c.y,l=a.length,h=a[l-1],d,m=0;m<l;m++){if(d=a[m],(f-h.x)*(d.y-h.y)+(p-h.y)*(h.x-d.x)>0)return!1;h=d}return!0},i.scale=function(a,c,f,p){if(c===1&&f===1)return a;p=p||i.centre(a);for(var l,h,d=0;d<a.length;d++)l=a[d],h=n.sub(l,p),a[d].x=p.x+h.x*c,a[d].y=p.y+h.y*f;return a},i.chamfer=function(a,c,f,p,l){typeof c=="number"?c=[c]:c=c||[8],f=typeof f<"u"?f:-1,p=p||2,l=l||14;for(var h=[],d=0;d<a.length;d++){var m=a[d-1>=0?d-1:a.length-1],_=a[d],x=a[(d+1)%a.length],T=c[d<c.length?d:c.length-1];if(T===0){h.push(_);continue}var S=n.normalise({x:_.y-m.y,y:m.x-_.x}),b=n.normalise({x:x.y-_.y,y:_.x-x.x}),y=Math.sqrt(2*Math.pow(T,2)),w=n.mult(o.clone(S),T),I=n.normalise(n.mult(n.add(S,b),.5)),C=n.sub(_,n.mult(I,y)),P=f;f===-1&&(P=Math.pow(T,.32)*1.75),P=o.clamp(P,p,l),P%2===1&&(P+=1);for(var M=Math.acos(n.dot(S,b)),B=M/P,F=0;F<P;F++)h.push(n.add(n.rotate(w,B*F),C))}return h},i.clockwiseSort=function(a){var c=i.mean(a);return a.sort(function(f,p){return n.angle(c,f)-n.angle(c,p)}),a},i.isConvex=function(a){var c=0,f=a.length,p,l,h,d;if(f<3)return null;for(p=0;p<f;p++)if(l=(p+1)%f,h=(p+2)%f,d=(a[l].x-a[p].x)*(a[h].y-a[l].y),d-=(a[l].y-a[p].y)*(a[h].x-a[l].x),d<0?c|=1:d>0&&(c|=2),c===3)return!1;return c!==0?!0:null},i.hull=function(a){var c=[],f=[],p,l;for(a=a.slice(0),a.sort(function(h,d){var m=h.x-d.x;return m!==0?m:h.y-d.y}),l=0;l<a.length;l+=1){for(p=a[l];f.length>=2&&n.cross3(f[f.length-2],f[f.length-1],p)<=0;)f.pop();f.push(p)}for(l=a.length-1;l>=0;l-=1){for(p=a[l];c.length>=2&&n.cross3(c[c.length-2],c[c.length-1],p)<=0;)c.pop();c.push(p)}return c.pop(),f.pop(),c.concat(f)}})()},function(e,t,r){var i={};e.exports=i;var n=r(3),o=r(2),a=r(7),c=r(0),f=r(1),p=r(11);(function(){i._timeCorrection=!0,i._inertiaScale=4,i._nextCollidingGroupId=1,i._nextNonCollidingGroupId=-1,i._nextCategory=1,i._baseDelta=1e3/60,i.create=function(h){var d={id:c.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:n.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,deltaTime:16.666666666666668,_original:null},m=c.extend(d,h);return l(m,h),m},i.nextGroup=function(h){return h?i._nextNonCollidingGroupId--:i._nextCollidingGroupId++},i.nextCategory=function(){return i._nextCategory=i._nextCategory<<1,i._nextCategory};var l=function(h,d){d=d||{},i.set(h,{bounds:h.bounds||f.create(h.vertices),positionPrev:h.positionPrev||o.clone(h.position),anglePrev:h.anglePrev||h.angle,vertices:h.vertices,parts:h.parts||[h],isStatic:h.isStatic,isSleeping:h.isSleeping,parent:h.parent||h}),n.rotate(h.vertices,h.angle,h.position),p.rotate(h.axes,h.angle),f.update(h.bounds,h.vertices,h.velocity),i.set(h,{axes:d.axes||h.axes,area:d.area||h.area,mass:d.mass||h.mass,inertia:d.inertia||h.inertia});var m=h.isStatic?"#14151f":c.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),_=h.isStatic?"#555":"#ccc",x=h.isStatic&&h.render.fillStyle===null?1:0;h.render.fillStyle=h.render.fillStyle||m,h.render.strokeStyle=h.render.strokeStyle||_,h.render.lineWidth=h.render.lineWidth||x,h.render.sprite.xOffset+=-(h.bounds.min.x-h.position.x)/(h.bounds.max.x-h.bounds.min.x),h.render.sprite.yOffset+=-(h.bounds.min.y-h.position.y)/(h.bounds.max.y-h.bounds.min.y)};i.set=function(h,d,m){var _;typeof d=="string"&&(_=d,d={},d[_]=m);for(_ in d)if(Object.prototype.hasOwnProperty.call(d,_))switch(m=d[_],_){case"isStatic":i.setStatic(h,m);break;case"isSleeping":a.set(h,m);break;case"mass":i.setMass(h,m);break;case"density":i.setDensity(h,m);break;case"inertia":i.setInertia(h,m);break;case"vertices":i.setVertices(h,m);break;case"position":i.setPosition(h,m);break;case"angle":i.setAngle(h,m);break;case"velocity":i.setVelocity(h,m);break;case"angularVelocity":i.setAngularVelocity(h,m);break;case"speed":i.setSpeed(h,m);break;case"angularSpeed":i.setAngularSpeed(h,m);break;case"parts":i.setParts(h,m);break;case"centre":i.setCentre(h,m);break;default:h[_]=m}},i.setStatic=function(h,d){for(var m=0;m<h.parts.length;m++){var _=h.parts[m];_.isStatic=d,d?(_._original={restitution:_.restitution,friction:_.friction,mass:_.mass,inertia:_.inertia,density:_.density,inverseMass:_.inverseMass,inverseInertia:_.inverseInertia},_.restitution=0,_.friction=1,_.mass=_.inertia=_.density=1/0,_.inverseMass=_.inverseInertia=0,_.positionPrev.x=_.position.x,_.positionPrev.y=_.position.y,_.anglePrev=_.angle,_.angularVelocity=0,_.speed=0,_.angularSpeed=0,_.motion=0):_._original&&(_.restitution=_._original.restitution,_.friction=_._original.friction,_.mass=_._original.mass,_.inertia=_._original.inertia,_.density=_._original.density,_.inverseMass=_._original.inverseMass,_.inverseInertia=_._original.inverseInertia,_._original=null)}},i.setMass=function(h,d){var m=h.inertia/(h.mass/6);h.inertia=m*(d/6),h.inverseInertia=1/h.inertia,h.mass=d,h.inverseMass=1/h.mass,h.density=h.mass/h.area},i.setDensity=function(h,d){i.setMass(h,d*h.area),h.density=d},i.setInertia=function(h,d){h.inertia=d,h.inverseInertia=1/h.inertia},i.setVertices=function(h,d){d[0].body===h?h.vertices=d:h.vertices=n.create(d,h),h.axes=p.fromVertices(h.vertices),h.area=n.area(h.vertices),i.setMass(h,h.density*h.area);var m=n.centre(h.vertices);n.translate(h.vertices,m,-1),i.setInertia(h,i._inertiaScale*n.inertia(h.vertices,h.mass)),n.translate(h.vertices,h.position),f.update(h.bounds,h.vertices,h.velocity)},i.setParts=function(h,d,m){var _;for(d=d.slice(0),h.parts.length=0,h.parts.push(h),h.parent=h,_=0;_<d.length;_++){var x=d[_];x!==h&&(x.parent=h,h.parts.push(x))}if(h.parts.length!==1){if(m=typeof m<"u"?m:!0,m){var T=[];for(_=0;_<d.length;_++)T=T.concat(d[_].vertices);n.clockwiseSort(T);var S=n.hull(T),b=n.centre(S);i.setVertices(h,S),n.translate(h.vertices,b)}var y=i._totalProperties(h);h.area=y.area,h.parent=h,h.position.x=y.centre.x,h.position.y=y.centre.y,h.positionPrev.x=y.centre.x,h.positionPrev.y=y.centre.y,i.setMass(h,y.mass),i.setInertia(h,y.inertia),i.setPosition(h,y.centre)}},i.setCentre=function(h,d,m){m?(h.positionPrev.x+=d.x,h.positionPrev.y+=d.y,h.position.x+=d.x,h.position.y+=d.y):(h.positionPrev.x=d.x-(h.position.x-h.positionPrev.x),h.positionPrev.y=d.y-(h.position.y-h.positionPrev.y),h.position.x=d.x,h.position.y=d.y)},i.setPosition=function(h,d,m){var _=o.sub(d,h.position);m?(h.positionPrev.x=h.position.x,h.positionPrev.y=h.position.y,h.velocity.x=_.x,h.velocity.y=_.y,h.speed=o.magnitude(_)):(h.positionPrev.x+=_.x,h.positionPrev.y+=_.y);for(var x=0;x<h.parts.length;x++){var T=h.parts[x];T.position.x+=_.x,T.position.y+=_.y,n.translate(T.vertices,_),f.update(T.bounds,T.vertices,h.velocity)}},i.setAngle=function(h,d,m){var _=d-h.angle;m?(h.anglePrev=h.angle,h.angularVelocity=_,h.angularSpeed=Math.abs(_)):h.anglePrev+=_;for(var x=0;x<h.parts.length;x++){var T=h.parts[x];T.angle+=_,n.rotate(T.vertices,_,h.position),p.rotate(T.axes,_),f.update(T.bounds,T.vertices,h.velocity),x>0&&o.rotateAbout(T.position,_,h.position,T.position)}},i.setVelocity=function(h,d){var m=h.deltaTime/i._baseDelta;h.positionPrev.x=h.position.x-d.x*m,h.positionPrev.y=h.position.y-d.y*m,h.velocity.x=(h.position.x-h.positionPrev.x)/m,h.velocity.y=(h.position.y-h.positionPrev.y)/m,h.speed=o.magnitude(h.velocity)},i.getVelocity=function(h){var d=i._baseDelta/h.deltaTime;return{x:(h.position.x-h.positionPrev.x)*d,y:(h.position.y-h.positionPrev.y)*d}},i.getSpeed=function(h){return o.magnitude(i.getVelocity(h))},i.setSpeed=function(h,d){i.setVelocity(h,o.mult(o.normalise(i.getVelocity(h)),d))},i.setAngularVelocity=function(h,d){var m=h.deltaTime/i._baseDelta;h.anglePrev=h.angle-d*m,h.angularVelocity=(h.angle-h.anglePrev)/m,h.angularSpeed=Math.abs(h.angularVelocity)},i.getAngularVelocity=function(h){return(h.angle-h.anglePrev)*i._baseDelta/h.deltaTime},i.getAngularSpeed=function(h){return Math.abs(i.getAngularVelocity(h))},i.setAngularSpeed=function(h,d){i.setAngularVelocity(h,c.sign(i.getAngularVelocity(h))*d)},i.translate=function(h,d,m){i.setPosition(h,o.add(h.position,d),m)},i.rotate=function(h,d,m,_){if(!m)i.setAngle(h,h.angle+d,_);else{var x=Math.cos(d),T=Math.sin(d),S=h.position.x-m.x,b=h.position.y-m.y;i.setPosition(h,{x:m.x+(S*x-b*T),y:m.y+(S*T+b*x)},_),i.setAngle(h,h.angle+d,_)}},i.scale=function(h,d,m,_){var x=0,T=0;_=_||h.position;for(var S=0;S<h.parts.length;S++){var b=h.parts[S];n.scale(b.vertices,d,m,_),b.axes=p.fromVertices(b.vertices),b.area=n.area(b.vertices),i.setMass(b,h.density*b.area),n.translate(b.vertices,{x:-b.position.x,y:-b.position.y}),i.setInertia(b,i._inertiaScale*n.inertia(b.vertices,b.mass)),n.translate(b.vertices,{x:b.position.x,y:b.position.y}),S>0&&(x+=b.area,T+=b.inertia),b.position.x=_.x+(b.position.x-_.x)*d,b.position.y=_.y+(b.position.y-_.y)*m,f.update(b.bounds,b.vertices,h.velocity)}h.parts.length>1&&(h.area=x,h.isStatic||(i.setMass(h,h.density*x),i.setInertia(h,T))),h.circleRadius&&(d===m?h.circleRadius*=d:h.circleRadius=null)},i.update=function(h,d){d=(typeof d<"u"?d:1e3/60)*h.timeScale;var m=d*d,_=i._timeCorrection?d/(h.deltaTime||d):1,x=1-h.frictionAir*(d/c._baseDelta),T=(h.position.x-h.positionPrev.x)*_,S=(h.position.y-h.positionPrev.y)*_;h.velocity.x=T*x+h.force.x/h.mass*m,h.velocity.y=S*x+h.force.y/h.mass*m,h.positionPrev.x=h.position.x,h.positionPrev.y=h.position.y,h.position.x+=h.velocity.x,h.position.y+=h.velocity.y,h.deltaTime=d,h.angularVelocity=(h.angle-h.anglePrev)*x*_+h.torque/h.inertia*m,h.anglePrev=h.angle,h.angle+=h.angularVelocity;for(var b=0;b<h.parts.length;b++){var y=h.parts[b];n.translate(y.vertices,h.velocity),b>0&&(y.position.x+=h.velocity.x,y.position.y+=h.velocity.y),h.angularVelocity!==0&&(n.rotate(y.vertices,h.angularVelocity,h.position),p.rotate(y.axes,h.angularVelocity),b>0&&o.rotateAbout(y.position,h.angularVelocity,h.position,y.position)),f.update(y.bounds,y.vertices,h.velocity)}},i.updateVelocities=function(h){var d=i._baseDelta/h.deltaTime,m=h.velocity;m.x=(h.position.x-h.positionPrev.x)*d,m.y=(h.position.y-h.positionPrev.y)*d,h.speed=Math.sqrt(m.x*m.x+m.y*m.y),h.angularVelocity=(h.angle-h.anglePrev)*d,h.angularSpeed=Math.abs(h.angularVelocity)},i.applyForce=function(h,d,m){var _={x:d.x-h.position.x,y:d.y-h.position.y};h.force.x+=m.x,h.force.y+=m.y,h.torque+=_.x*m.y-_.y*m.x},i._totalProperties=function(h){for(var d={mass:0,area:0,inertia:0,centre:{x:0,y:0}},m=h.parts.length===1?0:1;m<h.parts.length;m++){var _=h.parts[m],x=_.mass!==1/0?_.mass:1;d.mass+=x,d.area+=_.area,d.inertia+=_.inertia,d.centre=o.add(d.centre,o.mult(_.position,x))}return d.centre=o.div(d.centre,d.mass),d}})()},function(e,t,r){var i={};e.exports=i;var n=r(0);(function(){i.on=function(o,a,c){for(var f=a.split(" "),p,l=0;l<f.length;l++)p=f[l],o.events=o.events||{},o.events[p]=o.events[p]||[],o.events[p].push(c);return c},i.off=function(o,a,c){if(!a){o.events={};return}typeof a=="function"&&(c=a,a=n.keys(o.events).join(" "));for(var f=a.split(" "),p=0;p<f.length;p++){var l=o.events[f[p]],h=[];if(c&&l)for(var d=0;d<l.length;d++)l[d]!==c&&h.push(l[d]);o.events[f[p]]=h}},i.trigger=function(o,a,c){var f,p,l,h,d=o.events;if(d&&n.keys(d).length>0){c||(c={}),f=a.split(" ");for(var m=0;m<f.length;m++)if(p=f[m],l=d[p],l){h=n.clone(c,!1),h.name=p,h.source=o;for(var _=0;_<l.length;_++)l[_].apply(o,[h])}}}})()},function(e,t,r){var i={};e.exports=i;var n=r(5),o=r(0),a=r(1),c=r(4);(function(){i.create=function(f){return o.extend({id:o.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},f)},i.setModified=function(f,p,l,h){if(f.isModified=p,p&&f.cache&&(f.cache.allBodies=null,f.cache.allConstraints=null,f.cache.allComposites=null),l&&f.parent&&i.setModified(f.parent,p,l,h),h)for(var d=0;d<f.composites.length;d++){var m=f.composites[d];i.setModified(m,p,l,h)}},i.add=function(f,p){var l=[].concat(p);n.trigger(f,"beforeAdd",{object:p});for(var h=0;h<l.length;h++){var d=l[h];switch(d.type){case"body":if(d.parent!==d){o.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}i.addBody(f,d);break;case"constraint":i.addConstraint(f,d);break;case"composite":i.addComposite(f,d);break;case"mouseConstraint":i.addConstraint(f,d.constraint);break}}return n.trigger(f,"afterAdd",{object:p}),f},i.remove=function(f,p,l){var h=[].concat(p);n.trigger(f,"beforeRemove",{object:p});for(var d=0;d<h.length;d++){var m=h[d];switch(m.type){case"body":i.removeBody(f,m,l);break;case"constraint":i.removeConstraint(f,m,l);break;case"composite":i.removeComposite(f,m,l);break;case"mouseConstraint":i.removeConstraint(f,m.constraint);break}}return n.trigger(f,"afterRemove",{object:p}),f},i.addComposite=function(f,p){return f.composites.push(p),p.parent=f,i.setModified(f,!0,!0,!1),f},i.removeComposite=function(f,p,l){var h=o.indexOf(f.composites,p);if(h!==-1&&i.removeCompositeAt(f,h),l)for(var d=0;d<f.composites.length;d++)i.removeComposite(f.composites[d],p,!0);return f},i.removeCompositeAt=function(f,p){return f.composites.splice(p,1),i.setModified(f,!0,!0,!1),f},i.addBody=function(f,p){return f.bodies.push(p),i.setModified(f,!0,!0,!1),f},i.removeBody=function(f,p,l){var h=o.indexOf(f.bodies,p);if(h!==-1&&i.removeBodyAt(f,h),l)for(var d=0;d<f.composites.length;d++)i.removeBody(f.composites[d],p,!0);return f},i.removeBodyAt=function(f,p){return f.bodies.splice(p,1),i.setModified(f,!0,!0,!1),f},i.addConstraint=function(f,p){return f.constraints.push(p),i.setModified(f,!0,!0,!1),f},i.removeConstraint=function(f,p,l){var h=o.indexOf(f.constraints,p);if(h!==-1&&i.removeConstraintAt(f,h),l)for(var d=0;d<f.composites.length;d++)i.removeConstraint(f.composites[d],p,!0);return f},i.removeConstraintAt=function(f,p){return f.constraints.splice(p,1),i.setModified(f,!0,!0,!1),f},i.clear=function(f,p,l){if(l)for(var h=0;h<f.composites.length;h++)i.clear(f.composites[h],p,!0);return p?f.bodies=f.bodies.filter(function(d){return d.isStatic}):f.bodies.length=0,f.constraints.length=0,f.composites.length=0,i.setModified(f,!0,!0,!1),f},i.allBodies=function(f){if(f.cache&&f.cache.allBodies)return f.cache.allBodies;for(var p=[].concat(f.bodies),l=0;l<f.composites.length;l++)p=p.concat(i.allBodies(f.composites[l]));return f.cache&&(f.cache.allBodies=p),p},i.allConstraints=function(f){if(f.cache&&f.cache.allConstraints)return f.cache.allConstraints;for(var p=[].concat(f.constraints),l=0;l<f.composites.length;l++)p=p.concat(i.allConstraints(f.composites[l]));return f.cache&&(f.cache.allConstraints=p),p},i.allComposites=function(f){if(f.cache&&f.cache.allComposites)return f.cache.allComposites;for(var p=[].concat(f.composites),l=0;l<f.composites.length;l++)p=p.concat(i.allComposites(f.composites[l]));return f.cache&&(f.cache.allComposites=p),p},i.get=function(f,p,l){var h,d;switch(l){case"body":h=i.allBodies(f);break;case"constraint":h=i.allConstraints(f);break;case"composite":h=i.allComposites(f).concat(f);break}return h?(d=h.filter(function(m){return m.id.toString()===p.toString()}),d.length===0?null:d[0]):null},i.move=function(f,p,l){return i.remove(f,p),i.add(l,p),f},i.rebase=function(f){for(var p=i.allBodies(f).concat(i.allConstraints(f)).concat(i.allComposites(f)),l=0;l<p.length;l++)p[l].id=o.nextId();return f},i.translate=function(f,p,l){for(var h=l?i.allBodies(f):f.bodies,d=0;d<h.length;d++)c.translate(h[d],p);return f},i.rotate=function(f,p,l,h){for(var d=Math.cos(p),m=Math.sin(p),_=h?i.allBodies(f):f.bodies,x=0;x<_.length;x++){var T=_[x],S=T.position.x-l.x,b=T.position.y-l.y;c.setPosition(T,{x:l.x+(S*d-b*m),y:l.y+(S*m+b*d)}),c.rotate(T,p)}return f},i.scale=function(f,p,l,h,d){for(var m=d?i.allBodies(f):f.bodies,_=0;_<m.length;_++){var x=m[_],T=x.position.x-h.x,S=x.position.y-h.y;c.setPosition(x,{x:h.x+T*p,y:h.y+S*l}),c.scale(x,p,l)}return f},i.bounds=function(f){for(var p=i.allBodies(f),l=[],h=0;h<p.length;h+=1){var d=p[h];l.push(d.bounds.min,d.bounds.max)}return a.create(l)}})()},function(e,t,r){var i={};e.exports=i;var n=r(4),o=r(5),a=r(0);(function(){i._motionWakeThreshold=.18,i._motionSleepThreshold=.08,i._minBias=.9,i.update=function(c,f){for(var p=f/a._baseDelta,l=i._motionSleepThreshold,h=0;h<c.length;h++){var d=c[h],m=n.getSpeed(d),_=n.getAngularSpeed(d),x=m*m+_*_;if(d.force.x!==0||d.force.y!==0){i.set(d,!1);continue}var T=Math.min(d.motion,x),S=Math.max(d.motion,x);d.motion=i._minBias*T+(1-i._minBias)*S,d.sleepThreshold>0&&d.motion<l?(d.sleepCounter+=1,d.sleepCounter>=d.sleepThreshold/p&&i.set(d,!0)):d.sleepCounter>0&&(d.sleepCounter-=1)}},i.afterCollisions=function(c){for(var f=i._motionSleepThreshold,p=0;p<c.length;p++){var l=c[p];if(l.isActive){var h=l.collision,d=h.bodyA.parent,m=h.bodyB.parent;if(!(d.isSleeping&&m.isSleeping||d.isStatic||m.isStatic)&&(d.isSleeping||m.isSleeping)){var _=d.isSleeping&&!d.isStatic?d:m,x=_===d?m:d;!_.isStatic&&x.motion>f&&i.set(_,!1)}}}},i.set=function(c,f){var p=c.isSleeping;f?(c.isSleeping=!0,c.sleepCounter=c.sleepThreshold,c.positionImpulse.x=0,c.positionImpulse.y=0,c.positionPrev.x=c.position.x,c.positionPrev.y=c.position.y,c.anglePrev=c.angle,c.speed=0,c.angularSpeed=0,c.motion=0,p||o.trigger(c,"sleepStart")):(c.isSleeping=!1,c.sleepCounter=0,p&&o.trigger(c,"sleepEnd"))}})()},function(e,t,r){var i={};e.exports=i;var n=r(3),o=r(9);(function(){var a=[],c={overlap:0,axis:null},f={overlap:0,axis:null};i.create=function(p,l){return{pair:null,collided:!1,bodyA:p,bodyB:l,parentA:p.parent,parentB:l.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[]}},i.collides=function(p,l,h){if(i._overlapAxes(c,p.vertices,l.vertices,p.axes),c.overlap<=0||(i._overlapAxes(f,l.vertices,p.vertices,l.axes),f.overlap<=0))return null;var d=h&&h.table[o.id(p,l)],m;d?m=d.collision:(m=i.create(p,l),m.collided=!0,m.bodyA=p.id<l.id?p:l,m.bodyB=p.id<l.id?l:p,m.parentA=m.bodyA.parent,m.parentB=m.bodyB.parent),p=m.bodyA,l=m.bodyB;var _;c.overlap<f.overlap?_=c:_=f;var x=m.normal,T=m.supports,S=_.axis,b=S.x,y=S.y;b*(l.position.x-p.position.x)+y*(l.position.y-p.position.y)<0?(x.x=b,x.y=y):(x.x=-b,x.y=-y),m.tangent.x=-x.y,m.tangent.y=x.x,m.depth=_.overlap,m.penetration.x=x.x*m.depth,m.penetration.y=x.y*m.depth;var w=i._findSupports(p,l,x,1),I=0;if(n.contains(p.vertices,w[0])&&(T[I++]=w[0]),n.contains(p.vertices,w[1])&&(T[I++]=w[1]),I<2){var C=i._findSupports(l,p,x,-1);n.contains(l.vertices,C[0])&&(T[I++]=C[0]),I<2&&n.contains(l.vertices,C[1])&&(T[I++]=C[1])}return I===0&&(T[I++]=w[0]),T.length=I,m},i._overlapAxes=function(p,l,h,d){var m=l.length,_=h.length,x=l[0].x,T=l[0].y,S=h[0].x,b=h[0].y,y=d.length,w=Number.MAX_VALUE,I=0,C,P,M,B,F,L;for(F=0;F<y;F++){var H=d[F],N=H.x,G=H.y,q=x*N+T*G,j=S*N+b*G,rt=q,$=j;for(L=1;L<m;L+=1)B=l[L].x*N+l[L].y*G,B>rt?rt=B:B<q&&(q=B);for(L=1;L<_;L+=1)B=h[L].x*N+h[L].y*G,B>$?$=B:B<j&&(j=B);if(P=rt-j,M=$-q,C=P<M?P:M,C<w&&(w=C,I=F,C<=0))break}p.axis=d[I],p.overlap=w},i._projectToAxis=function(p,l,h){for(var d=l[0].x*h.x+l[0].y*h.y,m=d,_=1;_<l.length;_+=1){var x=l[_].x*h.x+l[_].y*h.y;x>m?m=x:x<d&&(d=x)}p.min=d,p.max=m},i._findSupports=function(p,l,h,d){var m=l.vertices,_=m.length,x=p.position.x,T=p.position.y,S=h.x*d,b=h.y*d,y=Number.MAX_VALUE,w,I,C,P,M;for(M=0;M<_;M+=1)I=m[M],P=S*(x-I.x)+b*(T-I.y),P<y&&(y=P,w=I);return C=m[(_+w.index-1)%_],y=S*(x-C.x)+b*(T-C.y),I=m[(w.index+1)%_],S*(x-I.x)+b*(T-I.y)<y?(a[0]=w,a[1]=I,a):(a[0]=w,a[1]=C,a)}})()},function(e,t,r){var i={};e.exports=i;var n=r(16);(function(){i.create=function(o,a){var c=o.bodyA,f=o.bodyB,p={id:i.id(c,f),bodyA:c,bodyB:f,collision:o,contacts:[],activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:c.isSensor||f.isSensor,timeCreated:a,timeUpdated:a,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return i.update(p,o,a),p},i.update=function(o,a,c){var f=o.contacts,p=a.supports,l=o.activeContacts,h=a.parentA,d=a.parentB,m=h.vertices.length;o.isActive=!0,o.timeUpdated=c,o.collision=a,o.separation=a.depth,o.inverseMass=h.inverseMass+d.inverseMass,o.friction=h.friction<d.friction?h.friction:d.friction,o.frictionStatic=h.frictionStatic>d.frictionStatic?h.frictionStatic:d.frictionStatic,o.restitution=h.restitution>d.restitution?h.restitution:d.restitution,o.slop=h.slop>d.slop?h.slop:d.slop,a.pair=o,l.length=0;for(var _=0;_<p.length;_++){var x=p[_],T=x.body===h?x.index:m+x.index,S=f[T];S?l.push(S):l.push(f[T]=n.create(x))}},i.setActive=function(o,a,c){a?(o.isActive=!0,o.timeUpdated=c):(o.isActive=!1,o.activeContacts.length=0)},i.id=function(o,a){return o.id<a.id?"A"+o.id+"B"+a.id:"A"+a.id+"B"+o.id}})()},function(e,t,r){var i={};e.exports=i;var n=r(3),o=r(2),a=r(7),c=r(1),f=r(11),p=r(0);(function(){i._warming=.4,i._torqueDampen=1,i._minLength=1e-6,i.create=function(l){var h=l;h.bodyA&&!h.pointA&&(h.pointA={x:0,y:0}),h.bodyB&&!h.pointB&&(h.pointB={x:0,y:0});var d=h.bodyA?o.add(h.bodyA.position,h.pointA):h.pointA,m=h.bodyB?o.add(h.bodyB.position,h.pointB):h.pointB,_=o.magnitude(o.sub(d,m));h.length=typeof h.length<"u"?h.length:_,h.id=h.id||p.nextId(),h.label=h.label||"Constraint",h.type="constraint",h.stiffness=h.stiffness||(h.length>0?1:.7),h.damping=h.damping||0,h.angularStiffness=h.angularStiffness||0,h.angleA=h.bodyA?h.bodyA.angle:h.angleA,h.angleB=h.bodyB?h.bodyB.angle:h.angleB,h.plugin={};var x={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return h.length===0&&h.stiffness>.1?(x.type="pin",x.anchors=!1):h.stiffness<.9&&(x.type="spring"),h.render=p.extend(x,h.render),h},i.preSolveAll=function(l){for(var h=0;h<l.length;h+=1){var d=l[h],m=d.constraintImpulse;d.isStatic||m.x===0&&m.y===0&&m.angle===0||(d.position.x+=m.x,d.position.y+=m.y,d.angle+=m.angle)}},i.solveAll=function(l,h){for(var d=p.clamp(h/p._baseDelta,0,1),m=0;m<l.length;m+=1){var _=l[m],x=!_.bodyA||_.bodyA&&_.bodyA.isStatic,T=!_.bodyB||_.bodyB&&_.bodyB.isStatic;(x||T)&&i.solve(l[m],d)}for(m=0;m<l.length;m+=1)_=l[m],x=!_.bodyA||_.bodyA&&_.bodyA.isStatic,T=!_.bodyB||_.bodyB&&_.bodyB.isStatic,!x&&!T&&i.solve(l[m],d)},i.solve=function(l,h){var d=l.bodyA,m=l.bodyB,_=l.pointA,x=l.pointB;if(!(!d&&!m)){d&&!d.isStatic&&(o.rotate(_,d.angle-l.angleA,_),l.angleA=d.angle),m&&!m.isStatic&&(o.rotate(x,m.angle-l.angleB,x),l.angleB=m.angle);var T=_,S=x;if(d&&(T=o.add(d.position,_)),m&&(S=o.add(m.position,x)),!(!T||!S)){var b=o.sub(T,S),y=o.magnitude(b);y<i._minLength&&(y=i._minLength);var w=(y-l.length)/y,I=l.stiffness>=1||l.length===0,C=I?l.stiffness*h:l.stiffness*h*h,P=l.damping*h,M=o.mult(b,w*C),B=(d?d.inverseMass:0)+(m?m.inverseMass:0),F=(d?d.inverseInertia:0)+(m?m.inverseInertia:0),L=B+F,H,N,G,q,j;if(P>0){var rt=o.create();G=o.div(b,y),j=o.sub(m&&o.sub(m.position,m.positionPrev)||rt,d&&o.sub(d.position,d.positionPrev)||rt),q=o.dot(G,j)}d&&!d.isStatic&&(N=d.inverseMass/B,d.constraintImpulse.x-=M.x*N,d.constraintImpulse.y-=M.y*N,d.position.x-=M.x*N,d.position.y-=M.y*N,P>0&&(d.positionPrev.x-=P*G.x*q*N,d.positionPrev.y-=P*G.y*q*N),H=o.cross(_,M)/L*i._torqueDampen*d.inverseInertia*(1-l.angularStiffness),d.constraintImpulse.angle-=H,d.angle-=H),m&&!m.isStatic&&(N=m.inverseMass/B,m.constraintImpulse.x+=M.x*N,m.constraintImpulse.y+=M.y*N,m.position.x+=M.x*N,m.position.y+=M.y*N,P>0&&(m.positionPrev.x+=P*G.x*q*N,m.positionPrev.y+=P*G.y*q*N),H=o.cross(x,M)/L*i._torqueDampen*m.inverseInertia*(1-l.angularStiffness),m.constraintImpulse.angle+=H,m.angle+=H)}}},i.postSolveAll=function(l){for(var h=0;h<l.length;h++){var d=l[h],m=d.constraintImpulse;if(!(d.isStatic||m.x===0&&m.y===0&&m.angle===0)){a.set(d,!1);for(var _=0;_<d.parts.length;_++){var x=d.parts[_];n.translate(x.vertices,m),_>0&&(x.position.x+=m.x,x.position.y+=m.y),m.angle!==0&&(n.rotate(x.vertices,m.angle,d.position),f.rotate(x.axes,m.angle),_>0&&o.rotateAbout(x.position,m.angle,d.position,x.position)),c.update(x.bounds,x.vertices,d.velocity)}m.angle*=i._warming,m.x*=i._warming,m.y*=i._warming}}},i.pointAWorld=function(l){return{x:(l.bodyA?l.bodyA.position.x:0)+(l.pointA?l.pointA.x:0),y:(l.bodyA?l.bodyA.position.y:0)+(l.pointA?l.pointA.y:0)}},i.pointBWorld=function(l){return{x:(l.bodyB?l.bodyB.position.x:0)+(l.pointB?l.pointB.x:0),y:(l.bodyB?l.bodyB.position.y:0)+(l.pointB?l.pointB.y:0)}}})()},function(e,t,r){var i={};e.exports=i;var n=r(2),o=r(0);(function(){i.fromVertices=function(a){for(var c={},f=0;f<a.length;f++){var p=(f+1)%a.length,l=n.normalise({x:a[p].y-a[f].y,y:a[f].x-a[p].x}),h=l.y===0?1/0:l.x/l.y;h=h.toFixed(3).toString(),c[h]=l}return o.values(c)},i.rotate=function(a,c){if(c!==0)for(var f=Math.cos(c),p=Math.sin(c),l=0;l<a.length;l++){var h=a[l],d;d=h.x*f-h.y*p,h.y=h.x*p+h.y*f,h.x=d}}})()},function(e,t,r){var i={};e.exports=i;var n=r(3),o=r(0),a=r(4),c=r(1),f=r(2);(function(){i.rectangle=function(p,l,h,d,m){m=m||{};var _={label:"Rectangle Body",position:{x:p,y:l},vertices:n.fromPath("L 0 0 L "+h+" 0 L "+h+" "+d+" L 0 "+d)};if(m.chamfer){var x=m.chamfer;_.vertices=n.chamfer(_.vertices,x.radius,x.quality,x.qualityMin,x.qualityMax),delete m.chamfer}return a.create(o.extend({},_,m))},i.trapezoid=function(p,l,h,d,m,_){_=_||{},m*=.5;var x=(1-m*2)*h,T=h*m,S=T+x,b=S+T,y;m<.5?y="L 0 0 L "+T+" "+-d+" L "+S+" "+-d+" L "+b+" 0":y="L 0 0 L "+S+" "+-d+" L "+b+" 0";var w={label:"Trapezoid Body",position:{x:p,y:l},vertices:n.fromPath(y)};if(_.chamfer){var I=_.chamfer;w.vertices=n.chamfer(w.vertices,I.radius,I.quality,I.qualityMin,I.qualityMax),delete _.chamfer}return a.create(o.extend({},w,_))},i.circle=function(p,l,h,d,m){d=d||{};var _={label:"Circle Body",circleRadius:h};m=m||25;var x=Math.ceil(Math.max(10,Math.min(m,h)));return x%2===1&&(x+=1),i.polygon(p,l,x,h,o.extend({},_,d))},i.polygon=function(p,l,h,d,m){if(m=m||{},h<3)return i.circle(p,l,d,m);for(var _=2*Math.PI/h,x="",T=_*.5,S=0;S<h;S+=1){var b=T+S*_,y=Math.cos(b)*d,w=Math.sin(b)*d;x+="L "+y.toFixed(3)+" "+w.toFixed(3)+" "}var I={label:"Polygon Body",position:{x:p,y:l},vertices:n.fromPath(x)};if(m.chamfer){var C=m.chamfer;I.vertices=n.chamfer(I.vertices,C.radius,C.quality,C.qualityMin,C.qualityMax),delete m.chamfer}return a.create(o.extend({},I,m))},i.fromVertices=function(p,l,h,d,m,_,x,T){var S=o.getDecomp(),b,y,w,I,C,P,M,B,F,L,H;for(b=!!(S&&S.quickDecomp),d=d||{},w=[],m=typeof m<"u"?m:!1,_=typeof _<"u"?_:.01,x=typeof x<"u"?x:10,T=typeof T<"u"?T:.01,o.isArray(h[0])||(h=[h]),L=0;L<h.length;L+=1)if(P=h[L],I=n.isConvex(P),C=!I,C&&!b&&o.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),I||!b)I?P=n.clockwiseSort(P):P=n.hull(P),w.push({position:{x:p,y:l},vertices:P});else{var N=P.map(function(yt){return[yt.x,yt.y]});S.makeCCW(N),_!==!1&&S.removeCollinearPoints(N,_),T!==!1&&S.removeDuplicatePoints&&S.removeDuplicatePoints(N,T);var G=S.quickDecomp(N);for(M=0;M<G.length;M++){var q=G[M],j=q.map(function(yt){return{x:yt[0],y:yt[1]}});x>0&&n.area(j)<x||w.push({position:n.centre(j),vertices:j})}}for(M=0;M<w.length;M++)w[M]=a.create(o.extend(w[M],d));if(m){var rt=5;for(M=0;M<w.length;M++){var $=w[M];for(B=M+1;B<w.length;B++){var Q=w[B];if(c.overlaps($.bounds,Q.bounds)){var st=$.vertices,_t=Q.vertices;for(F=0;F<$.vertices.length;F++)for(H=0;H<Q.vertices.length;H++){var Tt=f.magnitudeSquared(f.sub(st[(F+1)%st.length],_t[H])),Ct=f.magnitudeSquared(f.sub(st[F],_t[(H+1)%_t.length]));Tt<rt&&Ct<rt&&(st[F].isInternal=!0,_t[H].isInternal=!0)}}}}}return w.length>1?(y=a.create(o.extend({parts:w.slice(0)},d)),a.setPosition(y,{x:p,y:l}),y):w[0]}})()},function(e,t,r){var i={};e.exports=i;var n=r(0),o=r(8);(function(){i.create=function(a){var c={bodies:[],pairs:null};return n.extend(c,a)},i.setBodies=function(a,c){a.bodies=c.slice(0)},i.clear=function(a){a.bodies=[]},i.collisions=function(a){var c=[],f=a.pairs,p=a.bodies,l=p.length,h=i.canCollide,d=o.collides,m,_;for(p.sort(i._compareBoundsX),m=0;m<l;m++){var x=p[m],T=x.bounds,S=x.bounds.max.x,b=x.bounds.max.y,y=x.bounds.min.y,w=x.isStatic||x.isSleeping,I=x.parts.length,C=I===1;for(_=m+1;_<l;_++){var P=p[_],M=P.bounds;if(M.min.x>S)break;if(!(b<M.min.y||y>M.max.y)&&!(w&&(P.isStatic||P.isSleeping))&&h(x.collisionFilter,P.collisionFilter)){var B=P.parts.length;if(C&&B===1){var F=d(x,P,f);F&&c.push(F)}else for(var L=I>1?1:0,H=B>1?1:0,N=L;N<I;N++)for(var G=x.parts[N],T=G.bounds,q=H;q<B;q++){var j=P.parts[q],M=j.bounds;if(!(T.min.x>M.max.x||T.max.x<M.min.x||T.max.y<M.min.y||T.min.y>M.max.y)){var F=d(G,j,f);F&&c.push(F)}}}}}return c},i.canCollide=function(a,c){return a.group===c.group&&a.group!==0?a.group>0:(a.mask&c.category)!==0&&(c.mask&a.category)!==0},i._compareBoundsX=function(a,c){return a.bounds.min.x-c.bounds.min.x}})()},function(e,t,r){var i={};e.exports=i;var n=r(0);(function(){i.create=function(o){var a={};return o||n.log("Mouse.create: element was undefined, defaulting to document.body","warn"),a.element=o||document.body,a.absolute={x:0,y:0},a.position={x:0,y:0},a.mousedownPosition={x:0,y:0},a.mouseupPosition={x:0,y:0},a.offset={x:0,y:0},a.scale={x:1,y:1},a.wheelDelta=0,a.button=-1,a.pixelRatio=parseInt(a.element.getAttribute("data-pixel-ratio"),10)||1,a.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},a.mousemove=function(c){var f=i._getRelativeMousePosition(c,a.element,a.pixelRatio),p=c.changedTouches;p&&(a.button=0,c.preventDefault()),a.absolute.x=f.x,a.absolute.y=f.y,a.position.x=a.absolute.x*a.scale.x+a.offset.x,a.position.y=a.absolute.y*a.scale.y+a.offset.y,a.sourceEvents.mousemove=c},a.mousedown=function(c){var f=i._getRelativeMousePosition(c,a.element,a.pixelRatio),p=c.changedTouches;p?(a.button=0,c.preventDefault()):a.button=c.button,a.absolute.x=f.x,a.absolute.y=f.y,a.position.x=a.absolute.x*a.scale.x+a.offset.x,a.position.y=a.absolute.y*a.scale.y+a.offset.y,a.mousedownPosition.x=a.position.x,a.mousedownPosition.y=a.position.y,a.sourceEvents.mousedown=c},a.mouseup=function(c){var f=i._getRelativeMousePosition(c,a.element,a.pixelRatio),p=c.changedTouches;p&&c.preventDefault(),a.button=-1,a.absolute.x=f.x,a.absolute.y=f.y,a.position.x=a.absolute.x*a.scale.x+a.offset.x,a.position.y=a.absolute.y*a.scale.y+a.offset.y,a.mouseupPosition.x=a.position.x,a.mouseupPosition.y=a.position.y,a.sourceEvents.mouseup=c},a.mousewheel=function(c){a.wheelDelta=Math.max(-1,Math.min(1,c.wheelDelta||-c.detail)),c.preventDefault()},i.setElement(a,a.element),a},i.setElement=function(o,a){o.element=a,a.addEventListener("mousemove",o.mousemove),a.addEventListener("mousedown",o.mousedown),a.addEventListener("mouseup",o.mouseup),a.addEventListener("mousewheel",o.mousewheel),a.addEventListener("DOMMouseScroll",o.mousewheel),a.addEventListener("touchmove",o.mousemove),a.addEventListener("touchstart",o.mousedown),a.addEventListener("touchend",o.mouseup)},i.clearSourceEvents=function(o){o.sourceEvents.mousemove=null,o.sourceEvents.mousedown=null,o.sourceEvents.mouseup=null,o.sourceEvents.mousewheel=null,o.wheelDelta=0},i.setOffset=function(o,a){o.offset.x=a.x,o.offset.y=a.y,o.position.x=o.absolute.x*o.scale.x+o.offset.x,o.position.y=o.absolute.y*o.scale.y+o.offset.y},i.setScale=function(o,a){o.scale.x=a.x,o.scale.y=a.y,o.position.x=o.absolute.x*o.scale.x+o.offset.x,o.position.y=o.absolute.y*o.scale.y+o.offset.y},i._getRelativeMousePosition=function(o,a,c){var f=a.getBoundingClientRect(),p=document.documentElement||document.body.parentNode||document.body,l=window.pageXOffset!==void 0?window.pageXOffset:p.scrollLeft,h=window.pageYOffset!==void 0?window.pageYOffset:p.scrollTop,d=o.changedTouches,m,_;return d?(m=d[0].pageX-f.left-l,_=d[0].pageY-f.top-h):(m=o.pageX-f.left-l,_=o.pageY-f.top-h),{x:m/(a.clientWidth/(a.width||a.clientWidth)*c),y:_/(a.clientHeight/(a.height||a.clientHeight)*c)}}})()},function(e,t,r){var i={};e.exports=i;var n=r(0);(function(){i._registry={},i.register=function(o){if(i.isPlugin(o)||n.warn("Plugin.register:",i.toString(o),"does not implement all required fields."),o.name in i._registry){var a=i._registry[o.name],c=i.versionParse(o.version).number,f=i.versionParse(a.version).number;c>f?(n.warn("Plugin.register:",i.toString(a),"was upgraded to",i.toString(o)),i._registry[o.name]=o):c<f?n.warn("Plugin.register:",i.toString(a),"can not be downgraded to",i.toString(o)):o!==a&&n.warn("Plugin.register:",i.toString(o),"is already registered to different plugin object")}else i._registry[o.name]=o;return o},i.resolve=function(o){return i._registry[i.dependencyParse(o).name]},i.toString=function(o){return typeof o=="string"?o:(o.name||"anonymous")+"@"+(o.version||o.range||"0.0.0")},i.isPlugin=function(o){return o&&o.name&&o.version&&o.install},i.isUsed=function(o,a){return o.used.indexOf(a)>-1},i.isFor=function(o,a){var c=o.for&&i.dependencyParse(o.for);return!o.for||a.name===c.name&&i.versionSatisfies(a.version,c.range)},i.use=function(o,a){if(o.uses=(o.uses||[]).concat(a||[]),o.uses.length===0){n.warn("Plugin.use:",i.toString(o),"does not specify any dependencies to install.");return}for(var c=i.dependencies(o),f=n.topologicalSort(c),p=[],l=0;l<f.length;l+=1)if(f[l]!==o.name){var h=i.resolve(f[l]);if(!h){p.push("\u274C "+f[l]);continue}i.isUsed(o,h.name)||(i.isFor(h,o)||(n.warn("Plugin.use:",i.toString(h),"is for",h.for,"but installed on",i.toString(o)+"."),h._warned=!0),h.install?h.install(o):(n.warn("Plugin.use:",i.toString(h),"does not specify an install function."),h._warned=!0),h._warned?(p.push("\u{1F536} "+i.toString(h)),delete h._warned):p.push("\u2705 "+i.toString(h)),o.used.push(h.name))}p.length>0&&n.info(p.join("  "))},i.dependencies=function(o,a){var c=i.dependencyParse(o),f=c.name;if(a=a||{},!(f in a)){o=i.resolve(o)||o,a[f]=n.map(o.uses||[],function(l){i.isPlugin(l)&&i.register(l);var h=i.dependencyParse(l),d=i.resolve(l);return d&&!i.versionSatisfies(d.version,h.range)?(n.warn("Plugin.dependencies:",i.toString(d),"does not satisfy",i.toString(h),"used by",i.toString(c)+"."),d._warned=!0,o._warned=!0):d||(n.warn("Plugin.dependencies:",i.toString(l),"used by",i.toString(c),"could not be resolved."),o._warned=!0),h.name});for(var p=0;p<a[f].length;p+=1)i.dependencies(a[f][p],a);return a}},i.dependencyParse=function(o){if(n.isString(o)){var a=/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/;return a.test(o)||n.warn("Plugin.dependencyParse:",o,"is not a valid dependency string."),{name:o.split("@")[0],range:o.split("@")[1]||"*"}}return{name:o.name,range:o.range||o.version}},i.versionParse=function(o){var a=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;a.test(o)||n.warn("Plugin.versionParse:",o,"is not a valid version or range.");var c=a.exec(o),f=Number(c[4]),p=Number(c[5]),l=Number(c[6]);return{isRange:!!(c[1]||c[2]),version:c[3],range:o,operator:c[1]||c[2]||"",major:f,minor:p,patch:l,parts:[f,p,l],prerelease:c[7],number:f*1e8+p*1e4+l}},i.versionSatisfies=function(o,a){a=a||"*";var c=i.versionParse(a),f=i.versionParse(o);if(c.isRange){if(c.operator==="*"||o==="*")return!0;if(c.operator===">")return f.number>c.number;if(c.operator===">=")return f.number>=c.number;if(c.operator==="~")return f.major===c.major&&f.minor===c.minor&&f.patch>=c.patch;if(c.operator==="^")return c.major>0?f.major===c.major&&f.number>=c.number:c.minor>0?f.minor===c.minor&&f.patch>=c.patch:f.patch===c.patch}return o===a||o==="*"}})()},function(e,t){var r={};e.exports=r,function(){r.create=function(i){return{vertex:i,normalImpulse:0,tangentImpulse:0}}}()},function(e,t,r){var i={};e.exports=i;var n=r(7),o=r(18),a=r(13),c=r(19),f=r(5),p=r(6),l=r(10),h=r(0),d=r(4);(function(){i.create=function(m){m=m||{};var _={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0}},x=h.extend(_,m);return x.world=m.world||p.create({label:"World"}),x.pairs=m.pairs||c.create(),x.detector=m.detector||a.create(),x.grid={buckets:[]},x.world.gravity=x.gravity,x.broadphase=x.grid,x.metrics={},x},i.update=function(m,_){var x=h.now(),T=m.world,S=m.detector,b=m.pairs,y=m.timing,w=y.timestamp,I;_=typeof _<"u"?_:h._baseDelta,_*=y.timeScale,y.timestamp+=_,y.lastDelta=_;var C={timestamp:y.timestamp,delta:_};f.trigger(m,"beforeUpdate",C);var P=p.allBodies(T),M=p.allConstraints(T);for(T.isModified&&(a.setBodies(S,P),p.setModified(T,!1,!1,!0)),m.enableSleeping&&n.update(P,_),i._bodiesApplyGravity(P,m.gravity),_>0&&i._bodiesUpdate(P,_),l.preSolveAll(P),I=0;I<m.constraintIterations;I++)l.solveAll(M,_);l.postSolveAll(P),S.pairs=m.pairs;var B=a.collisions(S);c.update(b,B,w),m.enableSleeping&&n.afterCollisions(b.list),b.collisionStart.length>0&&f.trigger(m,"collisionStart",{pairs:b.collisionStart});var F=h.clamp(20/m.positionIterations,0,1);for(o.preSolvePosition(b.list),I=0;I<m.positionIterations;I++)o.solvePosition(b.list,_,F);for(o.postSolvePosition(P),l.preSolveAll(P),I=0;I<m.constraintIterations;I++)l.solveAll(M,_);for(l.postSolveAll(P),o.preSolveVelocity(b.list),I=0;I<m.velocityIterations;I++)o.solveVelocity(b.list,_);return i._bodiesUpdateVelocities(P),b.collisionActive.length>0&&f.trigger(m,"collisionActive",{pairs:b.collisionActive}),b.collisionEnd.length>0&&f.trigger(m,"collisionEnd",{pairs:b.collisionEnd}),i._bodiesClearForces(P),f.trigger(m,"afterUpdate",C),m.timing.lastElapsed=h.now()-x,m},i.merge=function(m,_){if(h.extend(m,_),_.world){m.world=_.world,i.clear(m);for(var x=p.allBodies(m.world),T=0;T<x.length;T++){var S=x[T];n.set(S,!1),S.id=h.nextId()}}},i.clear=function(m){c.clear(m.pairs),a.clear(m.detector)},i._bodiesClearForces=function(m){for(var _=m.length,x=0;x<_;x++){var T=m[x];T.force.x=0,T.force.y=0,T.torque=0}},i._bodiesApplyGravity=function(m,_){var x=typeof _.scale<"u"?_.scale:.001,T=m.length;if(!(_.x===0&&_.y===0||x===0))for(var S=0;S<T;S++){var b=m[S];b.isStatic||b.isSleeping||(b.force.y+=b.mass*_.y*x,b.force.x+=b.mass*_.x*x)}},i._bodiesUpdate=function(m,_){for(var x=m.length,T=0;T<x;T++){var S=m[T];S.isStatic||S.isSleeping||d.update(S,_)}},i._bodiesUpdateVelocities=function(m){for(var _=m.length,x=0;x<_;x++)d.updateVelocities(m[x])}})()},function(e,t,r){var i={};e.exports=i;var n=r(3),o=r(0),a=r(1);(function(){i._restingThresh=2,i._restingThreshTangent=Math.sqrt(6),i._positionDampen=.9,i._positionWarming=.8,i._frictionNormalMultiplier=5,i._frictionMaxStatic=Number.MAX_VALUE,i.preSolvePosition=function(c){var f,p,l,h=c.length;for(f=0;f<h;f++)p=c[f],p.isActive&&(l=p.activeContacts.length,p.collision.parentA.totalContacts+=l,p.collision.parentB.totalContacts+=l)},i.solvePosition=function(c,f,p){var l,h,d,m,_,x,T,S,b=i._positionDampen*(p||1),y=o.clamp(f/o._baseDelta,0,1),w=c.length;for(l=0;l<w;l++)h=c[l],!(!h.isActive||h.isSensor)&&(d=h.collision,m=d.parentA,_=d.parentB,x=d.normal,h.separation=x.x*(_.positionImpulse.x+d.penetration.x-m.positionImpulse.x)+x.y*(_.positionImpulse.y+d.penetration.y-m.positionImpulse.y));for(l=0;l<w;l++)h=c[l],!(!h.isActive||h.isSensor)&&(d=h.collision,m=d.parentA,_=d.parentB,x=d.normal,S=h.separation-h.slop*y,(m.isStatic||_.isStatic)&&(S*=2),m.isStatic||m.isSleeping||(T=b/m.totalContacts,m.positionImpulse.x+=x.x*S*T,m.positionImpulse.y+=x.y*S*T),_.isStatic||_.isSleeping||(T=b/_.totalContacts,_.positionImpulse.x-=x.x*S*T,_.positionImpulse.y-=x.y*S*T))},i.postSolvePosition=function(c){for(var f=i._positionWarming,p=c.length,l=n.translate,h=a.update,d=0;d<p;d++){var m=c[d],_=m.positionImpulse,x=_.x,T=_.y,S=m.velocity;if(m.totalContacts=0,x!==0||T!==0){for(var b=0;b<m.parts.length;b++){var y=m.parts[b];l(y.vertices,_),h(y.bounds,y.vertices,S),y.position.x+=x,y.position.y+=T}m.positionPrev.x+=x,m.positionPrev.y+=T,x*S.x+T*S.y<0?(_.x=0,_.y=0):(_.x*=f,_.y*=f)}}},i.preSolveVelocity=function(c){var f=c.length,p,l;for(p=0;p<f;p++){var h=c[p];if(!(!h.isActive||h.isSensor)){var d=h.activeContacts,m=d.length,_=h.collision,x=_.parentA,T=_.parentB,S=_.normal,b=_.tangent;for(l=0;l<m;l++){var y=d[l],w=y.vertex,I=y.normalImpulse,C=y.tangentImpulse;if(I!==0||C!==0){var P=S.x*I+b.x*C,M=S.y*I+b.y*C;x.isStatic||x.isSleeping||(x.positionPrev.x+=P*x.inverseMass,x.positionPrev.y+=M*x.inverseMass,x.anglePrev+=x.inverseInertia*((w.x-x.position.x)*M-(w.y-x.position.y)*P)),T.isStatic||T.isSleeping||(T.positionPrev.x-=P*T.inverseMass,T.positionPrev.y-=M*T.inverseMass,T.anglePrev-=T.inverseInertia*((w.x-T.position.x)*M-(w.y-T.position.y)*P))}}}}},i.solveVelocity=function(c,f){var p=f/o._baseDelta,l=p*p,h=l*p,d=-i._restingThresh*p,m=i._restingThreshTangent,_=i._frictionNormalMultiplier*p,x=i._frictionMaxStatic,T=c.length,S,b,y,w;for(y=0;y<T;y++){var I=c[y];if(!(!I.isActive||I.isSensor)){var C=I.collision,P=C.parentA,M=C.parentB,B=P.velocity,F=M.velocity,L=C.normal.x,H=C.normal.y,N=C.tangent.x,G=C.tangent.y,q=I.activeContacts,j=q.length,rt=1/j,$=P.inverseMass+M.inverseMass,Q=I.friction*I.frictionStatic*_;for(B.x=P.position.x-P.positionPrev.x,B.y=P.position.y-P.positionPrev.y,F.x=M.position.x-M.positionPrev.x,F.y=M.position.y-M.positionPrev.y,P.angularVelocity=P.angle-P.anglePrev,M.angularVelocity=M.angle-M.anglePrev,w=0;w<j;w++){var st=q[w],_t=st.vertex,Tt=_t.x-P.position.x,Ct=_t.y-P.position.y,yt=_t.x-M.position.x,Ht=_t.y-M.position.y,Bt=B.x-Ct*P.angularVelocity,Qt=B.y+Tt*P.angularVelocity,_e=F.x-Ht*M.angularVelocity,$t=F.y+yt*M.angularVelocity,Vt=Bt-_e,jt=Qt-$t,Dt=L*Vt+H*jt,Ot=N*Vt+G*jt,Yr=I.separation+Dt,Ce=Math.min(Yr,1);Ce=Yr<0?0:Ce;var pn=Ce*Q;Ot<-pn||Ot>pn?(b=Ot>0?Ot:-Ot,S=I.friction*(Ot>0?1:-1)*h,S<-b?S=-b:S>b&&(S=b)):(S=Ot,b=x);var Kn=Tt*H-Ct*L,rr=yt*H-Ht*L,$e=rt/($+P.inverseInertia*Kn*Kn+M.inverseInertia*rr*rr),jr=(1+I.restitution)*Dt*$e;if(S*=$e,Dt<d)st.normalImpulse=0;else{var qn=st.normalImpulse;st.normalImpulse+=jr,st.normalImpulse>0&&(st.normalImpulse=0),jr=st.normalImpulse-qn}if(Ot<-m||Ot>m)st.tangentImpulse=0;else{var Sh=st.tangentImpulse;st.tangentImpulse+=S,st.tangentImpulse<-b&&(st.tangentImpulse=-b),st.tangentImpulse>b&&(st.tangentImpulse=b),S=st.tangentImpulse-Sh}var Kr=L*jr+N*S,Zn=H*jr+G*S;P.isStatic||P.isSleeping||(P.positionPrev.x+=Kr*P.inverseMass,P.positionPrev.y+=Zn*P.inverseMass,P.anglePrev+=(Tt*Zn-Ct*Kr)*P.inverseInertia),M.isStatic||M.isSleeping||(M.positionPrev.x-=Kr*M.inverseMass,M.positionPrev.y-=Zn*M.inverseMass,M.anglePrev-=(yt*Zn-Ht*Kr)*M.inverseInertia)}}}}})()},function(e,t,r){var i={};e.exports=i;var n=r(9),o=r(0);(function(){i.create=function(a){return o.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},a)},i.update=function(a,c,f){var p=a.list,l=p.length,h=a.table,d=c.length,m=a.collisionStart,_=a.collisionEnd,x=a.collisionActive,T,S,b,y;for(m.length=0,_.length=0,x.length=0,y=0;y<l;y++)p[y].confirmedActive=!1;for(y=0;y<d;y++)T=c[y],b=T.pair,b?(b.isActive?x.push(b):m.push(b),n.update(b,T,f),b.confirmedActive=!0):(b=n.create(T,f),h[b.id]=b,m.push(b),p.push(b));var w=[];for(l=p.length,y=0;y<l;y++)b=p[y],b.confirmedActive||(n.setActive(b,!1,f),_.push(b),!b.collision.bodyA.isSleeping&&!b.collision.bodyB.isSleeping&&w.push(y));for(y=0;y<w.length;y++)S=w[y]-y,b=p[S],p.splice(S,1),delete h[b.id]},i.clear=function(a){return a.table={},a.list.length=0,a.collisionStart.length=0,a.collisionActive.length=0,a.collisionEnd.length=0,a}})()},function(e,t,r){var i=e.exports=r(21);i.Axes=r(11),i.Bodies=r(12),i.Body=r(4),i.Bounds=r(1),i.Collision=r(8),i.Common=r(0),i.Composite=r(6),i.Composites=r(22),i.Constraint=r(10),i.Contact=r(16),i.Detector=r(13),i.Engine=r(17),i.Events=r(5),i.Grid=r(23),i.Mouse=r(14),i.MouseConstraint=r(24),i.Pair=r(9),i.Pairs=r(19),i.Plugin=r(15),i.Query=r(25),i.Render=r(26),i.Resolver=r(18),i.Runner=r(27),i.SAT=r(28),i.Sleeping=r(7),i.Svg=r(29),i.Vector=r(2),i.Vertices=r(3),i.World=r(30),i.Engine.run=i.Runner.run,i.Common.deprecated(i.Engine,"run","Engine.run \u27A4 use Matter.Runner.run(engine) instead")},function(e,t,r){var i={};e.exports=i;var n=r(15),o=r(0);(function(){i.name="matter-js",i.version="0.19.0",i.uses=[],i.used=[],i.use=function(){n.use(i,Array.prototype.slice.call(arguments))},i.before=function(a,c){return a=a.replace(/^Matter./,""),o.chainPathBefore(i,a,c)},i.after=function(a,c){return a=a.replace(/^Matter./,""),o.chainPathAfter(i,a,c)}})()},function(e,t,r){var i={};e.exports=i;var n=r(6),o=r(10),a=r(0),c=r(4),f=r(12),p=a.deprecated;(function(){i.stack=function(l,h,d,m,_,x,T){for(var S=n.create({label:"Stack"}),b=l,y=h,w,I=0,C=0;C<m;C++){for(var P=0,M=0;M<d;M++){var B=T(b,y,M,C,w,I);if(B){var F=B.bounds.max.y-B.bounds.min.y,L=B.bounds.max.x-B.bounds.min.x;F>P&&(P=F),c.translate(B,{x:L*.5,y:F*.5}),b=B.bounds.max.x+_,n.addBody(S,B),w=B,I+=1}else b+=_}y+=P+x,b=l}return S},i.chain=function(l,h,d,m,_,x){for(var T=l.bodies,S=1;S<T.length;S++){var b=T[S-1],y=T[S],w=b.bounds.max.y-b.bounds.min.y,I=b.bounds.max.x-b.bounds.min.x,C=y.bounds.max.y-y.bounds.min.y,P=y.bounds.max.x-y.bounds.min.x,M={bodyA:b,pointA:{x:I*h,y:w*d},bodyB:y,pointB:{x:P*m,y:C*_}},B=a.extend(M,x);n.addConstraint(l,o.create(B))}return l.label+=" Chain",l},i.mesh=function(l,h,d,m,_){var x=l.bodies,T,S,b,y,w;for(T=0;T<d;T++){for(S=1;S<h;S++)b=x[S-1+T*h],y=x[S+T*h],n.addConstraint(l,o.create(a.extend({bodyA:b,bodyB:y},_)));if(T>0)for(S=0;S<h;S++)b=x[S+(T-1)*h],y=x[S+T*h],n.addConstraint(l,o.create(a.extend({bodyA:b,bodyB:y},_))),m&&S>0&&(w=x[S-1+(T-1)*h],n.addConstraint(l,o.create(a.extend({bodyA:w,bodyB:y},_)))),m&&S<h-1&&(w=x[S+1+(T-1)*h],n.addConstraint(l,o.create(a.extend({bodyA:w,bodyB:y},_))))}return l.label+=" Mesh",l},i.pyramid=function(l,h,d,m,_,x,T){return i.stack(l,h,d,m,_,x,function(S,b,y,w,I,C){var P=Math.min(m,Math.ceil(d/2)),M=I?I.bounds.max.x-I.bounds.min.x:0;if(!(w>P)){w=P-w;var B=w,F=d-1-w;if(!(y<B||y>F)){C===1&&c.translate(I,{x:(y+(d%2===1?1:-1))*M,y:0});var L=I?y*M:0;return T(l+L+y*_,b,y,w,I,C)}}})},i.newtonsCradle=function(l,h,d,m,_){for(var x=n.create({label:"Newtons Cradle"}),T=0;T<d;T++){var S=1.9,b=f.circle(l+T*(m*S),h+_,m,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),y=o.create({pointA:{x:l+T*(m*S),y:h},bodyB:b});n.addBody(x,b),n.addConstraint(x,y)}return x},p(i,"newtonsCradle","Composites.newtonsCradle \u27A4 moved to newtonsCradle example"),i.car=function(l,h,d,m,_){var x=c.nextGroup(!0),T=20,S=-d*.5+T,b=d*.5-T,y=0,w=n.create({label:"Car"}),I=f.rectangle(l,h,d,m,{collisionFilter:{group:x},chamfer:{radius:m*.5},density:2e-4}),C=f.circle(l+S,h+y,_,{collisionFilter:{group:x},friction:.8}),P=f.circle(l+b,h+y,_,{collisionFilter:{group:x},friction:.8}),M=o.create({bodyB:I,pointB:{x:S,y},bodyA:C,stiffness:1,length:0}),B=o.create({bodyB:I,pointB:{x:b,y},bodyA:P,stiffness:1,length:0});return n.addBody(w,I),n.addBody(w,C),n.addBody(w,P),n.addConstraint(w,M),n.addConstraint(w,B),w},p(i,"car","Composites.car \u27A4 moved to car example"),i.softBody=function(l,h,d,m,_,x,T,S,b,y){b=a.extend({inertia:1/0},b),y=a.extend({stiffness:.2,render:{type:"line",anchors:!1}},y);var w=i.stack(l,h,d,m,_,x,function(I,C){return f.circle(I,C,S,b)});return i.mesh(w,d,m,T,y),w.label="Soft Body",w},p(i,"softBody","Composites.softBody \u27A4 moved to softBody and cloth examples")})()},function(e,t,r){var i={};e.exports=i;var n=r(9),o=r(0),a=o.deprecated;(function(){i.create=function(c){var f={buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return o.extend(f,c)},i.update=function(c,f,p,l){var h,d,m,_=p.world,x=c.buckets,T,S,b=!1;for(h=0;h<f.length;h++){var y=f[h];if(!(y.isSleeping&&!l)&&!(_.bounds&&(y.bounds.max.x<_.bounds.min.x||y.bounds.min.x>_.bounds.max.x||y.bounds.max.y<_.bounds.min.y||y.bounds.min.y>_.bounds.max.y))){var w=i._getRegion(c,y);if(!y.region||w.id!==y.region.id||l){(!y.region||l)&&(y.region=w);var I=i._regionUnion(w,y.region);for(d=I.startCol;d<=I.endCol;d++)for(m=I.startRow;m<=I.endRow;m++){S=i._getBucketId(d,m),T=x[S];var C=d>=w.startCol&&d<=w.endCol&&m>=w.startRow&&m<=w.endRow,P=d>=y.region.startCol&&d<=y.region.endCol&&m>=y.region.startRow&&m<=y.region.endRow;!C&&P&&P&&T&&i._bucketRemoveBody(c,T,y),(y.region===w||C&&!P||l)&&(T||(T=i._createBucket(x,S)),i._bucketAddBody(c,T,y))}y.region=w,b=!0}}}b&&(c.pairsList=i._createActivePairsList(c))},a(i,"update","Grid.update \u27A4 replaced by Matter.Detector"),i.clear=function(c){c.buckets={},c.pairs={},c.pairsList=[]},a(i,"clear","Grid.clear \u27A4 replaced by Matter.Detector"),i._regionUnion=function(c,f){var p=Math.min(c.startCol,f.startCol),l=Math.max(c.endCol,f.endCol),h=Math.min(c.startRow,f.startRow),d=Math.max(c.endRow,f.endRow);return i._createRegion(p,l,h,d)},i._getRegion=function(c,f){var p=f.bounds,l=Math.floor(p.min.x/c.bucketWidth),h=Math.floor(p.max.x/c.bucketWidth),d=Math.floor(p.min.y/c.bucketHeight),m=Math.floor(p.max.y/c.bucketHeight);return i._createRegion(l,h,d,m)},i._createRegion=function(c,f,p,l){return{id:c+","+f+","+p+","+l,startCol:c,endCol:f,startRow:p,endRow:l}},i._getBucketId=function(c,f){return"C"+c+"R"+f},i._createBucket=function(c,f){var p=c[f]=[];return p},i._bucketAddBody=function(c,f,p){var l=c.pairs,h=n.id,d=f.length,m;for(m=0;m<d;m++){var _=f[m];if(!(p.id===_.id||p.isStatic&&_.isStatic)){var x=h(p,_),T=l[x];T?T[2]+=1:l[x]=[p,_,1]}}f.push(p)},i._bucketRemoveBody=function(c,f,p){var l=c.pairs,h=n.id,d;f.splice(o.indexOf(f,p),1);var m=f.length;for(d=0;d<m;d++){var _=l[h(p,f[d])];_&&(_[2]-=1)}},i._createActivePairsList=function(c){var f,p=c.pairs,l=o.keys(p),h=l.length,d=[],m;for(m=0;m<h;m++)f=p[l[m]],f[2]>0?d.push(f):delete p[l[m]];return d}})()},function(e,t,r){var i={};e.exports=i;var n=r(3),o=r(7),a=r(14),c=r(5),f=r(13),p=r(10),l=r(6),h=r(0),d=r(1);(function(){i.create=function(m,_){var x=(m?m.mouse:null)||(_?_.mouse:null);x||(m&&m.render&&m.render.canvas?x=a.create(m.render.canvas):_&&_.element?x=a.create(_.element):(x=a.create(),h.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var T=p.create({label:"Mouse Constraint",pointA:x.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),S={type:"mouseConstraint",mouse:x,element:null,body:null,constraint:T,collisionFilter:{category:1,mask:4294967295,group:0}},b=h.extend(S,_);return c.on(m,"beforeUpdate",function(){var y=l.allBodies(m.world);i.update(b,y),i._triggerEvents(b)}),b},i.update=function(m,_){var x=m.mouse,T=m.constraint,S=m.body;if(x.button===0){if(T.bodyB)o.set(T.bodyB,!1),T.pointA=x.position;else for(var b=0;b<_.length;b++)if(S=_[b],d.contains(S.bounds,x.position)&&f.canCollide(S.collisionFilter,m.collisionFilter))for(var y=S.parts.length>1?1:0;y<S.parts.length;y++){var w=S.parts[y];if(n.contains(w.vertices,x.position)){T.pointA=x.position,T.bodyB=m.body=S,T.pointB={x:x.position.x-S.position.x,y:x.position.y-S.position.y},T.angleB=S.angle,o.set(S,!1),c.trigger(m,"startdrag",{mouse:x,body:S});break}}}else T.bodyB=m.body=null,T.pointB=null,S&&c.trigger(m,"enddrag",{mouse:x,body:S})},i._triggerEvents=function(m){var _=m.mouse,x=_.sourceEvents;x.mousemove&&c.trigger(m,"mousemove",{mouse:_}),x.mousedown&&c.trigger(m,"mousedown",{mouse:_}),x.mouseup&&c.trigger(m,"mouseup",{mouse:_}),a.clearSourceEvents(_)}})()},function(e,t,r){var i={};e.exports=i;var n=r(2),o=r(8),a=r(1),c=r(12),f=r(3);(function(){i.collides=function(p,l){for(var h=[],d=l.length,m=p.bounds,_=o.collides,x=a.overlaps,T=0;T<d;T++){var S=l[T],b=S.parts.length,y=b===1?0:1;if(x(S.bounds,m))for(var w=y;w<b;w++){var I=S.parts[w];if(x(I.bounds,m)){var C=_(I,p);if(C){h.push(C);break}}}}return h},i.ray=function(p,l,h,d){d=d||1e-100;for(var m=n.angle(l,h),_=n.magnitude(n.sub(l,h)),x=(h.x+l.x)*.5,T=(h.y+l.y)*.5,S=c.rectangle(x,T,_,d,{angle:m}),b=i.collides(S,p),y=0;y<b.length;y+=1){var w=b[y];w.body=w.bodyB=w.bodyA}return b},i.region=function(p,l,h){for(var d=[],m=0;m<p.length;m++){var _=p[m],x=a.overlaps(_.bounds,l);(x&&!h||!x&&h)&&d.push(_)}return d},i.point=function(p,l){for(var h=[],d=0;d<p.length;d++){var m=p[d];if(a.contains(m.bounds,l))for(var _=m.parts.length===1?0:1;_<m.parts.length;_++){var x=m.parts[_];if(a.contains(x.bounds,l)&&f.contains(x.vertices,l)){h.push(m);break}}}return h}})()},function(e,t,r){var i={};e.exports=i;var n=r(4),o=r(0),a=r(6),c=r(1),f=r(5),p=r(2),l=r(14);(function(){var h,d;typeof window<"u"&&(h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(y){window.setTimeout(function(){y(o.now())},1e3/60)},d=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),i._goodFps=30,i._goodDelta=1e3/60,i.create=function(y){var w={engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",hasBounds:!!y.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},I=o.extend(w,y);return I.canvas&&(I.canvas.width=I.options.width||I.canvas.width,I.canvas.height=I.options.height||I.canvas.height),I.mouse=y.mouse,I.engine=y.engine,I.canvas=I.canvas||x(I.options.width,I.options.height),I.context=I.canvas.getContext("2d"),I.textures={},I.bounds=I.bounds||{min:{x:0,y:0},max:{x:I.canvas.width,y:I.canvas.height}},I.controller=i,I.options.showBroadphase=!1,I.options.pixelRatio!==1&&i.setPixelRatio(I,I.options.pixelRatio),o.isElement(I.element)&&I.element.appendChild(I.canvas),I},i.run=function(y){(function w(I){y.frameRequestId=h(w),m(y,I),i.world(y,I),(y.options.showStats||y.options.showDebug)&&i.stats(y,y.context,I),(y.options.showPerformance||y.options.showDebug)&&i.performance(y,y.context,I)})()},i.stop=function(y){d(y.frameRequestId)},i.setPixelRatio=function(y,w){var I=y.options,C=y.canvas;w==="auto"&&(w=T(C)),I.pixelRatio=w,C.setAttribute("data-pixel-ratio",w),C.width=I.width*w,C.height=I.height*w,C.style.width=I.width+"px",C.style.height=I.height+"px"},i.lookAt=function(y,w,I,C){C=typeof C<"u"?C:!0,w=o.isArray(w)?w:[w],I=I||{x:0,y:0};for(var P={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},M=0;M<w.length;M+=1){var B=w[M],F=B.bounds?B.bounds.min:B.min||B.position||B,L=B.bounds?B.bounds.max:B.max||B.position||B;F&&L&&(F.x<P.min.x&&(P.min.x=F.x),L.x>P.max.x&&(P.max.x=L.x),F.y<P.min.y&&(P.min.y=F.y),L.y>P.max.y&&(P.max.y=L.y))}var H=P.max.x-P.min.x+2*I.x,N=P.max.y-P.min.y+2*I.y,G=y.canvas.height,q=y.canvas.width,j=q/G,rt=H/N,$=1,Q=1;rt>j?Q=rt/j:$=j/rt,y.options.hasBounds=!0,y.bounds.min.x=P.min.x,y.bounds.max.x=P.min.x+H*$,y.bounds.min.y=P.min.y,y.bounds.max.y=P.min.y+N*Q,C&&(y.bounds.min.x+=H*.5-H*$*.5,y.bounds.max.x+=H*.5-H*$*.5,y.bounds.min.y+=N*.5-N*Q*.5,y.bounds.max.y+=N*.5-N*Q*.5),y.bounds.min.x-=I.x,y.bounds.max.x-=I.x,y.bounds.min.y-=I.y,y.bounds.max.y-=I.y,y.mouse&&(l.setScale(y.mouse,{x:(y.bounds.max.x-y.bounds.min.x)/y.canvas.width,y:(y.bounds.max.y-y.bounds.min.y)/y.canvas.height}),l.setOffset(y.mouse,y.bounds.min))},i.startViewTransform=function(y){var w=y.bounds.max.x-y.bounds.min.x,I=y.bounds.max.y-y.bounds.min.y,C=w/y.options.width,P=I/y.options.height;y.context.setTransform(y.options.pixelRatio/C,0,0,y.options.pixelRatio/P,0,0),y.context.translate(-y.bounds.min.x,-y.bounds.min.y)},i.endViewTransform=function(y){y.context.setTransform(y.options.pixelRatio,0,0,y.options.pixelRatio,0,0)},i.world=function(y,w){var I=o.now(),C=y.engine,P=C.world,M=y.canvas,B=y.context,F=y.options,L=y.timing,H=a.allBodies(P),N=a.allConstraints(P),G=F.wireframes?F.wireframeBackground:F.background,q=[],j=[],rt,$={timestamp:C.timing.timestamp};if(f.trigger(y,"beforeRender",$),y.currentBackground!==G&&b(y,G),B.globalCompositeOperation="source-in",B.fillStyle="transparent",B.fillRect(0,0,M.width,M.height),B.globalCompositeOperation="source-over",F.hasBounds){for(rt=0;rt<H.length;rt++){var Q=H[rt];c.overlaps(Q.bounds,y.bounds)&&q.push(Q)}for(rt=0;rt<N.length;rt++){var st=N[rt],_t=st.bodyA,Tt=st.bodyB,Ct=st.pointA,yt=st.pointB;_t&&(Ct=p.add(_t.position,st.pointA)),Tt&&(yt=p.add(Tt.position,st.pointB)),!(!Ct||!yt)&&(c.contains(y.bounds,Ct)||c.contains(y.bounds,yt))&&j.push(st)}i.startViewTransform(y),y.mouse&&(l.setScale(y.mouse,{x:(y.bounds.max.x-y.bounds.min.x)/y.options.width,y:(y.bounds.max.y-y.bounds.min.y)/y.options.height}),l.setOffset(y.mouse,y.bounds.min))}else j=N,q=H,y.options.pixelRatio!==1&&y.context.setTransform(y.options.pixelRatio,0,0,y.options.pixelRatio,0,0);!F.wireframes||C.enableSleeping&&F.showSleeping?i.bodies(y,q,B):(F.showConvexHulls&&i.bodyConvexHulls(y,q,B),i.bodyWireframes(y,q,B)),F.showBounds&&i.bodyBounds(y,q,B),(F.showAxes||F.showAngleIndicator)&&i.bodyAxes(y,q,B),F.showPositions&&i.bodyPositions(y,q,B),F.showVelocity&&i.bodyVelocity(y,q,B),F.showIds&&i.bodyIds(y,q,B),F.showSeparations&&i.separations(y,C.pairs.list,B),F.showCollisions&&i.collisions(y,C.pairs.list,B),F.showVertexNumbers&&i.vertexNumbers(y,q,B),F.showMousePosition&&i.mousePosition(y,y.mouse,B),i.constraints(j,B),F.hasBounds&&i.endViewTransform(y),f.trigger(y,"afterRender",$),L.lastElapsed=o.now()-I},i.stats=function(y,w,I){for(var C=y.engine,P=C.world,M=a.allBodies(P),B=0,F=55,L=44,H=0,N=0,G=0;G<M.length;G+=1)B+=M[G].parts.length;var q={Part:B,Body:M.length,Cons:a.allConstraints(P).length,Comp:a.allComposites(P).length,Pair:C.pairs.list.length};w.fillStyle="#0e0f19",w.fillRect(H,N,F*5.5,L),w.font="12px Arial",w.textBaseline="top",w.textAlign="right";for(var j in q){var rt=q[j];w.fillStyle="#aaa",w.fillText(j,H+F,N+8),w.fillStyle="#eee",w.fillText(rt,H+F,N+26),H+=F}},i.performance=function(y,w){var I=y.engine,C=y.timing,P=C.deltaHistory,M=C.elapsedHistory,B=C.timestampElapsedHistory,F=C.engineDeltaHistory,L=C.engineElapsedHistory,H=I.timing.lastDelta,N=_(P),G=_(M),q=_(F),j=_(L),rt=_(B),$=rt/N||0,Q=1e3/N||0,st=4,_t=12,Tt=60,Ct=34,yt=10,Ht=69;w.fillStyle="#0e0f19",w.fillRect(0,50,_t*4+Tt*5+22,Ct),i.status(w,yt,Ht,Tt,st,P.length,Math.round(Q)+" fps",Q/i._goodFps,function(Bt){return P[Bt]/N-1}),i.status(w,yt+_t+Tt,Ht,Tt,st,F.length,H.toFixed(2)+" dt",i._goodDelta/H,function(Bt){return F[Bt]/q-1}),i.status(w,yt+(_t+Tt)*2,Ht,Tt,st,L.length,j.toFixed(2)+" ut",1-j/i._goodFps,function(Bt){return L[Bt]/j-1}),i.status(w,yt+(_t+Tt)*3,Ht,Tt,st,M.length,G.toFixed(2)+" rt",1-G/i._goodFps,function(Bt){return M[Bt]/G-1}),i.status(w,yt+(_t+Tt)*4,Ht,Tt,st,B.length,$.toFixed(2)+" x",$*$*$,function(Bt){return(B[Bt]/P[Bt]/$||0)-1})},i.status=function(y,w,I,C,P,M,B,F,L){y.strokeStyle="#888",y.fillStyle="#444",y.lineWidth=1,y.fillRect(w,I+7,C,1),y.beginPath(),y.moveTo(w,I+7-P*o.clamp(.4*L(0),-2,2));for(var H=0;H<C;H+=1)y.lineTo(w+H,I+7-(H<M?P*o.clamp(.4*L(H),-2,2):0));y.stroke(),y.fillStyle="hsl("+o.clamp(25+95*F,0,120)+",100%,60%)",y.fillRect(w,I-7,4,4),y.font="12px Arial",y.textBaseline="middle",y.textAlign="right",y.fillStyle="#eee",y.fillText(B,w+C,I-5)},i.constraints=function(y,w){for(var I=w,C=0;C<y.length;C++){var P=y[C];if(!(!P.render.visible||!P.pointA||!P.pointB)){var M=P.bodyA,B=P.bodyB,F,L;if(M?F=p.add(M.position,P.pointA):F=P.pointA,P.render.type==="pin")I.beginPath(),I.arc(F.x,F.y,3,0,2*Math.PI),I.closePath();else{if(B?L=p.add(B.position,P.pointB):L=P.pointB,I.beginPath(),I.moveTo(F.x,F.y),P.render.type==="spring")for(var H=p.sub(L,F),N=p.perp(p.normalise(H)),G=Math.ceil(o.clamp(P.length/5,12,20)),q,j=1;j<G;j+=1)q=j%2===0?1:-1,I.lineTo(F.x+H.x*(j/G)+N.x*q*4,F.y+H.y*(j/G)+N.y*q*4);I.lineTo(L.x,L.y)}P.render.lineWidth&&(I.lineWidth=P.render.lineWidth,I.strokeStyle=P.render.strokeStyle,I.stroke()),P.render.anchors&&(I.fillStyle=P.render.strokeStyle,I.beginPath(),I.arc(F.x,F.y,3,0,2*Math.PI),I.arc(L.x,L.y,3,0,2*Math.PI),I.closePath(),I.fill())}}},i.bodies=function(y,w,I){var C=I,P=y.engine,M=y.options,B=M.showInternalEdges||!M.wireframes,F,L,H,N;for(H=0;H<w.length;H++)if(F=w[H],!!F.render.visible){for(N=F.parts.length>1?1:0;N<F.parts.length;N++)if(L=F.parts[N],!!L.render.visible){if(M.showSleeping&&F.isSleeping?C.globalAlpha=.5*L.render.opacity:L.render.opacity!==1&&(C.globalAlpha=L.render.opacity),L.render.sprite&&L.render.sprite.texture&&!M.wireframes){var G=L.render.sprite,q=S(y,G.texture);C.translate(L.position.x,L.position.y),C.rotate(L.angle),C.drawImage(q,q.width*-G.xOffset*G.xScale,q.height*-G.yOffset*G.yScale,q.width*G.xScale,q.height*G.yScale),C.rotate(-L.angle),C.translate(-L.position.x,-L.position.y)}else{if(L.circleRadius)C.beginPath(),C.arc(L.position.x,L.position.y,L.circleRadius,0,2*Math.PI);else{C.beginPath(),C.moveTo(L.vertices[0].x,L.vertices[0].y);for(var j=1;j<L.vertices.length;j++)!L.vertices[j-1].isInternal||B?C.lineTo(L.vertices[j].x,L.vertices[j].y):C.moveTo(L.vertices[j].x,L.vertices[j].y),L.vertices[j].isInternal&&!B&&C.moveTo(L.vertices[(j+1)%L.vertices.length].x,L.vertices[(j+1)%L.vertices.length].y);C.lineTo(L.vertices[0].x,L.vertices[0].y),C.closePath()}M.wireframes?(C.lineWidth=1,C.strokeStyle="#bbb",C.stroke()):(C.fillStyle=L.render.fillStyle,L.render.lineWidth&&(C.lineWidth=L.render.lineWidth,C.strokeStyle=L.render.strokeStyle,C.stroke()),C.fill())}C.globalAlpha=1}}},i.bodyWireframes=function(y,w,I){var C=I,P=y.options.showInternalEdges,M,B,F,L,H;for(C.beginPath(),F=0;F<w.length;F++)if(M=w[F],!!M.render.visible)for(H=M.parts.length>1?1:0;H<M.parts.length;H++){for(B=M.parts[H],C.moveTo(B.vertices[0].x,B.vertices[0].y),L=1;L<B.vertices.length;L++)!B.vertices[L-1].isInternal||P?C.lineTo(B.vertices[L].x,B.vertices[L].y):C.moveTo(B.vertices[L].x,B.vertices[L].y),B.vertices[L].isInternal&&!P&&C.moveTo(B.vertices[(L+1)%B.vertices.length].x,B.vertices[(L+1)%B.vertices.length].y);C.lineTo(B.vertices[0].x,B.vertices[0].y)}C.lineWidth=1,C.strokeStyle="#bbb",C.stroke()},i.bodyConvexHulls=function(y,w,I){var C=I,P,M,B,F,L;for(C.beginPath(),B=0;B<w.length;B++)if(P=w[B],!(!P.render.visible||P.parts.length===1)){for(C.moveTo(P.vertices[0].x,P.vertices[0].y),F=1;F<P.vertices.length;F++)C.lineTo(P.vertices[F].x,P.vertices[F].y);C.lineTo(P.vertices[0].x,P.vertices[0].y)}C.lineWidth=1,C.strokeStyle="rgba(255,255,255,0.2)",C.stroke()},i.vertexNumbers=function(y,w,I){var C=I,P,M,B;for(P=0;P<w.length;P++){var F=w[P].parts;for(B=F.length>1?1:0;B<F.length;B++){var L=F[B];for(M=0;M<L.vertices.length;M++)C.fillStyle="rgba(255,255,255,0.2)",C.fillText(P+"_"+M,L.position.x+(L.vertices[M].x-L.position.x)*.8,L.position.y+(L.vertices[M].y-L.position.y)*.8)}}},i.mousePosition=function(y,w,I){var C=I;C.fillStyle="rgba(255,255,255,0.8)",C.fillText(w.position.x+"  "+w.position.y,w.position.x+5,w.position.y-5)},i.bodyBounds=function(y,w,I){var C=I,P=y.engine,M=y.options;C.beginPath();for(var B=0;B<w.length;B++){var F=w[B];if(F.render.visible)for(var L=w[B].parts,H=L.length>1?1:0;H<L.length;H++){var N=L[H];C.rect(N.bounds.min.x,N.bounds.min.y,N.bounds.max.x-N.bounds.min.x,N.bounds.max.y-N.bounds.min.y)}}M.wireframes?C.strokeStyle="rgba(255,255,255,0.08)":C.strokeStyle="rgba(0,0,0,0.1)",C.lineWidth=1,C.stroke()},i.bodyAxes=function(y,w,I){var C=I,P=y.engine,M=y.options,B,F,L,H;for(C.beginPath(),F=0;F<w.length;F++){var N=w[F],G=N.parts;if(N.render.visible)if(M.showAxes)for(L=G.length>1?1:0;L<G.length;L++)for(B=G[L],H=0;H<B.axes.length;H++){var q=B.axes[H];C.moveTo(B.position.x,B.position.y),C.lineTo(B.position.x+q.x*20,B.position.y+q.y*20)}else for(L=G.length>1?1:0;L<G.length;L++)for(B=G[L],H=0;H<B.axes.length;H++)C.moveTo(B.position.x,B.position.y),C.lineTo((B.vertices[0].x+B.vertices[B.vertices.length-1].x)/2,(B.vertices[0].y+B.vertices[B.vertices.length-1].y)/2)}M.wireframes?(C.strokeStyle="indianred",C.lineWidth=1):(C.strokeStyle="rgba(255, 255, 255, 0.4)",C.globalCompositeOperation="overlay",C.lineWidth=2),C.stroke(),C.globalCompositeOperation="source-over"},i.bodyPositions=function(y,w,I){var C=I,P=y.engine,M=y.options,B,F,L,H;for(C.beginPath(),L=0;L<w.length;L++)if(B=w[L],!!B.render.visible)for(H=0;H<B.parts.length;H++)F=B.parts[H],C.arc(F.position.x,F.position.y,3,0,2*Math.PI,!1),C.closePath();for(M.wireframes?C.fillStyle="indianred":C.fillStyle="rgba(0,0,0,0.5)",C.fill(),C.beginPath(),L=0;L<w.length;L++)B=w[L],B.render.visible&&(C.arc(B.positionPrev.x,B.positionPrev.y,2,0,2*Math.PI,!1),C.closePath());C.fillStyle="rgba(255,165,0,0.8)",C.fill()},i.bodyVelocity=function(y,w,I){var C=I;C.beginPath();for(var P=0;P<w.length;P++){var M=w[P];if(M.render.visible){var B=n.getVelocity(M);C.moveTo(M.position.x,M.position.y),C.lineTo(M.position.x+B.x,M.position.y+B.y)}}C.lineWidth=3,C.strokeStyle="cornflowerblue",C.stroke()},i.bodyIds=function(y,w,I){var C=I,P,M;for(P=0;P<w.length;P++)if(w[P].render.visible){var B=w[P].parts;for(M=B.length>1?1:0;M<B.length;M++){var F=B[M];C.font="12px Arial",C.fillStyle="rgba(255,255,255,0.5)",C.fillText(F.id,F.position.x+10,F.position.y-10)}}},i.collisions=function(y,w,I){var C=I,P=y.options,M,B,F,L,H,N,G;for(C.beginPath(),N=0;N<w.length;N++)if(M=w[N],!!M.isActive)for(B=M.collision,G=0;G<M.activeContacts.length;G++){var q=M.activeContacts[G],j=q.vertex;C.rect(j.x-1.5,j.y-1.5,3.5,3.5)}for(P.wireframes?C.fillStyle="rgba(255,255,255,0.7)":C.fillStyle="orange",C.fill(),C.beginPath(),N=0;N<w.length;N++)if(M=w[N],!!M.isActive&&(B=M.collision,M.activeContacts.length>0)){var rt=M.activeContacts[0].vertex.x,$=M.activeContacts[0].vertex.y;M.activeContacts.length===2&&(rt=(M.activeContacts[0].vertex.x+M.activeContacts[1].vertex.x)/2,$=(M.activeContacts[0].vertex.y+M.activeContacts[1].vertex.y)/2),B.bodyB===B.supports[0].body||B.bodyA.isStatic===!0?C.moveTo(rt-B.normal.x*8,$-B.normal.y*8):C.moveTo(rt+B.normal.x*8,$+B.normal.y*8),C.lineTo(rt,$)}P.wireframes?C.strokeStyle="rgba(255,165,0,0.7)":C.strokeStyle="orange",C.lineWidth=1,C.stroke()},i.separations=function(y,w,I){var C=I,P=y.options,M,B,F,L,H,N,G;for(C.beginPath(),N=0;N<w.length;N++)if(M=w[N],!!M.isActive){B=M.collision,L=B.bodyA,H=B.bodyB;var q=1;!H.isStatic&&!L.isStatic&&(q=.5),H.isStatic&&(q=0),C.moveTo(H.position.x,H.position.y),C.lineTo(H.position.x-B.penetration.x*q,H.position.y-B.penetration.y*q),q=1,!H.isStatic&&!L.isStatic&&(q=.5),L.isStatic&&(q=0),C.moveTo(L.position.x,L.position.y),C.lineTo(L.position.x+B.penetration.x*q,L.position.y+B.penetration.y*q)}P.wireframes?C.strokeStyle="rgba(255,165,0,0.5)":C.strokeStyle="orange",C.stroke()},i.inspector=function(y,w){var I=y.engine,C=y.selected,P=y.render,M=P.options,B;if(M.hasBounds){var F=P.bounds.max.x-P.bounds.min.x,L=P.bounds.max.y-P.bounds.min.y,H=F/P.options.width,N=L/P.options.height;w.scale(1/H,1/N),w.translate(-P.bounds.min.x,-P.bounds.min.y)}for(var G=0;G<C.length;G++){var q=C[G].data;switch(w.translate(.5,.5),w.lineWidth=1,w.strokeStyle="rgba(255,165,0,0.9)",w.setLineDash([1,2]),q.type){case"body":B=q.bounds,w.beginPath(),w.rect(Math.floor(B.min.x-3),Math.floor(B.min.y-3),Math.floor(B.max.x-B.min.x+6),Math.floor(B.max.y-B.min.y+6)),w.closePath(),w.stroke();break;case"constraint":var j=q.pointA;q.bodyA&&(j=q.pointB),w.beginPath(),w.arc(j.x,j.y,10,0,2*Math.PI),w.closePath(),w.stroke();break}w.setLineDash([]),w.translate(-.5,-.5)}y.selectStart!==null&&(w.translate(.5,.5),w.lineWidth=1,w.strokeStyle="rgba(255,165,0,0.6)",w.fillStyle="rgba(255,165,0,0.1)",B=y.selectBounds,w.beginPath(),w.rect(Math.floor(B.min.x),Math.floor(B.min.y),Math.floor(B.max.x-B.min.x),Math.floor(B.max.y-B.min.y)),w.closePath(),w.stroke(),w.fill(),w.translate(-.5,-.5)),M.hasBounds&&w.setTransform(1,0,0,1,0,0)};var m=function(y,w){var I=y.engine,C=y.timing,P=C.historySize,M=I.timing.timestamp;C.delta=w-C.lastTime||i._goodDelta,C.lastTime=w,C.timestampElapsed=M-C.lastTimestamp||0,C.lastTimestamp=M,C.deltaHistory.unshift(C.delta),C.deltaHistory.length=Math.min(C.deltaHistory.length,P),C.engineDeltaHistory.unshift(I.timing.lastDelta),C.engineDeltaHistory.length=Math.min(C.engineDeltaHistory.length,P),C.timestampElapsedHistory.unshift(C.timestampElapsed),C.timestampElapsedHistory.length=Math.min(C.timestampElapsedHistory.length,P),C.engineElapsedHistory.unshift(I.timing.lastElapsed),C.engineElapsedHistory.length=Math.min(C.engineElapsedHistory.length,P),C.elapsedHistory.unshift(C.lastElapsed),C.elapsedHistory.length=Math.min(C.elapsedHistory.length,P)},_=function(y){for(var w=0,I=0;I<y.length;I+=1)w+=y[I];return w/y.length||0},x=function(y,w){var I=document.createElement("canvas");return I.width=y,I.height=w,I.oncontextmenu=function(){return!1},I.onselectstart=function(){return!1},I},T=function(y){var w=y.getContext("2d"),I=window.devicePixelRatio||1,C=w.webkitBackingStorePixelRatio||w.mozBackingStorePixelRatio||w.msBackingStorePixelRatio||w.oBackingStorePixelRatio||w.backingStorePixelRatio||1;return I/C},S=function(y,w){var I=y.textures[w];return I||(I=y.textures[w]=new Image,I.src=w,I)},b=function(y,w){var I=w;/(jpg|gif|png)$/.test(w)&&(I="url("+w+")"),y.canvas.style.background=I,y.canvas.style.backgroundSize="contain",y.currentBackground=w}})()},function(e,t,r){var i={};e.exports=i;var n=r(5),o=r(17),a=r(0);(function(){var c,f;if(typeof window<"u"&&(c=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,f=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),!c){var p;c=function(l){p=setTimeout(function(){l(a.now())},1e3/60)},f=function(){clearTimeout(p)}}i.create=function(l){var h={fps:60,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,frameRequestId:null,isFixed:!1,enabled:!0},d=a.extend(h,l);return d.delta=d.delta||1e3/d.fps,d.deltaMin=d.deltaMin||1e3/d.fps,d.deltaMax=d.deltaMax||1e3/(d.fps*.5),d.fps=1e3/d.delta,d},i.run=function(l,h){return typeof l.positionIterations<"u"&&(h=l,l=i.create()),function d(m){l.frameRequestId=c(d),m&&l.enabled&&i.tick(l,h,m)}(),l},i.tick=function(l,h,d){var m=h.timing,_;l.isFixed?_=l.delta:(_=d-l.timePrev||l.delta,l.timePrev=d,l.deltaHistory.push(_),l.deltaHistory=l.deltaHistory.slice(-l.deltaSampleSize),_=Math.min.apply(null,l.deltaHistory),_=_<l.deltaMin?l.deltaMin:_,_=_>l.deltaMax?l.deltaMax:_,l.delta=_);var x={timestamp:m.timestamp};n.trigger(l,"beforeTick",x),l.frameCounter+=1,d-l.counterTimestamp>=1e3&&(l.fps=l.frameCounter*((d-l.counterTimestamp)/1e3),l.counterTimestamp=d,l.frameCounter=0),n.trigger(l,"tick",x),n.trigger(l,"beforeUpdate",x),o.update(h,_),n.trigger(l,"afterUpdate",x),n.trigger(l,"afterTick",x)},i.stop=function(l){f(l.frameRequestId)},i.start=function(l,h){i.run(l,h)}})()},function(e,t,r){var i={};e.exports=i;var n=r(8),o=r(0),a=o.deprecated;(function(){i.collides=function(c,f){return n.collides(c,f)},a(i,"collides","SAT.collides \u27A4 replaced by Collision.collides")})()},function(e,t,r){var i={};e.exports=i;var n=r(1),o=r(0);(function(){i.pathToVertices=function(a,c){typeof window<"u"&&!("SVGPathSeg"in window)&&o.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var f,p,l,h,d,m,_,x,T,S,b=[],y,w,I=0,C=0,P=0;c=c||15;var M=function(F,L,H){var N=H%2===1&&H>1;if(!T||F!=T.x||L!=T.y){T&&N?(y=T.x,w=T.y):(y=0,w=0);var G={x:y+F,y:w+L};(N||!T)&&(T=G),b.push(G),C=y+F,P=w+L}},B=function(F){var L=F.pathSegTypeAsLetter.toUpperCase();if(L!=="Z"){switch(L){case"M":case"L":case"T":case"C":case"S":case"Q":C=F.x,P=F.y;break;case"H":C=F.x;break;case"V":P=F.y;break}M(C,P,F.pathSegType)}};for(i._svgPathToAbsolute(a),l=a.getTotalLength(),m=[],f=0;f<a.pathSegList.numberOfItems;f+=1)m.push(a.pathSegList.getItem(f));for(_=m.concat();I<l;){if(S=a.getPathSegAtLength(I),d=m[S],d!=x){for(;_.length&&_[0]!=d;)B(_.shift());x=d}switch(d.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":h=a.getPointAtLength(I),M(h.x,h.y,0);break}I+=c}for(f=0,p=_.length;f<p;++f)B(_[f]);return b},i._svgPathToAbsolute=function(a){for(var c,f,p,l,h,d,m=a.pathSegList,_=0,x=0,T=m.numberOfItems,S=0;S<T;++S){var b=m.getItem(S),y=b.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(y))"x"in b&&(_=b.x),"y"in b&&(x=b.y);else switch("x1"in b&&(p=_+b.x1),"x2"in b&&(h=_+b.x2),"y1"in b&&(l=x+b.y1),"y2"in b&&(d=x+b.y2),"x"in b&&(_+=b.x),"y"in b&&(x+=b.y),y){case"m":m.replaceItem(a.createSVGPathSegMovetoAbs(_,x),S);break;case"l":m.replaceItem(a.createSVGPathSegLinetoAbs(_,x),S);break;case"h":m.replaceItem(a.createSVGPathSegLinetoHorizontalAbs(_),S);break;case"v":m.replaceItem(a.createSVGPathSegLinetoVerticalAbs(x),S);break;case"c":m.replaceItem(a.createSVGPathSegCurvetoCubicAbs(_,x,p,l,h,d),S);break;case"s":m.replaceItem(a.createSVGPathSegCurvetoCubicSmoothAbs(_,x,h,d),S);break;case"q":m.replaceItem(a.createSVGPathSegCurvetoQuadraticAbs(_,x,p,l),S);break;case"t":m.replaceItem(a.createSVGPathSegCurvetoQuadraticSmoothAbs(_,x),S);break;case"a":m.replaceItem(a.createSVGPathSegArcAbs(_,x,b.r1,b.r2,b.angle,b.largeArcFlag,b.sweepFlag),S);break;case"z":case"Z":_=c,x=f;break}(y=="M"||y=="m")&&(c=_,f=x)}}})()},function(e,t,r){var i={};e.exports=i;var n=r(6),o=r(0);(function(){i.create=n.create,i.add=n.add,i.remove=n.remove,i.clear=n.clear,i.addComposite=n.addComposite,i.addBody=n.addBody,i.addConstraint=n.addConstraint})()}])})});var If=Fr((eo,Ca)=>{(function(){var e,t="4.17.21",r=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",n="Expected a function",o="Invalid `variable` option passed into `_.template`",a="__lodash_hash_undefined__",c=500,f="__lodash_placeholder__",p=1,l=2,h=4,d=1,m=2,_=1,x=2,T=4,S=8,b=16,y=32,w=64,I=128,C=256,P=512,M=30,B="...",F=800,L=16,H=1,N=2,G=3,q=1/0,j=9007199254740991,rt=17976931348623157e292,$=0/0,Q=4294967295,st=Q-1,_t=Q>>>1,Tt=[["ary",I],["bind",_],["bindKey",x],["curry",S],["curryRight",b],["flip",P],["partial",y],["partialRight",w],["rearg",C]],Ct="[object Arguments]",yt="[object Array]",Ht="[object AsyncFunction]",Bt="[object Boolean]",Qt="[object Date]",_e="[object DOMException]",$t="[object Error]",Vt="[object Function]",jt="[object GeneratorFunction]",Dt="[object Map]",Ot="[object Number]",Yr="[object Null]",Ce="[object Object]",pn="[object Promise]",Kn="[object Proxy]",rr="[object RegExp]",$e="[object Set]",jr="[object String]",qn="[object Symbol]",Sh="[object Undefined]",Kr="[object WeakMap]",Zn="[object WeakSet]",io="[object ArrayBuffer]",Qn="[object DataView]",bh="[object Float32Array]",Ah="[object Float64Array]",Ch="[object Int8Array]",Ih="[object Int16Array]",Rh="[object Int32Array]",Ph="[object Uint8Array]",Mh="[object Uint8ClampedArray]",Bh="[object Uint16Array]",Dh="[object Uint32Array]",z_=/\b__p \+= '';/g,$_=/\b(__p \+=) '' \+/g,Y_=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Pf=/&(?:amp|lt|gt|quot|#39);/g,Mf=/[&<>"']/g,j_=RegExp(Pf.source),K_=RegExp(Mf.source),q_=/<%-([\s\S]+?)%>/g,Z_=/<%([\s\S]+?)%>/g,Bf=/<%=([\s\S]+?)%>/g,Q_=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,J_=/^\w*$/,tx=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Lh=/[\\^$.*+?()[\]{}|]/g,ex=RegExp(Lh.source),Fh=/^\s+/,rx=/\s/,ix=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,nx=/\{\n\/\* \[wrapped with (.+)\] \*/,sx=/,? & /,ox=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ax=/[()=,{}\[\]\/\s]/,lx=/\\(\\)?/g,hx=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Df=/\w*$/,ux=/^[-+]0x[0-9a-f]+$/i,cx=/^0b[01]+$/i,fx=/^\[object .+?Constructor\]$/,dx=/^0o[0-7]+$/i,px=/^(?:0|[1-9]\d*)$/,mx=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ia=/($^)/,gx=/['\n\r\u2028\u2029\\]/g,Ra="\\ud800-\\udfff",_x="\\u0300-\\u036f",xx="\\ufe20-\\ufe2f",vx="\\u20d0-\\u20ff",Lf=_x+xx+vx,Ff="\\u2700-\\u27bf",Of="a-z\\xdf-\\xf6\\xf8-\\xff",yx="\\xac\\xb1\\xd7\\xf7",Tx="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",wx="\\u2000-\\u206f",Ex=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Nf="A-Z\\xc0-\\xd6\\xd8-\\xde",Uf="\\ufe0e\\ufe0f",kf=yx+Tx+wx+Ex,Oh="['\u2019]",Sx="["+Ra+"]",Gf="["+kf+"]",Pa="["+Lf+"]",Hf="\\d+",bx="["+Ff+"]",Vf="["+Of+"]",Wf="[^"+Ra+kf+Hf+Ff+Of+Nf+"]",Nh="\\ud83c[\\udffb-\\udfff]",Ax="(?:"+Pa+"|"+Nh+")",Xf="[^"+Ra+"]",Uh="(?:\\ud83c[\\udde6-\\uddff]){2}",kh="[\\ud800-\\udbff][\\udc00-\\udfff]",Jn="["+Nf+"]",zf="\\u200d",$f="(?:"+Vf+"|"+Wf+")",Cx="(?:"+Jn+"|"+Wf+")",Yf="(?:"+Oh+"(?:d|ll|m|re|s|t|ve))?",jf="(?:"+Oh+"(?:D|LL|M|RE|S|T|VE))?",Kf=Ax+"?",qf="["+Uf+"]?",Ix="(?:"+zf+"(?:"+[Xf,Uh,kh].join("|")+")"+qf+Kf+")*",Rx="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Px="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Zf=qf+Kf+Ix,Mx="(?:"+[bx,Uh,kh].join("|")+")"+Zf,Bx="(?:"+[Xf+Pa+"?",Pa,Uh,kh,Sx].join("|")+")",Dx=RegExp(Oh,"g"),Lx=RegExp(Pa,"g"),Gh=RegExp(Nh+"(?="+Nh+")|"+Bx+Zf,"g"),Fx=RegExp([Jn+"?"+Vf+"+"+Yf+"(?="+[Gf,Jn,"$"].join("|")+")",Cx+"+"+jf+"(?="+[Gf,Jn+$f,"$"].join("|")+")",Jn+"?"+$f+"+"+Yf,Jn+"+"+jf,Px,Rx,Hf,Mx].join("|"),"g"),Ox=RegExp("["+zf+Ra+Lf+Uf+"]"),Nx=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ux=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],kx=-1,Kt={};Kt[bh]=Kt[Ah]=Kt[Ch]=Kt[Ih]=Kt[Rh]=Kt[Ph]=Kt[Mh]=Kt[Bh]=Kt[Dh]=!0,Kt[Ct]=Kt[yt]=Kt[io]=Kt[Bt]=Kt[Qn]=Kt[Qt]=Kt[$t]=Kt[Vt]=Kt[Dt]=Kt[Ot]=Kt[Ce]=Kt[rr]=Kt[$e]=Kt[jr]=Kt[Kr]=!1;var Yt={};Yt[Ct]=Yt[yt]=Yt[io]=Yt[Qn]=Yt[Bt]=Yt[Qt]=Yt[bh]=Yt[Ah]=Yt[Ch]=Yt[Ih]=Yt[Rh]=Yt[Dt]=Yt[Ot]=Yt[Ce]=Yt[rr]=Yt[$e]=Yt[jr]=Yt[qn]=Yt[Ph]=Yt[Mh]=Yt[Bh]=Yt[Dh]=!0,Yt[$t]=Yt[Vt]=Yt[Kr]=!1;var Gx={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Hx={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Vx={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Wx={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Xx=parseFloat,zx=parseInt,Qf=typeof global=="object"&&global&&global.Object===Object&&global,$x=typeof self=="object"&&self&&self.Object===Object&&self,xe=Qf||$x||Function("return this")(),Hh=typeof eo=="object"&&eo&&!eo.nodeType&&eo,mn=Hh&&typeof Ca=="object"&&Ca&&!Ca.nodeType&&Ca,Jf=mn&&mn.exports===Hh,Vh=Jf&&Qf.process,_r=function(){try{var U=mn&&mn.require&&mn.require("util").types;return U||Vh&&Vh.binding&&Vh.binding("util")}catch{}}(),td=_r&&_r.isArrayBuffer,ed=_r&&_r.isDate,rd=_r&&_r.isMap,id=_r&&_r.isRegExp,nd=_r&&_r.isSet,sd=_r&&_r.isTypedArray;function ir(U,X,V){switch(V.length){case 0:return U.call(X);case 1:return U.call(X,V[0]);case 2:return U.call(X,V[0],V[1]);case 3:return U.call(X,V[0],V[1],V[2])}return U.apply(X,V)}function Yx(U,X,V,ot){for(var wt=-1,Nt=U==null?0:U.length;++wt<Nt;){var ce=U[wt];X(ot,ce,V(ce),U)}return ot}function xr(U,X){for(var V=-1,ot=U==null?0:U.length;++V<ot&&X(U[V],V,U)!==!1;);return U}function jx(U,X){for(var V=U==null?0:U.length;V--&&X(U[V],V,U)!==!1;);return U}function od(U,X){for(var V=-1,ot=U==null?0:U.length;++V<ot;)if(!X(U[V],V,U))return!1;return!0}function Fi(U,X){for(var V=-1,ot=U==null?0:U.length,wt=0,Nt=[];++V<ot;){var ce=U[V];X(ce,V,U)&&(Nt[wt++]=ce)}return Nt}function Ma(U,X){var V=U==null?0:U.length;return!!V&&ts(U,X,0)>-1}function Wh(U,X,V){for(var ot=-1,wt=U==null?0:U.length;++ot<wt;)if(V(X,U[ot]))return!0;return!1}function Zt(U,X){for(var V=-1,ot=U==null?0:U.length,wt=Array(ot);++V<ot;)wt[V]=X(U[V],V,U);return wt}function Oi(U,X){for(var V=-1,ot=X.length,wt=U.length;++V<ot;)U[wt+V]=X[V];return U}function Xh(U,X,V,ot){var wt=-1,Nt=U==null?0:U.length;for(ot&&Nt&&(V=U[++wt]);++wt<Nt;)V=X(V,U[wt],wt,U);return V}function Kx(U,X,V,ot){var wt=U==null?0:U.length;for(ot&&wt&&(V=U[--wt]);wt--;)V=X(V,U[wt],wt,U);return V}function zh(U,X){for(var V=-1,ot=U==null?0:U.length;++V<ot;)if(X(U[V],V,U))return!0;return!1}var qx=$h("length");function Zx(U){return U.split("")}function Qx(U){return U.match(ox)||[]}function ad(U,X,V){var ot;return V(U,function(wt,Nt,ce){if(X(wt,Nt,ce))return ot=Nt,!1}),ot}function Ba(U,X,V,ot){for(var wt=U.length,Nt=V+(ot?1:-1);ot?Nt--:++Nt<wt;)if(X(U[Nt],Nt,U))return Nt;return-1}function ts(U,X,V){return X===X?uv(U,X,V):Ba(U,ld,V)}function Jx(U,X,V,ot){for(var wt=V-1,Nt=U.length;++wt<Nt;)if(ot(U[wt],X))return wt;return-1}function ld(U){return U!==U}function hd(U,X){var V=U==null?0:U.length;return V?jh(U,X)/V:$}function $h(U){return function(X){return X==null?e:X[U]}}function Yh(U){return function(X){return U==null?e:U[X]}}function ud(U,X,V,ot,wt){return wt(U,function(Nt,ce,Xt){V=ot?(ot=!1,Nt):X(V,Nt,ce,Xt)}),V}function tv(U,X){var V=U.length;for(U.sort(X);V--;)U[V]=U[V].value;return U}function jh(U,X){for(var V,ot=-1,wt=U.length;++ot<wt;){var Nt=X(U[ot]);Nt!==e&&(V=V===e?Nt:V+Nt)}return V}function Kh(U,X){for(var V=-1,ot=Array(U);++V<U;)ot[V]=X(V);return ot}function ev(U,X){return Zt(X,function(V){return[V,U[V]]})}function cd(U){return U&&U.slice(0,md(U)+1).replace(Fh,"")}function nr(U){return function(X){return U(X)}}function qh(U,X){return Zt(X,function(V){return U[V]})}function no(U,X){return U.has(X)}function fd(U,X){for(var V=-1,ot=U.length;++V<ot&&ts(X,U[V],0)>-1;);return V}function dd(U,X){for(var V=U.length;V--&&ts(X,U[V],0)>-1;);return V}function rv(U,X){for(var V=U.length,ot=0;V--;)U[V]===X&&++ot;return ot}var iv=Yh(Gx),nv=Yh(Hx);function sv(U){return"\\"+Wx[U]}function ov(U,X){return U==null?e:U[X]}function es(U){return Ox.test(U)}function av(U){return Nx.test(U)}function lv(U){for(var X,V=[];!(X=U.next()).done;)V.push(X.value);return V}function Zh(U){var X=-1,V=Array(U.size);return U.forEach(function(ot,wt){V[++X]=[wt,ot]}),V}function pd(U,X){return function(V){return U(X(V))}}function Ni(U,X){for(var V=-1,ot=U.length,wt=0,Nt=[];++V<ot;){var ce=U[V];(ce===X||ce===f)&&(U[V]=f,Nt[wt++]=V)}return Nt}function Da(U){var X=-1,V=Array(U.size);return U.forEach(function(ot){V[++X]=ot}),V}function hv(U){var X=-1,V=Array(U.size);return U.forEach(function(ot){V[++X]=[ot,ot]}),V}function uv(U,X,V){for(var ot=V-1,wt=U.length;++ot<wt;)if(U[ot]===X)return ot;return-1}function cv(U,X,V){for(var ot=V+1;ot--;)if(U[ot]===X)return ot;return ot}function rs(U){return es(U)?dv(U):qx(U)}function Mr(U){return es(U)?pv(U):Zx(U)}function md(U){for(var X=U.length;X--&&rx.test(U.charAt(X)););return X}var fv=Yh(Vx);function dv(U){for(var X=Gh.lastIndex=0;Gh.test(U);)++X;return X}function pv(U){return U.match(Gh)||[]}function mv(U){return U.match(Fx)||[]}var gv=function U(X){X=X==null?xe:Ui.defaults(xe.Object(),X,Ui.pick(xe,Ux));var V=X.Array,ot=X.Date,wt=X.Error,Nt=X.Function,ce=X.Math,Xt=X.Object,Qh=X.RegExp,_v=X.String,vr=X.TypeError,La=V.prototype,xv=Nt.prototype,is=Xt.prototype,Fa=X["__core-js_shared__"],Oa=xv.toString,Gt=is.hasOwnProperty,vv=0,gd=function(){var s=/[^.]+$/.exec(Fa&&Fa.keys&&Fa.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}(),Na=is.toString,yv=Oa.call(Xt),Tv=xe._,wv=Qh("^"+Oa.call(Gt).replace(Lh,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ua=Jf?X.Buffer:e,ki=X.Symbol,ka=X.Uint8Array,_d=Ua?Ua.allocUnsafe:e,Ga=pd(Xt.getPrototypeOf,Xt),xd=Xt.create,vd=is.propertyIsEnumerable,Ha=La.splice,yd=ki?ki.isConcatSpreadable:e,so=ki?ki.iterator:e,gn=ki?ki.toStringTag:e,Va=function(){try{var s=Tn(Xt,"defineProperty");return s({},"",{}),s}catch{}}(),Ev=X.clearTimeout!==xe.clearTimeout&&X.clearTimeout,Sv=ot&&ot.now!==xe.Date.now&&ot.now,bv=X.setTimeout!==xe.setTimeout&&X.setTimeout,Wa=ce.ceil,Xa=ce.floor,Jh=Xt.getOwnPropertySymbols,Av=Ua?Ua.isBuffer:e,Td=X.isFinite,Cv=La.join,Iv=pd(Xt.keys,Xt),fe=ce.max,Ie=ce.min,Rv=ot.now,Pv=X.parseInt,wd=ce.random,Mv=La.reverse,tu=Tn(X,"DataView"),oo=Tn(X,"Map"),eu=Tn(X,"Promise"),ns=Tn(X,"Set"),ao=Tn(X,"WeakMap"),lo=Tn(Xt,"create"),za=ao&&new ao,ss={},Bv=wn(tu),Dv=wn(oo),Lv=wn(eu),Fv=wn(ns),Ov=wn(ao),$a=ki?ki.prototype:e,ho=$a?$a.valueOf:e,Ed=$a?$a.toString:e;function A(s){if(re(s)&&!St(s)&&!(s instanceof Pt)){if(s instanceof yr)return s;if(Gt.call(s,"__wrapped__"))return Sp(s)}return new yr(s)}var os=function(){function s(){}return function(u){if(!Jt(u))return{};if(xd)return xd(u);s.prototype=u;var g=new s;return s.prototype=e,g}}();function Ya(){}function yr(s,u){this.__wrapped__=s,this.__actions__=[],this.__chain__=!!u,this.__index__=0,this.__values__=e}A.templateSettings={escape:q_,evaluate:Z_,interpolate:Bf,variable:"",imports:{_:A}},A.prototype=Ya.prototype,A.prototype.constructor=A,yr.prototype=os(Ya.prototype),yr.prototype.constructor=yr;function Pt(s){this.__wrapped__=s,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Q,this.__views__=[]}function Nv(){var s=new Pt(this.__wrapped__);return s.__actions__=Ye(this.__actions__),s.__dir__=this.__dir__,s.__filtered__=this.__filtered__,s.__iteratees__=Ye(this.__iteratees__),s.__takeCount__=this.__takeCount__,s.__views__=Ye(this.__views__),s}function Uv(){if(this.__filtered__){var s=new Pt(this);s.__dir__=-1,s.__filtered__=!0}else s=this.clone(),s.__dir__*=-1;return s}function kv(){var s=this.__wrapped__.value(),u=this.__dir__,g=St(s),v=u<0,E=g?s.length:0,R=Z0(0,E,this.__views__),D=R.start,O=R.end,k=O-D,Y=v?O:D-1,K=this.__iteratees__,J=K.length,nt=0,ht=Ie(k,this.__takeCount__);if(!g||!v&&E==k&&ht==k)return Yd(s,this.__actions__);var xt=[];t:for(;k--&&nt<ht;){Y+=u;for(var At=-1,vt=s[Y];++At<J;){var Rt=K[At],Mt=Rt.iteratee,ar=Rt.type,Ne=Mt(vt);if(ar==N)vt=Ne;else if(!Ne){if(ar==H)continue t;break t}}xt[nt++]=vt}return xt}Pt.prototype=os(Ya.prototype),Pt.prototype.constructor=Pt;function _n(s){var u=-1,g=s==null?0:s.length;for(this.clear();++u<g;){var v=s[u];this.set(v[0],v[1])}}function Gv(){this.__data__=lo?lo(null):{},this.size=0}function Hv(s){var u=this.has(s)&&delete this.__data__[s];return this.size-=u?1:0,u}function Vv(s){var u=this.__data__;if(lo){var g=u[s];return g===a?e:g}return Gt.call(u,s)?u[s]:e}function Wv(s){var u=this.__data__;return lo?u[s]!==e:Gt.call(u,s)}function Xv(s,u){var g=this.__data__;return this.size+=this.has(s)?0:1,g[s]=lo&&u===e?a:u,this}_n.prototype.clear=Gv,_n.prototype.delete=Hv,_n.prototype.get=Vv,_n.prototype.has=Wv,_n.prototype.set=Xv;function li(s){var u=-1,g=s==null?0:s.length;for(this.clear();++u<g;){var v=s[u];this.set(v[0],v[1])}}function zv(){this.__data__=[],this.size=0}function $v(s){var u=this.__data__,g=ja(u,s);if(g<0)return!1;var v=u.length-1;return g==v?u.pop():Ha.call(u,g,1),--this.size,!0}function Yv(s){var u=this.__data__,g=ja(u,s);return g<0?e:u[g][1]}function jv(s){return ja(this.__data__,s)>-1}function Kv(s,u){var g=this.__data__,v=ja(g,s);return v<0?(++this.size,g.push([s,u])):g[v][1]=u,this}li.prototype.clear=zv,li.prototype.delete=$v,li.prototype.get=Yv,li.prototype.has=jv,li.prototype.set=Kv;function hi(s){var u=-1,g=s==null?0:s.length;for(this.clear();++u<g;){var v=s[u];this.set(v[0],v[1])}}function qv(){this.size=0,this.__data__={hash:new _n,map:new(oo||li),string:new _n}}function Zv(s){var u=ol(this,s).delete(s);return this.size-=u?1:0,u}function Qv(s){return ol(this,s).get(s)}function Jv(s){return ol(this,s).has(s)}function t0(s,u){var g=ol(this,s),v=g.size;return g.set(s,u),this.size+=g.size==v?0:1,this}hi.prototype.clear=qv,hi.prototype.delete=Zv,hi.prototype.get=Qv,hi.prototype.has=Jv,hi.prototype.set=t0;function xn(s){var u=-1,g=s==null?0:s.length;for(this.__data__=new hi;++u<g;)this.add(s[u])}function e0(s){return this.__data__.set(s,a),this}function r0(s){return this.__data__.has(s)}xn.prototype.add=xn.prototype.push=e0,xn.prototype.has=r0;function Br(s){var u=this.__data__=new li(s);this.size=u.size}function i0(){this.__data__=new li,this.size=0}function n0(s){var u=this.__data__,g=u.delete(s);return this.size=u.size,g}function s0(s){return this.__data__.get(s)}function o0(s){return this.__data__.has(s)}function a0(s,u){var g=this.__data__;if(g instanceof li){var v=g.__data__;if(!oo||v.length<r-1)return v.push([s,u]),this.size=++g.size,this;g=this.__data__=new hi(v)}return g.set(s,u),this.size=g.size,this}Br.prototype.clear=i0,Br.prototype.delete=n0,Br.prototype.get=s0,Br.prototype.has=o0,Br.prototype.set=a0;function Sd(s,u){var g=St(s),v=!g&&En(s),E=!g&&!v&&Xi(s),R=!g&&!v&&!E&&us(s),D=g||v||E||R,O=D?Kh(s.length,_v):[],k=O.length;for(var Y in s)(u||Gt.call(s,Y))&&!(D&&(Y=="length"||E&&(Y=="offset"||Y=="parent")||R&&(Y=="buffer"||Y=="byteLength"||Y=="byteOffset")||di(Y,k)))&&O.push(Y);return O}function bd(s){var u=s.length;return u?s[fu(0,u-1)]:e}function l0(s,u){return al(Ye(s),vn(u,0,s.length))}function h0(s){return al(Ye(s))}function ru(s,u,g){(g!==e&&!Dr(s[u],g)||g===e&&!(u in s))&&ui(s,u,g)}function uo(s,u,g){var v=s[u];(!(Gt.call(s,u)&&Dr(v,g))||g===e&&!(u in s))&&ui(s,u,g)}function ja(s,u){for(var g=s.length;g--;)if(Dr(s[g][0],u))return g;return-1}function u0(s,u,g,v){return Gi(s,function(E,R,D){u(v,E,g(E),D)}),v}function Ad(s,u){return s&&Zr(u,ve(u),s)}function c0(s,u){return s&&Zr(u,Ke(u),s)}function ui(s,u,g){u=="__proto__"&&Va?Va(s,u,{configurable:!0,enumerable:!0,value:g,writable:!0}):s[u]=g}function iu(s,u){for(var g=-1,v=u.length,E=V(v),R=s==null;++g<v;)E[g]=R?e:Nu(s,u[g]);return E}function vn(s,u,g){return s===s&&(g!==e&&(s=s<=g?s:g),u!==e&&(s=s>=u?s:u)),s}function Tr(s,u,g,v,E,R){var D,O=u&p,k=u&l,Y=u&h;if(g&&(D=E?g(s,v,E,R):g(s)),D!==e)return D;if(!Jt(s))return s;var K=St(s);if(K){if(D=J0(s),!O)return Ye(s,D)}else{var J=Re(s),nt=J==Vt||J==jt;if(Xi(s))return qd(s,O);if(J==Ce||J==Ct||nt&&!E){if(D=k||nt?{}:mp(s),!O)return k?V0(s,c0(D,s)):H0(s,Ad(D,s))}else{if(!Yt[J])return E?s:{};D=ty(s,J,O)}}R||(R=new Br);var ht=R.get(s);if(ht)return ht;R.set(s,D),Xp(s)?s.forEach(function(vt){D.add(Tr(vt,u,g,vt,s,R))}):Vp(s)&&s.forEach(function(vt,Rt){D.set(Rt,Tr(vt,u,g,Rt,s,R))});var xt=Y?k?Eu:wu:k?Ke:ve,At=K?e:xt(s);return xr(At||s,function(vt,Rt){At&&(Rt=vt,vt=s[Rt]),uo(D,Rt,Tr(vt,u,g,Rt,s,R))}),D}function f0(s){var u=ve(s);return function(g){return Cd(g,s,u)}}function Cd(s,u,g){var v=g.length;if(s==null)return!v;for(s=Xt(s);v--;){var E=g[v],R=u[E],D=s[E];if(D===e&&!(E in s)||!R(D))return!1}return!0}function Id(s,u,g){if(typeof s!="function")throw new vr(n);return xo(function(){s.apply(e,g)},u)}function co(s,u,g,v){var E=-1,R=Ma,D=!0,O=s.length,k=[],Y=u.length;if(!O)return k;g&&(u=Zt(u,nr(g))),v?(R=Wh,D=!1):u.length>=r&&(R=no,D=!1,u=new xn(u));t:for(;++E<O;){var K=s[E],J=g==null?K:g(K);if(K=v||K!==0?K:0,D&&J===J){for(var nt=Y;nt--;)if(u[nt]===J)continue t;k.push(K)}else R(u,J,v)||k.push(K)}return k}var Gi=ep(qr),Rd=ep(su,!0);function d0(s,u){var g=!0;return Gi(s,function(v,E,R){return g=!!u(v,E,R),g}),g}function Ka(s,u,g){for(var v=-1,E=s.length;++v<E;){var R=s[v],D=u(R);if(D!=null&&(O===e?D===D&&!or(D):g(D,O)))var O=D,k=R}return k}function p0(s,u,g,v){var E=s.length;for(g=bt(g),g<0&&(g=-g>E?0:E+g),v=v===e||v>E?E:bt(v),v<0&&(v+=E),v=g>v?0:$p(v);g<v;)s[g++]=u;return s}function Pd(s,u){var g=[];return Gi(s,function(v,E,R){u(v,E,R)&&g.push(v)}),g}function Ee(s,u,g,v,E){var R=-1,D=s.length;for(g||(g=ry),E||(E=[]);++R<D;){var O=s[R];u>0&&g(O)?u>1?Ee(O,u-1,g,v,E):Oi(E,O):v||(E[E.length]=O)}return E}var nu=rp(),Md=rp(!0);function qr(s,u){return s&&nu(s,u,ve)}function su(s,u){return s&&Md(s,u,ve)}function qa(s,u){return Fi(u,function(g){return pi(s[g])})}function yn(s,u){u=Vi(u,s);for(var g=0,v=u.length;s!=null&&g<v;)s=s[Qr(u[g++])];return g&&g==v?s:e}function Bd(s,u,g){var v=u(s);return St(s)?v:Oi(v,g(s))}function Fe(s){return s==null?s===e?Sh:Yr:gn&&gn in Xt(s)?q0(s):hy(s)}function ou(s,u){return s>u}function m0(s,u){return s!=null&&Gt.call(s,u)}function g0(s,u){return s!=null&&u in Xt(s)}function _0(s,u,g){return s>=Ie(u,g)&&s<fe(u,g)}function au(s,u,g){for(var v=g?Wh:Ma,E=s[0].length,R=s.length,D=R,O=V(R),k=1/0,Y=[];D--;){var K=s[D];D&&u&&(K=Zt(K,nr(u))),k=Ie(K.length,k),O[D]=!g&&(u||E>=120&&K.length>=120)?new xn(D&&K):e}K=s[0];var J=-1,nt=O[0];t:for(;++J<E&&Y.length<k;){var ht=K[J],xt=u?u(ht):ht;if(ht=g||ht!==0?ht:0,!(nt?no(nt,xt):v(Y,xt,g))){for(D=R;--D;){var At=O[D];if(!(At?no(At,xt):v(s[D],xt,g)))continue t}nt&&nt.push(xt),Y.push(ht)}}return Y}function x0(s,u,g,v){return qr(s,function(E,R,D){u(v,g(E),R,D)}),v}function fo(s,u,g){u=Vi(u,s),s=vp(s,u);var v=s==null?s:s[Qr(Er(u))];return v==null?e:ir(v,s,g)}function Dd(s){return re(s)&&Fe(s)==Ct}function v0(s){return re(s)&&Fe(s)==io}function y0(s){return re(s)&&Fe(s)==Qt}function po(s,u,g,v,E){return s===u?!0:s==null||u==null||!re(s)&&!re(u)?s!==s&&u!==u:T0(s,u,g,v,po,E)}function T0(s,u,g,v,E,R){var D=St(s),O=St(u),k=D?yt:Re(s),Y=O?yt:Re(u);k=k==Ct?Ce:k,Y=Y==Ct?Ce:Y;var K=k==Ce,J=Y==Ce,nt=k==Y;if(nt&&Xi(s)){if(!Xi(u))return!1;D=!0,K=!1}if(nt&&!K)return R||(R=new Br),D||us(s)?fp(s,u,g,v,E,R):j0(s,u,k,g,v,E,R);if(!(g&d)){var ht=K&&Gt.call(s,"__wrapped__"),xt=J&&Gt.call(u,"__wrapped__");if(ht||xt){var At=ht?s.value():s,vt=xt?u.value():u;return R||(R=new Br),E(At,vt,g,v,R)}}return nt?(R||(R=new Br),K0(s,u,g,v,E,R)):!1}function w0(s){return re(s)&&Re(s)==Dt}function lu(s,u,g,v){var E=g.length,R=E,D=!v;if(s==null)return!R;for(s=Xt(s);E--;){var O=g[E];if(D&&O[2]?O[1]!==s[O[0]]:!(O[0]in s))return!1}for(;++E<R;){O=g[E];var k=O[0],Y=s[k],K=O[1];if(D&&O[2]){if(Y===e&&!(k in s))return!1}else{var J=new Br;if(v)var nt=v(Y,K,k,s,u,J);if(!(nt===e?po(K,Y,d|m,v,J):nt))return!1}}return!0}function Ld(s){if(!Jt(s)||ny(s))return!1;var u=pi(s)?wv:fx;return u.test(wn(s))}function E0(s){return re(s)&&Fe(s)==rr}function S0(s){return re(s)&&Re(s)==$e}function b0(s){return re(s)&&dl(s.length)&&!!Kt[Fe(s)]}function Fd(s){return typeof s=="function"?s:s==null?qe:typeof s=="object"?St(s)?Ud(s[0],s[1]):Nd(s):im(s)}function hu(s){if(!_o(s))return Iv(s);var u=[];for(var g in Xt(s))Gt.call(s,g)&&g!="constructor"&&u.push(g);return u}function A0(s){if(!Jt(s))return ly(s);var u=_o(s),g=[];for(var v in s)v=="constructor"&&(u||!Gt.call(s,v))||g.push(v);return g}function uu(s,u){return s<u}function Od(s,u){var g=-1,v=je(s)?V(s.length):[];return Gi(s,function(E,R,D){v[++g]=u(E,R,D)}),v}function Nd(s){var u=bu(s);return u.length==1&&u[0][2]?_p(u[0][0],u[0][1]):function(g){return g===s||lu(g,s,u)}}function Ud(s,u){return Cu(s)&&gp(u)?_p(Qr(s),u):function(g){var v=Nu(g,s);return v===e&&v===u?Uu(g,s):po(u,v,d|m)}}function Za(s,u,g,v,E){s!==u&&nu(u,function(R,D){if(E||(E=new Br),Jt(R))C0(s,u,D,g,Za,v,E);else{var O=v?v(Ru(s,D),R,D+"",s,u,E):e;O===e&&(O=R),ru(s,D,O)}},Ke)}function C0(s,u,g,v,E,R,D){var O=Ru(s,g),k=Ru(u,g),Y=D.get(k);if(Y){ru(s,g,Y);return}var K=R?R(O,k,g+"",s,u,D):e,J=K===e;if(J){var nt=St(k),ht=!nt&&Xi(k),xt=!nt&&!ht&&us(k);K=k,nt||ht||xt?St(O)?K=O:se(O)?K=Ye(O):ht?(J=!1,K=qd(k,!0)):xt?(J=!1,K=Zd(k,!0)):K=[]:vo(k)||En(k)?(K=O,En(O)?K=Yp(O):(!Jt(O)||pi(O))&&(K=mp(k))):J=!1}J&&(D.set(k,K),E(K,k,v,R,D),D.delete(k)),ru(s,g,K)}function kd(s,u){var g=s.length;if(g)return u+=u<0?g:0,di(u,g)?s[u]:e}function Gd(s,u,g){u.length?u=Zt(u,function(R){return St(R)?function(D){return yn(D,R.length===1?R[0]:R)}:R}):u=[qe];var v=-1;u=Zt(u,nr(mt()));var E=Od(s,function(R,D,O){var k=Zt(u,function(Y){return Y(R)});return{criteria:k,index:++v,value:R}});return tv(E,function(R,D){return G0(R,D,g)})}function I0(s,u){return Hd(s,u,function(g,v){return Uu(s,v)})}function Hd(s,u,g){for(var v=-1,E=u.length,R={};++v<E;){var D=u[v],O=yn(s,D);g(O,D)&&mo(R,Vi(D,s),O)}return R}function R0(s){return function(u){return yn(u,s)}}function cu(s,u,g,v){var E=v?Jx:ts,R=-1,D=u.length,O=s;for(s===u&&(u=Ye(u)),g&&(O=Zt(s,nr(g)));++R<D;)for(var k=0,Y=u[R],K=g?g(Y):Y;(k=E(O,K,k,v))>-1;)O!==s&&Ha.call(O,k,1),Ha.call(s,k,1);return s}function Vd(s,u){for(var g=s?u.length:0,v=g-1;g--;){var E=u[g];if(g==v||E!==R){var R=E;di(E)?Ha.call(s,E,1):mu(s,E)}}return s}function fu(s,u){return s+Xa(wd()*(u-s+1))}function P0(s,u,g,v){for(var E=-1,R=fe(Wa((u-s)/(g||1)),0),D=V(R);R--;)D[v?R:++E]=s,s+=g;return D}function du(s,u){var g="";if(!s||u<1||u>j)return g;do u%2&&(g+=s),u=Xa(u/2),u&&(s+=s);while(u);return g}function It(s,u){return Pu(xp(s,u,qe),s+"")}function M0(s){return bd(cs(s))}function B0(s,u){var g=cs(s);return al(g,vn(u,0,g.length))}function mo(s,u,g,v){if(!Jt(s))return s;u=Vi(u,s);for(var E=-1,R=u.length,D=R-1,O=s;O!=null&&++E<R;){var k=Qr(u[E]),Y=g;if(k==="__proto__"||k==="constructor"||k==="prototype")return s;if(E!=D){var K=O[k];Y=v?v(K,k,O):e,Y===e&&(Y=Jt(K)?K:di(u[E+1])?[]:{})}uo(O,k,Y),O=O[k]}return s}var Wd=za?function(s,u){return za.set(s,u),s}:qe,D0=Va?function(s,u){return Va(s,"toString",{configurable:!0,enumerable:!1,value:Gu(u),writable:!0})}:qe;function L0(s){return al(cs(s))}function wr(s,u,g){var v=-1,E=s.length;u<0&&(u=-u>E?0:E+u),g=g>E?E:g,g<0&&(g+=E),E=u>g?0:g-u>>>0,u>>>=0;for(var R=V(E);++v<E;)R[v]=s[v+u];return R}function F0(s,u){var g;return Gi(s,function(v,E,R){return g=u(v,E,R),!g}),!!g}function Qa(s,u,g){var v=0,E=s==null?v:s.length;if(typeof u=="number"&&u===u&&E<=_t){for(;v<E;){var R=v+E>>>1,D=s[R];D!==null&&!or(D)&&(g?D<=u:D<u)?v=R+1:E=R}return E}return pu(s,u,qe,g)}function pu(s,u,g,v){var E=0,R=s==null?0:s.length;if(R===0)return 0;u=g(u);for(var D=u!==u,O=u===null,k=or(u),Y=u===e;E<R;){var K=Xa((E+R)/2),J=g(s[K]),nt=J!==e,ht=J===null,xt=J===J,At=or(J);if(D)var vt=v||xt;else Y?vt=xt&&(v||nt):O?vt=xt&&nt&&(v||!ht):k?vt=xt&&nt&&!ht&&(v||!At):ht||At?vt=!1:vt=v?J<=u:J<u;vt?E=K+1:R=K}return Ie(R,st)}function Xd(s,u){for(var g=-1,v=s.length,E=0,R=[];++g<v;){var D=s[g],O=u?u(D):D;if(!g||!Dr(O,k)){var k=O;R[E++]=D===0?0:D}}return R}function zd(s){return typeof s=="number"?s:or(s)?$:+s}function sr(s){if(typeof s=="string")return s;if(St(s))return Zt(s,sr)+"";if(or(s))return Ed?Ed.call(s):"";var u=s+"";return u=="0"&&1/s==-q?"-0":u}function Hi(s,u,g){var v=-1,E=Ma,R=s.length,D=!0,O=[],k=O;if(g)D=!1,E=Wh;else if(R>=r){var Y=u?null:$0(s);if(Y)return Da(Y);D=!1,E=no,k=new xn}else k=u?[]:O;t:for(;++v<R;){var K=s[v],J=u?u(K):K;if(K=g||K!==0?K:0,D&&J===J){for(var nt=k.length;nt--;)if(k[nt]===J)continue t;u&&k.push(J),O.push(K)}else E(k,J,g)||(k!==O&&k.push(J),O.push(K))}return O}function mu(s,u){return u=Vi(u,s),s=vp(s,u),s==null||delete s[Qr(Er(u))]}function $d(s,u,g,v){return mo(s,u,g(yn(s,u)),v)}function Ja(s,u,g,v){for(var E=s.length,R=v?E:-1;(v?R--:++R<E)&&u(s[R],R,s););return g?wr(s,v?0:R,v?R+1:E):wr(s,v?R+1:0,v?E:R)}function Yd(s,u){var g=s;return g instanceof Pt&&(g=g.value()),Xh(u,function(v,E){return E.func.apply(E.thisArg,Oi([v],E.args))},g)}function gu(s,u,g){var v=s.length;if(v<2)return v?Hi(s[0]):[];for(var E=-1,R=V(v);++E<v;)for(var D=s[E],O=-1;++O<v;)O!=E&&(R[E]=co(R[E]||D,s[O],u,g));return Hi(Ee(R,1),u,g)}function jd(s,u,g){for(var v=-1,E=s.length,R=u.length,D={};++v<E;){var O=v<R?u[v]:e;g(D,s[v],O)}return D}function _u(s){return se(s)?s:[]}function xu(s){return typeof s=="function"?s:qe}function Vi(s,u){return St(s)?s:Cu(s,u)?[s]:Ep(Ut(s))}var O0=It;function Wi(s,u,g){var v=s.length;return g=g===e?v:g,!u&&g>=v?s:wr(s,u,g)}var Kd=Ev||function(s){return xe.clearTimeout(s)};function qd(s,u){if(u)return s.slice();var g=s.length,v=_d?_d(g):new s.constructor(g);return s.copy(v),v}function vu(s){var u=new s.constructor(s.byteLength);return new ka(u).set(new ka(s)),u}function N0(s,u){var g=u?vu(s.buffer):s.buffer;return new s.constructor(g,s.byteOffset,s.byteLength)}function U0(s){var u=new s.constructor(s.source,Df.exec(s));return u.lastIndex=s.lastIndex,u}function k0(s){return ho?Xt(ho.call(s)):{}}function Zd(s,u){var g=u?vu(s.buffer):s.buffer;return new s.constructor(g,s.byteOffset,s.length)}function Qd(s,u){if(s!==u){var g=s!==e,v=s===null,E=s===s,R=or(s),D=u!==e,O=u===null,k=u===u,Y=or(u);if(!O&&!Y&&!R&&s>u||R&&D&&k&&!O&&!Y||v&&D&&k||!g&&k||!E)return 1;if(!v&&!R&&!Y&&s<u||Y&&g&&E&&!v&&!R||O&&g&&E||!D&&E||!k)return-1}return 0}function G0(s,u,g){for(var v=-1,E=s.criteria,R=u.criteria,D=E.length,O=g.length;++v<D;){var k=Qd(E[v],R[v]);if(k){if(v>=O)return k;var Y=g[v];return k*(Y=="desc"?-1:1)}}return s.index-u.index}function Jd(s,u,g,v){for(var E=-1,R=s.length,D=g.length,O=-1,k=u.length,Y=fe(R-D,0),K=V(k+Y),J=!v;++O<k;)K[O]=u[O];for(;++E<D;)(J||E<R)&&(K[g[E]]=s[E]);for(;Y--;)K[O++]=s[E++];return K}function tp(s,u,g,v){for(var E=-1,R=s.length,D=-1,O=g.length,k=-1,Y=u.length,K=fe(R-O,0),J=V(K+Y),nt=!v;++E<K;)J[E]=s[E];for(var ht=E;++k<Y;)J[ht+k]=u[k];for(;++D<O;)(nt||E<R)&&(J[ht+g[D]]=s[E++]);return J}function Ye(s,u){var g=-1,v=s.length;for(u||(u=V(v));++g<v;)u[g]=s[g];return u}function Zr(s,u,g,v){var E=!g;g||(g={});for(var R=-1,D=u.length;++R<D;){var O=u[R],k=v?v(g[O],s[O],O,g,s):e;k===e&&(k=s[O]),E?ui(g,O,k):uo(g,O,k)}return g}function H0(s,u){return Zr(s,Au(s),u)}function V0(s,u){return Zr(s,dp(s),u)}function tl(s,u){return function(g,v){var E=St(g)?Yx:u0,R=u?u():{};return E(g,s,mt(v,2),R)}}function as(s){return It(function(u,g){var v=-1,E=g.length,R=E>1?g[E-1]:e,D=E>2?g[2]:e;for(R=s.length>3&&typeof R=="function"?(E--,R):e,D&&Oe(g[0],g[1],D)&&(R=E<3?e:R,E=1),u=Xt(u);++v<E;){var O=g[v];O&&s(u,O,v,R)}return u})}function ep(s,u){return function(g,v){if(g==null)return g;if(!je(g))return s(g,v);for(var E=g.length,R=u?E:-1,D=Xt(g);(u?R--:++R<E)&&v(D[R],R,D)!==!1;);return g}}function rp(s){return function(u,g,v){for(var E=-1,R=Xt(u),D=v(u),O=D.length;O--;){var k=D[s?O:++E];if(g(R[k],k,R)===!1)break}return u}}function W0(s,u,g){var v=u&_,E=go(s);function R(){var D=this&&this!==xe&&this instanceof R?E:s;return D.apply(v?g:this,arguments)}return R}function ip(s){return function(u){u=Ut(u);var g=es(u)?Mr(u):e,v=g?g[0]:u.charAt(0),E=g?Wi(g,1).join(""):u.slice(1);return v[s]()+E}}function ls(s){return function(u){return Xh(em(tm(u).replace(Dx,"")),s,"")}}function go(s){return function(){var u=arguments;switch(u.length){case 0:return new s;case 1:return new s(u[0]);case 2:return new s(u[0],u[1]);case 3:return new s(u[0],u[1],u[2]);case 4:return new s(u[0],u[1],u[2],u[3]);case 5:return new s(u[0],u[1],u[2],u[3],u[4]);case 6:return new s(u[0],u[1],u[2],u[3],u[4],u[5]);case 7:return new s(u[0],u[1],u[2],u[3],u[4],u[5],u[6])}var g=os(s.prototype),v=s.apply(g,u);return Jt(v)?v:g}}function X0(s,u,g){var v=go(s);function E(){for(var R=arguments.length,D=V(R),O=R,k=hs(E);O--;)D[O]=arguments[O];var Y=R<3&&D[0]!==k&&D[R-1]!==k?[]:Ni(D,k);if(R-=Y.length,R<g)return lp(s,u,el,E.placeholder,e,D,Y,e,e,g-R);var K=this&&this!==xe&&this instanceof E?v:s;return ir(K,this,D)}return E}function np(s){return function(u,g,v){var E=Xt(u);if(!je(u)){var R=mt(g,3);u=ve(u),g=function(O){return R(E[O],O,E)}}var D=s(u,g,v);return D>-1?E[R?u[D]:D]:e}}function sp(s){return fi(function(u){var g=u.length,v=g,E=yr.prototype.thru;for(s&&u.reverse();v--;){var R=u[v];if(typeof R!="function")throw new vr(n);if(E&&!D&&sl(R)=="wrapper")var D=new yr([],!0)}for(v=D?v:g;++v<g;){R=u[v];var O=sl(R),k=O=="wrapper"?Su(R):e;k&&Iu(k[0])&&k[1]==(I|S|y|C)&&!k[4].length&&k[9]==1?D=D[sl(k[0])].apply(D,k[3]):D=R.length==1&&Iu(R)?D[O]():D.thru(R)}return function(){var Y=arguments,K=Y[0];if(D&&Y.length==1&&St(K))return D.plant(K).value();for(var J=0,nt=g?u[J].apply(this,Y):K;++J<g;)nt=u[J].call(this,nt);return nt}})}function el(s,u,g,v,E,R,D,O,k,Y){var K=u&I,J=u&_,nt=u&x,ht=u&(S|b),xt=u&P,At=nt?e:go(s);function vt(){for(var Rt=arguments.length,Mt=V(Rt),ar=Rt;ar--;)Mt[ar]=arguments[ar];if(ht)var Ne=hs(vt),lr=rv(Mt,Ne);if(v&&(Mt=Jd(Mt,v,E,ht)),R&&(Mt=tp(Mt,R,D,ht)),Rt-=lr,ht&&Rt<Y){var oe=Ni(Mt,Ne);return lp(s,u,el,vt.placeholder,g,Mt,oe,O,k,Y-Rt)}var Lr=J?g:this,gi=nt?Lr[s]:s;return Rt=Mt.length,O?Mt=uy(Mt,O):xt&&Rt>1&&Mt.reverse(),K&&k<Rt&&(Mt.length=k),this&&this!==xe&&this instanceof vt&&(gi=At||go(gi)),gi.apply(Lr,Mt)}return vt}function op(s,u){return function(g,v){return x0(g,s,u(v),{})}}function rl(s,u){return function(g,v){var E;if(g===e&&v===e)return u;if(g!==e&&(E=g),v!==e){if(E===e)return v;typeof g=="string"||typeof v=="string"?(g=sr(g),v=sr(v)):(g=zd(g),v=zd(v)),E=s(g,v)}return E}}function yu(s){return fi(function(u){return u=Zt(u,nr(mt())),It(function(g){var v=this;return s(u,function(E){return ir(E,v,g)})})})}function il(s,u){u=u===e?" ":sr(u);var g=u.length;if(g<2)return g?du(u,s):u;var v=du(u,Wa(s/rs(u)));return es(u)?Wi(Mr(v),0,s).join(""):v.slice(0,s)}function z0(s,u,g,v){var E=u&_,R=go(s);function D(){for(var O=-1,k=arguments.length,Y=-1,K=v.length,J=V(K+k),nt=this&&this!==xe&&this instanceof D?R:s;++Y<K;)J[Y]=v[Y];for(;k--;)J[Y++]=arguments[++O];return ir(nt,E?g:this,J)}return D}function ap(s){return function(u,g,v){return v&&typeof v!="number"&&Oe(u,g,v)&&(g=v=e),u=mi(u),g===e?(g=u,u=0):g=mi(g),v=v===e?u<g?1:-1:mi(v),P0(u,g,v,s)}}function nl(s){return function(u,g){return typeof u=="string"&&typeof g=="string"||(u=Sr(u),g=Sr(g)),s(u,g)}}function lp(s,u,g,v,E,R,D,O,k,Y){var K=u&S,J=K?D:e,nt=K?e:D,ht=K?R:e,xt=K?e:R;u|=K?y:w,u&=~(K?w:y),u&T||(u&=~(_|x));var At=[s,u,E,ht,J,xt,nt,O,k,Y],vt=g.apply(e,At);return Iu(s)&&yp(vt,At),vt.placeholder=v,Tp(vt,s,u)}function Tu(s){var u=ce[s];return function(g,v){if(g=Sr(g),v=v==null?0:Ie(bt(v),292),v&&Td(g)){var E=(Ut(g)+"e").split("e"),R=u(E[0]+"e"+(+E[1]+v));return E=(Ut(R)+"e").split("e"),+(E[0]+"e"+(+E[1]-v))}return u(g)}}var $0=ns&&1/Da(new ns([,-0]))[1]==q?function(s){return new ns(s)}:Wu;function hp(s){return function(u){var g=Re(u);return g==Dt?Zh(u):g==$e?hv(u):ev(u,s(u))}}function ci(s,u,g,v,E,R,D,O){var k=u&x;if(!k&&typeof s!="function")throw new vr(n);var Y=v?v.length:0;if(Y||(u&=~(y|w),v=E=e),D=D===e?D:fe(bt(D),0),O=O===e?O:bt(O),Y-=E?E.length:0,u&w){var K=v,J=E;v=E=e}var nt=k?e:Su(s),ht=[s,u,g,v,E,K,J,R,D,O];if(nt&&ay(ht,nt),s=ht[0],u=ht[1],g=ht[2],v=ht[3],E=ht[4],O=ht[9]=ht[9]===e?k?0:s.length:fe(ht[9]-Y,0),!O&&u&(S|b)&&(u&=~(S|b)),!u||u==_)var xt=W0(s,u,g);else u==S||u==b?xt=X0(s,u,O):(u==y||u==(_|y))&&!E.length?xt=z0(s,u,g,v):xt=el.apply(e,ht);var At=nt?Wd:yp;return Tp(At(xt,ht),s,u)}function up(s,u,g,v){return s===e||Dr(s,is[g])&&!Gt.call(v,g)?u:s}function cp(s,u,g,v,E,R){return Jt(s)&&Jt(u)&&(R.set(u,s),Za(s,u,e,cp,R),R.delete(u)),s}function Y0(s){return vo(s)?e:s}function fp(s,u,g,v,E,R){var D=g&d,O=s.length,k=u.length;if(O!=k&&!(D&&k>O))return!1;var Y=R.get(s),K=R.get(u);if(Y&&K)return Y==u&&K==s;var J=-1,nt=!0,ht=g&m?new xn:e;for(R.set(s,u),R.set(u,s);++J<O;){var xt=s[J],At=u[J];if(v)var vt=D?v(At,xt,J,u,s,R):v(xt,At,J,s,u,R);if(vt!==e){if(vt)continue;nt=!1;break}if(ht){if(!zh(u,function(Rt,Mt){if(!no(ht,Mt)&&(xt===Rt||E(xt,Rt,g,v,R)))return ht.push(Mt)})){nt=!1;break}}else if(!(xt===At||E(xt,At,g,v,R))){nt=!1;break}}return R.delete(s),R.delete(u),nt}function j0(s,u,g,v,E,R,D){switch(g){case Qn:if(s.byteLength!=u.byteLength||s.byteOffset!=u.byteOffset)return!1;s=s.buffer,u=u.buffer;case io:return!(s.byteLength!=u.byteLength||!R(new ka(s),new ka(u)));case Bt:case Qt:case Ot:return Dr(+s,+u);case $t:return s.name==u.name&&s.message==u.message;case rr:case jr:return s==u+"";case Dt:var O=Zh;case $e:var k=v&d;if(O||(O=Da),s.size!=u.size&&!k)return!1;var Y=D.get(s);if(Y)return Y==u;v|=m,D.set(s,u);var K=fp(O(s),O(u),v,E,R,D);return D.delete(s),K;case qn:if(ho)return ho.call(s)==ho.call(u)}return!1}function K0(s,u,g,v,E,R){var D=g&d,O=wu(s),k=O.length,Y=wu(u),K=Y.length;if(k!=K&&!D)return!1;for(var J=k;J--;){var nt=O[J];if(!(D?nt in u:Gt.call(u,nt)))return!1}var ht=R.get(s),xt=R.get(u);if(ht&&xt)return ht==u&&xt==s;var At=!0;R.set(s,u),R.set(u,s);for(var vt=D;++J<k;){nt=O[J];var Rt=s[nt],Mt=u[nt];if(v)var ar=D?v(Mt,Rt,nt,u,s,R):v(Rt,Mt,nt,s,u,R);if(!(ar===e?Rt===Mt||E(Rt,Mt,g,v,R):ar)){At=!1;break}vt||(vt=nt=="constructor")}if(At&&!vt){var Ne=s.constructor,lr=u.constructor;Ne!=lr&&"constructor"in s&&"constructor"in u&&!(typeof Ne=="function"&&Ne instanceof Ne&&typeof lr=="function"&&lr instanceof lr)&&(At=!1)}return R.delete(s),R.delete(u),At}function fi(s){return Pu(xp(s,e,Cp),s+"")}function wu(s){return Bd(s,ve,Au)}function Eu(s){return Bd(s,Ke,dp)}var Su=za?function(s){return za.get(s)}:Wu;function sl(s){for(var u=s.name+"",g=ss[u],v=Gt.call(ss,u)?g.length:0;v--;){var E=g[v],R=E.func;if(R==null||R==s)return E.name}return u}function hs(s){var u=Gt.call(A,"placeholder")?A:s;return u.placeholder}function mt(){var s=A.iteratee||Hu;return s=s===Hu?Fd:s,arguments.length?s(arguments[0],arguments[1]):s}function ol(s,u){var g=s.__data__;return iy(u)?g[typeof u=="string"?"string":"hash"]:g.map}function bu(s){for(var u=ve(s),g=u.length;g--;){var v=u[g],E=s[v];u[g]=[v,E,gp(E)]}return u}function Tn(s,u){var g=ov(s,u);return Ld(g)?g:e}function q0(s){var u=Gt.call(s,gn),g=s[gn];try{s[gn]=e;var v=!0}catch{}var E=Na.call(s);return v&&(u?s[gn]=g:delete s[gn]),E}var Au=Jh?function(s){return s==null?[]:(s=Xt(s),Fi(Jh(s),function(u){return vd.call(s,u)}))}:Xu,dp=Jh?function(s){for(var u=[];s;)Oi(u,Au(s)),s=Ga(s);return u}:Xu,Re=Fe;(tu&&Re(new tu(new ArrayBuffer(1)))!=Qn||oo&&Re(new oo)!=Dt||eu&&Re(eu.resolve())!=pn||ns&&Re(new ns)!=$e||ao&&Re(new ao)!=Kr)&&(Re=function(s){var u=Fe(s),g=u==Ce?s.constructor:e,v=g?wn(g):"";if(v)switch(v){case Bv:return Qn;case Dv:return Dt;case Lv:return pn;case Fv:return $e;case Ov:return Kr}return u});function Z0(s,u,g){for(var v=-1,E=g.length;++v<E;){var R=g[v],D=R.size;switch(R.type){case"drop":s+=D;break;case"dropRight":u-=D;break;case"take":u=Ie(u,s+D);break;case"takeRight":s=fe(s,u-D);break}}return{start:s,end:u}}function Q0(s){var u=s.match(nx);return u?u[1].split(sx):[]}function pp(s,u,g){u=Vi(u,s);for(var v=-1,E=u.length,R=!1;++v<E;){var D=Qr(u[v]);if(!(R=s!=null&&g(s,D)))break;s=s[D]}return R||++v!=E?R:(E=s==null?0:s.length,!!E&&dl(E)&&di(D,E)&&(St(s)||En(s)))}function J0(s){var u=s.length,g=new s.constructor(u);return u&&typeof s[0]=="string"&&Gt.call(s,"index")&&(g.index=s.index,g.input=s.input),g}function mp(s){return typeof s.constructor=="function"&&!_o(s)?os(Ga(s)):{}}function ty(s,u,g){var v=s.constructor;switch(u){case io:return vu(s);case Bt:case Qt:return new v(+s);case Qn:return N0(s,g);case bh:case Ah:case Ch:case Ih:case Rh:case Ph:case Mh:case Bh:case Dh:return Zd(s,g);case Dt:return new v;case Ot:case jr:return new v(s);case rr:return U0(s);case $e:return new v;case qn:return k0(s)}}function ey(s,u){var g=u.length;if(!g)return s;var v=g-1;return u[v]=(g>1?"& ":"")+u[v],u=u.join(g>2?", ":" "),s.replace(ix,`{
/* [wrapped with `+u+`] */
`)}function ry(s){return St(s)||En(s)||!!(yd&&s&&s[yd])}function di(s,u){var g=typeof s;return u=u??j,!!u&&(g=="number"||g!="symbol"&&px.test(s))&&s>-1&&s%1==0&&s<u}function Oe(s,u,g){if(!Jt(g))return!1;var v=typeof u;return(v=="number"?je(g)&&di(u,g.length):v=="string"&&u in g)?Dr(g[u],s):!1}function Cu(s,u){if(St(s))return!1;var g=typeof s;return g=="number"||g=="symbol"||g=="boolean"||s==null||or(s)?!0:J_.test(s)||!Q_.test(s)||u!=null&&s in Xt(u)}function iy(s){var u=typeof s;return u=="string"||u=="number"||u=="symbol"||u=="boolean"?s!=="__proto__":s===null}function Iu(s){var u=sl(s),g=A[u];if(typeof g!="function"||!(u in Pt.prototype))return!1;if(s===g)return!0;var v=Su(g);return!!v&&s===v[0]}function ny(s){return!!gd&&gd in s}var sy=Fa?pi:zu;function _o(s){var u=s&&s.constructor,g=typeof u=="function"&&u.prototype||is;return s===g}function gp(s){return s===s&&!Jt(s)}function _p(s,u){return function(g){return g==null?!1:g[s]===u&&(u!==e||s in Xt(g))}}function oy(s){var u=cl(s,function(v){return g.size===c&&g.clear(),v}),g=u.cache;return u}function ay(s,u){var g=s[1],v=u[1],E=g|v,R=E<(_|x|I),D=v==I&&g==S||v==I&&g==C&&s[7].length<=u[8]||v==(I|C)&&u[7].length<=u[8]&&g==S;if(!(R||D))return s;v&_&&(s[2]=u[2],E|=g&_?0:T);var O=u[3];if(O){var k=s[3];s[3]=k?Jd(k,O,u[4]):O,s[4]=k?Ni(s[3],f):u[4]}return O=u[5],O&&(k=s[5],s[5]=k?tp(k,O,u[6]):O,s[6]=k?Ni(s[5],f):u[6]),O=u[7],O&&(s[7]=O),v&I&&(s[8]=s[8]==null?u[8]:Ie(s[8],u[8])),s[9]==null&&(s[9]=u[9]),s[0]=u[0],s[1]=E,s}function ly(s){var u=[];if(s!=null)for(var g in Xt(s))u.push(g);return u}function hy(s){return Na.call(s)}function xp(s,u,g){return u=fe(u===e?s.length-1:u,0),function(){for(var v=arguments,E=-1,R=fe(v.length-u,0),D=V(R);++E<R;)D[E]=v[u+E];E=-1;for(var O=V(u+1);++E<u;)O[E]=v[E];return O[u]=g(D),ir(s,this,O)}}function vp(s,u){return u.length<2?s:yn(s,wr(u,0,-1))}function uy(s,u){for(var g=s.length,v=Ie(u.length,g),E=Ye(s);v--;){var R=u[v];s[v]=di(R,g)?E[R]:e}return s}function Ru(s,u){if(!(u==="constructor"&&typeof s[u]=="function")&&u!="__proto__")return s[u]}var yp=wp(Wd),xo=bv||function(s,u){return xe.setTimeout(s,u)},Pu=wp(D0);function Tp(s,u,g){var v=u+"";return Pu(s,ey(v,cy(Q0(v),g)))}function wp(s){var u=0,g=0;return function(){var v=Rv(),E=L-(v-g);if(g=v,E>0){if(++u>=F)return arguments[0]}else u=0;return s.apply(e,arguments)}}function al(s,u){var g=-1,v=s.length,E=v-1;for(u=u===e?v:u;++g<u;){var R=fu(g,E),D=s[R];s[R]=s[g],s[g]=D}return s.length=u,s}var Ep=oy(function(s){var u=[];return s.charCodeAt(0)===46&&u.push(""),s.replace(tx,function(g,v,E,R){u.push(E?R.replace(lx,"$1"):v||g)}),u});function Qr(s){if(typeof s=="string"||or(s))return s;var u=s+"";return u=="0"&&1/s==-q?"-0":u}function wn(s){if(s!=null){try{return Oa.call(s)}catch{}try{return s+""}catch{}}return""}function cy(s,u){return xr(Tt,function(g){var v="_."+g[0];u&g[1]&&!Ma(s,v)&&s.push(v)}),s.sort()}function Sp(s){if(s instanceof Pt)return s.clone();var u=new yr(s.__wrapped__,s.__chain__);return u.__actions__=Ye(s.__actions__),u.__index__=s.__index__,u.__values__=s.__values__,u}function fy(s,u,g){(g?Oe(s,u,g):u===e)?u=1:u=fe(bt(u),0);var v=s==null?0:s.length;if(!v||u<1)return[];for(var E=0,R=0,D=V(Wa(v/u));E<v;)D[R++]=wr(s,E,E+=u);return D}function dy(s){for(var u=-1,g=s==null?0:s.length,v=0,E=[];++u<g;){var R=s[u];R&&(E[v++]=R)}return E}function py(){var s=arguments.length;if(!s)return[];for(var u=V(s-1),g=arguments[0],v=s;v--;)u[v-1]=arguments[v];return Oi(St(g)?Ye(g):[g],Ee(u,1))}var my=It(function(s,u){return se(s)?co(s,Ee(u,1,se,!0)):[]}),gy=It(function(s,u){var g=Er(u);return se(g)&&(g=e),se(s)?co(s,Ee(u,1,se,!0),mt(g,2)):[]}),_y=It(function(s,u){var g=Er(u);return se(g)&&(g=e),se(s)?co(s,Ee(u,1,se,!0),e,g):[]});function xy(s,u,g){var v=s==null?0:s.length;return v?(u=g||u===e?1:bt(u),wr(s,u<0?0:u,v)):[]}function vy(s,u,g){var v=s==null?0:s.length;return v?(u=g||u===e?1:bt(u),u=v-u,wr(s,0,u<0?0:u)):[]}function yy(s,u){return s&&s.length?Ja(s,mt(u,3),!0,!0):[]}function Ty(s,u){return s&&s.length?Ja(s,mt(u,3),!0):[]}function wy(s,u,g,v){var E=s==null?0:s.length;return E?(g&&typeof g!="number"&&Oe(s,u,g)&&(g=0,v=E),p0(s,u,g,v)):[]}function bp(s,u,g){var v=s==null?0:s.length;if(!v)return-1;var E=g==null?0:bt(g);return E<0&&(E=fe(v+E,0)),Ba(s,mt(u,3),E)}function Ap(s,u,g){var v=s==null?0:s.length;if(!v)return-1;var E=v-1;return g!==e&&(E=bt(g),E=g<0?fe(v+E,0):Ie(E,v-1)),Ba(s,mt(u,3),E,!0)}function Cp(s){var u=s==null?0:s.length;return u?Ee(s,1):[]}function Ey(s){var u=s==null?0:s.length;return u?Ee(s,q):[]}function Sy(s,u){var g=s==null?0:s.length;return g?(u=u===e?1:bt(u),Ee(s,u)):[]}function by(s){for(var u=-1,g=s==null?0:s.length,v={};++u<g;){var E=s[u];v[E[0]]=E[1]}return v}function Ip(s){return s&&s.length?s[0]:e}function Ay(s,u,g){var v=s==null?0:s.length;if(!v)return-1;var E=g==null?0:bt(g);return E<0&&(E=fe(v+E,0)),ts(s,u,E)}function Cy(s){var u=s==null?0:s.length;return u?wr(s,0,-1):[]}var Iy=It(function(s){var u=Zt(s,_u);return u.length&&u[0]===s[0]?au(u):[]}),Ry=It(function(s){var u=Er(s),g=Zt(s,_u);return u===Er(g)?u=e:g.pop(),g.length&&g[0]===s[0]?au(g,mt(u,2)):[]}),Py=It(function(s){var u=Er(s),g=Zt(s,_u);return u=typeof u=="function"?u:e,u&&g.pop(),g.length&&g[0]===s[0]?au(g,e,u):[]});function My(s,u){return s==null?"":Cv.call(s,u)}function Er(s){var u=s==null?0:s.length;return u?s[u-1]:e}function By(s,u,g){var v=s==null?0:s.length;if(!v)return-1;var E=v;return g!==e&&(E=bt(g),E=E<0?fe(v+E,0):Ie(E,v-1)),u===u?cv(s,u,E):Ba(s,ld,E,!0)}function Dy(s,u){return s&&s.length?kd(s,bt(u)):e}var Ly=It(Rp);function Rp(s,u){return s&&s.length&&u&&u.length?cu(s,u):s}function Fy(s,u,g){return s&&s.length&&u&&u.length?cu(s,u,mt(g,2)):s}function Oy(s,u,g){return s&&s.length&&u&&u.length?cu(s,u,e,g):s}var Ny=fi(function(s,u){var g=s==null?0:s.length,v=iu(s,u);return Vd(s,Zt(u,function(E){return di(E,g)?+E:E}).sort(Qd)),v});function Uy(s,u){var g=[];if(!(s&&s.length))return g;var v=-1,E=[],R=s.length;for(u=mt(u,3);++v<R;){var D=s[v];u(D,v,s)&&(g.push(D),E.push(v))}return Vd(s,E),g}function Mu(s){return s==null?s:Mv.call(s)}function ky(s,u,g){var v=s==null?0:s.length;return v?(g&&typeof g!="number"&&Oe(s,u,g)?(u=0,g=v):(u=u==null?0:bt(u),g=g===e?v:bt(g)),wr(s,u,g)):[]}function Gy(s,u){return Qa(s,u)}function Hy(s,u,g){return pu(s,u,mt(g,2))}function Vy(s,u){var g=s==null?0:s.length;if(g){var v=Qa(s,u);if(v<g&&Dr(s[v],u))return v}return-1}function Wy(s,u){return Qa(s,u,!0)}function Xy(s,u,g){return pu(s,u,mt(g,2),!0)}function zy(s,u){var g=s==null?0:s.length;if(g){var v=Qa(s,u,!0)-1;if(Dr(s[v],u))return v}return-1}function $y(s){return s&&s.length?Xd(s):[]}function Yy(s,u){return s&&s.length?Xd(s,mt(u,2)):[]}function jy(s){var u=s==null?0:s.length;return u?wr(s,1,u):[]}function Ky(s,u,g){return s&&s.length?(u=g||u===e?1:bt(u),wr(s,0,u<0?0:u)):[]}function qy(s,u,g){var v=s==null?0:s.length;return v?(u=g||u===e?1:bt(u),u=v-u,wr(s,u<0?0:u,v)):[]}function Zy(s,u){return s&&s.length?Ja(s,mt(u,3),!1,!0):[]}function Qy(s,u){return s&&s.length?Ja(s,mt(u,3)):[]}var Jy=It(function(s){return Hi(Ee(s,1,se,!0))}),t1=It(function(s){var u=Er(s);return se(u)&&(u=e),Hi(Ee(s,1,se,!0),mt(u,2))}),e1=It(function(s){var u=Er(s);return u=typeof u=="function"?u:e,Hi(Ee(s,1,se,!0),e,u)});function r1(s){return s&&s.length?Hi(s):[]}function i1(s,u){return s&&s.length?Hi(s,mt(u,2)):[]}function n1(s,u){return u=typeof u=="function"?u:e,s&&s.length?Hi(s,e,u):[]}function Bu(s){if(!(s&&s.length))return[];var u=0;return s=Fi(s,function(g){if(se(g))return u=fe(g.length,u),!0}),Kh(u,function(g){return Zt(s,$h(g))})}function Pp(s,u){if(!(s&&s.length))return[];var g=Bu(s);return u==null?g:Zt(g,function(v){return ir(u,e,v)})}var s1=It(function(s,u){return se(s)?co(s,u):[]}),o1=It(function(s){return gu(Fi(s,se))}),a1=It(function(s){var u=Er(s);return se(u)&&(u=e),gu(Fi(s,se),mt(u,2))}),l1=It(function(s){var u=Er(s);return u=typeof u=="function"?u:e,gu(Fi(s,se),e,u)}),h1=It(Bu);function u1(s,u){return jd(s||[],u||[],uo)}function c1(s,u){return jd(s||[],u||[],mo)}var f1=It(function(s){var u=s.length,g=u>1?s[u-1]:e;return g=typeof g=="function"?(s.pop(),g):e,Pp(s,g)});function Mp(s){var u=A(s);return u.__chain__=!0,u}function d1(s,u){return u(s),s}function ll(s,u){return u(s)}var p1=fi(function(s){var u=s.length,g=u?s[0]:0,v=this.__wrapped__,E=function(R){return iu(R,s)};return u>1||this.__actions__.length||!(v instanceof Pt)||!di(g)?this.thru(E):(v=v.slice(g,+g+(u?1:0)),v.__actions__.push({func:ll,args:[E],thisArg:e}),new yr(v,this.__chain__).thru(function(R){return u&&!R.length&&R.push(e),R}))});function m1(){return Mp(this)}function g1(){return new yr(this.value(),this.__chain__)}function _1(){this.__values__===e&&(this.__values__=zp(this.value()));var s=this.__index__>=this.__values__.length,u=s?e:this.__values__[this.__index__++];return{done:s,value:u}}function x1(){return this}function v1(s){for(var u,g=this;g instanceof Ya;){var v=Sp(g);v.__index__=0,v.__values__=e,u?E.__wrapped__=v:u=v;var E=v;g=g.__wrapped__}return E.__wrapped__=s,u}function y1(){var s=this.__wrapped__;if(s instanceof Pt){var u=s;return this.__actions__.length&&(u=new Pt(this)),u=u.reverse(),u.__actions__.push({func:ll,args:[Mu],thisArg:e}),new yr(u,this.__chain__)}return this.thru(Mu)}function T1(){return Yd(this.__wrapped__,this.__actions__)}var w1=tl(function(s,u,g){Gt.call(s,g)?++s[g]:ui(s,g,1)});function E1(s,u,g){var v=St(s)?od:d0;return g&&Oe(s,u,g)&&(u=e),v(s,mt(u,3))}function S1(s,u){var g=St(s)?Fi:Pd;return g(s,mt(u,3))}var b1=np(bp),A1=np(Ap);function C1(s,u){return Ee(hl(s,u),1)}function I1(s,u){return Ee(hl(s,u),q)}function R1(s,u,g){return g=g===e?1:bt(g),Ee(hl(s,u),g)}function Bp(s,u){var g=St(s)?xr:Gi;return g(s,mt(u,3))}function Dp(s,u){var g=St(s)?jx:Rd;return g(s,mt(u,3))}var P1=tl(function(s,u,g){Gt.call(s,g)?s[g].push(u):ui(s,g,[u])});function M1(s,u,g,v){s=je(s)?s:cs(s),g=g&&!v?bt(g):0;var E=s.length;return g<0&&(g=fe(E+g,0)),pl(s)?g<=E&&s.indexOf(u,g)>-1:!!E&&ts(s,u,g)>-1}var B1=It(function(s,u,g){var v=-1,E=typeof u=="function",R=je(s)?V(s.length):[];return Gi(s,function(D){R[++v]=E?ir(u,D,g):fo(D,u,g)}),R}),D1=tl(function(s,u,g){ui(s,g,u)});function hl(s,u){var g=St(s)?Zt:Od;return g(s,mt(u,3))}function L1(s,u,g,v){return s==null?[]:(St(u)||(u=u==null?[]:[u]),g=v?e:g,St(g)||(g=g==null?[]:[g]),Gd(s,u,g))}var F1=tl(function(s,u,g){s[g?0:1].push(u)},function(){return[[],[]]});function O1(s,u,g){var v=St(s)?Xh:ud,E=arguments.length<3;return v(s,mt(u,4),g,E,Gi)}function N1(s,u,g){var v=St(s)?Kx:ud,E=arguments.length<3;return v(s,mt(u,4),g,E,Rd)}function U1(s,u){var g=St(s)?Fi:Pd;return g(s,fl(mt(u,3)))}function k1(s){var u=St(s)?bd:M0;return u(s)}function G1(s,u,g){(g?Oe(s,u,g):u===e)?u=1:u=bt(u);var v=St(s)?l0:B0;return v(s,u)}function H1(s){var u=St(s)?h0:L0;return u(s)}function V1(s){if(s==null)return 0;if(je(s))return pl(s)?rs(s):s.length;var u=Re(s);return u==Dt||u==$e?s.size:hu(s).length}function W1(s,u,g){var v=St(s)?zh:F0;return g&&Oe(s,u,g)&&(u=e),v(s,mt(u,3))}var X1=It(function(s,u){if(s==null)return[];var g=u.length;return g>1&&Oe(s,u[0],u[1])?u=[]:g>2&&Oe(u[0],u[1],u[2])&&(u=[u[0]]),Gd(s,Ee(u,1),[])}),ul=Sv||function(){return xe.Date.now()};function z1(s,u){if(typeof u!="function")throw new vr(n);return s=bt(s),function(){if(--s<1)return u.apply(this,arguments)}}function Lp(s,u,g){return u=g?e:u,u=s&&u==null?s.length:u,ci(s,I,e,e,e,e,u)}function Fp(s,u){var g;if(typeof u!="function")throw new vr(n);return s=bt(s),function(){return--s>0&&(g=u.apply(this,arguments)),s<=1&&(u=e),g}}var Du=It(function(s,u,g){var v=_;if(g.length){var E=Ni(g,hs(Du));v|=y}return ci(s,v,u,g,E)}),Op=It(function(s,u,g){var v=_|x;if(g.length){var E=Ni(g,hs(Op));v|=y}return ci(u,v,s,g,E)});function Np(s,u,g){u=g?e:u;var v=ci(s,S,e,e,e,e,e,u);return v.placeholder=Np.placeholder,v}function Up(s,u,g){u=g?e:u;var v=ci(s,b,e,e,e,e,e,u);return v.placeholder=Up.placeholder,v}function kp(s,u,g){var v,E,R,D,O,k,Y=0,K=!1,J=!1,nt=!0;if(typeof s!="function")throw new vr(n);u=Sr(u)||0,Jt(g)&&(K=!!g.leading,J="maxWait"in g,R=J?fe(Sr(g.maxWait)||0,u):R,nt="trailing"in g?!!g.trailing:nt);function ht(oe){var Lr=v,gi=E;return v=E=e,Y=oe,D=s.apply(gi,Lr),D}function xt(oe){return Y=oe,O=xo(Rt,u),K?ht(oe):D}function At(oe){var Lr=oe-k,gi=oe-Y,nm=u-Lr;return J?Ie(nm,R-gi):nm}function vt(oe){var Lr=oe-k,gi=oe-Y;return k===e||Lr>=u||Lr<0||J&&gi>=R}function Rt(){var oe=ul();if(vt(oe))return Mt(oe);O=xo(Rt,At(oe))}function Mt(oe){return O=e,nt&&v?ht(oe):(v=E=e,D)}function ar(){O!==e&&Kd(O),Y=0,v=k=E=O=e}function Ne(){return O===e?D:Mt(ul())}function lr(){var oe=ul(),Lr=vt(oe);if(v=arguments,E=this,k=oe,Lr){if(O===e)return xt(k);if(J)return Kd(O),O=xo(Rt,u),ht(k)}return O===e&&(O=xo(Rt,u)),D}return lr.cancel=ar,lr.flush=Ne,lr}var $1=It(function(s,u){return Id(s,1,u)}),Y1=It(function(s,u,g){return Id(s,Sr(u)||0,g)});function j1(s){return ci(s,P)}function cl(s,u){if(typeof s!="function"||u!=null&&typeof u!="function")throw new vr(n);var g=function(){var v=arguments,E=u?u.apply(this,v):v[0],R=g.cache;if(R.has(E))return R.get(E);var D=s.apply(this,v);return g.cache=R.set(E,D)||R,D};return g.cache=new(cl.Cache||hi),g}cl.Cache=hi;function fl(s){if(typeof s!="function")throw new vr(n);return function(){var u=arguments;switch(u.length){case 0:return!s.call(this);case 1:return!s.call(this,u[0]);case 2:return!s.call(this,u[0],u[1]);case 3:return!s.call(this,u[0],u[1],u[2])}return!s.apply(this,u)}}function K1(s){return Fp(2,s)}var q1=O0(function(s,u){u=u.length==1&&St(u[0])?Zt(u[0],nr(mt())):Zt(Ee(u,1),nr(mt()));var g=u.length;return It(function(v){for(var E=-1,R=Ie(v.length,g);++E<R;)v[E]=u[E].call(this,v[E]);return ir(s,this,v)})}),Lu=It(function(s,u){var g=Ni(u,hs(Lu));return ci(s,y,e,u,g)}),Gp=It(function(s,u){var g=Ni(u,hs(Gp));return ci(s,w,e,u,g)}),Z1=fi(function(s,u){return ci(s,C,e,e,e,u)});function Q1(s,u){if(typeof s!="function")throw new vr(n);return u=u===e?u:bt(u),It(s,u)}function J1(s,u){if(typeof s!="function")throw new vr(n);return u=u==null?0:fe(bt(u),0),It(function(g){var v=g[u],E=Wi(g,0,u);return v&&Oi(E,v),ir(s,this,E)})}function tT(s,u,g){var v=!0,E=!0;if(typeof s!="function")throw new vr(n);return Jt(g)&&(v="leading"in g?!!g.leading:v,E="trailing"in g?!!g.trailing:E),kp(s,u,{leading:v,maxWait:u,trailing:E})}function eT(s){return Lp(s,1)}function rT(s,u){return Lu(xu(u),s)}function iT(){if(!arguments.length)return[];var s=arguments[0];return St(s)?s:[s]}function nT(s){return Tr(s,h)}function sT(s,u){return u=typeof u=="function"?u:e,Tr(s,h,u)}function oT(s){return Tr(s,p|h)}function aT(s,u){return u=typeof u=="function"?u:e,Tr(s,p|h,u)}function lT(s,u){return u==null||Cd(s,u,ve(u))}function Dr(s,u){return s===u||s!==s&&u!==u}var hT=nl(ou),uT=nl(function(s,u){return s>=u}),En=Dd(function(){return arguments}())?Dd:function(s){return re(s)&&Gt.call(s,"callee")&&!vd.call(s,"callee")},St=V.isArray,cT=td?nr(td):v0;function je(s){return s!=null&&dl(s.length)&&!pi(s)}function se(s){return re(s)&&je(s)}function fT(s){return s===!0||s===!1||re(s)&&Fe(s)==Bt}var Xi=Av||zu,dT=ed?nr(ed):y0;function pT(s){return re(s)&&s.nodeType===1&&!vo(s)}function mT(s){if(s==null)return!0;if(je(s)&&(St(s)||typeof s=="string"||typeof s.splice=="function"||Xi(s)||us(s)||En(s)))return!s.length;var u=Re(s);if(u==Dt||u==$e)return!s.size;if(_o(s))return!hu(s).length;for(var g in s)if(Gt.call(s,g))return!1;return!0}function gT(s,u){return po(s,u)}function _T(s,u,g){g=typeof g=="function"?g:e;var v=g?g(s,u):e;return v===e?po(s,u,e,g):!!v}function Fu(s){if(!re(s))return!1;var u=Fe(s);return u==$t||u==_e||typeof s.message=="string"&&typeof s.name=="string"&&!vo(s)}function xT(s){return typeof s=="number"&&Td(s)}function pi(s){if(!Jt(s))return!1;var u=Fe(s);return u==Vt||u==jt||u==Ht||u==Kn}function Hp(s){return typeof s=="number"&&s==bt(s)}function dl(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=j}function Jt(s){var u=typeof s;return s!=null&&(u=="object"||u=="function")}function re(s){return s!=null&&typeof s=="object"}var Vp=rd?nr(rd):w0;function vT(s,u){return s===u||lu(s,u,bu(u))}function yT(s,u,g){return g=typeof g=="function"?g:e,lu(s,u,bu(u),g)}function TT(s){return Wp(s)&&s!=+s}function wT(s){if(sy(s))throw new wt(i);return Ld(s)}function ET(s){return s===null}function ST(s){return s==null}function Wp(s){return typeof s=="number"||re(s)&&Fe(s)==Ot}function vo(s){if(!re(s)||Fe(s)!=Ce)return!1;var u=Ga(s);if(u===null)return!0;var g=Gt.call(u,"constructor")&&u.constructor;return typeof g=="function"&&g instanceof g&&Oa.call(g)==yv}var Ou=id?nr(id):E0;function bT(s){return Hp(s)&&s>=-j&&s<=j}var Xp=nd?nr(nd):S0;function pl(s){return typeof s=="string"||!St(s)&&re(s)&&Fe(s)==jr}function or(s){return typeof s=="symbol"||re(s)&&Fe(s)==qn}var us=sd?nr(sd):b0;function AT(s){return s===e}function CT(s){return re(s)&&Re(s)==Kr}function IT(s){return re(s)&&Fe(s)==Zn}var RT=nl(uu),PT=nl(function(s,u){return s<=u});function zp(s){if(!s)return[];if(je(s))return pl(s)?Mr(s):Ye(s);if(so&&s[so])return lv(s[so]());var u=Re(s),g=u==Dt?Zh:u==$e?Da:cs;return g(s)}function mi(s){if(!s)return s===0?s:0;if(s=Sr(s),s===q||s===-q){var u=s<0?-1:1;return u*rt}return s===s?s:0}function bt(s){var u=mi(s),g=u%1;return u===u?g?u-g:u:0}function $p(s){return s?vn(bt(s),0,Q):0}function Sr(s){if(typeof s=="number")return s;if(or(s))return $;if(Jt(s)){var u=typeof s.valueOf=="function"?s.valueOf():s;s=Jt(u)?u+"":u}if(typeof s!="string")return s===0?s:+s;s=cd(s);var g=cx.test(s);return g||dx.test(s)?zx(s.slice(2),g?2:8):ux.test(s)?$:+s}function Yp(s){return Zr(s,Ke(s))}function MT(s){return s?vn(bt(s),-j,j):s===0?s:0}function Ut(s){return s==null?"":sr(s)}var BT=as(function(s,u){if(_o(u)||je(u)){Zr(u,ve(u),s);return}for(var g in u)Gt.call(u,g)&&uo(s,g,u[g])}),jp=as(function(s,u){Zr(u,Ke(u),s)}),ml=as(function(s,u,g,v){Zr(u,Ke(u),s,v)}),DT=as(function(s,u,g,v){Zr(u,ve(u),s,v)}),LT=fi(iu);function FT(s,u){var g=os(s);return u==null?g:Ad(g,u)}var OT=It(function(s,u){s=Xt(s);var g=-1,v=u.length,E=v>2?u[2]:e;for(E&&Oe(u[0],u[1],E)&&(v=1);++g<v;)for(var R=u[g],D=Ke(R),O=-1,k=D.length;++O<k;){var Y=D[O],K=s[Y];(K===e||Dr(K,is[Y])&&!Gt.call(s,Y))&&(s[Y]=R[Y])}return s}),NT=It(function(s){return s.push(e,cp),ir(Kp,e,s)});function UT(s,u){return ad(s,mt(u,3),qr)}function kT(s,u){return ad(s,mt(u,3),su)}function GT(s,u){return s==null?s:nu(s,mt(u,3),Ke)}function HT(s,u){return s==null?s:Md(s,mt(u,3),Ke)}function VT(s,u){return s&&qr(s,mt(u,3))}function WT(s,u){return s&&su(s,mt(u,3))}function XT(s){return s==null?[]:qa(s,ve(s))}function zT(s){return s==null?[]:qa(s,Ke(s))}function Nu(s,u,g){var v=s==null?e:yn(s,u);return v===e?g:v}function $T(s,u){return s!=null&&pp(s,u,m0)}function Uu(s,u){return s!=null&&pp(s,u,g0)}var YT=op(function(s,u,g){u!=null&&typeof u.toString!="function"&&(u=Na.call(u)),s[u]=g},Gu(qe)),jT=op(function(s,u,g){u!=null&&typeof u.toString!="function"&&(u=Na.call(u)),Gt.call(s,u)?s[u].push(g):s[u]=[g]},mt),KT=It(fo);function ve(s){return je(s)?Sd(s):hu(s)}function Ke(s){return je(s)?Sd(s,!0):A0(s)}function qT(s,u){var g={};return u=mt(u,3),qr(s,function(v,E,R){ui(g,u(v,E,R),v)}),g}function ZT(s,u){var g={};return u=mt(u,3),qr(s,function(v,E,R){ui(g,E,u(v,E,R))}),g}var QT=as(function(s,u,g){Za(s,u,g)}),Kp=as(function(s,u,g,v){Za(s,u,g,v)}),JT=fi(function(s,u){var g={};if(s==null)return g;var v=!1;u=Zt(u,function(R){return R=Vi(R,s),v||(v=R.length>1),R}),Zr(s,Eu(s),g),v&&(g=Tr(g,p|l|h,Y0));for(var E=u.length;E--;)mu(g,u[E]);return g});function tw(s,u){return qp(s,fl(mt(u)))}var ew=fi(function(s,u){return s==null?{}:I0(s,u)});function qp(s,u){if(s==null)return{};var g=Zt(Eu(s),function(v){return[v]});return u=mt(u),Hd(s,g,function(v,E){return u(v,E[0])})}function rw(s,u,g){u=Vi(u,s);var v=-1,E=u.length;for(E||(E=1,s=e);++v<E;){var R=s==null?e:s[Qr(u[v])];R===e&&(v=E,R=g),s=pi(R)?R.call(s):R}return s}function iw(s,u,g){return s==null?s:mo(s,u,g)}function nw(s,u,g,v){return v=typeof v=="function"?v:e,s==null?s:mo(s,u,g,v)}var Zp=hp(ve),Qp=hp(Ke);function sw(s,u,g){var v=St(s),E=v||Xi(s)||us(s);if(u=mt(u,4),g==null){var R=s&&s.constructor;E?g=v?new R:[]:Jt(s)?g=pi(R)?os(Ga(s)):{}:g={}}return(E?xr:qr)(s,function(D,O,k){return u(g,D,O,k)}),g}function ow(s,u){return s==null?!0:mu(s,u)}function aw(s,u,g){return s==null?s:$d(s,u,xu(g))}function lw(s,u,g,v){return v=typeof v=="function"?v:e,s==null?s:$d(s,u,xu(g),v)}function cs(s){return s==null?[]:qh(s,ve(s))}function hw(s){return s==null?[]:qh(s,Ke(s))}function uw(s,u,g){return g===e&&(g=u,u=e),g!==e&&(g=Sr(g),g=g===g?g:0),u!==e&&(u=Sr(u),u=u===u?u:0),vn(Sr(s),u,g)}function cw(s,u,g){return u=mi(u),g===e?(g=u,u=0):g=mi(g),s=Sr(s),_0(s,u,g)}function fw(s,u,g){if(g&&typeof g!="boolean"&&Oe(s,u,g)&&(u=g=e),g===e&&(typeof u=="boolean"?(g=u,u=e):typeof s=="boolean"&&(g=s,s=e)),s===e&&u===e?(s=0,u=1):(s=mi(s),u===e?(u=s,s=0):u=mi(u)),s>u){var v=s;s=u,u=v}if(g||s%1||u%1){var E=wd();return Ie(s+E*(u-s+Xx("1e-"+((E+"").length-1))),u)}return fu(s,u)}var dw=ls(function(s,u,g){return u=u.toLowerCase(),s+(g?Jp(u):u)});function Jp(s){return ku(Ut(s).toLowerCase())}function tm(s){return s=Ut(s),s&&s.replace(mx,iv).replace(Lx,"")}function pw(s,u,g){s=Ut(s),u=sr(u);var v=s.length;g=g===e?v:vn(bt(g),0,v);var E=g;return g-=u.length,g>=0&&s.slice(g,E)==u}function mw(s){return s=Ut(s),s&&K_.test(s)?s.replace(Mf,nv):s}function gw(s){return s=Ut(s),s&&ex.test(s)?s.replace(Lh,"\\$&"):s}var _w=ls(function(s,u,g){return s+(g?"-":"")+u.toLowerCase()}),xw=ls(function(s,u,g){return s+(g?" ":"")+u.toLowerCase()}),vw=ip("toLowerCase");function yw(s,u,g){s=Ut(s),u=bt(u);var v=u?rs(s):0;if(!u||v>=u)return s;var E=(u-v)/2;return il(Xa(E),g)+s+il(Wa(E),g)}function Tw(s,u,g){s=Ut(s),u=bt(u);var v=u?rs(s):0;return u&&v<u?s+il(u-v,g):s}function ww(s,u,g){s=Ut(s),u=bt(u);var v=u?rs(s):0;return u&&v<u?il(u-v,g)+s:s}function Ew(s,u,g){return g||u==null?u=0:u&&(u=+u),Pv(Ut(s).replace(Fh,""),u||0)}function Sw(s,u,g){return(g?Oe(s,u,g):u===e)?u=1:u=bt(u),du(Ut(s),u)}function bw(){var s=arguments,u=Ut(s[0]);return s.length<3?u:u.replace(s[1],s[2])}var Aw=ls(function(s,u,g){return s+(g?"_":"")+u.toLowerCase()});function Cw(s,u,g){return g&&typeof g!="number"&&Oe(s,u,g)&&(u=g=e),g=g===e?Q:g>>>0,g?(s=Ut(s),s&&(typeof u=="string"||u!=null&&!Ou(u))&&(u=sr(u),!u&&es(s))?Wi(Mr(s),0,g):s.split(u,g)):[]}var Iw=ls(function(s,u,g){return s+(g?" ":"")+ku(u)});function Rw(s,u,g){return s=Ut(s),g=g==null?0:vn(bt(g),0,s.length),u=sr(u),s.slice(g,g+u.length)==u}function Pw(s,u,g){var v=A.templateSettings;g&&Oe(s,u,g)&&(u=e),s=Ut(s),u=ml({},u,v,up);var E=ml({},u.imports,v.imports,up),R=ve(E),D=qh(E,R),O,k,Y=0,K=u.interpolate||Ia,J="__p += '",nt=Qh((u.escape||Ia).source+"|"+K.source+"|"+(K===Bf?hx:Ia).source+"|"+(u.evaluate||Ia).source+"|$","g"),ht="//# sourceURL="+(Gt.call(u,"sourceURL")?(u.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++kx+"]")+`
`;s.replace(nt,function(vt,Rt,Mt,ar,Ne,lr){return Mt||(Mt=ar),J+=s.slice(Y,lr).replace(gx,sv),Rt&&(O=!0,J+=`' +
__e(`+Rt+`) +
'`),Ne&&(k=!0,J+=`';
`+Ne+`;
__p += '`),Mt&&(J+=`' +
((__t = (`+Mt+`)) == null ? '' : __t) +
'`),Y=lr+vt.length,vt}),J+=`';
`;var xt=Gt.call(u,"variable")&&u.variable;if(!xt)J=`with (obj) {
`+J+`
}
`;else if(ax.test(xt))throw new wt(o);J=(k?J.replace(z_,""):J).replace($_,"$1").replace(Y_,"$1;"),J="function("+(xt||"obj")+`) {
`+(xt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(O?", __e = _.escape":"")+(k?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+J+`return __p
}`;var At=rm(function(){return Nt(R,ht+"return "+J).apply(e,D)});if(At.source=J,Fu(At))throw At;return At}function Mw(s){return Ut(s).toLowerCase()}function Bw(s){return Ut(s).toUpperCase()}function Dw(s,u,g){if(s=Ut(s),s&&(g||u===e))return cd(s);if(!s||!(u=sr(u)))return s;var v=Mr(s),E=Mr(u),R=fd(v,E),D=dd(v,E)+1;return Wi(v,R,D).join("")}function Lw(s,u,g){if(s=Ut(s),s&&(g||u===e))return s.slice(0,md(s)+1);if(!s||!(u=sr(u)))return s;var v=Mr(s),E=dd(v,Mr(u))+1;return Wi(v,0,E).join("")}function Fw(s,u,g){if(s=Ut(s),s&&(g||u===e))return s.replace(Fh,"");if(!s||!(u=sr(u)))return s;var v=Mr(s),E=fd(v,Mr(u));return Wi(v,E).join("")}function Ow(s,u){var g=M,v=B;if(Jt(u)){var E="separator"in u?u.separator:E;g="length"in u?bt(u.length):g,v="omission"in u?sr(u.omission):v}s=Ut(s);var R=s.length;if(es(s)){var D=Mr(s);R=D.length}if(g>=R)return s;var O=g-rs(v);if(O<1)return v;var k=D?Wi(D,0,O).join(""):s.slice(0,O);if(E===e)return k+v;if(D&&(O+=k.length-O),Ou(E)){if(s.slice(O).search(E)){var Y,K=k;for(E.global||(E=Qh(E.source,Ut(Df.exec(E))+"g")),E.lastIndex=0;Y=E.exec(K);)var J=Y.index;k=k.slice(0,J===e?O:J)}}else if(s.indexOf(sr(E),O)!=O){var nt=k.lastIndexOf(E);nt>-1&&(k=k.slice(0,nt))}return k+v}function Nw(s){return s=Ut(s),s&&j_.test(s)?s.replace(Pf,fv):s}var Uw=ls(function(s,u,g){return s+(g?" ":"")+u.toUpperCase()}),ku=ip("toUpperCase");function em(s,u,g){return s=Ut(s),u=g?e:u,u===e?av(s)?mv(s):Qx(s):s.match(u)||[]}var rm=It(function(s,u){try{return ir(s,e,u)}catch(g){return Fu(g)?g:new wt(g)}}),kw=fi(function(s,u){return xr(u,function(g){g=Qr(g),ui(s,g,Du(s[g],s))}),s});function Gw(s){var u=s==null?0:s.length,g=mt();return s=u?Zt(s,function(v){if(typeof v[1]!="function")throw new vr(n);return[g(v[0]),v[1]]}):[],It(function(v){for(var E=-1;++E<u;){var R=s[E];if(ir(R[0],this,v))return ir(R[1],this,v)}})}function Hw(s){return f0(Tr(s,p))}function Gu(s){return function(){return s}}function Vw(s,u){return s==null||s!==s?u:s}var Ww=sp(),Xw=sp(!0);function qe(s){return s}function Hu(s){return Fd(typeof s=="function"?s:Tr(s,p))}function zw(s){return Nd(Tr(s,p))}function $w(s,u){return Ud(s,Tr(u,p))}var Yw=It(function(s,u){return function(g){return fo(g,s,u)}}),jw=It(function(s,u){return function(g){return fo(s,g,u)}});function Vu(s,u,g){var v=ve(u),E=qa(u,v);g==null&&!(Jt(u)&&(E.length||!v.length))&&(g=u,u=s,s=this,E=qa(u,ve(u)));var R=!(Jt(g)&&"chain"in g)||!!g.chain,D=pi(s);return xr(E,function(O){var k=u[O];s[O]=k,D&&(s.prototype[O]=function(){var Y=this.__chain__;if(R||Y){var K=s(this.__wrapped__),J=K.__actions__=Ye(this.__actions__);return J.push({func:k,args:arguments,thisArg:s}),K.__chain__=Y,K}return k.apply(s,Oi([this.value()],arguments))})}),s}function Kw(){return xe._===this&&(xe._=Tv),this}function Wu(){}function qw(s){return s=bt(s),It(function(u){return kd(u,s)})}var Zw=yu(Zt),Qw=yu(od),Jw=yu(zh);function im(s){return Cu(s)?$h(Qr(s)):R0(s)}function tE(s){return function(u){return s==null?e:yn(s,u)}}var eE=ap(),rE=ap(!0);function Xu(){return[]}function zu(){return!1}function iE(){return{}}function nE(){return""}function sE(){return!0}function oE(s,u){if(s=bt(s),s<1||s>j)return[];var g=Q,v=Ie(s,Q);u=mt(u),s-=Q;for(var E=Kh(v,u);++g<s;)u(g);return E}function aE(s){return St(s)?Zt(s,Qr):or(s)?[s]:Ye(Ep(Ut(s)))}function lE(s){var u=++vv;return Ut(s)+u}var hE=rl(function(s,u){return s+u},0),uE=Tu("ceil"),cE=rl(function(s,u){return s/u},1),fE=Tu("floor");function dE(s){return s&&s.length?Ka(s,qe,ou):e}function pE(s,u){return s&&s.length?Ka(s,mt(u,2),ou):e}function mE(s){return hd(s,qe)}function gE(s,u){return hd(s,mt(u,2))}function _E(s){return s&&s.length?Ka(s,qe,uu):e}function xE(s,u){return s&&s.length?Ka(s,mt(u,2),uu):e}var vE=rl(function(s,u){return s*u},1),yE=Tu("round"),TE=rl(function(s,u){return s-u},0);function wE(s){return s&&s.length?jh(s,qe):0}function EE(s,u){return s&&s.length?jh(s,mt(u,2)):0}return A.after=z1,A.ary=Lp,A.assign=BT,A.assignIn=jp,A.assignInWith=ml,A.assignWith=DT,A.at=LT,A.before=Fp,A.bind=Du,A.bindAll=kw,A.bindKey=Op,A.castArray=iT,A.chain=Mp,A.chunk=fy,A.compact=dy,A.concat=py,A.cond=Gw,A.conforms=Hw,A.constant=Gu,A.countBy=w1,A.create=FT,A.curry=Np,A.curryRight=Up,A.debounce=kp,A.defaults=OT,A.defaultsDeep=NT,A.defer=$1,A.delay=Y1,A.difference=my,A.differenceBy=gy,A.differenceWith=_y,A.drop=xy,A.dropRight=vy,A.dropRightWhile=yy,A.dropWhile=Ty,A.fill=wy,A.filter=S1,A.flatMap=C1,A.flatMapDeep=I1,A.flatMapDepth=R1,A.flatten=Cp,A.flattenDeep=Ey,A.flattenDepth=Sy,A.flip=j1,A.flow=Ww,A.flowRight=Xw,A.fromPairs=by,A.functions=XT,A.functionsIn=zT,A.groupBy=P1,A.initial=Cy,A.intersection=Iy,A.intersectionBy=Ry,A.intersectionWith=Py,A.invert=YT,A.invertBy=jT,A.invokeMap=B1,A.iteratee=Hu,A.keyBy=D1,A.keys=ve,A.keysIn=Ke,A.map=hl,A.mapKeys=qT,A.mapValues=ZT,A.matches=zw,A.matchesProperty=$w,A.memoize=cl,A.merge=QT,A.mergeWith=Kp,A.method=Yw,A.methodOf=jw,A.mixin=Vu,A.negate=fl,A.nthArg=qw,A.omit=JT,A.omitBy=tw,A.once=K1,A.orderBy=L1,A.over=Zw,A.overArgs=q1,A.overEvery=Qw,A.overSome=Jw,A.partial=Lu,A.partialRight=Gp,A.partition=F1,A.pick=ew,A.pickBy=qp,A.property=im,A.propertyOf=tE,A.pull=Ly,A.pullAll=Rp,A.pullAllBy=Fy,A.pullAllWith=Oy,A.pullAt=Ny,A.range=eE,A.rangeRight=rE,A.rearg=Z1,A.reject=U1,A.remove=Uy,A.rest=Q1,A.reverse=Mu,A.sampleSize=G1,A.set=iw,A.setWith=nw,A.shuffle=H1,A.slice=ky,A.sortBy=X1,A.sortedUniq=$y,A.sortedUniqBy=Yy,A.split=Cw,A.spread=J1,A.tail=jy,A.take=Ky,A.takeRight=qy,A.takeRightWhile=Zy,A.takeWhile=Qy,A.tap=d1,A.throttle=tT,A.thru=ll,A.toArray=zp,A.toPairs=Zp,A.toPairsIn=Qp,A.toPath=aE,A.toPlainObject=Yp,A.transform=sw,A.unary=eT,A.union=Jy,A.unionBy=t1,A.unionWith=e1,A.uniq=r1,A.uniqBy=i1,A.uniqWith=n1,A.unset=ow,A.unzip=Bu,A.unzipWith=Pp,A.update=aw,A.updateWith=lw,A.values=cs,A.valuesIn=hw,A.without=s1,A.words=em,A.wrap=rT,A.xor=o1,A.xorBy=a1,A.xorWith=l1,A.zip=h1,A.zipObject=u1,A.zipObjectDeep=c1,A.zipWith=f1,A.entries=Zp,A.entriesIn=Qp,A.extend=jp,A.extendWith=ml,Vu(A,A),A.add=hE,A.attempt=rm,A.camelCase=dw,A.capitalize=Jp,A.ceil=uE,A.clamp=uw,A.clone=nT,A.cloneDeep=oT,A.cloneDeepWith=aT,A.cloneWith=sT,A.conformsTo=lT,A.deburr=tm,A.defaultTo=Vw,A.divide=cE,A.endsWith=pw,A.eq=Dr,A.escape=mw,A.escapeRegExp=gw,A.every=E1,A.find=b1,A.findIndex=bp,A.findKey=UT,A.findLast=A1,A.findLastIndex=Ap,A.findLastKey=kT,A.floor=fE,A.forEach=Bp,A.forEachRight=Dp,A.forIn=GT,A.forInRight=HT,A.forOwn=VT,A.forOwnRight=WT,A.get=Nu,A.gt=hT,A.gte=uT,A.has=$T,A.hasIn=Uu,A.head=Ip,A.identity=qe,A.includes=M1,A.indexOf=Ay,A.inRange=cw,A.invoke=KT,A.isArguments=En,A.isArray=St,A.isArrayBuffer=cT,A.isArrayLike=je,A.isArrayLikeObject=se,A.isBoolean=fT,A.isBuffer=Xi,A.isDate=dT,A.isElement=pT,A.isEmpty=mT,A.isEqual=gT,A.isEqualWith=_T,A.isError=Fu,A.isFinite=xT,A.isFunction=pi,A.isInteger=Hp,A.isLength=dl,A.isMap=Vp,A.isMatch=vT,A.isMatchWith=yT,A.isNaN=TT,A.isNative=wT,A.isNil=ST,A.isNull=ET,A.isNumber=Wp,A.isObject=Jt,A.isObjectLike=re,A.isPlainObject=vo,A.isRegExp=Ou,A.isSafeInteger=bT,A.isSet=Xp,A.isString=pl,A.isSymbol=or,A.isTypedArray=us,A.isUndefined=AT,A.isWeakMap=CT,A.isWeakSet=IT,A.join=My,A.kebabCase=_w,A.last=Er,A.lastIndexOf=By,A.lowerCase=xw,A.lowerFirst=vw,A.lt=RT,A.lte=PT,A.max=dE,A.maxBy=pE,A.mean=mE,A.meanBy=gE,A.min=_E,A.minBy=xE,A.stubArray=Xu,A.stubFalse=zu,A.stubObject=iE,A.stubString=nE,A.stubTrue=sE,A.multiply=vE,A.nth=Dy,A.noConflict=Kw,A.noop=Wu,A.now=ul,A.pad=yw,A.padEnd=Tw,A.padStart=ww,A.parseInt=Ew,A.random=fw,A.reduce=O1,A.reduceRight=N1,A.repeat=Sw,A.replace=bw,A.result=rw,A.round=yE,A.runInContext=U,A.sample=k1,A.size=V1,A.snakeCase=Aw,A.some=W1,A.sortedIndex=Gy,A.sortedIndexBy=Hy,A.sortedIndexOf=Vy,A.sortedLastIndex=Wy,A.sortedLastIndexBy=Xy,A.sortedLastIndexOf=zy,A.startCase=Iw,A.startsWith=Rw,A.subtract=TE,A.sum=wE,A.sumBy=EE,A.template=Pw,A.times=oE,A.toFinite=mi,A.toInteger=bt,A.toLength=$p,A.toLower=Mw,A.toNumber=Sr,A.toSafeInteger=MT,A.toString=Ut,A.toUpper=Bw,A.trim=Dw,A.trimEnd=Lw,A.trimStart=Fw,A.truncate=Ow,A.unescape=Nw,A.uniqueId=lE,A.upperCase=Uw,A.upperFirst=ku,A.each=Bp,A.eachRight=Dp,A.first=Ip,Vu(A,function(){var s={};return qr(A,function(u,g){Gt.call(A.prototype,g)||(s[g]=u)}),s}(),{chain:!1}),A.VERSION=t,xr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(s){A[s].placeholder=A}),xr(["drop","take"],function(s,u){Pt.prototype[s]=function(g){g=g===e?1:fe(bt(g),0);var v=this.__filtered__&&!u?new Pt(this):this.clone();return v.__filtered__?v.__takeCount__=Ie(g,v.__takeCount__):v.__views__.push({size:Ie(g,Q),type:s+(v.__dir__<0?"Right":"")}),v},Pt.prototype[s+"Right"]=function(g){return this.reverse()[s](g).reverse()}}),xr(["filter","map","takeWhile"],function(s,u){var g=u+1,v=g==H||g==G;Pt.prototype[s]=function(E){var R=this.clone();return R.__iteratees__.push({iteratee:mt(E,3),type:g}),R.__filtered__=R.__filtered__||v,R}}),xr(["head","last"],function(s,u){var g="take"+(u?"Right":"");Pt.prototype[s]=function(){return this[g](1).value()[0]}}),xr(["initial","tail"],function(s,u){var g="drop"+(u?"":"Right");Pt.prototype[s]=function(){return this.__filtered__?new Pt(this):this[g](1)}}),Pt.prototype.compact=function(){return this.filter(qe)},Pt.prototype.find=function(s){return this.filter(s).head()},Pt.prototype.findLast=function(s){return this.reverse().find(s)},Pt.prototype.invokeMap=It(function(s,u){return typeof s=="function"?new Pt(this):this.map(function(g){return fo(g,s,u)})}),Pt.prototype.reject=function(s){return this.filter(fl(mt(s)))},Pt.prototype.slice=function(s,u){s=bt(s);var g=this;return g.__filtered__&&(s>0||u<0)?new Pt(g):(s<0?g=g.takeRight(-s):s&&(g=g.drop(s)),u!==e&&(u=bt(u),g=u<0?g.dropRight(-u):g.take(u-s)),g)},Pt.prototype.takeRightWhile=function(s){return this.reverse().takeWhile(s).reverse()},Pt.prototype.toArray=function(){return this.take(Q)},qr(Pt.prototype,function(s,u){var g=/^(?:filter|find|map|reject)|While$/.test(u),v=/^(?:head|last)$/.test(u),E=A[v?"take"+(u=="last"?"Right":""):u],R=v||/^find/.test(u);E&&(A.prototype[u]=function(){var D=this.__wrapped__,O=v?[1]:arguments,k=D instanceof Pt,Y=O[0],K=k||St(D),J=function(Rt){var Mt=E.apply(A,Oi([Rt],O));return v&&nt?Mt[0]:Mt};K&&g&&typeof Y=="function"&&Y.length!=1&&(k=K=!1);var nt=this.__chain__,ht=!!this.__actions__.length,xt=R&&!nt,At=k&&!ht;if(!R&&K){D=At?D:new Pt(this);var vt=s.apply(D,O);return vt.__actions__.push({func:ll,args:[J],thisArg:e}),new yr(vt,nt)}return xt&&At?s.apply(this,O):(vt=this.thru(J),xt?v?vt.value()[0]:vt.value():vt)})}),xr(["pop","push","shift","sort","splice","unshift"],function(s){var u=La[s],g=/^(?:push|sort|unshift)$/.test(s)?"tap":"thru",v=/^(?:pop|shift)$/.test(s);A.prototype[s]=function(){var E=arguments;if(v&&!this.__chain__){var R=this.value();return u.apply(St(R)?R:[],E)}return this[g](function(D){return u.apply(St(D)?D:[],E)})}}),qr(Pt.prototype,function(s,u){var g=A[u];if(g){var v=g.name+"";Gt.call(ss,v)||(ss[v]=[]),ss[v].push({name:u,func:g})}}),ss[el(e,x).name]=[{name:"wrapper",func:e}],Pt.prototype.clone=Nv,Pt.prototype.reverse=Uv,Pt.prototype.value=kv,A.prototype.at=p1,A.prototype.chain=m1,A.prototype.commit=g1,A.prototype.next=_1,A.prototype.plant=v1,A.prototype.reverse=y1,A.prototype.toJSON=A.prototype.valueOf=A.prototype.value=T1,A.prototype.first=A.prototype.head,so&&(A.prototype[so]=x1),A},Ui=gv();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(xe._=Ui,define(function(){return Ui})):mn?((mn.exports=Ui)._=Ui,Hh._=Ui):xe._=Ui}).call(eo)});var W_=Fr(wh=>{(function(){"use strict";var e=function(){this.init()};e.prototype={init:function(){var l=this||t;return l._counter=1e3,l._html5AudioPool=[],l.html5PoolSize=10,l._codecs={},l._howls=[],l._muted=!1,l._volume=1,l._canPlayEvent="canplaythrough",l._navigator=typeof window<"u"&&window.navigator?window.navigator:null,l.masterGain=null,l.noAudio=!1,l.usingWebAudio=!0,l.autoSuspend=!0,l.ctx=null,l.autoUnlock=!0,l._setup(),l},volume:function(l){var h=this||t;if(l=parseFloat(l),h.ctx||p(),typeof l<"u"&&l>=0&&l<=1){if(h._volume=l,h._muted)return h;h.usingWebAudio&&h.masterGain.gain.setValueAtTime(l,t.ctx.currentTime);for(var d=0;d<h._howls.length;d++)if(!h._howls[d]._webAudio)for(var m=h._howls[d]._getSoundIds(),_=0;_<m.length;_++){var x=h._howls[d]._soundById(m[_]);x&&x._node&&(x._node.volume=x._volume*l)}return h}return h._volume},mute:function(l){var h=this||t;h.ctx||p(),h._muted=l,h.usingWebAudio&&h.masterGain.gain.setValueAtTime(l?0:h._volume,t.ctx.currentTime);for(var d=0;d<h._howls.length;d++)if(!h._howls[d]._webAudio)for(var m=h._howls[d]._getSoundIds(),_=0;_<m.length;_++){var x=h._howls[d]._soundById(m[_]);x&&x._node&&(x._node.muted=l?!0:x._muted)}return h},stop:function(){for(var l=this||t,h=0;h<l._howls.length;h++)l._howls[h].stop();return l},unload:function(){for(var l=this||t,h=l._howls.length-1;h>=0;h--)l._howls[h].unload();return l.usingWebAudio&&l.ctx&&typeof l.ctx.close<"u"&&(l.ctx.close(),l.ctx=null,p()),l},codecs:function(l){return(this||t)._codecs[l.replace(/^x-/,"")]},_setup:function(){var l=this||t;if(l.state=l.ctx&&l.ctx.state||"suspended",l._autoSuspend(),!l.usingWebAudio)if(typeof Audio<"u")try{var h=new Audio;typeof h.oncanplaythrough>"u"&&(l._canPlayEvent="canplay")}catch{l.noAudio=!0}else l.noAudio=!0;try{var h=new Audio;h.muted&&(l.noAudio=!0)}catch{}return l.noAudio||l._setupCodecs(),l},_setupCodecs:function(){var l=this||t,h=null;try{h=typeof Audio<"u"?new Audio:null}catch{return l}if(!h||typeof h.canPlayType!="function")return l;var d=h.canPlayType("audio/mpeg;").replace(/^no$/,""),m=l._navigator?l._navigator.userAgent:"",_=m.match(/OPR\/([0-6].)/g),x=_&&parseInt(_[0].split("/")[1],10)<33,T=m.indexOf("Safari")!==-1&&m.indexOf("Chrome")===-1,S=m.match(/Version\/(.*?) /),b=T&&S&&parseInt(S[1],10)<15;return l._codecs={mp3:!!(!x&&(d||h.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!d,opus:!!h.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!h.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!h.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(h.canPlayType('audio/wav; codecs="1"')||h.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!h.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!h.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(h.canPlayType("audio/x-m4a;")||h.canPlayType("audio/m4a;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(h.canPlayType("audio/x-m4b;")||h.canPlayType("audio/m4b;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(h.canPlayType("audio/x-mp4;")||h.canPlayType("audio/mp4;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!b&&h.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!b&&h.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!h.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(h.canPlayType("audio/x-flac;")||h.canPlayType("audio/flac;")).replace(/^no$/,"")},l},_unlockAudio:function(){var l=this||t;if(!(l._audioUnlocked||!l.ctx)){l._audioUnlocked=!1,l.autoUnlock=!1,!l._mobileUnloaded&&l.ctx.sampleRate!==44100&&(l._mobileUnloaded=!0,l.unload()),l._scratchBuffer=l.ctx.createBuffer(1,1,22050);var h=function(d){for(;l._html5AudioPool.length<l.html5PoolSize;)try{var m=new Audio;m._unlocked=!0,l._releaseHtml5Audio(m)}catch{l.noAudio=!0;break}for(var _=0;_<l._howls.length;_++)if(!l._howls[_]._webAudio)for(var x=l._howls[_]._getSoundIds(),T=0;T<x.length;T++){var S=l._howls[_]._soundById(x[T]);S&&S._node&&!S._node._unlocked&&(S._node._unlocked=!0,S._node.load())}l._autoResume();var b=l.ctx.createBufferSource();b.buffer=l._scratchBuffer,b.connect(l.ctx.destination),typeof b.start>"u"?b.noteOn(0):b.start(0),typeof l.ctx.resume=="function"&&l.ctx.resume(),b.onended=function(){b.disconnect(0),l._audioUnlocked=!0,document.removeEventListener("touchstart",h,!0),document.removeEventListener("touchend",h,!0),document.removeEventListener("click",h,!0),document.removeEventListener("keydown",h,!0);for(var y=0;y<l._howls.length;y++)l._howls[y]._emit("unlock")}};return document.addEventListener("touchstart",h,!0),document.addEventListener("touchend",h,!0),document.addEventListener("click",h,!0),document.addEventListener("keydown",h,!0),l}},_obtainHtml5Audio:function(){var l=this||t;if(l._html5AudioPool.length)return l._html5AudioPool.pop();var h=new Audio().play();return h&&typeof Promise<"u"&&(h instanceof Promise||typeof h.then=="function")&&h.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(l){var h=this||t;return l._unlocked&&h._html5AudioPool.push(l),h},_autoSuspend:function(){var l=this;if(!(!l.autoSuspend||!l.ctx||typeof l.ctx.suspend>"u"||!t.usingWebAudio)){for(var h=0;h<l._howls.length;h++)if(l._howls[h]._webAudio){for(var d=0;d<l._howls[h]._sounds.length;d++)if(!l._howls[h]._sounds[d]._paused)return l}return l._suspendTimer&&clearTimeout(l._suspendTimer),l._suspendTimer=setTimeout(function(){if(l.autoSuspend){l._suspendTimer=null,l.state="suspending";var m=function(){l.state="suspended",l._resumeAfterSuspend&&(delete l._resumeAfterSuspend,l._autoResume())};l.ctx.suspend().then(m,m)}},3e4),l}},_autoResume:function(){var l=this;if(!(!l.ctx||typeof l.ctx.resume>"u"||!t.usingWebAudio))return l.state==="running"&&l.ctx.state!=="interrupted"&&l._suspendTimer?(clearTimeout(l._suspendTimer),l._suspendTimer=null):l.state==="suspended"||l.state==="running"&&l.ctx.state==="interrupted"?(l.ctx.resume().then(function(){l.state="running";for(var h=0;h<l._howls.length;h++)l._howls[h]._emit("resume")}),l._suspendTimer&&(clearTimeout(l._suspendTimer),l._suspendTimer=null)):l.state==="suspending"&&(l._resumeAfterSuspend=!0),l}};var t=new e,r=function(l){var h=this;if(!l.src||l.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}h.init(l)};r.prototype={init:function(l){var h=this;return t.ctx||p(),h._autoplay=l.autoplay||!1,h._format=typeof l.format!="string"?l.format:[l.format],h._html5=l.html5||!1,h._muted=l.mute||!1,h._loop=l.loop||!1,h._pool=l.pool||5,h._preload=typeof l.preload=="boolean"||l.preload==="metadata"?l.preload:!0,h._rate=l.rate||1,h._sprite=l.sprite||{},h._src=typeof l.src!="string"?l.src:[l.src],h._volume=l.volume!==void 0?l.volume:1,h._xhr={method:l.xhr&&l.xhr.method?l.xhr.method:"GET",headers:l.xhr&&l.xhr.headers?l.xhr.headers:null,withCredentials:l.xhr&&l.xhr.withCredentials?l.xhr.withCredentials:!1},h._duration=0,h._state="unloaded",h._sounds=[],h._endTimers={},h._queue=[],h._playLock=!1,h._onend=l.onend?[{fn:l.onend}]:[],h._onfade=l.onfade?[{fn:l.onfade}]:[],h._onload=l.onload?[{fn:l.onload}]:[],h._onloaderror=l.onloaderror?[{fn:l.onloaderror}]:[],h._onplayerror=l.onplayerror?[{fn:l.onplayerror}]:[],h._onpause=l.onpause?[{fn:l.onpause}]:[],h._onplay=l.onplay?[{fn:l.onplay}]:[],h._onstop=l.onstop?[{fn:l.onstop}]:[],h._onmute=l.onmute?[{fn:l.onmute}]:[],h._onvolume=l.onvolume?[{fn:l.onvolume}]:[],h._onrate=l.onrate?[{fn:l.onrate}]:[],h._onseek=l.onseek?[{fn:l.onseek}]:[],h._onunlock=l.onunlock?[{fn:l.onunlock}]:[],h._onresume=[],h._webAudio=t.usingWebAudio&&!h._html5,typeof t.ctx<"u"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(h),h._autoplay&&h._queue.push({event:"play",action:function(){h.play()}}),h._preload&&h._preload!=="none"&&h.load(),h},load:function(){var l=this,h=null;if(t.noAudio){l._emit("loaderror",null,"No audio support.");return}typeof l._src=="string"&&(l._src=[l._src]);for(var d=0;d<l._src.length;d++){var m,_;if(l._format&&l._format[d])m=l._format[d];else{if(_=l._src[d],typeof _!="string"){l._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}m=/^data:audio\/([^;,]+);/i.exec(_),m||(m=/\.([^.]+)$/.exec(_.split("?",1)[0])),m&&(m=m[1].toLowerCase())}if(m||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),m&&t.codecs(m)){h=l._src[d];break}}if(!h){l._emit("loaderror",null,"No codec support for selected audio sources.");return}return l._src=h,l._state="loading",window.location.protocol==="https:"&&h.slice(0,5)==="http:"&&(l._html5=!0,l._webAudio=!1),new i(l),l._webAudio&&o(l),l},play:function(l,h){var d=this,m=null;if(typeof l=="number")m=l,l=null;else{if(typeof l=="string"&&d._state==="loaded"&&!d._sprite[l])return null;if(typeof l>"u"&&(l="__default",!d._playLock)){for(var _=0,x=0;x<d._sounds.length;x++)d._sounds[x]._paused&&!d._sounds[x]._ended&&(_++,m=d._sounds[x]._id);_===1?l=null:m=null}}var T=m?d._soundById(m):d._inactiveSound();if(!T)return null;if(m&&!l&&(l=T._sprite||"__default"),d._state!=="loaded"){T._sprite=l,T._ended=!1;var S=T._id;return d._queue.push({event:"play",action:function(){d.play(S)}}),S}if(m&&!T._paused)return h||d._loadQueue("play"),T._id;d._webAudio&&t._autoResume();var b=Math.max(0,T._seek>0?T._seek:d._sprite[l][0]/1e3),y=Math.max(0,(d._sprite[l][0]+d._sprite[l][1])/1e3-b),w=y*1e3/Math.abs(T._rate),I=d._sprite[l][0]/1e3,C=(d._sprite[l][0]+d._sprite[l][1])/1e3;T._sprite=l,T._ended=!1;var P=function(){T._paused=!1,T._seek=b,T._start=I,T._stop=C,T._loop=!!(T._loop||d._sprite[l][2])};if(b>=C){d._ended(T);return}var M=T._node;if(d._webAudio){var B=function(){d._playLock=!1,P(),d._refreshBuffer(T);var N=T._muted||d._muted?0:T._volume;M.gain.setValueAtTime(N,t.ctx.currentTime),T._playStart=t.ctx.currentTime,typeof M.bufferSource.start>"u"?T._loop?M.bufferSource.noteGrainOn(0,b,86400):M.bufferSource.noteGrainOn(0,b,y):T._loop?M.bufferSource.start(0,b,86400):M.bufferSource.start(0,b,y),w!==1/0&&(d._endTimers[T._id]=setTimeout(d._ended.bind(d,T),w)),h||setTimeout(function(){d._emit("play",T._id),d._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?B():(d._playLock=!0,d.once("resume",B),d._clearTimer(T._id))}else{var F=function(){M.currentTime=b,M.muted=T._muted||d._muted||t._muted||M.muted,M.volume=T._volume*t.volume(),M.playbackRate=T._rate;try{var N=M.play();if(N&&typeof Promise<"u"&&(N instanceof Promise||typeof N.then=="function")?(d._playLock=!0,P(),N.then(function(){d._playLock=!1,M._unlocked=!0,h?d._loadQueue():d._emit("play",T._id)}).catch(function(){d._playLock=!1,d._emit("playerror",T._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),T._ended=!0,T._paused=!0})):h||(d._playLock=!1,P(),d._emit("play",T._id)),M.playbackRate=T._rate,M.paused){d._emit("playerror",T._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}l!=="__default"||T._loop?d._endTimers[T._id]=setTimeout(d._ended.bind(d,T),w):(d._endTimers[T._id]=function(){d._ended(T),M.removeEventListener("ended",d._endTimers[T._id],!1)},M.addEventListener("ended",d._endTimers[T._id],!1))}catch(G){d._emit("playerror",T._id,G)}};M.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(M.src=d._src,M.load());var L=window&&window.ejecta||!M.readyState&&t._navigator.isCocoonJS;if(M.readyState>=3||L)F();else{d._playLock=!0,d._state="loading";var H=function(){d._state="loaded",F(),M.removeEventListener(t._canPlayEvent,H,!1)};M.addEventListener(t._canPlayEvent,H,!1),d._clearTimer(T._id)}}return T._id},pause:function(l){var h=this;if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"pause",action:function(){h.pause(l)}}),h;for(var d=h._getSoundIds(l),m=0;m<d.length;m++){h._clearTimer(d[m]);var _=h._soundById(d[m]);if(_&&!_._paused&&(_._seek=h.seek(d[m]),_._rateSeek=0,_._paused=!0,h._stopFade(d[m]),_._node))if(h._webAudio){if(!_._node.bufferSource)continue;typeof _._node.bufferSource.stop>"u"?_._node.bufferSource.noteOff(0):_._node.bufferSource.stop(0),h._cleanBuffer(_._node)}else(!isNaN(_._node.duration)||_._node.duration===1/0)&&_._node.pause();arguments[1]||h._emit("pause",_?_._id:null)}return h},stop:function(l,h){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"stop",action:function(){d.stop(l)}}),d;for(var m=d._getSoundIds(l),_=0;_<m.length;_++){d._clearTimer(m[_]);var x=d._soundById(m[_]);x&&(x._seek=x._start||0,x._rateSeek=0,x._paused=!0,x._ended=!0,d._stopFade(m[_]),x._node&&(d._webAudio?x._node.bufferSource&&(typeof x._node.bufferSource.stop>"u"?x._node.bufferSource.noteOff(0):x._node.bufferSource.stop(0),d._cleanBuffer(x._node)):(!isNaN(x._node.duration)||x._node.duration===1/0)&&(x._node.currentTime=x._start||0,x._node.pause(),x._node.duration===1/0&&d._clearSound(x._node))),h||d._emit("stop",x._id))}return d},mute:function(l,h){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"mute",action:function(){d.mute(l,h)}}),d;if(typeof h>"u")if(typeof l=="boolean")d._muted=l;else return d._muted;for(var m=d._getSoundIds(h),_=0;_<m.length;_++){var x=d._soundById(m[_]);x&&(x._muted=l,x._interval&&d._stopFade(x._id),d._webAudio&&x._node?x._node.gain.setValueAtTime(l?0:x._volume,t.ctx.currentTime):x._node&&(x._node.muted=t._muted?!0:l),d._emit("mute",x._id))}return d},volume:function(){var l=this,h=arguments,d,m;if(h.length===0)return l._volume;if(h.length===1||h.length===2&&typeof h[1]>"u"){var _=l._getSoundIds(),x=_.indexOf(h[0]);x>=0?m=parseInt(h[0],10):d=parseFloat(h[0])}else h.length>=2&&(d=parseFloat(h[0]),m=parseInt(h[1],10));var T;if(typeof d<"u"&&d>=0&&d<=1){if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"volume",action:function(){l.volume.apply(l,h)}}),l;typeof m>"u"&&(l._volume=d),m=l._getSoundIds(m);for(var S=0;S<m.length;S++)T=l._soundById(m[S]),T&&(T._volume=d,h[2]||l._stopFade(m[S]),l._webAudio&&T._node&&!T._muted?T._node.gain.setValueAtTime(d,t.ctx.currentTime):T._node&&!T._muted&&(T._node.volume=d*t.volume()),l._emit("volume",T._id))}else return T=m?l._soundById(m):l._sounds[0],T?T._volume:0;return l},fade:function(l,h,d,m){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"fade",action:function(){_.fade(l,h,d,m)}}),_;l=Math.min(Math.max(0,parseFloat(l)),1),h=Math.min(Math.max(0,parseFloat(h)),1),d=parseFloat(d),_.volume(l,m);for(var x=_._getSoundIds(m),T=0;T<x.length;T++){var S=_._soundById(x[T]);if(S){if(m||_._stopFade(x[T]),_._webAudio&&!S._muted){var b=t.ctx.currentTime,y=b+d/1e3;S._volume=l,S._node.gain.setValueAtTime(l,b),S._node.gain.linearRampToValueAtTime(h,y)}_._startFadeInterval(S,l,h,d,x[T],typeof m>"u")}}return _},_startFadeInterval:function(l,h,d,m,_,x){var T=this,S=h,b=d-h,y=Math.abs(b/.01),w=Math.max(4,y>0?m/y:m),I=Date.now();l._fadeTo=d,l._interval=setInterval(function(){var C=(Date.now()-I)/m;I=Date.now(),S+=b*C,S=Math.round(S*100)/100,b<0?S=Math.max(d,S):S=Math.min(d,S),T._webAudio?l._volume=S:T.volume(S,l._id,!0),x&&(T._volume=S),(d<h&&S<=d||d>h&&S>=d)&&(clearInterval(l._interval),l._interval=null,l._fadeTo=null,T.volume(d,l._id),T._emit("fade",l._id))},w)},_stopFade:function(l){var h=this,d=h._soundById(l);return d&&d._interval&&(h._webAudio&&d._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(d._interval),d._interval=null,h.volume(d._fadeTo,l),d._fadeTo=null,h._emit("fade",l)),h},loop:function(){var l=this,h=arguments,d,m,_;if(h.length===0)return l._loop;if(h.length===1)if(typeof h[0]=="boolean")d=h[0],l._loop=d;else return _=l._soundById(parseInt(h[0],10)),_?_._loop:!1;else h.length===2&&(d=h[0],m=parseInt(h[1],10));for(var x=l._getSoundIds(m),T=0;T<x.length;T++)_=l._soundById(x[T]),_&&(_._loop=d,l._webAudio&&_._node&&_._node.bufferSource&&(_._node.bufferSource.loop=d,d&&(_._node.bufferSource.loopStart=_._start||0,_._node.bufferSource.loopEnd=_._stop,l.playing(x[T])&&(l.pause(x[T],!0),l.play(x[T],!0)))));return l},rate:function(){var l=this,h=arguments,d,m;if(h.length===0)m=l._sounds[0]._id;else if(h.length===1){var _=l._getSoundIds(),x=_.indexOf(h[0]);x>=0?m=parseInt(h[0],10):d=parseFloat(h[0])}else h.length===2&&(d=parseFloat(h[0]),m=parseInt(h[1],10));var T;if(typeof d=="number"){if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"rate",action:function(){l.rate.apply(l,h)}}),l;typeof m>"u"&&(l._rate=d),m=l._getSoundIds(m);for(var S=0;S<m.length;S++)if(T=l._soundById(m[S]),T){l.playing(m[S])&&(T._rateSeek=l.seek(m[S]),T._playStart=l._webAudio?t.ctx.currentTime:T._playStart),T._rate=d,l._webAudio&&T._node&&T._node.bufferSource?T._node.bufferSource.playbackRate.setValueAtTime(d,t.ctx.currentTime):T._node&&(T._node.playbackRate=d);var b=l.seek(m[S]),y=(l._sprite[T._sprite][0]+l._sprite[T._sprite][1])/1e3-b,w=y*1e3/Math.abs(T._rate);(l._endTimers[m[S]]||!T._paused)&&(l._clearTimer(m[S]),l._endTimers[m[S]]=setTimeout(l._ended.bind(l,T),w)),l._emit("rate",T._id)}}else return T=l._soundById(m),T?T._rate:l._rate;return l},seek:function(){var l=this,h=arguments,d,m;if(h.length===0)l._sounds.length&&(m=l._sounds[0]._id);else if(h.length===1){var _=l._getSoundIds(),x=_.indexOf(h[0]);x>=0?m=parseInt(h[0],10):l._sounds.length&&(m=l._sounds[0]._id,d=parseFloat(h[0]))}else h.length===2&&(d=parseFloat(h[0]),m=parseInt(h[1],10));if(typeof m>"u")return 0;if(typeof d=="number"&&(l._state!=="loaded"||l._playLock))return l._queue.push({event:"seek",action:function(){l.seek.apply(l,h)}}),l;var T=l._soundById(m);if(T)if(typeof d=="number"&&d>=0){var S=l.playing(m);S&&l.pause(m,!0),T._seek=d,T._ended=!1,l._clearTimer(m),!l._webAudio&&T._node&&!isNaN(T._node.duration)&&(T._node.currentTime=d);var b=function(){S&&l.play(m,!0),l._emit("seek",m)};if(S&&!l._webAudio){var y=function(){l._playLock?setTimeout(y,0):b()};setTimeout(y,0)}else b()}else if(l._webAudio){var w=l.playing(m)?t.ctx.currentTime-T._playStart:0,I=T._rateSeek?T._rateSeek-T._seek:0;return T._seek+(I+w*Math.abs(T._rate))}else return T._node.currentTime;return l},playing:function(l){var h=this;if(typeof l=="number"){var d=h._soundById(l);return d?!d._paused:!1}for(var m=0;m<h._sounds.length;m++)if(!h._sounds[m]._paused)return!0;return!1},duration:function(l){var h=this,d=h._duration,m=h._soundById(l);return m&&(d=h._sprite[m._sprite][1]/1e3),d},state:function(){return this._state},unload:function(){for(var l=this,h=l._sounds,d=0;d<h.length;d++)h[d]._paused||l.stop(h[d]._id),l._webAudio||(l._clearSound(h[d]._node),h[d]._node.removeEventListener("error",h[d]._errorFn,!1),h[d]._node.removeEventListener(t._canPlayEvent,h[d]._loadFn,!1),h[d]._node.removeEventListener("ended",h[d]._endFn,!1),t._releaseHtml5Audio(h[d]._node)),delete h[d]._node,l._clearTimer(h[d]._id);var m=t._howls.indexOf(l);m>=0&&t._howls.splice(m,1);var _=!0;for(d=0;d<t._howls.length;d++)if(t._howls[d]._src===l._src||l._src.indexOf(t._howls[d]._src)>=0){_=!1;break}return n&&_&&delete n[l._src],t.noAudio=!1,l._state="unloaded",l._sounds=[],l=null,null},on:function(l,h,d,m){var _=this,x=_["_on"+l];return typeof h=="function"&&x.push(m?{id:d,fn:h,once:m}:{id:d,fn:h}),_},off:function(l,h,d){var m=this,_=m["_on"+l],x=0;if(typeof h=="number"&&(d=h,h=null),h||d)for(x=0;x<_.length;x++){var T=d===_[x].id;if(h===_[x].fn&&T||!h&&T){_.splice(x,1);break}}else if(l)m["_on"+l]=[];else{var S=Object.keys(m);for(x=0;x<S.length;x++)S[x].indexOf("_on")===0&&Array.isArray(m[S[x]])&&(m[S[x]]=[])}return m},once:function(l,h,d){var m=this;return m.on(l,h,d,1),m},_emit:function(l,h,d){for(var m=this,_=m["_on"+l],x=_.length-1;x>=0;x--)(!_[x].id||_[x].id===h||l==="load")&&(setTimeout(function(T){T.call(this,h,d)}.bind(m,_[x].fn),0),_[x].once&&m.off(l,_[x].fn,_[x].id));return m._loadQueue(l),m},_loadQueue:function(l){var h=this;if(h._queue.length>0){var d=h._queue[0];d.event===l&&(h._queue.shift(),h._loadQueue()),l||d.action()}return h},_ended:function(l){var h=this,d=l._sprite;if(!h._webAudio&&l._node&&!l._node.paused&&!l._node.ended&&l._node.currentTime<l._stop)return setTimeout(h._ended.bind(h,l),100),h;var m=!!(l._loop||h._sprite[d][2]);if(h._emit("end",l._id),!h._webAudio&&m&&h.stop(l._id,!0).play(l._id),h._webAudio&&m){h._emit("play",l._id),l._seek=l._start||0,l._rateSeek=0,l._playStart=t.ctx.currentTime;var _=(l._stop-l._start)*1e3/Math.abs(l._rate);h._endTimers[l._id]=setTimeout(h._ended.bind(h,l),_)}return h._webAudio&&!m&&(l._paused=!0,l._ended=!0,l._seek=l._start||0,l._rateSeek=0,h._clearTimer(l._id),h._cleanBuffer(l._node),t._autoSuspend()),!h._webAudio&&!m&&h.stop(l._id,!0),h},_clearTimer:function(l){var h=this;if(h._endTimers[l]){if(typeof h._endTimers[l]!="function")clearTimeout(h._endTimers[l]);else{var d=h._soundById(l);d&&d._node&&d._node.removeEventListener("ended",h._endTimers[l],!1)}delete h._endTimers[l]}return h},_soundById:function(l){for(var h=this,d=0;d<h._sounds.length;d++)if(l===h._sounds[d]._id)return h._sounds[d];return null},_inactiveSound:function(){var l=this;l._drain();for(var h=0;h<l._sounds.length;h++)if(l._sounds[h]._ended)return l._sounds[h].reset();return new i(l)},_drain:function(){var l=this,h=l._pool,d=0,m=0;if(!(l._sounds.length<h)){for(m=0;m<l._sounds.length;m++)l._sounds[m]._ended&&d++;for(m=l._sounds.length-1;m>=0;m--){if(d<=h)return;l._sounds[m]._ended&&(l._webAudio&&l._sounds[m]._node&&l._sounds[m]._node.disconnect(0),l._sounds.splice(m,1),d--)}}},_getSoundIds:function(l){var h=this;if(typeof l>"u"){for(var d=[],m=0;m<h._sounds.length;m++)d.push(h._sounds[m]._id);return d}else return[l]},_refreshBuffer:function(l){var h=this;return l._node.bufferSource=t.ctx.createBufferSource(),l._node.bufferSource.buffer=n[h._src],l._panner?l._node.bufferSource.connect(l._panner):l._node.bufferSource.connect(l._node),l._node.bufferSource.loop=l._loop,l._loop&&(l._node.bufferSource.loopStart=l._start||0,l._node.bufferSource.loopEnd=l._stop||0),l._node.bufferSource.playbackRate.setValueAtTime(l._rate,t.ctx.currentTime),h},_cleanBuffer:function(l){var h=this,d=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(t._scratchBuffer&&l.bufferSource&&(l.bufferSource.onended=null,l.bufferSource.disconnect(0),d))try{l.bufferSource.buffer=t._scratchBuffer}catch{}return l.bufferSource=null,h},_clearSound:function(l){var h=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);h||(l.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(l){this._parent=l,this.init()};i.prototype={init:function(){var l=this,h=l._parent;return l._muted=h._muted,l._loop=h._loop,l._volume=h._volume,l._rate=h._rate,l._seek=0,l._paused=!0,l._ended=!0,l._sprite="__default",l._id=++t._counter,h._sounds.push(l),l.create(),l},create:function(){var l=this,h=l._parent,d=t._muted||l._muted||l._parent._muted?0:l._volume;return h._webAudio?(l._node=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),l._node.gain.setValueAtTime(d,t.ctx.currentTime),l._node.paused=!0,l._node.connect(t.masterGain)):t.noAudio||(l._node=t._obtainHtml5Audio(),l._errorFn=l._errorListener.bind(l),l._node.addEventListener("error",l._errorFn,!1),l._loadFn=l._loadListener.bind(l),l._node.addEventListener(t._canPlayEvent,l._loadFn,!1),l._endFn=l._endListener.bind(l),l._node.addEventListener("ended",l._endFn,!1),l._node.src=h._src,l._node.preload=h._preload===!0?"auto":h._preload,l._node.volume=d*t.volume(),l._node.load()),l},reset:function(){var l=this,h=l._parent;return l._muted=h._muted,l._loop=h._loop,l._volume=h._volume,l._rate=h._rate,l._seek=0,l._rateSeek=0,l._paused=!0,l._ended=!0,l._sprite="__default",l._id=++t._counter,l},_errorListener:function(){var l=this;l._parent._emit("loaderror",l._id,l._node.error?l._node.error.code:0),l._node.removeEventListener("error",l._errorFn,!1)},_loadListener:function(){var l=this,h=l._parent;h._duration=Math.ceil(l._node.duration*10)/10,Object.keys(h._sprite).length===0&&(h._sprite={__default:[0,h._duration*1e3]}),h._state!=="loaded"&&(h._state="loaded",h._emit("load"),h._loadQueue()),l._node.removeEventListener(t._canPlayEvent,l._loadFn,!1)},_endListener:function(){var l=this,h=l._parent;h._duration===1/0&&(h._duration=Math.ceil(l._node.duration*10)/10,h._sprite.__default[1]===1/0&&(h._sprite.__default[1]=h._duration*1e3),h._ended(l)),l._node.removeEventListener("ended",l._endFn,!1)}};var n={},o=function(l){var h=l._src;if(n[h]){l._duration=n[h].duration,f(l);return}if(/^data:[^;]+;base64,/.test(h)){for(var d=atob(h.split(",")[1]),m=new Uint8Array(d.length),_=0;_<d.length;++_)m[_]=d.charCodeAt(_);c(m.buffer,l)}else{var x=new XMLHttpRequest;x.open(l._xhr.method,h,!0),x.withCredentials=l._xhr.withCredentials,x.responseType="arraybuffer",l._xhr.headers&&Object.keys(l._xhr.headers).forEach(function(T){x.setRequestHeader(T,l._xhr.headers[T])}),x.onload=function(){var T=(x.status+"")[0];if(T!=="0"&&T!=="2"&&T!=="3"){l._emit("loaderror",null,"Failed loading audio file with status: "+x.status+".");return}c(x.response,l)},x.onerror=function(){l._webAudio&&(l._html5=!0,l._webAudio=!1,l._sounds=[],delete n[h],l.load())},a(x)}},a=function(l){try{l.send()}catch{l.onerror()}},c=function(l,h){var d=function(){h._emit("loaderror",null,"Decoding audio data failed.")},m=function(_){_&&h._sounds.length>0?(n[h._src]=_,f(h,_)):d()};typeof Promise<"u"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(l).then(m).catch(d):t.ctx.decodeAudioData(l,m,d)},f=function(l,h){h&&!l._duration&&(l._duration=h.duration),Object.keys(l._sprite).length===0&&(l._sprite={__default:[0,l._duration*1e3]}),l._state!=="loaded"&&(l._state="loaded",l._emit("load"),l._loadQueue())},p=function(){if(t.usingWebAudio){try{typeof AudioContext<"u"?t.ctx=new AudioContext:typeof webkitAudioContext<"u"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var l=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),h=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),d=h?parseInt(h[1],10):null;if(l&&d&&d<9){var m=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!m&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:t,Howl:r}}),typeof wh<"u"&&(wh.Howler=t,wh.Howl=r),typeof global<"u"?(global.HowlerGlobal=e,global.Howler=t,global.Howl=r,global.Sound=i):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=t,window.Howl=r,window.Sound=i)})();(function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var r=this;if(!r.ctx||!r.ctx.listener)return r;for(var i=r._howls.length-1;i>=0;i--)r._howls[i].stereo(t);return r},HowlerGlobal.prototype.pos=function(t,r,i){var n=this;if(!n.ctx||!n.ctx.listener)return n;if(r=typeof r!="number"?n._pos[1]:r,i=typeof i!="number"?n._pos[2]:i,typeof t=="number")n._pos=[t,r,i],typeof n.ctx.listener.positionX<"u"?(n.ctx.listener.positionX.setTargetAtTime(n._pos[0],Howler.ctx.currentTime,.1),n.ctx.listener.positionY.setTargetAtTime(n._pos[1],Howler.ctx.currentTime,.1),n.ctx.listener.positionZ.setTargetAtTime(n._pos[2],Howler.ctx.currentTime,.1)):n.ctx.listener.setPosition(n._pos[0],n._pos[1],n._pos[2]);else return n._pos;return n},HowlerGlobal.prototype.orientation=function(t,r,i,n,o,a){var c=this;if(!c.ctx||!c.ctx.listener)return c;var f=c._orientation;if(r=typeof r!="number"?f[1]:r,i=typeof i!="number"?f[2]:i,n=typeof n!="number"?f[3]:n,o=typeof o!="number"?f[4]:o,a=typeof a!="number"?f[5]:a,typeof t=="number")c._orientation=[t,r,i,n,o,a],typeof c.ctx.listener.forwardX<"u"?(c.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),c.ctx.listener.forwardY.setTargetAtTime(r,Howler.ctx.currentTime,.1),c.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),c.ctx.listener.upX.setTargetAtTime(n,Howler.ctx.currentTime,.1),c.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),c.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):c.ctx.listener.setOrientation(t,r,i,n,o,a);else return f;return c},Howl.prototype.init=function(t){return function(r){var i=this;return i._orientation=r.orientation||[1,0,0],i._stereo=r.stereo||null,i._pos=r.pos||null,i._pannerAttr={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:360,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:360,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:0,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:"inverse",maxDistance:typeof r.maxDistance<"u"?r.maxDistance:1e4,panningModel:typeof r.panningModel<"u"?r.panningModel:"HRTF",refDistance:typeof r.refDistance<"u"?r.refDistance:1,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:1},i._onstereo=r.onstereo?[{fn:r.onstereo}]:[],i._onpos=r.onpos?[{fn:r.onpos}]:[],i._onorientation=r.onorientation?[{fn:r.onorientation}]:[],t.call(this,r)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,r){var i=this;if(!i._webAudio)return i;if(i._state!=="loaded")return i._queue.push({event:"stereo",action:function(){i.stereo(t,r)}}),i;var n=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof r>"u")if(typeof t=="number")i._stereo=t,i._pos=[t,0,0];else return i._stereo;for(var o=i._getSoundIds(r),a=0;a<o.length;a++){var c=i._soundById(o[a]);if(c)if(typeof t=="number")c._stereo=t,c._pos=[t,0,0],c._node&&(c._pannerAttr.panningModel="equalpower",(!c._panner||!c._panner.pan)&&e(c,n),n==="spatial"?typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):c._panner.setPosition(t,0,0):c._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),i._emit("stereo",c._id);else return c._stereo}return i},Howl.prototype.pos=function(t,r,i,n){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"pos",action:function(){o.pos(t,r,i,n)}}),o;if(r=typeof r!="number"?0:r,i=typeof i!="number"?-.5:i,typeof n>"u")if(typeof t=="number")o._pos=[t,r,i];else return o._pos;for(var a=o._getSoundIds(n),c=0;c<a.length;c++){var f=o._soundById(a[c]);if(f)if(typeof t=="number")f._pos=[t,r,i],f._node&&((!f._panner||f._panner.pan)&&e(f,"spatial"),typeof f._panner.positionX<"u"?(f._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),f._panner.positionY.setValueAtTime(r,Howler.ctx.currentTime),f._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):f._panner.setPosition(t,r,i)),o._emit("pos",f._id);else return f._pos}return o},Howl.prototype.orientation=function(t,r,i,n){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"orientation",action:function(){o.orientation(t,r,i,n)}}),o;if(r=typeof r!="number"?o._orientation[1]:r,i=typeof i!="number"?o._orientation[2]:i,typeof n>"u")if(typeof t=="number")o._orientation=[t,r,i];else return o._orientation;for(var a=o._getSoundIds(n),c=0;c<a.length;c++){var f=o._soundById(a[c]);if(f)if(typeof t=="number")f._orientation=[t,r,i],f._node&&(f._panner||(f._pos||(f._pos=o._pos||[0,0,-.5]),e(f,"spatial")),typeof f._panner.orientationX<"u"?(f._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),f._panner.orientationY.setValueAtTime(r,Howler.ctx.currentTime),f._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):f._panner.setOrientation(t,r,i)),o._emit("orientation",f._id);else return f._orientation}return o},Howl.prototype.pannerAttr=function(){var t=this,r=arguments,i,n,o;if(!t._webAudio)return t;if(r.length===0)return t._pannerAttr;if(r.length===1)if(typeof r[0]=="object")i=r[0],typeof n>"u"&&(i.pannerAttr||(i.pannerAttr={coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,panningModel:i.panningModel}),t._pannerAttr={coneInnerAngle:typeof i.pannerAttr.coneInnerAngle<"u"?i.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof i.pannerAttr.coneOuterAngle<"u"?i.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof i.pannerAttr.coneOuterGain<"u"?i.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof i.pannerAttr.distanceModel<"u"?i.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof i.pannerAttr.maxDistance<"u"?i.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof i.pannerAttr.refDistance<"u"?i.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof i.pannerAttr.rolloffFactor<"u"?i.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof i.pannerAttr.panningModel<"u"?i.pannerAttr.panningModel:t._panningModel});else return o=t._soundById(parseInt(r[0],10)),o?o._pannerAttr:t._pannerAttr;else r.length===2&&(i=r[0],n=parseInt(r[1],10));for(var a=t._getSoundIds(n),c=0;c<a.length;c++)if(o=t._soundById(a[c]),o){var f=o._pannerAttr;f={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:f.coneInnerAngle,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:f.coneOuterAngle,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:f.coneOuterGain,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:f.distanceModel,maxDistance:typeof i.maxDistance<"u"?i.maxDistance:f.maxDistance,refDistance:typeof i.refDistance<"u"?i.refDistance:f.refDistance,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:f.rolloffFactor,panningModel:typeof i.panningModel<"u"?i.panningModel:f.panningModel};var p=o._panner;p?(p.coneInnerAngle=f.coneInnerAngle,p.coneOuterAngle=f.coneOuterAngle,p.coneOuterGain=f.coneOuterGain,p.distanceModel=f.distanceModel,p.maxDistance=f.maxDistance,p.refDistance=f.refDistance,p.rolloffFactor=f.rolloffFactor,p.panningModel=f.panningModel):(o._pos||(o._pos=t._pos||[0,0,-.5]),e(o,"spatial"))}return t},Sound.prototype.init=function(t){return function(){var r=this,i=r._parent;r._orientation=i._orientation,r._stereo=i._stereo,r._pos=i._pos,r._pannerAttr=i._pannerAttr,t.call(this),r._stereo?i.stereo(r._stereo):r._pos&&i.pos(r._pos[0],r._pos[1],r._pos[2],r._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var r=this,i=r._parent;return r._orientation=i._orientation,r._stereo=i._stereo,r._pos=i._pos,r._pannerAttr=i._pannerAttr,r._stereo?i.stereo(r._stereo):r._pos?i.pos(r._pos[0],r._pos[1],r._pos[2],r._id):r._panner&&(r._panner.disconnect(0),r._panner=void 0,i._refreshBuffer(r)),t.call(this)}}(Sound.prototype.reset);var e=function(t,r){r=r||"spatial",r==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()});var hr=(e=>(e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2",e))(hr||{}),Yu=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.WEBGL=1]="WEBGL",e[e.CANVAS=2]="CANVAS",e))(Yu||{}),gl=(e=>(e[e.COLOR=16384]="COLOR",e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL",e))(gl||{}),ft=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR",e))(ft||{}),Ze=(e=>(e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e))(Ze||{}),tt=(e=>(e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.RG=33319]="RG",e[e.RED=6403]="RED",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e))(tt||{}),xi=(e=>(e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e))(xi||{}),at=(e=>(e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.BYTE=5120]="BYTE",e[e.SHORT=5122]="SHORT",e[e.INT=5124]="INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.HALF_FLOAT=36193]="HALF_FLOAT",e))(at||{}),_l=(e=>(e[e.FLOAT=0]="FLOAT",e[e.INT=1]="INT",e[e.UINT=2]="UINT",e))(_l||{}),br=(e=>(e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR",e))(br||{}),ur=(e=>(e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e))(ur||{}),Se=(e=>(e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON",e[e.ON_MANUAL=3]="ON_MANUAL",e))(Se||{}),ue=(e=>(e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",e))(ue||{}),cr=(e=>(e[e.NO=0]="NO",e[e.YES=1]="YES",e[e.AUTO=2]="AUTO",e[e.BLEND=0]="BLEND",e[e.CLEAR=1]="CLEAR",e[e.BLIT=2]="BLIT",e))(cr||{}),xl=(e=>(e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL",e))(xl||{}),Ue=(e=>(e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp",e))(Ue||{}),ie=(e=>(e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE",e[e.COLOR=4]="COLOR",e))(ie||{});var Lt=(e=>(e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH",e))(Lt||{}),Qe=(e=>(e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e))(Qe||{});var ju={createCanvas:(e,t)=>{let r=document.createElement("canvas");return r.width=e,r.height=t,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>new DOMParser().parseFromString(e,"text/xml")};var W={ADAPTER:ju,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Ku=/iPhone/i,sm=/iPod/i,om=/iPad/i,am=/\biOS-universal(?:.+)Mac\b/i,qu=/\bAndroid(?:.+)Mobile\b/i,lm=/Android/i,fs=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,vl=/Silk/i,vi=/Windows Phone/i,hm=/\bWindows(?:.+)ARM\b/i,um=/BlackBerry/i,cm=/BB10/i,fm=/Opera Mini/i,dm=/\b(CriOS|Chrome)(?:.+)Mobile/i,pm=/Mobile(?:.+)Firefox\b/i,mm=function(e){return typeof e<"u"&&e.platform==="MacIntel"&&typeof e.maxTouchPoints=="number"&&e.maxTouchPoints>1&&typeof MSStream>"u"};function ME(e){return function(t){return t.test(e)}}function yo(e){var t={userAgent:"",platform:"",maxTouchPoints:0};!e&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof e=="string"?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0});var r=t.userAgent,i=r.split("[FBAN");typeof i[1]<"u"&&(r=i[0]),i=r.split("Twitter"),typeof i[1]<"u"&&(r=i[0]);var n=ME(r),o={apple:{phone:n(Ku)&&!n(vi),ipod:n(sm),tablet:!n(Ku)&&(n(om)||mm(t))&&!n(vi),universal:n(am),device:(n(Ku)||n(sm)||n(om)||n(am)||mm(t))&&!n(vi)},amazon:{phone:n(fs),tablet:!n(fs)&&n(vl),device:n(fs)||n(vl)},android:{phone:!n(vi)&&n(fs)||!n(vi)&&n(qu),tablet:!n(vi)&&!n(fs)&&!n(qu)&&(n(vl)||n(lm)),device:!n(vi)&&(n(fs)||n(vl)||n(qu)||n(lm))||n(/\bokhttp\b/i)},windows:{phone:n(vi),tablet:n(hm),device:n(vi)||n(hm)},other:{blackberry:n(um),blackberry10:n(cm),opera:n(fm),firefox:n(pm),chrome:n(dm),device:n(um)||n(cm)||n(fm)||n(pm)||n(dm)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}var BE=yo.default??yo,Ar=BE(globalThis.navigator);var et={};RE(et,{BaseTextureCache:()=>Ge,BoundingBox:()=>ys,CanvasRenderTarget:()=>Pl,DATA_URI:()=>Il,EventEmitter:()=>Yi.default,ProgramCache:()=>Do,TextureCache:()=>Te,clearTextureCache:()=>hg,correctBlendMode:()=>tg,createIndicesForQuads:()=>ng,decomposeDataUri:()=>dg,deprecation:()=>gt,destroyTextureCache:()=>lg,determineCrossOrigin:()=>Dl,earcut:()=>pg.default,getBufferType:()=>zi,getCanvasBoundingBox:()=>Ml,getResolutionOfUrl:()=>Lo,hex2rgb:()=>qm,hex2string:()=>Zm,interleaveTypedArrays:()=>sg,isMobile:()=>Ar,isPow2:()=>Mo,isWebGLSupported:()=>Al,log2:()=>Bo,nextPow2:()=>$i,path:()=>sc,premultiplyBlendMode:()=>Po,premultiplyRgba:()=>eg,premultiplyTint:()=>rg,premultiplyTintToRgba:()=>ig,removeItems:()=>Rl,rgb2hex:()=>Jm,sayHello:()=>Nm,sign:()=>og,skipHello:()=>Om,string2hex:()=>Qm,trimCanvas:()=>fg,uid:()=>ti,url:()=>bl});W.RETINA_PREFIX=/@([0-9\.]+)x/;W.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Yi=_i(_m(),1),pg=_i(wm(),1);var xs=_i(Lm(),1),bl={parse:xs.parse,format:xs.format,resolve:xs.resolve};function Or(e){if(typeof e!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(e)}`)}function Io(e){return e.split("?")[0].split("#")[0]}function hS(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function uS(e,t,r){return e.replace(new RegExp(hS(t),"g"),r)}function cS(e,t){let r="",i=0,n=-1,o=0,a=-1;for(let c=0;c<=e.length;++c){if(c<e.length)a=e.charCodeAt(c);else{if(a===47)break;a=47}if(a===47){if(!(n===c-1||o===1))if(n!==c-1&&o===2){if(r.length<2||i!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){let f=r.lastIndexOf("/");if(f!==r.length-1){f===-1?(r="",i=0):(r=r.slice(0,f),i=r.length-1-r.lastIndexOf("/")),n=c,o=0;continue}}else if(r.length===2||r.length===1){r="",i=0,n=c,o=0;continue}}t&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+=`/${e.slice(n+1,c)}`:r=e.slice(n+1,c),i=c-n-1;n=c,o=0}else a===46&&o!==-1?++o:o=-1}return r}var sc={toPosix(e){return uS(e,"\\","/")},isUrl(e){return/^https?:/.test(this.toPosix(e))},isDataUrl(e){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e)},hasProtocol(e){return/^[^/:]+:\//.test(this.toPosix(e))},getProtocol(e){Or(e),e=this.toPosix(e);let t="",r=/^file:\/\/\//.exec(e),i=/^[^/:]+:\/\//.exec(e),n=/^[^/:]+:\//.exec(e);if(r||i||n){let o=r?.[0]||i?.[0]||n?.[0];t=o,e=e.slice(o.length)}return t},toAbsolute(e,t,r){if(this.isDataUrl(e))return e;let i=Io(this.toPosix(t??W.ADAPTER.getBaseUrl())),n=Io(this.toPosix(r??this.rootname(i)));return Or(e),e=this.toPosix(e),e.startsWith("/")?sc.join(n,e.slice(1)):this.isAbsolute(e)?e:this.join(i,e)},normalize(e){if(e=this.toPosix(e),Or(e),e.length===0)return".";let t="",r=e.startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));let i=e.endsWith("/");return e=cS(e,!1),e.length>0&&i&&(e+="/"),r?`/${e}`:t+e},isAbsolute(e){return Or(e),e=this.toPosix(e),this.hasProtocol(e)?!0:e.startsWith("/")},join(...e){if(e.length===0)return".";let t;for(let r=0;r<e.length;++r){let i=e[r];if(Or(i),i.length>0)if(t===void 0)t=i;else{let n=e[r-1]??"";this.extname(n)?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(e){if(Or(e),e.length===0)return".";e=this.toPosix(e);let t=e.charCodeAt(0),r=t===47,i=-1,n=!0,o=this.getProtocol(e),a=e;e=e.slice(o.length);for(let c=e.length-1;c>=1;--c)if(t=e.charCodeAt(c),t===47){if(!n){i=c;break}}else n=!1;return i===-1?r?"/":this.isUrl(a)?o+e:o:r&&i===1?"//":o+e.slice(0,i)},rootname(e){Or(e),e=this.toPosix(e);let t="";if(e.startsWith("/")?t="/":t=this.getProtocol(e),this.isUrl(e)){let r=e.indexOf("/",t.length);r!==-1?t=e.slice(0,r):t=e,t.endsWith("/")||(t+="/")}return t},basename(e,t){Or(e),t&&Or(t),e=Io(this.toPosix(e));let r=0,i=-1,n=!0,o;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let a=t.length-1,c=-1;for(o=e.length-1;o>=0;--o){let f=e.charCodeAt(o);if(f===47){if(!n){r=o+1;break}}else c===-1&&(n=!1,c=o+1),a>=0&&(f===t.charCodeAt(a)?--a===-1&&(i=o):(a=-1,i=c))}return r===i?i=c:i===-1&&(i=e.length),e.slice(r,i)}for(o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===47){if(!n){r=o+1;break}}else i===-1&&(n=!1,i=o+1);return i===-1?"":e.slice(r,i)},extname(e){Or(e),e=Io(this.toPosix(e));let t=-1,r=0,i=-1,n=!0,o=0;for(let a=e.length-1;a>=0;--a){let c=e.charCodeAt(a);if(c===47){if(!n){r=a+1;break}continue}i===-1&&(n=!1,i=a+1),c===46?t===-1?t=a:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||i===-1||o===0||o===1&&t===i-1&&t===r+1?"":e.slice(t,i)},parse(e){Or(e);let t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;e=Io(this.toPosix(e));let r=e.charCodeAt(0),i=this.isAbsolute(e),n,o="";t.root=this.rootname(e),i||this.hasProtocol(e)?n=1:n=0;let a=-1,c=0,f=-1,p=!0,l=e.length-1,h=0;for(;l>=n;--l){if(r=e.charCodeAt(l),r===47){if(!p){c=l+1;break}continue}f===-1&&(p=!1,f=l+1),r===46?a===-1?a=l:h!==1&&(h=1):a!==-1&&(h=-1)}return a===-1||f===-1||h===0||h===1&&a===f-1&&a===c+1?f!==-1&&(c===0&&i?t.base=t.name=e.slice(1,f):t.base=t.name=e.slice(c,f)):(c===0&&i?(t.name=e.slice(1,a),t.base=e.slice(1,f)):(t.name=e.slice(c,a),t.base=e.slice(c,f)),t.ext=e.slice(a,f)),t.dir=this.dirname(e),o&&(t.dir=o+t.dir),t},sep:"/",delimiter:":"};var Fm={};function gt(e,t,r=3){if(Fm[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`):(i=i.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${e}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`),console.warn(i))),Fm[t]=!0}function Om(){gt("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function Nm(){gt("7.0.0",`sayHello is deprecated, please use Renderer's "hello" option`)}var oc;function Al(){return typeof oc>"u"&&(oc=function(){let t={stencil:!0,failIfMajorPerformanceCaveat:W.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!W.ADAPTER.getWebGLRenderingContext())return!1;let r=W.ADAPTER.createCanvas(),i=r.getContext("webgl",t)||r.getContext("experimental-webgl",t),n=!!i?.getContextAttributes()?.stencil;if(i){let o=i.getExtension("WEBGL_lose_context");o&&o.loseContext()}return i=null,n}catch{return!1}}()),oc}var fS={grad:.9,turn:360,rad:360/(2*Math.PI)},yi=function(e){return typeof e=="string"?e.length>0:typeof e=="number"},ye=function(e,t,r){return t===void 0&&(t=0),r===void 0&&(r=Math.pow(10,t)),Math.round(r*e)/r+0},Ir=function(e,t,r){return t===void 0&&(t=0),r===void 0&&(r=1),e>r?r:e>t?e:t},zm=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},Um=function(e){return{r:Ir(e.r,0,255),g:Ir(e.g,0,255),b:Ir(e.b,0,255),a:Ir(e.a)}},ac=function(e){return{r:ye(e.r),g:ye(e.g),b:ye(e.b),a:ye(e.a,3)}},dS=/^#([0-9a-f]{3,8})$/i,Cl=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},$m=function(e){var t=e.r,r=e.g,i=e.b,n=e.a,o=Math.max(t,r,i),a=o-Math.min(t,r,i),c=a?o===t?(r-i)/a:o===r?2+(i-t)/a:4+(t-r)/a:0;return{h:60*(c<0?c+6:c),s:o?a/o*100:0,v:o/255*100,a:n}},Ym=function(e){var t=e.h,r=e.s,i=e.v,n=e.a;t=t/360*6,r/=100,i/=100;var o=Math.floor(t),a=i*(1-r),c=i*(1-(t-o)*r),f=i*(1-(1-t+o)*r),p=o%6;return{r:255*[i,c,a,a,f,i][p],g:255*[f,i,i,c,a,a][p],b:255*[a,a,f,i,i,c][p],a:n}},km=function(e){return{h:zm(e.h),s:Ir(e.s,0,100),l:Ir(e.l,0,100),a:Ir(e.a)}},Gm=function(e){return{h:ye(e.h),s:ye(e.s),l:ye(e.l),a:ye(e.a,3)}},Hm=function(e){return Ym((r=(t=e).s,{h:t.h,s:(r*=((i=t.l)<50?i:100-i)/100)>0?2*r/(i+r)*100:0,v:i+r,a:t.a}));var t,r,i},Ro=function(e){return{h:(t=$m(e)).h,s:(n=(200-(r=t.s))*(i=t.v)/100)>0&&n<200?r*i/100/(n<=100?n:200-n)*100:0,l:n/2,a:t.a};var t,r,i,n},pS=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,mS=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,gS=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,_S=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,uc={string:[[function(e){var t=dS.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:e.length===4?ye(parseInt(e[3]+e[3],16)/255,2):1}:e.length===6||e.length===8?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:e.length===8?ye(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=gS.exec(e)||_S.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:Um({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=pS.exec(e)||mS.exec(e);if(!t)return null;var r,i,n=km({h:(r=t[1],i=t[2],i===void 0&&(i="deg"),Number(r)*(fS[i]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return Hm(n)},"hsl"]],object:[[function(e){var t=e.r,r=e.g,i=e.b,n=e.a,o=n===void 0?1:n;return yi(t)&&yi(r)&&yi(i)?Um({r:Number(t),g:Number(r),b:Number(i),a:Number(o)}):null},"rgb"],[function(e){var t=e.h,r=e.s,i=e.l,n=e.a,o=n===void 0?1:n;if(!yi(t)||!yi(r)||!yi(i))return null;var a=km({h:Number(t),s:Number(r),l:Number(i),a:Number(o)});return Hm(a)},"hsl"],[function(e){var t=e.h,r=e.s,i=e.v,n=e.a,o=n===void 0?1:n;if(!yi(t)||!yi(r)||!yi(i))return null;var a=function(c){return{h:zm(c.h),s:Ir(c.s,0,100),v:Ir(c.v,0,100),a:Ir(c.a)}}({h:Number(t),s:Number(r),v:Number(i),a:Number(o)});return Ym(a)},"hsv"]]},Vm=function(e,t){for(var r=0;r<t.length;r++){var i=t[r][0](e);if(i)return[i,t[r][1]]}return[null,void 0]},xS=function(e){return typeof e=="string"?Vm(e.trim(),uc.string):typeof e=="object"&&e!==null?Vm(e,uc.object):[null,void 0]};var lc=function(e,t){var r=Ro(e);return{h:r.h,s:Ir(r.s+100*t,0,100),l:r.l,a:r.a}},hc=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},Wm=function(e,t){var r=Ro(e);return{h:r.h,s:r.s,l:Ir(r.l+100*t,0,100),a:r.a}},cc=function(){function e(t){this.parsed=xS(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return this.parsed!==null},e.prototype.brightness=function(){return ye(hc(this.rgba),2)},e.prototype.isDark=function(){return hc(this.rgba)<.5},e.prototype.isLight=function(){return hc(this.rgba)>=.5},e.prototype.toHex=function(){return t=ac(this.rgba),r=t.r,i=t.g,n=t.b,a=(o=t.a)<1?Cl(ye(255*o)):"","#"+Cl(r)+Cl(i)+Cl(n)+a;var t,r,i,n,o,a},e.prototype.toRgb=function(){return ac(this.rgba)},e.prototype.toRgbString=function(){return t=ac(this.rgba),r=t.r,i=t.g,n=t.b,(o=t.a)<1?"rgba("+r+", "+i+", "+n+", "+o+")":"rgb("+r+", "+i+", "+n+")";var t,r,i,n,o},e.prototype.toHsl=function(){return Gm(Ro(this.rgba))},e.prototype.toHslString=function(){return t=Gm(Ro(this.rgba)),r=t.h,i=t.s,n=t.l,(o=t.a)<1?"hsla("+r+", "+i+"%, "+n+"%, "+o+")":"hsl("+r+", "+i+"%, "+n+"%)";var t,r,i,n,o},e.prototype.toHsv=function(){return t=$m(this.rgba),{h:ye(t.h),s:ye(t.s),v:ye(t.v),a:ye(t.a,3)};var t},e.prototype.invert=function(){return Nr({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},e.prototype.saturate=function(t){return t===void 0&&(t=.1),Nr(lc(this.rgba,t))},e.prototype.desaturate=function(t){return t===void 0&&(t=.1),Nr(lc(this.rgba,-t))},e.prototype.grayscale=function(){return Nr(lc(this.rgba,-1))},e.prototype.lighten=function(t){return t===void 0&&(t=.1),Nr(Wm(this.rgba,t))},e.prototype.darken=function(t){return t===void 0&&(t=.1),Nr(Wm(this.rgba,-t))},e.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},e.prototype.alpha=function(t){return typeof t=="number"?Nr({r:(r=this.rgba).r,g:r.g,b:r.b,a:t}):ye(this.rgba.a,3);var r},e.prototype.hue=function(t){var r=Ro(this.rgba);return typeof t=="number"?Nr({h:t,s:r.s,l:r.l,a:r.a}):ye(r.h)},e.prototype.isEqual=function(t){return this.toHex()===Nr(t).toHex()},e}(),Nr=function(e){return e instanceof cc?e:new cc(e)},Xm=[],jm=function(e){e.forEach(function(t){Xm.indexOf(t)<0&&(t(cc,uc),Xm.push(t))})};function Km(e,t){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var n in r)i[r[n]]=n;var o={};e.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var c,f,p=i[this.toHex()];if(p)return p;if(a?.closest){var l=this.toRgb(),h=1/0,d="black";if(!o.length)for(var m in r)o[m]=new e(r[m]).toRgb();for(var _ in r){var x=(c=l,f=o[_],Math.pow(c.r-f.r,2)+Math.pow(c.g-f.g,2)+Math.pow(c.b-f.b,2));x<h&&(h=x,d=_)}return d}},t.string.push([function(a){var c=a.toLowerCase(),f=c==="transparent"?"#0000":r[c];return f?new e(f).toRgb():null},"name"])}jm([Km]);var vs=class{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof vs)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,t){let r=typeof e;if(r!==typeof t)return!1;if(r==="number"||r==="string"||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length!==t.length?!1:e.every((n,o)=>n===t[o]);if(e!==null&&t!==null){let n=Object.keys(e),o=Object.keys(t);return n.length!==o.length?!1:n.every(a=>e[a]===t[a])}return e===t}toRgba(){let[e,t,r,i]=this._components;return{r:e,g:t,b:r,a:i}}toRgb(){let[e,t,r]=this._components;return{r:e,g:t,b:r}}toRgbaString(){let[e,t,r]=this.toUint8RgbArray();return`rgba(${e},${t},${r},${this.alpha})`}toUint8RgbArray(e){let[t,r,i]=this._components;return e=e??[],e[0]=Math.round(t*255),e[1]=Math.round(r*255),e[2]=Math.round(i*255),e}toRgbArray(e){e=e??[];let[t,r,i]=this._components;return e[0]=t,e[1]=r,e[2]=i,e}toNumber(){return this._int}toLittleEndianNumber(){let e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){let[t,r,i,n]=vs.temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=r,this._components[2]*=i,this._components[3]*=n,this.refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e){if(e===1)return(e*255<<24)+this._int;if(e===0)return 0;let t=this._int>>16&255,r=this._int>>8&255,i=this._int&255;return t=t*e+.5|0,r=r*e+.5|0,i=i*e+.5|0,(e*255<<24)+(t<<16)+(r<<8)+i}toHex(){let e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){let t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(e){return this._components[3]=e,this}round(e){let[t,r,i]=this._components;return this._components.set([Math.min(255,t/e*e),Math.min(255,r/e*e),Math.min(255,i/e*e)]),this.refreshInt(),this._value=null,this}toArray(e){e=e??[];let[t,r,i,n]=this._components;return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e}normalize(e){let t;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){let r=e;t=[(r>>16&255)/255,(r>>8&255)/255,(r&255)/255,1]}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4&&e.every(r=>r<=1&&r>=0)){let[r,i,n,o=1]=e;t=[r,i,n,o]}else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4){let[r,i,n,o=255]=e;t=[r/255,i/255,n/255,o/255]}else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){let i=vs.HEX_PATTERN.exec(e);i&&(e=`#${i[2]}`)}let r=Nr(e);if(r.isValid()){let{r:i,g:n,b:o,a}=r.rgba;t=[i/255,n/255,o/255,a]}}if(t)this._components.set(t),this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._components.forEach((i,n)=>this._components[n]=Math.min(Math.max(i,0),1));let[e,t,r]=this._components;this._int=(e*255<<16)+(t*255<<8)+(r*255|0)}},pt=vs;pt.shared=new vs;pt.temp=new vs;pt.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;function qm(e,t=[]){return gt("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),pt.shared.setValue(e).toRgbArray(t)}function Zm(e){return gt("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),pt.shared.setValue(e).toHex()}function Qm(e){return gt("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),pt.shared.setValue(e).toNumber()}function Jm(e){return gt("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),pt.shared.setValue(e).toNumber()}function vS(){let e=[],t=[];for(let i=0;i<32;i++)e[i]=i,t[i]=i;e[ft.NORMAL_NPM]=ft.NORMAL,e[ft.ADD_NPM]=ft.ADD,e[ft.SCREEN_NPM]=ft.SCREEN,t[ft.NORMAL]=ft.NORMAL_NPM,t[ft.ADD]=ft.ADD_NPM,t[ft.SCREEN]=ft.SCREEN_NPM;let r=[];return r.push(t),r.push(e),r}var Po=vS();function tg(e,t){return Po[t?1:0][e]}function eg(e,t,r,i=!0){return gt("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),pt.shared.setValue(e).premultiply(t,i).toArray(r??new Float32Array(4))}function rg(e,t){return gt("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),pt.shared.setValue(e).toPremultiplied(t)}function ig(e,t,r,i=!0){return gt("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),pt.shared.setValue(e).premultiply(t,i).toArray(r??new Float32Array(4))}var Il=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function ng(e,t=null){let r=e*6;if(t=t||new Uint16Array(r),t.length!==r)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${r}`);for(let i=0,n=0;i<r;i+=6,n+=4)t[i+0]=n+0,t[i+1]=n+1,t[i+2]=n+2,t[i+3]=n+0,t[i+4]=n+2,t[i+5]=n+3;return t}function zi(e){if(e.BYTES_PER_ELEMENT===4)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(e.BYTES_PER_ELEMENT===2){if(e instanceof Uint16Array)return"Uint16Array"}else if(e.BYTES_PER_ELEMENT===1&&e instanceof Uint8Array)return"Uint8Array";return null}var yS={Float32Array,Uint32Array,Int32Array,Uint8Array};function sg(e,t){let r=0,i=0,n={};for(let f=0;f<e.length;f++)i+=t[f],r+=e[f].length;let o=new ArrayBuffer(r*4),a=null,c=0;for(let f=0;f<e.length;f++){let p=t[f],l=e[f],h=zi(l);n[h]||(n[h]=new yS[h](o)),a=n[h];for(let d=0;d<l.length;d++){let m=(d/p|0)*i+c,_=d%p;a[m+_]=l[d]}c+=p}return new Float32Array(o)}function $i(e){return e+=e===0?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1}function Mo(e){return!(e&e-1)&&!!e}function Bo(e){let t=(e>65535?1:0)<<4;e>>>=t;let r=(e>255?1:0)<<3;return e>>>=r,t|=r,r=(e>15?1:0)<<2,e>>>=r,t|=r,r=(e>3?1:0)<<1,e>>>=r,t|=r,t|e>>1}function Rl(e,t,r){let i=e.length,n;if(t>=i||r===0)return;r=t+r>i?i-t:r;let o=i-r;for(n=t;n<o;++n)e[n]=e[n+r];e.length=o}function og(e){return e===0?0:e<0?-1:1}var TS=0;function ti(){return++TS}var ag=class{constructor(e,t,r,i){this.left=e,this.top=t,this.right=r,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}},ys=ag;ys.EMPTY=new ag(0,0,0,0);var Do={},Te=Object.create(null),Ge=Object.create(null);function lg(){let e;for(e in Te)Te[e].destroy();for(e in Ge)Ge[e].destroy()}function hg(){let e;for(e in Te)delete Te[e];for(e in Ge)delete Ge[e]}var Pl=class{constructor(t,r,i){this._canvas=W.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||W.RESOLUTION,this.resize(t,r)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,r){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(r*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}};function ug(e,t,r){for(let i=0,n=4*r*t;i<t;++i,n+=4)if(e[n+3]!==0)return!1;return!0}function cg(e,t,r,i,n){let o=4*t;for(let a=i,c=i*o+4*r;a<=n;++a,c+=o)if(e[c+3]!==0)return!1;return!0}function Ml(e){let{width:t,height:r}=e,i=e.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");let o=i.getImageData(0,0,t,r).data,a=0,c=0,f=t-1,p=r-1;for(;c<r&&ug(o,t,c);)++c;if(c===r)return ys.EMPTY;for(;ug(o,t,p);)--p;for(;cg(o,t,a,c,p);)++a;for(;cg(o,t,f,c,p);)--f;return++f,++p,new ys(a,c,f,p)}function fg(e){let t=Ml(e),{width:r,height:i}=t,n=null;if(!t.isEmpty()){let o=e.getContext("2d");if(o===null)throw new TypeError("Failed to get canvas 2D context");n=o.getImageData(t.left,t.top,r,i)}return{width:r,height:i,data:n}}function dg(e){let t=Il.exec(e);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]}}var Bl;function Dl(e,t=globalThis.location){if(e.startsWith("data:"))return"";t=t||globalThis.location,Bl||(Bl=document.createElement("a")),Bl.href=e;let r=bl.parse(Bl.href),i=!r.port&&t.port===""||r.port===t.port;return r.hostname!==t.hostname||!i||r.protocol!==t.protocol?"anonymous":""}function Lo(e,t=1){let r=W.RETINA_PREFIX?.exec(e);return r?parseFloat(r[1]):t}var z=(e=>(e.Renderer="renderer",e.Application="application",e.RendererSystem="renderer-webgl-system",e.RendererPlugin="renderer-webgl-plugin",e.CanvasRendererSystem="renderer-canvas-system",e.CanvasRendererPlugin="renderer-canvas-plugin",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e))(z||{}),fc=e=>{if(typeof e=="function"||typeof e=="object"&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");e={...typeof e.extension!="object"?{type:e.extension}:e.extension,ref:e}}if(typeof e=="object")e={...e};else throw new Error("Invalid extension type");return typeof e.type=="string"&&(e.type=[e.type]),e},mg=(e,t)=>fc(e).priority??t,Z={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...e){return e.map(fc).forEach(t=>{t.type.forEach(r=>this._removeHandlers[r]?.(t))}),this},add(...e){return e.map(fc).forEach(t=>{t.type.forEach(r=>{let i=this._addHandlers,n=this._queue;i[r]?i[r](t):(n[r]=n[r]||[],n[r].push(t))})}),this},handle(e,t,r){let i=this._addHandlers,n=this._removeHandlers;if(i[e]||n[e])throw new Error(`Extension type ${e} already has a handler`);i[e]=t,n[e]=r;let o=this._queue;return o[e]&&(o[e].forEach(a=>t(a)),delete o[e]),this},handleByMap(e,t){return this.handle(e,r=>{t[r.name]=r.ref},r=>{delete t[r.name]})},handleByList(e,t,r=-1){return this.handle(e,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((n,o)=>mg(o,r)-mg(n,r)))},i=>{let n=t.indexOf(i.ref);n!==-1&&t.splice(n,1)})}};var ji=class{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}};var wS=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function ES(e){let t="";for(let r=0;r<e;++r)r>0&&(t+=`
else `),r<e-1&&(t+=`if(test == ${r}.0){}`);return t}function Ll(e,t){if(e===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");let r=t.createShader(t.FRAGMENT_SHADER);for(;;){let i=wS.replace(/%forloop%/gi,ES(e));if(t.shaderSource(r,i),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))e=e/2|0;else break}return e}var dc=0,pc=1,mc=2,gc=3,_c=4,xc=5,de=class{constructor(){this.data=0,this.blendMode=ft.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<dc)}set blend(t){!!(this.data&1<<dc)!==t&&(this.data^=1<<dc)}get offsets(){return!!(this.data&1<<pc)}set offsets(t){!!(this.data&1<<pc)!==t&&(this.data^=1<<pc)}get culling(){return!!(this.data&1<<mc)}set culling(t){!!(this.data&1<<mc)!==t&&(this.data^=1<<mc)}get depthTest(){return!!(this.data&1<<gc)}set depthTest(t){!!(this.data&1<<gc)!==t&&(this.data^=1<<gc)}get depthMask(){return!!(this.data&1<<xc)}set depthMask(t){!!(this.data&1<<xc)!==t&&(this.data^=1<<xc)}get clockwiseFrontFace(){return!!(this.data&1<<_c)}set clockwiseFrontFace(t){!!(this.data&1<<_c)!==t&&(this.data^=1<<_c)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==ft.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){let t=new de;return t.depthTest=!1,t.blend=!0,t}};var Ts=[];function ws(e,t){if(!e)return null;let r="";if(typeof e=="string"){let i=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);i&&(r=i[1].toLowerCase())}for(let i=Ts.length-1;i>=0;--i){let n=Ts[i];if(n.test&&n.test(e,r))return new n(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}var ae=class{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,r,i,n,o,a,c,f){if(arguments.length>8)throw new Error("max arguments reached");let{name:p,items:l}=this;this._aliasCount++;for(let h=0,d=l.length;h<d;h++)l[h][p](t,r,i,n,o,a,c,f);return l===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){let r=this.items.indexOf(t);return r!==-1&&(this.ensureNonAliasedItems(),this.items.splice(r,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}};Object.defineProperties(ae.prototype,{dispatch:{value:ae.prototype.emit},run:{value:ae.prototype.emit}});var fr=class{constructor(t=0,r=0){this._width=t,this._height=r,this.destroyed=!1,this.internal=!1,this.onResize=new ae("setRealSize"),this.onUpdate=new ae("update"),this.onError=new ae("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,r){(t!==this._width||r!==this._height)&&(this._width=t,this._height=r,this.onResize.emit(t,r))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,r,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,r){return!1}};var Je=class extends fr{constructor(t,r){let{width:i,height:n}=r||{};if(!i||!n)throw new Error("BufferResource width or height invalid");super(i,n),this.data=t}upload(t,r,i){let n=t.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===ue.UNPACK);let o=r.realWidth,a=r.realHeight;return i.width===o&&i.height===a?n.texSubImage2D(r.target,0,0,0,o,a,r.format,i.type,this.data):(i.width=o,i.height=a,n.texImage2D(r.target,0,i.internalFormat,o,a,0,r.format,i.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}};var SS={scaleMode:br.NEAREST,format:tt.RGBA,alphaMode:ue.NPM},Es=class extends Yi.default{constructor(e=null,t=null){super(),t=Object.assign({},Es.defaultOptions,t);let{alphaMode:r,mipmap:i,anisotropicLevel:n,scaleMode:o,width:a,height:c,wrapMode:f,format:p,type:l,target:h,resolution:d,resourceOptions:m}=t;e&&!(e instanceof fr)&&(e=ws(e,m),e.internal=!0),this.resolution=d||W.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((c||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=n,this._wrapMode=f,this._scaleMode=o,this.format=p,this.type=l,this.target=h,this.alphaMode=r,this.uid=ti(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&c>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let r;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,r=!0),r&&this.dirtyStyleId++,this}setSize(e,t,r){return r=r||this.resolution,this.setRealSize(e*r,t*r,r)}setRealSize(e,t,r){return this.resolution=r||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Mo(this.realWidth)&&Mo(this.realHeight)}setResolution(e){let t=this.resolution;return t===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Ge[this.cacheId],delete Te[this.cacheId],this.cacheId=null),this.dispose(),Es.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,t,r=W.STRICT_TEXTURE_CACHE){let i=typeof e=="string",n=null;if(i)n=e;else{if(!e._pixiId){let a=t?.pixiIdPrefix||"pixiid";e._pixiId=`${a}_${ti()}`}n=e._pixiId}let o=Ge[n];if(i&&r&&!o)throw new Error(`The cacheId "${n}" does not exist in BaseTextureCache.`);return o||(o=new Es(e,t),o.cacheId=n,Es.addToCache(o,n)),o}static fromBuffer(e,t,r,i){e=e||new Float32Array(t*r*4);let n=new Je(e,{width:t,height:r}),o=e instanceof Float32Array?at.FLOAT:at.UNSIGNED_BYTE;return new Es(n,Object.assign({},SS,i||{width:t,height:r,type:o}))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),Ge[t]&&Ge[t]!==e&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),Ge[t]=e)}static removeFromCache(e){if(typeof e=="string"){let t=Ge[e];if(t){let r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete Ge[e],t}}else if(e?.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)delete Ge[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}},lt=Es;lt.defaultOptions={mipmap:Se.POW2,anisotropicLevel:0,scaleMode:br.LINEAR,wrapMode:ur.CLAMP,alphaMode:ue.UNPACK,target:xi.TEXTURE_2D,format:tt.RGBA,type:at.UNSIGNED_BYTE};lt._globalBatch=0;var Ki=class{constructor(){this.texArray=null,this.blend=0,this.type=Ze.TRIANGLES,this.start=0,this.size=0,this.data=null}};var bS=0,kt=class{constructor(t,r=!0,i=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=r,this.id=bS++,this.disposeRunner=new ae("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?Qe.ELEMENT_ARRAY_BUFFER:Qe.ARRAY_BUFFER}get index(){return this.type===Qe.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new kt(t)}};var qi=class{constructor(t,r=0,i=!1,n=at.FLOAT,o,a,c,f=1){this.buffer=t,this.size=r,this.normalized=i,this.type=n,this.stride=o,this.start=a,this.instance=c,this.divisor=f}destroy(){this.buffer=null}static from(t,r,i,n,o){return new qi(t,r,i,n,o)}};var AS={Float32Array,Uint32Array,Int32Array,Uint8Array};function gg(e,t){let r=0,i=0,n={};for(let f=0;f<e.length;f++)i+=t[f],r+=e[f].length;let o=new ArrayBuffer(r*4),a=null,c=0;for(let f=0;f<e.length;f++){let p=t[f],l=e[f],h=zi(l);n[h]||(n[h]=new AS[h](o)),a=n[h];for(let d=0;d<l.length;d++){let m=(d/p|0)*i+c,_=d%p;a[m+_]=l[d]}c+=p}return new Float32Array(o)}var _g={5126:4,5123:2,5121:1},CS=0,IS={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Me=class{constructor(t=[],r={}){this.buffers=t,this.indexBuffer=null,this.attributes=r,this.glVertexArrayObjects={},this.id=CS++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ae("disposeGeometry"),this.refCount=0}addAttribute(t,r,i=0,n=!1,o,a,c,f=!1){if(!r)throw new Error("You must pass a buffer when creating an attribute");r instanceof kt||(r instanceof Array&&(r=new Float32Array(r)),r=new kt(r));let p=t.split("|");if(p.length>1){for(let h=0;h<p.length;h++)this.addAttribute(p[h],r,i,n,o);return this}let l=this.buffers.indexOf(r);return l===-1&&(this.buffers.push(r),l=this.buffers.length-1),this.attributes[t]=new qi(l,i,n,o,a,c,f),this.instanced=this.instanced||f,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof kt||(t instanceof Array&&(t=new Uint16Array(t)),t=new kt(t)),t.type=Qe.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;let t=[],r=[],i=new kt,n;for(n in this.attributes){let o=this.attributes[n],a=this.buffers[o.buffer];t.push(a.data),r.push(o.size*_g[o.type]/4),o.buffer=0}for(i.data=gg(t,r),n=0;n<this.buffers.length;n++)this.buffers[n]!==this.indexBuffer&&this.buffers[n].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(let t in this.attributes){let r=this.attributes[t];return this.buffers[r.buffer].data.length/(r.stride/4||r.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){let t=new Me;for(let r=0;r<this.buffers.length;r++)t.buffers[r]=new kt(this.buffers[r].data.slice(0));for(let r in this.attributes){let i=this.attributes[r];t.attributes[r]=new qi(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=Qe.ELEMENT_ARRAY_BUFFER),t}static merge(t){let r=new Me,i=[],n=[],o=[],a;for(let c=0;c<t.length;c++){a=t[c];for(let f=0;f<a.buffers.length;f++)n[f]=n[f]||0,n[f]+=a.buffers[f].data.length,o[f]=0}for(let c=0;c<a.buffers.length;c++)i[c]=new IS[zi(a.buffers[c].data)](n[c]),r.buffers[c]=new kt(i[c]);for(let c=0;c<t.length;c++){a=t[c];for(let f=0;f<a.buffers.length;f++)i[f].set(a.buffers[f].data,o[f]),o[f]+=a.buffers[f].data.length}if(r.attributes=a.attributes,a.indexBuffer){r.indexBuffer=r.buffers[a.buffers.indexOf(a.indexBuffer)],r.indexBuffer.type=Qe.ELEMENT_ARRAY_BUFFER;let c=0,f=0,p=0,l=0;for(let h=0;h<a.buffers.length;h++)if(a.buffers[h]!==a.indexBuffer){l=h;break}for(let h in a.attributes){let d=a.attributes[h];(d.buffer|0)===l&&(f+=d.size*_g[d.type]/4)}for(let h=0;h<t.length;h++){let d=t[h].indexBuffer.data;for(let m=0;m<d.length;m++)r.indexBuffer.data[m+p]+=c;c+=t[h].buffers[l].data.length/f,p+=d.length}}return r}};var bn=class extends Me{constructor(t=!1){super(),this._buffer=new kt(null,t,!1),this._indexBuffer=new kt(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,at.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,at.FLOAT).addAttribute("aColor",this._buffer,4,!0,at.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,at.FLOAT).addIndex(this._indexBuffer)}};var Zi=Math.PI*2,vc=180/Math.PI,yc=Math.PI/180,zt=(e=>(e[e.POLY=0]="POLY",e[e.RECT=1]="RECT",e[e.CIRC=2]="CIRC",e[e.ELIP=3]="ELIP",e[e.RREC=4]="RREC",e))(zt||{});var dt=class{constructor(t=0,r=0){this.x=0,this.y=0,this.x=t,this.y=r}clone(){return new dt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,r=t){return this.x=t,this.y=r,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}};var Fl=[new dt,new dt,new dt,new dt],ut=class{constructor(t=0,r=0,i=0,n=0){this.x=Number(t),this.y=Number(r),this.width=Number(i),this.height=Number(n),this.type=zt.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new ut(0,0,0,0)}clone(){return new ut(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,r){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&r>=this.y&&r<this.y+this.height}intersects(t,r){if(!r){let M=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=M)return!1;let F=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>F}let i=this.left,n=this.right,o=this.top,a=this.bottom;if(n<=i||a<=o)return!1;let c=Fl[0].set(t.left,t.top),f=Fl[1].set(t.left,t.bottom),p=Fl[2].set(t.right,t.top),l=Fl[3].set(t.right,t.bottom);if(p.x<=c.x||f.y<=c.y)return!1;let h=Math.sign(r.a*r.d-r.b*r.c);if(h===0||(r.apply(c,c),r.apply(f,f),r.apply(p,p),r.apply(l,l),Math.max(c.x,f.x,p.x,l.x)<=i||Math.min(c.x,f.x,p.x,l.x)>=n||Math.max(c.y,f.y,p.y,l.y)<=o||Math.min(c.y,f.y,p.y,l.y)>=a))return!1;let d=h*(f.y-c.y),m=h*(c.x-f.x),_=d*i+m*o,x=d*n+m*o,T=d*i+m*a,S=d*n+m*a;if(Math.max(_,x,T,S)<=d*c.x+m*c.y||Math.min(_,x,T,S)>=d*l.x+m*l.y)return!1;let b=h*(c.y-p.y),y=h*(p.x-c.x),w=b*i+y*o,I=b*n+y*o,C=b*i+y*a,P=b*n+y*a;return!(Math.max(w,I,C,P)<=b*c.x+y*c.y||Math.min(w,I,C,P)>=b*l.x+y*l.y)}pad(t=0,r=t){return this.x-=t,this.y-=r,this.width+=t*2,this.height+=r*2,this}fit(t){let r=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),n=Math.max(this.y,t.y),o=Math.min(this.y+this.height,t.y+t.height);return this.x=r,this.width=Math.max(i-r,0),this.y=n,this.height=Math.max(o-n,0),this}ceil(t=1,r=.001){let i=Math.ceil((this.x+this.width-r)*t)/t,n=Math.ceil((this.y+this.height-r)*t)/t;return this.x=Math.floor((this.x+r)*t)/t,this.y=Math.floor((this.y+r)*t)/t,this.width=i-this.x,this.height=n-this.y,this}enlarge(t){let r=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),o=Math.max(this.y+this.height,t.y+t.height);return this.x=r,this.width=i-r,this.y=n,this.height=o-n,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};var An=class{constructor(t=0,r=0,i=0){this.x=t,this.y=r,this.radius=i,this.type=zt.CIRC}clone(){return new An(this.x,this.y,this.radius)}contains(t,r){if(this.radius<=0)return!1;let i=this.radius*this.radius,n=this.x-t,o=this.y-r;return n*=n,o*=o,n+o<=i}getBounds(){return new ut(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}};var Cn=class{constructor(t=0,r=0,i=0,n=0){this.x=t,this.y=r,this.width=i,this.height=n,this.type=zt.ELIP}clone(){return new Cn(this.x,this.y,this.width,this.height)}contains(t,r){if(this.width<=0||this.height<=0)return!1;let i=(t-this.x)/this.width,n=(r-this.y)/this.height;return i*=i,n*=n,i+n<=1}getBounds(){return new ut(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};var Ur=class{constructor(...t){let r=Array.isArray(t[0])?t[0]:t;if(typeof r[0]!="number"){let i=[];for(let n=0,o=r.length;n<o;n++)i.push(r[n].x,r[n].y);r=i}this.points=r,this.type=zt.POLY,this.closeStroke=!0}clone(){let t=this.points.slice(),r=new Ur(t);return r.closeStroke=this.closeStroke,r}contains(t,r){let i=!1,n=this.points.length/2;for(let o=0,a=n-1;o<n;a=o++){let c=this.points[o*2],f=this.points[o*2+1],p=this.points[a*2],l=this.points[a*2+1];f>r!=l>r&&t<(p-c)*((r-f)/(l-f))+c&&(i=!i)}return i}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,r)=>`${t}, ${r}`,"")}]`}};var In=class{constructor(t=0,r=0,i=0,n=0,o=20){this.x=t,this.y=r,this.width=i,this.height=n,this.radius=o,this.type=zt.RREC}clone(){return new In(this.x,this.y,this.width,this.height,this.radius)}contains(t,r){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){let i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+i&&r<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let n=t-(this.x+i),o=r-(this.y+i),a=i*i;if(n*n+o*o<=a||(n=t-(this.x+this.width-i),n*n+o*o<=a)||(o=r-(this.y+this.height-i),n*n+o*o<=a)||(n=t-(this.x+i),n*n+o*o<=a))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}};var Et=class{constructor(t=1,r=0,i=0,n=1,o=0,a=0){this.array=null,this.a=t,this.b=r,this.c=i,this.d=n,this.tx=o,this.ty=a}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,r,i,n,o,a){return this.a=t,this.b=r,this.c=i,this.d=n,this.tx=o,this.ty=a,this}toArray(t,r){this.array||(this.array=new Float32Array(9));let i=r||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,r){r=r||new dt;let i=t.x,n=t.y;return r.x=this.a*i+this.c*n+this.tx,r.y=this.b*i+this.d*n+this.ty,r}applyInverse(t,r){r=r||new dt;let i=1/(this.a*this.d+this.c*-this.b),n=t.x,o=t.y;return r.x=this.d*i*n+-this.c*i*o+(this.ty*this.c-this.tx*this.d)*i,r.y=this.a*i*o+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,r}translate(t,r){return this.tx+=t,this.ty+=r,this}scale(t,r){return this.a*=t,this.d*=r,this.c*=t,this.b*=r,this.tx*=t,this.ty*=r,this}rotate(t){let r=Math.cos(t),i=Math.sin(t),n=this.a,o=this.c,a=this.tx;return this.a=n*r-this.b*i,this.b=n*i+this.b*r,this.c=o*r-this.d*i,this.d=o*i+this.d*r,this.tx=a*r-this.ty*i,this.ty=a*i+this.ty*r,this}append(t){let r=this.a,i=this.b,n=this.c,o=this.d;return this.a=t.a*r+t.b*n,this.b=t.a*i+t.b*o,this.c=t.c*r+t.d*n,this.d=t.c*i+t.d*o,this.tx=t.tx*r+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*o+this.ty,this}setTransform(t,r,i,n,o,a,c,f,p){return this.a=Math.cos(c+p)*o,this.b=Math.sin(c+p)*o,this.c=-Math.sin(c-f)*a,this.d=Math.cos(c-f)*a,this.tx=t-(i*this.a+n*this.c),this.ty=r-(i*this.b+n*this.d),this}prepend(t){let r=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){let i=this.a,n=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=r*t.a+this.ty*t.c+t.tx,this.ty=r*t.b+this.ty*t.d+t.ty,this}decompose(t){let r=this.a,i=this.b,n=this.c,o=this.d,a=t.pivot,c=-Math.atan2(-n,o),f=Math.atan2(i,r),p=Math.abs(c+f);return p<1e-5||Math.abs(Zi-p)<1e-5?(t.rotation=f,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=c,t.skew.y=f),t.scale.x=Math.sqrt(r*r+i*i),t.scale.y=Math.sqrt(n*n+o*o),t.position.x=this.tx+(a.x*r+a.y*n),t.position.y=this.ty+(a.x*i+a.y*o),t}invert(){let t=this.a,r=this.b,i=this.c,n=this.d,o=this.tx,a=t*n-r*i;return this.a=n/a,this.b=-r/a,this.c=-i/a,this.d=t/a,this.tx=(i*this.ty-n*o)/a,this.ty=-(t*this.ty-r*o)/a,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){let t=new Et;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new Et}static get TEMP_MATRIX(){return new Et}};var Rn=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Pn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Mn=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Bn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Tc=[],xg=[],Ol=Math.sign;function RS(){for(let e=0;e<16;e++){let t=[];Tc.push(t);for(let r=0;r<16;r++){let i=Ol(Rn[e]*Rn[r]+Mn[e]*Pn[r]),n=Ol(Pn[e]*Rn[r]+Bn[e]*Pn[r]),o=Ol(Rn[e]*Mn[r]+Mn[e]*Bn[r]),a=Ol(Pn[e]*Mn[r]+Bn[e]*Bn[r]);for(let c=0;c<16;c++)if(Rn[c]===i&&Pn[c]===n&&Mn[c]===o&&Bn[c]===a){t.push(c);break}}}for(let e=0;e<16;e++){let t=new Et;t.set(Rn[e],Pn[e],Mn[e],Bn[e],0,0),xg.push(t)}}RS();var qt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:e=>Rn[e],uY:e=>Pn[e],vX:e=>Mn[e],vY:e=>Bn[e],inv:e=>e&8?e&15:-e&7,add:(e,t)=>Tc[e][t],sub:(e,t)=>Tc[e][qt.inv(t)],rotate180:e=>e^4,isVertical:e=>(e&3)===2,byDirection:(e,t)=>Math.abs(e)*2<=Math.abs(t)?t>=0?qt.S:qt.N:Math.abs(t)*2<=Math.abs(e)?e>0?qt.E:qt.W:t>0?e>0?qt.SE:qt.SW:e>0?qt.NE:qt.NW,matrixAppendRotationInv:(e,t,r=0,i=0)=>{let n=xg[qt.inv(t)];n.tx=r,n.ty=i,e.append(n)}};var tr=class{constructor(t,r,i=0,n=0){this._x=i,this._y=n,this.cb=t,this.scope=r}clone(t=this.cb,r=this.scope){return new tr(t,r,this._x,this._y)}set(t=0,r=t){return(this._x!==t||this._y!==r)&&(this._x=t,this._y=r,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}};var vg=class{constructor(){this.worldTransform=new Et,this.localTransform=new Et,this.position=new tr(this.onChange,this,0,0),this.scale=new tr(this.onChange,this,1,1),this.pivot=new tr(this.onChange,this,0,0),this.skew=new tr(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){let e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(e){let t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){let r=e.worldTransform,i=this.worldTransform;i.a=t.a*r.a+t.b*r.c,i.b=t.a*r.b+t.b*r.d,i.c=t.c*r.a+t.d*r.c,i.d=t.c*r.b+t.d*r.d,i.tx=t.tx*r.a+t.ty*r.c+r.tx,i.ty=t.tx*r.b+t.ty*r.d+r.ty,this._parentID=e._worldID,this._worldID++}}setFromMatrix(e){e.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())}},Dn=vg;Dn.IDENTITY=new vg;var yg=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`;var Tg=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Nl(e,t,r){let i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}function wc(e){let t=new Array(e);for(let r=0;r<t.length;r++)t[r]=!1;return t}function Fo(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return wc(2*t);case"bvec3":return wc(3*t);case"bvec4":return wc(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var ei=[{test:e=>e.type==="float"&&e.size===1&&!e.isArray,code:e=>`
            if(uv["${e}"] !== ud["${e}"].value)
            {
                ud["${e}"].value = uv["${e}"]
                gl.uniform1f(ud["${e}"].location, uv["${e}"])
            }
            `},{test:(e,t)=>(e.type==="sampler2D"||e.type==="samplerCube"||e.type==="sampler2DArray")&&e.size===1&&!e.isArray&&(t==null||t.castToBaseTexture!==void 0),code:e=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${e}"], t);

            if(ud["${e}"].value !== t)
            {
                ud["${e}"].value = t;
                gl.uniform1i(ud["${e}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(e,t)=>e.type==="mat3"&&e.size===1&&!e.isArray&&t.a!==void 0,code:e=>`
            gl.uniformMatrix3fv(ud["${e}"].location, false, uv["${e}"].toArray(true));
            `,codeUbo:e=>`
                var ${e}_matrix = uv.${e}.toArray(true);

                data[offset] = ${e}_matrix[0];
                data[offset+1] = ${e}_matrix[1];
                data[offset+2] = ${e}_matrix[2];
        
                data[offset + 4] = ${e}_matrix[3];
                data[offset + 5] = ${e}_matrix[4];
                data[offset + 6] = ${e}_matrix[5];
        
                data[offset + 8] = ${e}_matrix[6];
                data[offset + 9] = ${e}_matrix[7];
                data[offset + 10] = ${e}_matrix[8];
            `},{test:(e,t)=>e.type==="vec2"&&e.size===1&&!e.isArray&&t.x!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${e}"].location, v.x, v.y);
                }`,codeUbo:e=>`
                v = uv.${e};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:e=>e.type==="vec2"&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${e}"].location, v[0], v[1]);
                }
            `},{test:(e,t)=>e.type==="vec4"&&e.size===1&&!e.isArray&&t.width!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${e}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(e,t)=>e.type==="vec4"&&e.size===1&&!e.isArray&&t.red!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${e}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(e,t)=>e.type==="vec3"&&e.size===1&&!e.isArray&&t.red!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${e}"].location, v.red, v.green, v.blue)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:e=>e.type==="vec4"&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${e}"].location, v[0], v[1], v[2], v[3])
                }`}];var PS={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},MS={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Ec(e,t){let r=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(let i in e.uniforms){let n=t[i];if(!n){e.uniforms[i]?.group&&(e.uniforms[i].ubo?r.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):r.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}let o=e.uniforms[i],a=!1;for(let c=0;c<ei.length;c++)if(ei[c].test(n,o)){r.push(ei[c].code(i,o)),a=!0;break}if(!a){let f=(n.size===1&&!n.isArray?PS:MS)[n.type].replace("location",`ud["${i}"].location`);r.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${f};`)}}return new Function("ud","uv","renderer","syncData",r.join(`
`))}var wg={},Ul=wg;function kl(){if(Ul===wg||Ul?.isContextLost()){let e=W.ADAPTER.createCanvas(),t;W.PREFER_ENV>=hr.WEBGL2&&(t=e.getContext("webgl2",{})),t||(t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),Ul=t}return Ul}var Gl;function Sc(){if(!Gl){Gl=Ue.MEDIUM;let e=kl();e&&e.getShaderPrecisionFormat&&(Gl=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision?Ue.HIGH:Ue.MEDIUM)}return Gl}function Eg(e,t){let r=e.getShaderSource(t).split(`
`).map((p,l)=>`${l}: ${p}`),i=e.getShaderInfoLog(t),n=i.split(`
`),o={},a=n.map(p=>parseFloat(p.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(p=>p&&!o[p]?(o[p]=!0,!0):!1),c=[""];a.forEach(p=>{r[p-1]=`%c${r[p-1]}%c`,c.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});let f=r.join(`
`);c[0]=f,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...c),console.groupEnd()}function bc(e,t,r,i){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(r,e.COMPILE_STATUS)||Eg(e,r),e.getShaderParameter(i,e.COMPILE_STATUS)||Eg(e,i),console.error("PixiJS Error: Could not initialize shader."),e.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(t)))}var BS={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Oo(e){return BS[e]}var Hl=null,Sg={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function No(e,t){if(!Hl){let r=Object.keys(Sg);Hl={};for(let i=0;i<r.length;++i){let n=r[i];Hl[e[n]]=Sg[n]}}return Hl[t]}function Vl(e,t,r){if(e.substring(0,9)!=="precision"){let i=t;return t===Ue.HIGH&&r!==Ue.HIGH&&(i=Ue.MEDIUM),`precision ${i} float;
${e}`}else if(r!==Ue.HIGH&&e.substring(0,15)==="precision highp")return e.replace("precision highp","precision mediump");return e}var Uo;function Wl(){if(typeof Uo=="boolean")return Uo;try{Uo=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Uo=!1}return Uo}var DS=0,Xl={},Ss=class{constructor(e,t,r="pixi-shader",i={}){this.extra={},this.id=DS++,this.vertexSrc=e||Ss.defaultVertexSrc,this.fragmentSrc=t||Ss.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(r=r.replace(/\s+/g,"-"),Xl[r]?(Xl[r]++,r+=`-${Xl[r]}`):Xl[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${r}
${this.fragmentSrc}`,this.vertexSrc=Vl(this.vertexSrc,Ss.defaultVertexPrecision,Ue.HIGH),this.fragmentSrc=Vl(this.fragmentSrc,Ss.defaultFragmentPrecision,Sc())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return Tg}static get defaultFragmentSrc(){return yg}static from(e,t,r){let i=e+t,n=Do[i];return n||(Do[i]=n=new Ss(e,t,r)),n}},we=Ss;we.defaultVertexPrecision=Ue.HIGH;we.defaultFragmentPrecision=Ar.apple.device?Ue.HIGH:Ue.MEDIUM;var LS=0,pe=class{constructor(t,r,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=LS++,this.static=!!r,this.ubo=!!i,t instanceof kt?(this.buffer=t,this.buffer.type=Qe.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new kt(new Float32Array(1)),this.buffer.type=Qe.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,r,i){if(!this.ubo)this.uniforms[t]=new pe(r,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,r,i){return new pe(t,r,i)}static uboFrom(t,r){return new pe(t,r??!0,!0)}};var me=class{constructor(t,r){this.uniformBindCount=0,this.program=t,r?r instanceof pe?this.uniformGroup=r:this.uniformGroup=new pe(r):this.uniformGroup=new pe({}),this.disposeRunner=new ae("disposeShader")}checkUniformExists(t,r){if(r.uniforms[t])return!0;for(let i in r.uniforms){let n=r.uniforms[i];if(n.group&&this.checkUniformExists(t,n))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,r,i){let n=we.from(t,r);return new me(n,i)}};var ko=class{constructor(t,r){if(this.vertexSrc=t,this.fragTemplate=r,this.programCache={},this.defaultGroupCache={},!r.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!r.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){let i=new Int32Array(t);for(let o=0;o<t;o++)i[o]=o;this.defaultGroupCache[t]=pe.from({uSamplers:i},!0);let n=this.fragTemplate;n=n.replace(/%count%/gi,`${t}`),n=n.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new we(this.vertexSrc,n)}let r={tint:new Float32Array([1,1,1,1]),translationMatrix:new Et,default:this.defaultGroupCache[t]};return new me(this.programCache[t],r)}generateSampleSrc(t){let r="";r+=`
`,r+=`
`;for(let i=0;i<t;i++)i>0&&(r+=`
else `),i<t-1&&(r+=`if(vTextureId < ${i}.5)`),r+=`
{`,r+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,r+=`
}`;return r+=`
`,r+=`
`,r}};var Qi=class{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}};function bg(){return!Ar.apple.device}function Ag(e){let t=!0,r=W.ADAPTER.getNavigator();if(Ar.tablet||Ar.phone){if(Ar.apple.device){let i=r.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(t=!1)}if(Ar.android.device){let i=r.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(t=!1)}}return t?e:4}var kr=class{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}};var Cg=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`;var Ig=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;var Gr=class extends kr{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=bn,this.vertexSize=6,this.state=de.for2d(),this.size=Gr.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??Ag(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??bg(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return gt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return Ig}static get defaultFragmentTemplate(){return Cg}setShaderGenerator({vertex:e=Gr.defaultVertexSrc,fragment:t=Gr.defaultFragmentTemplate}={}){this.shaderGenerator=new ko(e,t)}contextChange(){let e=this.renderer.gl;W.PREFER_ENV===hr.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),Gr.defaultMaxTextures),this.maxTextures=Ll(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){let{_drawCallPool:e,_textureArrayPool:t}=Gr,r=this.size/4,i=Math.floor(r/this.maxTextures)+1;for(;e.length<r;)e.push(new Ki);for(;t.length<i;)t.push(new Qi);for(let n=0;n<this.maxTextures;n++)this._tempBoundTextures[n]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){let{_bufferedTextures:e,maxTextures:t}=this,r=Gr._textureArrayPool,i=this.renderer.batch,n=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++lt._globalBatch,c=0,f=r[0],p=0;i.copyBoundTextures(n,t);for(let l=0;l<this._bufferSize;++l){let h=e[l];e[l]=null,h._batchEnabled!==a&&(f.count>=t&&(i.boundArray(f,n,a,t),this.buildDrawCalls(f,p,l),p=l,f=r[++c],++a),h._batchEnabled=a,h.touched=o,f.elements[f.count++]=h)}f.count>0&&(i.boundArray(f,n,a,t),this.buildDrawCalls(f,p,this._bufferSize),++c,++a);for(let l=0;l<n.length;l++)n[l]=null;lt._globalBatch=a}buildDrawCalls(e,t,r){let{_bufferedElements:i,_attributeBuffer:n,_indexBuffer:o,vertexSize:a}=this,c=Gr._drawCallPool,f=this._dcIndex,p=this._aIndex,l=this._iIndex,h=c[f];h.start=this._iIndex,h.texArray=e;for(let d=t;d<r;++d){let m=i[d],_=m._texture.baseTexture,x=Po[_.alphaMode?1:0][m.blendMode];i[d]=null,t<d&&h.blend!==x&&(h.size=l-h.start,t=d,h=c[++f],h.texArray=e,h.start=l),this.packInterleavedGeometry(m,n,o,p,l),p+=m.vertexData.length/2*a,l+=m.indices.length,h.blend=x}t<r&&(h.size=l-h.start,++f),this._dcIndex=f,this._aIndex=p,this._iIndex=l}bindAndClearTexArray(e){let t=this.renderer.texture;for(let r=0;r<e.count;r++)t.bind(e.elements[r],e.ids[r]),e.elements[r]=null;e.count=0}updateGeometry(){let{_packedGeometries:e,_attributeBuffer:t,_indexBuffer:r}=this;Gr.canUploadSameBuffer?(e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){let e=this._dcIndex,{gl:t,state:r}=this.renderer,i=Gr._drawCallPool,n=null;for(let o=0;o<e;o++){let{texArray:a,type:c,size:f,start:p,blend:l}=i[o];n!==a&&(n=a,this.bindAndClearTexArray(a)),this.state.blendMode=l,r.set(this.state),t.drawElements(c,f,t.UNSIGNED_SHORT,p*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Gr.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){let t=$i(Math.ceil(e/8)),r=Bo(t),i=t*8;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new ji(i*this.vertexSize*4)),n}getIndexBuffer(e){let t=$i(Math.ceil(e/12)),r=Bo(t),i=t*12;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n}packInterleavedGeometry(e,t,r,i,n){let{uint32View:o,float32View:a}=t,c=i/this.vertexSize,f=e.uvs,p=e.indices,l=e.vertexData,h=e._texture.baseTexture._batchLocation,d=Math.min(e.worldAlpha,1),m=pt.shared.setValue(e._tintRGB).toPremultiplied(d);for(let _=0;_<l.length;_+=2)a[i++]=l[_],a[i++]=l[_+1],a[i++]=f[_],a[i++]=f[_+1],o[i++]=m,a[i++]=h;for(let _=0;_<p.length;_++)r[n++]=c+p[_]}},dr=Gr;dr.defaultBatchSize=4096;dr.extension={name:"batch",type:z.RendererPlugin};dr._drawCallPool=[];dr._textureArrayPool=[];Z.add(dr);var Rg=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`;var Pg=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;var Go=class extends me{constructor(e,t,r){let i=we.from(e||Go.defaultVertexSrc,t||Go.defaultFragmentSrc);super(i,r),this.padding=0,this.resolution=Go.defaultResolution,this.multisample=Go.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new de}apply(e,t,r,i,n){e.applyFilter(this,t,r,i)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return Pg}static get defaultFragmentSrc(){return Rg}},Wt=Go;Wt.defaultResolution=1;Wt.defaultMultisample=Lt.NONE;var Ti=class{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new pt(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;let{backgroundColor:r,background:i,backgroundAlpha:n}=t,o=i??r;o!==void 0&&(this.color=o),this.alpha=n}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}};Ti.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};Ti.extension={type:[z.RendererSystem,z.CanvasRendererSystem],name:"background"};Z.add(Ti);var bs=class{constructor(t){this.renderer=t,this.emptyRenderer=new kr(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,r){let{boundTextures:i}=this.renderer.texture;for(let n=r-1;n>=0;--n)t[n]=i[n]||null,t[n]&&(t[n]._batchLocation=n)}boundArray(t,r,i,n){let{elements:o,ids:a,count:c}=t,f=0;for(let p=0;p<c;p++){let l=o[p],h=l._batchLocation;if(h>=0&&h<n&&r[h]===l){a[p]=h;continue}for(;f<n;){let d=r[f];if(d&&d._batchEnabled===i&&d._batchLocation===f){f++;continue}a[p]=f,l._batchLocation=f,r[f]=l;break}}}destroy(){this.renderer=null}};bs.extension={type:z.RendererSystem,name:"batch"};Z.add(bs);var Mg=0,wi=class{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Mg++}init(t){if(t.context)this.initFromContext(t.context);else{let r=this.renderer.background.alpha<1,i=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:r,premultipliedAlpha:i,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Mg++,this.renderer.runners.contextChange.emit(t);let r=this.renderer.view;r.addEventListener!==void 0&&(r.addEventListener("webglcontextlost",this.handleContextLost,!1),r.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){let r=this.createContext(this.renderer.view,t);this.initFromContext(r)}createContext(t,r){let i;if(W.PREFER_ENV>=hr.WEBGL2&&(i=t.getContext("webgl2",r)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=t.getContext("webgl",r)||t.getContext("experimental-webgl",r),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){let{gl:t}=this,r={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,r,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,r,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){let t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){let r=t.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),r&&!r.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");let n=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}};wi.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"};wi.extension={type:z.RendererSystem,name:"context"};Z.add(wi);var zl=class extends Je{upload(t,r,i){let n=t.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===ue.UNPACK);let o=r.realWidth,a=r.realHeight;return i.width===o&&i.height===a?n.texSubImage2D(r.target,0,0,0,o,a,r.format,i.type,this.data):(i.width=o,i.height=a,n.texImage2D(r.target,0,i.internalFormat,o,a,0,r.format,i.type,this.data)),!0}};var Ji=class{constructor(t,r){this.width=Math.round(t||100),this.height=Math.round(r||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ae("disposeFramebuffer"),this.multisample=Lt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,r){return this.colorTextures[t]=r||new lt(null,{scaleMode:br.NEAREST,resolution:1,mipmap:Se.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new lt(new zl(null,{width:this.width,height:this.height}),{scaleMode:br.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Se.OFF,format:tt.DEPTH_COMPONENT,type:at.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,r){if(t=Math.round(t),r=Math.round(r),!(t===this.width&&r===this.height)){this.width=t,this.height=r,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){let n=this.colorTextures[i],o=n.resolution;n.setSize(t/o,r/o)}if(this.depthTexture){let i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,r/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}};var Ln=class extends lt{constructor(t={}){if(typeof t=="number"){let r=arguments[0],i=arguments[1],n=arguments[2],o=arguments[3];t={width:r,height:i,scaleMode:n,resolution:o}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=Lt.NONE),super(null,t),this.mipmap=Se.OFF,this.valid=!0,this._clear=new pt([0,0,0,0]),this.framebuffer=new Ji(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}resize(t,r){this.framebuffer.resize(t*this.resolution,r*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}};var be=class extends fr{constructor(t){let r=t,i=r.naturalWidth||r.videoWidth||r.width,n=r.naturalHeight||r.videoHeight||r.height;super(i,n),this.source=t,this.noSubImage=!1}static crossOrigin(t,r,i){i===void 0&&!r.startsWith("data:")?t.crossOrigin=Dl(r):i!==!1&&(t.crossOrigin=typeof i=="string"?i:"anonymous")}upload(t,r,i,n){let o=t.gl,a=r.realWidth,c=r.realHeight;if(n=n||this.source,typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement){if(!n.complete||n.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement&&n.readyState<=1&&n.buffered.length===0)return!1;return o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===ue.UNPACK),!this.noSubImage&&r.target===o.TEXTURE_2D&&i.width===a&&i.height===c?o.texSubImage2D(o.TEXTURE_2D,0,0,0,r.format,i.type,n):(i.width=a,i.height=c,o.texImage2D(r.target,0,i.internalFormat,r.format,i.type,n)),!0}update(){if(this.destroyed)return;let t=this.source,r=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(r,i),super.update()}dispose(){this.source=null}};var tn=class extends be{constructor(t,r){if(r=r||{},typeof t=="string"){let i=new Image;be.crossOrigin(i,t,r.crossorigin),i.src=t,t=i}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(r.createBitmap??W.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.bitmap=null,this._load=null,r.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((r,i)=>{let n=this.source;this.url=n.src;let o=()=>{this.destroyed||(n.onload=null,n.onerror=null,this.resize(n.width,n.height),this._load=null,this.createBitmap?r(this.process()):r(this))};n.complete&&n.src?o():(n.onload=o,n.onerror=a=>{i(a),this.onError.emit(a)})}),this._load)}process(){let t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);let r=globalThis.createImageBitmap,i=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:i?"cors":"no-cors"}).then(n=>n.blob()).then(n=>r(n,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ue.UNPACK?"premultiply":"none"})).then(n=>this.destroyed?Promise.reject():(this.bitmap=n,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,r,i){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,r,i,this.bitmap),!this.preserveBitmap){let n=!0,o=r._glTextures;for(let a in o){let c=o[a];if(c!==i&&c.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}};var As=class{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,r,i){let n=r.width,o=r.height;if(i){let a=t.width/2/n,c=t.height/2/o,f=t.x/n+a,p=t.y/o+c;i=qt.add(i,qt.NW),this.x0=f+a*qt.uX(i),this.y0=p+c*qt.uY(i),i=qt.add(i,2),this.x1=f+a*qt.uX(i),this.y1=p+c*qt.uY(i),i=qt.add(i,2),this.x2=f+a*qt.uX(i),this.y2=p+c*qt.uY(i),i=qt.add(i,2),this.x3=f+a*qt.uX(i),this.y3=p+c*qt.uY(i)}else this.x0=t.x/n,this.y0=t.y/o,this.x1=(t.x+t.width)/n,this.y1=t.y/o,this.x2=(t.x+t.width)/n,this.y2=(t.y+t.height)/o,this.x3=t.x/n,this.y3=(t.y+t.height)/o;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}};var Bg=new As;function $l(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}var it=class extends Yi.default{constructor(t,r,i,n,o,a,c){if(super(),this.noFrame=!1,r||(this.noFrame=!0,r=new ut(0,0,1,1)),t instanceof it&&(t=t.baseTexture),this.baseTexture=t,this._frame=r,this.trim=n,this.valid=!1,this._uvs=Bg,this.uvMatrix=null,this.orig=i||r,this._rotate=Number(o||0),o===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new dt(a.x,a.y):new dt(0,0),this.defaultBorders=c,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=r:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){let{resource:r}=this.baseTexture;r?.url&&Te[r.url]&&it.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,it.removeFromCache(this),this.textureCacheIds=null}clone(){let t=this._frame.clone(),r=this._frame===this.orig?t:this.orig.clone(),i=new it(this.baseTexture,!this.noFrame&&t,r,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=t),i}updateUvs(){this._uvs===Bg&&(this._uvs=new As),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,r={},i=W.STRICT_TEXTURE_CACHE){let n=typeof t=="string",o=null;if(n)o=t;else if(t instanceof lt){if(!t.cacheId){let c=r?.pixiIdPrefix||"pixiid";t.cacheId=`${c}-${ti()}`,lt.addToCache(t,t.cacheId)}o=t.cacheId}else{if(!t._pixiId){let c=r?.pixiIdPrefix||"pixiid";t._pixiId=`${c}_${ti()}`}o=t._pixiId}let a=Te[o];if(n&&i&&!a)throw new Error(`The cacheId "${o}" does not exist in TextureCache.`);return!a&&!(t instanceof lt)?(r.resolution||(r.resolution=Lo(t)),a=new it(new lt(t,r)),a.baseTexture.cacheId=o,lt.addToCache(a.baseTexture,o),it.addToCache(a,o)):!a&&t instanceof lt&&(a=new it(t),it.addToCache(a,o)),a}static fromURL(t,r){let i=Object.assign({autoLoad:!1},r?.resourceOptions),n=it.from(t,Object.assign({resourceOptions:i},r),!1),o=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):o.load().then(()=>Promise.resolve(n))}static fromBuffer(t,r,i,n){return new it(lt.fromBuffer(t,r,i,n))}static fromLoader(t,r,i,n){let o=new lt(t,Object.assign({scaleMode:lt.defaultOptions.scaleMode,resolution:Lo(r)},n)),{resource:a}=o;a instanceof tn&&(a.url=r);let c=new it(o);return i||(i=r),lt.addToCache(c.baseTexture,i),it.addToCache(c,i),i!==r&&(lt.addToCache(c.baseTexture,r),it.addToCache(c,r)),c.baseTexture.valid?Promise.resolve(c):new Promise(f=>{c.baseTexture.once("loaded",()=>f(c))})}static addToCache(t,r){r&&(t.textureCacheIds.includes(r)||t.textureCacheIds.push(r),Te[r]&&Te[r]!==t&&console.warn(`Texture added to the cache with an id [${r}] that already had an entry`),Te[r]=t)}static removeFromCache(t){if(typeof t=="string"){let r=Te[t];if(r){let i=r.textureCacheIds.indexOf(t);return i>-1&&r.textureCacheIds.splice(i,1),delete Te[t],r}}else if(t?.textureCacheIds){for(let r=0;r<t.textureCacheIds.length;++r)Te[t.textureCacheIds[r]]===t&&delete Te[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;let{x:r,y:i,width:n,height:o}=t,a=r+n>this.baseTexture.width,c=i+o>this.baseTexture.height;if(a||c){let f=a&&c?"and":"or",p=`X: ${r} + ${n} = ${r+n} > ${this.baseTexture.width}`,l=`Y: ${i} + ${o} = ${i+o} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${p} ${f} ${l}`)}this.valid=n&&o&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return it._EMPTY||(it._EMPTY=new it(new lt),$l(it._EMPTY),$l(it._EMPTY.baseTexture)),it._EMPTY}static get WHITE(){if(!it._WHITE){let t=W.ADAPTER.createCanvas(16,16),r=t.getContext("2d");t.width=16,t.height=16,r.fillStyle="white",r.fillRect(0,0,16,16),it._WHITE=new it(lt.from(t)),$l(it._WHITE),$l(it._WHITE.baseTexture)}return it._WHITE}};var He=class extends it{constructor(t,r){super(t,r),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,r,i=!0){let n=this.baseTexture.resolution,o=Math.round(t*n)/n,a=Math.round(r*n)/n;this.valid=o>0&&a>0,this._frame.width=this.orig.width=o,this._frame.height=this.orig.height=a,i&&this.baseTexture.resize(o,a),this.updateUvs()}setResolution(t){let{baseTexture:r}=this;r.resolution!==t&&(r.setResolution(t),this.resize(r.width,r.height,!1))}static create(t){return new He(new Ln(t))}};var Cs=class{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,r,i=Lt.NONE){let n=new Ln(Object.assign({width:t,height:r,resolution:1,multisample:i},this.textureOptions));return new He(n)}getOptimalTexture(t,r,i=1,n=Lt.NONE){let o;t=Math.ceil(t*i-1e-6),r=Math.ceil(r*i-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||r!==this._pixelsHeight?(t=$i(t),r=$i(r),o=((t&65535)<<16|r&65535)>>>0,n>1&&(o+=n*4294967296)):o=n>1?-n:-1,this.texturePool[o]||(this.texturePool[o]=[]);let a=this.texturePool[o].pop();return a||(a=this.createTexture(t,r,n)),a.filterPoolKey=o,a.setResolution(i),a}getFilterTexture(t,r,i){let n=this.getOptimalTexture(t.width,t.height,r||t.resolution,i||Lt.NONE);return n.filterFrame=t.filterFrame,n}returnTexture(t){let r=t.filterPoolKey;t.filterFrame=null,this.texturePool[r].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(let r in this.texturePool){let i=this.texturePool[r];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(let r in this.texturePool){if(!(Number(r)<0))continue;let i=this.texturePool[r];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0);this.texturePool[r]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}};Cs.SCREEN_KEY=-1;var Ho=class extends Me{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}};var Fn=class extends Me{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new kt(this.vertices),this.uvBuffer=new kt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,r){let i=0,n=0;return this.uvs[0]=i,this.uvs[1]=n,this.uvs[2]=i+r.width/t.width,this.uvs[3]=n,this.uvs[4]=i+r.width/t.width,this.uvs[5]=n+r.height/t.height,this.uvs[6]=i,this.uvs[7]=n+r.height/t.height,i=r.x,n=r.y,this.vertices[0]=i,this.vertices[1]=n,this.vertices[2]=i+r.width,this.vertices[3]=n,this.vertices[4]=i+r.width,this.vertices[5]=n+r.height,this.vertices[6]=i,this.vertices[7]=n+r.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}};var Vo=class{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Lt.NONE,this.sourceFrame=new ut,this.destinationFrame=new ut,this.bindingSourceFrame=new ut,this.bindingDestinationFrame=new ut,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}};var Yl=[new dt,new dt,new dt,new dt],Ac=new Et,Is=class{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Cs,this.statePool=[],this.quad=new Ho,this.quadUv=new Fn,this.tempRect=new ut,this.activeState={},this.globalUniforms=new pe({outputFrame:new ut,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,r){let i=this.renderer,n=this.defaultFilterStack,o=this.statePool.pop()||new Vo,a=this.renderer.renderTexture,c=r[0].resolution,f=r[0].multisample,p=r[0].padding,l=r[0].autoFit,h=r[0].legacy??!0;for(let _=1;_<r.length;_++){let x=r[_];c=Math.min(c,x.resolution),f=Math.min(f,x.multisample),p=this.useMaxPadding?Math.max(p,x.padding):p+x.padding,l=l&&x.autoFit,h=h||(x.legacy??!0)}n.length===1&&(this.defaultFilterStack[0].renderTexture=a.current),n.push(o),o.resolution=c,o.multisample=f,o.legacy=h,o.target=t,o.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),o.sourceFrame.pad(p);let d=this.tempRect.copyFrom(a.sourceFrame);i.projection.transform&&this.transformAABB(Ac.copyFrom(i.projection.transform).invert(),d),l?(o.sourceFrame.fit(d),(o.sourceFrame.width<=0||o.sourceFrame.height<=0)&&(o.sourceFrame.width=0,o.sourceFrame.height=0)):o.sourceFrame.intersects(d)||(o.sourceFrame.width=0,o.sourceFrame.height=0),this.roundFrame(o.sourceFrame,a.current?a.current.resolution:i.resolution,a.sourceFrame,a.destinationFrame,i.projection.transform),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,c,f),o.filters=r,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;let m=this.tempRect;m.x=0,m.y=0,m.width=o.sourceFrame.width,m.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,o.bindingSourceFrame.copyFrom(a.sourceFrame),o.bindingDestinationFrame.copyFrom(a.destinationFrame),o.transform=i.projection.transform,i.projection.transform=null,a.bind(o.renderTexture,o.sourceFrame,m),i.framebuffer.clear(0,0,0,0)}pop(){let t=this.defaultFilterStack,r=t.pop(),i=r.filters;this.activeState=r;let n=this.globalUniforms.uniforms;n.outputFrame=r.sourceFrame,n.resolution=r.resolution;let o=n.inputSize,a=n.inputPixel,c=n.inputClamp;if(o[0]=r.destinationFrame.width,o[1]=r.destinationFrame.height,o[2]=1/o[0],o[3]=1/o[1],a[0]=Math.round(o[0]*r.resolution),a[1]=Math.round(o[1]*r.resolution),a[2]=1/a[0],a[3]=1/a[1],c[0]=.5*a[2],c[1]=.5*a[3],c[2]=r.sourceFrame.width*o[2]-.5*a[2],c[3]=r.sourceFrame.height*o[3]-.5*a[3],r.legacy){let p=n.filterArea;p[0]=r.destinationFrame.width,p[1]=r.destinationFrame.height,p[2]=r.sourceFrame.x,p[3]=r.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();let f=t[t.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,r.renderTexture,f.renderTexture,cr.BLEND,r),this.returnFilterTexture(r.renderTexture);else{let p=r.renderTexture,l=this.getOptimalFilterTexture(p.width,p.height,r.resolution);l.filterFrame=p.filterFrame;let h=0;for(h=0;h<i.length-1;++h){h===1&&r.multisample>1&&(l=this.getOptimalFilterTexture(p.width,p.height,r.resolution),l.filterFrame=p.filterFrame),i[h].apply(this,p,l,cr.CLEAR,r);let d=p;p=l,l=d}i[h].apply(this,p,f.renderTexture,cr.BLEND,r),h>1&&r.multisample>1&&this.returnFilterTexture(r.renderTexture),this.returnFilterTexture(p),this.returnFilterTexture(l)}r.clear(),this.statePool.push(r)}bindAndClear(t,r=cr.CLEAR){let{renderTexture:i,state:n}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t?.filterFrame){let a=this.tempRect;a.x=0,a.y=0,a.width=t.filterFrame.width,a.height=t.filterFrame.height,i.bind(t,t.filterFrame,a)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);let o=n.stateId&1||this.forceClear;(r===cr.CLEAR||r===cr.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,r,i,n){let o=this.renderer;o.state.set(t.state),this.bindAndClear(i,n),t.uniforms.uSampler=r,t.uniforms.filterGlobals=this.globalUniforms,o.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(r._frame,r.filterFrame),o.geometry.bind(this.quadUv),o.geometry.draw(Ze.TRIANGLES)):(o.geometry.bind(this.quad),o.geometry.draw(Ze.TRIANGLE_STRIP))}calculateSpriteMatrix(t,r){let{sourceFrame:i,destinationFrame:n}=this.activeState,{orig:o}=r._texture,a=t.set(n.width,0,0,n.height,i.x,i.y),c=r.worldTransform.copyTo(Et.TEMP_MATRIX);return c.invert(),a.prepend(c),a.scale(1/o.width,1/o.height),a.translate(r.anchor.x,r.anchor.y),a}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,r,i=1,n=Lt.NONE){return this.texturePool.getOptimalTexture(t,r,i,n)}getFilterTexture(t,r,i){if(typeof t=="number"){let o=t;t=r,r=o}t=t||this.activeState.renderTexture;let n=this.texturePool.getOptimalTexture(t.width,t.height,r||t.resolution,i||Lt.NONE);return n.filterFrame=t.filterFrame,n}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,r){let i=Yl[0],n=Yl[1],o=Yl[2],a=Yl[3];i.set(r.left,r.top),n.set(r.left,r.bottom),o.set(r.right,r.top),a.set(r.right,r.bottom),t.apply(i,i),t.apply(n,n),t.apply(o,o),t.apply(a,a);let c=Math.min(i.x,n.x,o.x,a.x),f=Math.min(i.y,n.y,o.y,a.y),p=Math.max(i.x,n.x,o.x,a.x),l=Math.max(i.y,n.y,o.y,a.y);r.x=c,r.y=f,r.width=p-c,r.height=l-f}roundFrame(t,r,i,n,o){if(!(t.width<=0||t.height<=0||i.width<=0||i.height<=0)){if(o){let{a,b:c,c:f,d:p}=o;if((Math.abs(c)>1e-4||Math.abs(f)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(p)>1e-4))return}o=o?Ac.copyFrom(o):Ac.identity(),o.translate(-i.x,-i.y).scale(n.width/i.width,n.height/i.height).translate(n.x,n.y),this.transformAABB(o,t),t.ceil(r),this.transformAABB(o.invert(),t)}}};Is.extension={type:z.RendererSystem,name:"filter"};Z.add(Is);var Wo=class{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Lt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}};var FS=new ut,Rs=class{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Ji(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);let t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new ut,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let r=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;W.PREFER_ENV===hr.WEBGL_LEGACY&&(r=null,i=null),r?t.drawBuffers=n=>r.drawBuffersWEBGL(n):(this.hasMRT=!1,t.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,r,i=0){let{gl:n}=this;if(t){let o=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,n.bindFramebuffer(n.FRAMEBUFFER,o.framebuffer)),o.mipLevel!==i&&(t.dirtyId++,t.dirtyFormat++,o.mipLevel=i),o.dirtyId!==t.dirtyId&&(o.dirtyId=t.dirtyId,o.dirtyFormat!==t.dirtyFormat?(o.dirtyFormat=t.dirtyFormat,o.dirtySize=t.dirtySize,this.updateFramebuffer(t,i)):o.dirtySize!==t.dirtySize&&(o.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let a=0;a<t.colorTextures.length;a++){let c=t.colorTextures[a];this.renderer.texture.unbind(c.parentTextureArray||c)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),r){let a=r.width>>i,c=r.height>>i,f=a/r.width;this.setViewport(r.x*f,r.y*f,a,c)}else{let a=t.width>>i,c=t.height>>i;this.setViewport(0,0,a,c)}}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,r,i,n){let o=this.viewport;t=Math.round(t),r=Math.round(r),i=Math.round(i),n=Math.round(n),(o.width!==i||o.height!==n||o.x!==t||o.y!==r)&&(o.x=t,o.y=r,o.width=i,o.height=n,this.gl.viewport(t,r,i,n))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,r,i,n,o=gl.COLOR|gl.DEPTH){let{gl:a}=this;a.clearColor(t,r,i,n),a.clear(o)}initFramebuffer(t){let{gl:r}=this,i=new Wo(r.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i}resizeFramebuffer(t){let{gl:r}=this,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(r.bindRenderbuffer(r.RENDERBUFFER,i.stencil),i.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,r.DEPTH24_STENCIL8,t.width,t.height):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,t.width,t.height));let n=t.colorTextures,o=n.length;r.drawBuffers||(o=Math.min(o,1));for(let a=0;a<o;a++){let c=n[a],f=c.parentTextureArray||c;this.renderer.texture.bind(f,0),a===0&&i.msaaBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,i.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,f._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,r){let{gl:i}=this,n=t.glFramebuffers[this.CONTEXT_UID],o=t.colorTextures,a=o.length;i.drawBuffers||(a=Math.min(a,1)),n.multisample>1&&this.canMultisampleFramebuffer(t)?n.msaaBuffer=n.msaaBuffer||i.createRenderbuffer():n.msaaBuffer&&(i.deleteRenderbuffer(n.msaaBuffer),n.msaaBuffer=null,n.blitFramebuffer&&(n.blitFramebuffer.dispose(),n.blitFramebuffer=null));let c=[];for(let f=0;f<a;f++){let p=o[f],l=p.parentTextureArray||p;this.renderer.texture.bind(l,0),f===0&&n.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,n.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,n.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+f,p.target,l._glTextures[this.CONTEXT_UID].texture,r),c.push(i.COLOR_ATTACHMENT0+f))}if(c.length>1&&i.drawBuffers(c),t.depthTexture&&this.writeDepthTexture){let p=t.depthTexture;this.renderer.texture.bind(p,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,p._glTextures[this.CONTEXT_UID].texture,r)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(n.stencil=n.stencil||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,n.stencil),n.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,i.DEPTH24_STENCIL8,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,n.stencil)):n.stencil&&(i.deleteRenderbuffer(n.stencil),n.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){let{msaaSamples:r}=this,i=Lt.NONE;if(t<=1||r===null)return i;for(let n=0;n<r.length;n++)if(r[n]<=t){i=r[n];break}return i===1&&(i=Lt.NONE),i}blit(t,r,i){let{current:n,renderer:o,gl:a,CONTEXT_UID:c}=this;if(o.context.webGLVersion!==2||!n)return;let f=n.glFramebuffers[c];if(!f)return;if(!t){if(!f.msaaBuffer)return;let l=n.colorTextures[0];if(!l)return;f.blitFramebuffer||(f.blitFramebuffer=new Ji(n.width,n.height),f.blitFramebuffer.addColorTexture(0,l)),t=f.blitFramebuffer,t.colorTextures[0]!==l&&(t.colorTextures[0]=l,t.dirtyId++,t.dirtyFormat++),(t.width!==n.width||t.height!==n.height)&&(t.width=n.width,t.height=n.height,t.dirtyId++,t.dirtySize++)}r||(r=FS,r.width=n.width,r.height=n.height),i||(i=r);let p=r.width===i.width&&r.height===i.height;this.bind(t),a.bindFramebuffer(a.READ_FRAMEBUFFER,f.framebuffer),a.blitFramebuffer(r.left,r.top,r.right,r.bottom,i.left,i.top,i.right,i.bottom,a.COLOR_BUFFER_BIT,p?a.NEAREST:a.LINEAR)}disposeFramebuffer(t,r){let i=t.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(!i)return;delete t.glFramebuffers[this.CONTEXT_UID];let o=this.managedFramebuffers.indexOf(t);o>=0&&this.managedFramebuffers.splice(o,1),t.disposeRunner.remove(this),r||(n.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&n.deleteRenderbuffer(i.msaaBuffer),i.stencil&&n.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,r)}disposeAll(t){let r=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<r.length;i++)this.disposeFramebuffer(r[i],t)}forceStencil(){let t=this.current;if(!t)return;let r=t.glFramebuffers[this.CONTEXT_UID];if(!r||r.stencil)return;t.stencil=!0;let i=t.width,n=t.height,o=this.gl,a=o.createRenderbuffer();o.bindRenderbuffer(o.RENDERBUFFER,a),r.msaaBuffer?o.renderbufferStorageMultisample(o.RENDERBUFFER,r.multisample,o.DEPTH24_STENCIL8,i,n):o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,i,n),r.stencil=a,o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,a)}reset(){this.current=this.unknownFramebuffer,this.viewport=new ut}destroy(){this.renderer=null}};Rs.extension={type:z.RendererSystem,name:"framebuffer"};Z.add(Rs);var Cc={5126:4,5123:2,5121:1},Ps=class{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);let t=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;W.PREFER_ENV===hr.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=()=>i.createVertexArrayOES(),t.bindVertexArray=n=>i.bindVertexArrayOES(n),t.deleteVertexArray=n=>i.deleteVertexArrayOES(n)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(r.webGLVersion!==2){let i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=(n,o)=>i.vertexAttribDivisorANGLE(n,o),t.drawElementsInstanced=(n,o,a,c,f)=>i.drawElementsInstancedANGLE(n,o,a,c,f),t.drawArraysInstanced=(n,o,a,c)=>i.drawArraysInstancedANGLE(n,o,a,c)):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex}bind(t,r){r=r||this.renderer.shader.shader;let{gl:i}=this,n=t.glVertexArrayObjects[this.CONTEXT_UID],o=!1;n||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=n={},o=!0);let a=n[r.program.id]||this.initGeometryVao(t,r,o);this._activeGeometry=t,this._activeVao!==a&&(this._activeVao=a,this.hasVao?i.bindVertexArray(a):this.activateVao(t,r.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){let t=this._activeGeometry,r=this.renderer.buffer;for(let i=0;i<t.buffers.length;i++){let n=t.buffers[i];r.update(n)}}checkCompatibility(t,r){let i=t.attributes,n=r.attributeData;for(let o in n)if(!i[o])throw new Error(`shader and geometry incompatible, geometry missing the "${o}" attribute`)}getSignature(t,r){let i=t.attributes,n=r.attributeData,o=["g",t.id];for(let a in i)n[a]&&o.push(a,n[a].location);return o.join("-")}initGeometryVao(t,r,i=!0){let n=this.gl,o=this.CONTEXT_UID,a=this.renderer.buffer,c=r.program;c.glPrograms[o]||this.renderer.shader.generateProgram(r),this.checkCompatibility(t,c);let f=this.getSignature(t,c),p=t.glVertexArrayObjects[this.CONTEXT_UID],l=p[f];if(l)return p[c.id]=l,l;let h=t.buffers,d=t.attributes,m={},_={};for(let x in h)m[x]=0,_[x]=0;for(let x in d)!d[x].size&&c.attributeData[x]?d[x].size=c.attributeData[x].size:d[x].size||console.warn(`PIXI Geometry attribute '${x}' size cannot be determined (likely the bound shader does not have the attribute)`),m[d[x].buffer]+=d[x].size*Cc[d[x].type];for(let x in d){let T=d[x],S=T.size;T.stride===void 0&&(m[T.buffer]===S*Cc[T.type]?T.stride=0:T.stride=m[T.buffer]),T.start===void 0&&(T.start=_[T.buffer],_[T.buffer]+=S*Cc[T.type])}l=n.createVertexArray(),n.bindVertexArray(l);for(let x=0;x<h.length;x++){let T=h[x];a.bind(T),i&&T._glBuffers[o].refCount++}return this.activateVao(t,c),p[c.id]=l,p[f]=l,n.bindVertexArray(null),a.unbind(Qe.ARRAY_BUFFER),l}disposeGeometry(t,r){if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];let i=t.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,o=t.buffers,a=this.renderer?.buffer;if(t.disposeRunner.remove(this),!!i){if(a)for(let c=0;c<o.length;c++){let f=o[c]._glBuffers[this.CONTEXT_UID];f&&(f.refCount--,f.refCount===0&&!r&&a.dispose(o[c],r))}if(!r){for(let c in i)if(c[0]==="g"){let f=i[c];this._activeVao===f&&this.unbind(),n.deleteVertexArray(f)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){let r=Object.keys(this.managedGeometries);for(let i=0;i<r.length;i++)this.disposeGeometry(this.managedGeometries[r[i]],t)}activateVao(t,r){let i=this.gl,n=this.CONTEXT_UID,o=this.renderer.buffer,a=t.buffers,c=t.attributes;t.indexBuffer&&o.bind(t.indexBuffer);let f=null;for(let p in c){let l=c[p],h=a[l.buffer],d=h._glBuffers[n];if(r.attributeData[p]){f!==d&&(o.bind(h),f=d);let m=r.attributeData[p].location;if(i.enableVertexAttribArray(m),i.vertexAttribPointer(m,l.size,l.type||i.FLOAT,l.normalized,l.stride,l.start),l.instance)if(this.hasInstance)i.vertexAttribDivisor(m,l.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,r,i,n){let{gl:o}=this,a=this._activeGeometry;if(a.indexBuffer){let c=a.indexBuffer.data.BYTES_PER_ELEMENT,f=c===2?o.UNSIGNED_SHORT:o.UNSIGNED_INT;c===2||c===4&&this.canUseUInt32ElementIndex?a.instanced?o.drawElementsInstanced(t,r||a.indexBuffer.data.length,f,(i||0)*c,n||1):o.drawElements(t,r||a.indexBuffer.data.length,f,(i||0)*c):console.warn("unsupported index buffer type: uint32")}else a.instanced?o.drawArraysInstanced(t,i,r||a.getSize(),n||1):o.drawArrays(t,i,r||a.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}};Ps.extension={type:z.RendererSystem,name:"geometry"};Z.add(Ps);var Dg=new Et,en=class{constructor(t,r){this._texture=t,this.mapCoord=new Et,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof r>"u"?.5:r,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,r){r===void 0&&(r=t);let i=this.mapCoord;for(let n=0;n<t.length;n+=2){let o=t[n],a=t[n+1];r[n]=o*i.a+a*i.c+i.tx,r[n+1]=o*i.b+a*i.d+i.ty}return r}update(t){let r=this._texture;if(!r||!r.valid||!t&&this._textureID===r._updateID)return!1;this._textureID=r._updateID,this._updateID++;let i=r._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);let n=r.orig,o=r.trim;o&&(Dg.set(n.width/o.width,0,0,n.height/o.height,-o.x/o.width,-o.y/o.height),this.mapCoord.append(Dg));let a=r.baseTexture,c=this.uClampFrame,f=this.clampMargin/a.resolution,p=this.clampOffset;return c[0]=(r._frame.x+f+p)/a.width,c[1]=(r._frame.y+f+p)/a.height,c[2]=(r._frame.x+r._frame.width-f+p)/a.width,c[3]=(r._frame.y+r._frame.height-f+p)/a.height,this.uClampOffset[0]=p/a.realWidth,this.uClampOffset[1]=p/a.realHeight,this.isSimple=r._frame.width===a.width&&r._frame.height===a.height&&r.rotate===0,!0}};var Lg=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`;var Fg=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;var Xo=class extends Wt{constructor(t,r,i){let n=null;typeof t!="string"&&r===void 0&&i===void 0&&(n=t,t=void 0,r=void 0,i=void 0),super(t||Fg,r||Lg,i),this.maskSprite=n,this.maskMatrix=new Et}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,r,i,n){let o=this._maskSprite,a=o._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new en(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,o).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=o.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,t.applyFilter(this,r,i,n))}};var zo=class{constructor(t=null){this.type=ie.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Wt.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=ie.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}};var Ms=class{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,r){let i=r;if(!i.isMaskData){let o=this.maskDataPool.pop()||new zo;o.pooled=!0,o.maskObject=r,i=o}let n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(n),i._colorMask=n?n._colorMask:15,i.autoDetect&&this.detect(i),i._target=t,i.type!==ie.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case ie.SCISSOR:this.renderer.scissor.push(i);break;case ie.STENCIL:this.renderer.stencil.push(i);break;case ie.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case ie.COLOR:this.pushColorMask(i);break;default:break}i.type===ie.SPRITE&&this.maskStack.push(i)}pop(t){let r=this.maskStack.pop();if(!(!r||r._target!==t)){if(r.enabled)switch(r.type){case ie.SCISSOR:this.renderer.scissor.pop(r);break;case ie.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case ie.SPRITE:this.popSpriteMask(r);break;case ie.COLOR:this.popColorMask(r);break;default:break}if(r.reset(),r.pooled&&this.maskDataPool.push(r),this.maskStack.length!==0){let i=this.maskStack[this.maskStack.length-1];i.type===ie.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(t){let r=t.maskObject;r?r.isSprite?t.type=ie.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=ie.SCISSOR:t.type=ie.STENCIL:t.type=ie.COLOR}pushSpriteMask(t){let{maskObject:r}=t,i=t._target,n=t._filters;n||(n=this.alphaMaskPool[this.alphaMaskIndex],n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new Xo]));let o=this.renderer,a=o.renderTexture,c,f;if(a.current){let l=a.current;c=t.resolution||l.resolution,f=t.multisample??l.multisample}else c=t.resolution||o.resolution,f=t.multisample??o.multisample;n[0].resolution=c,n[0].multisample=f,n[0].maskSprite=r;let p=i.filterArea;i.filterArea=r.getBounds(!0),o.filter.push(i,n),i.filterArea=p,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){let r=t._colorMask,i=t._colorMask=r&t.colorMask;i!==r&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(t){let r=t._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==r&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}};Ms.extension={type:z.RendererSystem,name:"mask"};Z.add(Ms);var Bs=class{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){let{gl:r}=this.renderer,i=this.getStackLength();this.maskStack=t;let n=this.getStackLength();n!==i&&(n===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}};var Og=new Et,Ng=[],jl=class extends Bs{constructor(e){super(e),this.glConst=W.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){let e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;let t=e._scissorRect,{maskObject:r}=e,{renderer:i}=this,n=i.renderTexture,o=r.getBounds(!0,Ng.pop()??new ut);this.roundFrameToPixels(o,n.current?n.current.resolution:i.resolution,n.sourceFrame,n.destinationFrame,i.projection.transform),t&&o.fit(t),e._scissorRectLocal=o}static isMatrixRotated(e){if(!e)return!1;let{a:t,b:r,c:i,d:n}=e;return(Math.abs(r)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(n)>1e-4)}testScissor(e){let{maskObject:t}=e;if(!t.isFastRect||!t.isFastRect()||jl.isMatrixRotated(t.worldTransform)||jl.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);let r=e._scissorRectLocal;return r.width>0&&r.height>0}roundFrameToPixels(e,t,r,i,n){jl.isMatrixRotated(n)||(n=n?Og.copyFrom(n):Og.identity(),n.translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.renderer.filter.transformAABB(n,e),e.fit(i),e.x=Math.round(e.x*t),e.y=Math.round(e.y*t),e.width=Math.round(e.width*t),e.height=Math.round(e.height*t))}push(e){e._scissorRectLocal||this.calcScissorRect(e);let{gl:t}=this.renderer;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){let{gl:t}=this.renderer;e&&Ng.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){let e=this.maskStack[this.maskStack.length-1]._scissorRect,t;this.renderer.renderTexture.current?t=e.y:t=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}},Kl=jl;Kl.extension={type:z.RendererSystem,name:"scissor"};Z.add(Kl);var Ds=class extends Bs{constructor(t){super(t),this.glConst=W.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){let t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){let r=t.maskObject,{gl:i}=this.renderer,n=t._stencilCounter;n===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),t._stencilCounter++;let o=t._colorMask;o!==0&&(t._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,n,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,o!==0&&(t._colorMask=o,i.colorMask((o&1)!==0,(o&2)!==0,(o&4)!==0,(o&8)!==0)),this._useCurrent()}pop(t){let r=this.renderer.gl;if(this.getStackLength()===0)r.disable(r.STENCIL_TEST);else{let i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,n=i?i._colorMask:15;n!==0&&(i._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilOp(r.KEEP,r.KEEP,r.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,n!==0&&(i._colorMask=n,r.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}}_useCurrent(){let t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}};Ds.extension={type:z.RendererSystem,name:"stencil"};Z.add(Ds);var Ls=class{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return gt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return gt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return gt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){let t=this.rendererPlugins;for(let r in t)this.plugins[r]=new t[r](this.renderer)}destroy(){for(let t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}};Ls.extension={type:[z.RendererSystem,z.CanvasRendererSystem],name:"_plugin"};Z.add(Ls);var Fs=class{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Et,this.transform=null}update(t,r,i,n){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,n),this.transform&&this.projectionMatrix.append(this.transform);let o=this.renderer;o.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,o.globalUniforms.update(),o.shader.shader&&o.shader.syncUniformGroup(o.shader.shader.uniforms.globals)}calculateProjection(t,r,i,n){let o=this.projectionMatrix,a=n?-1:1;o.identity(),o.a=1/r.width*2,o.d=a*(1/r.height*2),o.tx=-1-r.x*o.a,o.ty=-a-r.y*o.d}setTransform(t){}destroy(){this.renderer=null}};Fs.extension={type:z.RendererSystem,name:"projection"};Z.add(Fs);var OS=new Dn,Os=class{constructor(t){this.renderer=t,this._tempMatrix=new Et}generateTexture(t,r){let{region:i,...n}=r||{},o=i||t.getLocalBounds(null,!0);o.width===0&&(o.width=1),o.height===0&&(o.height=1);let a=He.create({width:o.width,height:o.height,...n});this._tempMatrix.tx=-o.x,this._tempMatrix.ty=-o.y;let c=t.transform;return t.transform=OS,this.renderer.render(t,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=c,a}destroy(){}};Os.extension={type:[z.RendererSystem,z.CanvasRendererSystem],name:"textureGenerator"};Z.add(Os);var On=new ut,$o=new ut,Ns=class{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new ut,this.destinationFrame=new ut,this.viewportFrame=new ut}bind(t=null,r,i){let n=this.renderer;this.current=t;let o,a,c;t?(o=t.baseTexture,c=o.resolution,r||(On.width=t.frame.width,On.height=t.frame.height,r=On),i||($o.x=t.frame.x,$o.y=t.frame.y,$o.width=r.width,$o.height=r.height,i=$o),a=o.framebuffer):(c=n.resolution,r||(On.width=n._view.screen.width,On.height=n._view.screen.height,r=On),i||(i=On,i.width=r.width,i.height=r.height));let f=this.viewportFrame;f.x=i.x*c,f.y=i.y*c,f.width=i.width*c,f.height=i.height*c,t||(f.y=n.view.height-(f.y+f.height)),f.ceil(),this.renderer.framebuffer.bind(a,f),this.renderer.projection.update(i,r,c,!a),t?this.renderer.mask.setMaskStack(o.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(i)}clear(t,r){let i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,n=t?pt.shared.setValue(t):i,o=this.destinationFrame,a=this.current?this.current.baseTexture:this.renderer._view.screen,c=o.width!==a.width||o.height!==a.height;if(c){let{x:f,y:p,width:l,height:h}=this.viewportFrame;f=Math.round(f),p=Math.round(p),l=Math.round(l),h=Math.round(h),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(f,p,l,h)}this.renderer.framebuffer.clear(n.red,n.green,n.blue,n.alpha,r),c&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}};Ns.extension={type:z.RendererSystem,name:"renderTexture"};Z.add(Ns);var Yo=class{constructor(t,r){this.program=t,this.uniformData=r,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}};function Ug(e,t){let r={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let n=0;n<i;n++){let o=t.getActiveAttrib(e,n);if(o.name.startsWith("gl_"))continue;let a=No(t,o.type),c={type:a,name:o.name,size:Oo(a),location:t.getAttribLocation(e,o.name)};r[o.name]=c}return r}function kg(e,t){let r={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let n=0;n<i;n++){let o=t.getActiveUniform(e,n),a=o.name.replace(/\[.*?\]$/,""),c=!!o.name.match(/\[.*?\]$/),f=No(t,o.type);r[a]={name:a,index:n,type:f,size:o.size,isArray:c,value:Fo(f,o.size)}}return r}function Ic(e,t){let r=Nl(e,e.VERTEX_SHADER,t.vertexSrc),i=Nl(e,e.FRAGMENT_SHADER,t.fragmentSrc),n=e.createProgram();e.attachShader(n,r),e.attachShader(n,i);let o=t.extra?.transformFeedbackVaryings;if(o&&(typeof e.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):e.transformFeedbackVaryings(n,o.names,o.bufferMode==="separate"?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS)),e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS)||bc(e,n,r,i),t.attributeData=Ug(n,e),t.uniformData=kg(n,e),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){let f=Object.keys(t.attributeData);f.sort((p,l)=>p>l?1:-1);for(let p=0;p<f.length;p++)t.attributeData[f[p]].location=p,e.bindAttribLocation(n,p,f[p]);e.linkProgram(n)}e.deleteShader(r),e.deleteShader(i);let a={};for(let f in t.uniformData){let p=t.uniformData[f];a[f]={location:e.getUniformLocation(n,f),value:Fo(p.type,p.size)}}return new Yo(n,a)}function NS(e,t,r,i,n){r.buffer.update(n)}var US={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Gg={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function Hg(e){let t=e.map(o=>({data:o,offset:0,dataLen:0,dirty:0})),r=0,i=0,n=0;for(let o=0;o<t.length;o++){let a=t[o];if(r=Gg[a.data.type],a.data.size>1&&(r=Math.max(r,16)*a.data.size),a.dataLen=r,i%r!==0&&i<16){let c=i%r%16;i+=c,n+=c}i+r>16?(n=Math.ceil(n/16)*16,a.offset=n,n+=r,i=r):(a.offset=n,i+=r,n+=r)}return n=Math.ceil(n/16)*16,{uboElements:t,size:n}}function Vg(e,t){let r=[];for(let i in e)t[i]&&r.push(t[i]);return r.sort((i,n)=>i.index-n.index),r}function Rc(e,t){if(!e.autoManage)return{size:0,syncFunc:NS};let r=Vg(e.uniforms,t),{uboElements:i,size:n}=Hg(r),o=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let a=0;a<i.length;a++){let c=i[a],f=e.uniforms[c.data.name],p=c.data.name,l=!1;for(let h=0;h<ei.length;h++){let d=ei[h];if(d.codeUbo&&d.test(c.data,f)){o.push(`offset = ${c.offset/4};`,ei[h].codeUbo(c.data.name,f)),l=!0;break}}if(!l)if(c.data.size>1){let h=Oo(c.data.type),d=Math.max(Gg[c.data.type]/16,1),m=h/d,_=(4-m%4)%4;o.push(`
                cv = ud.${p}.value;
                v = uv.${p};
                offset = ${c.offset/4};

                t = 0;

                for(var i=0; i < ${c.data.size*d}; i++)
                {
                    for(var j = 0; j < ${m}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${_};
                }

                `)}else{let h=US[c.data.type];o.push(`
                cv = ud.${p}.value;
                v = uv.${p};
                offset = ${c.offset/4};
                ${h};
                `)}}return o.push(`
       renderer.buffer.update(buffer);
    `),{size:n,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join(`
`))}}var kS=0,ql={textureCount:0,uboCount:0},Us=class{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=kS++}systemCheck(){if(!Wl())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,r){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;let i=t.program,n=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(n.program)),r||(ql.textureCount=0,ql.uboCount=0,this.syncUniformGroup(t.uniformGroup,ql)),n}setUniforms(t){let r=this.shader.program,i=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(i.uniformData,t,this.renderer)}syncUniformGroup(t,r){let i=this.getGlProgram();(!t.static||t.dirtyId!==i.uniformDirtyGroups[t.id])&&(i.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,r))}syncUniforms(t,r,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(r.uniformData,t.uniforms,this.renderer,i)}createSyncGroups(t){let r=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[r]||(this.cache[r]=Ec(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[r],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,r){let i=this.getGlProgram();if(!t.static||t.dirtyId!==0||!i.uniformGroups[t.id]){t.dirtyId=0;let n=i.uniformGroups[t.id]||this.createSyncBufferGroup(t,i,r);t.buffer.update(),n(i.uniformData,t.uniforms,this.renderer,ql,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,i.uniformBufferBindings[r])}createSyncBufferGroup(t,r,i){let{gl:n}=this.renderer;this.renderer.buffer.bind(t.buffer);let o=this.gl.getUniformBlockIndex(r.program,i);r.uniformBufferBindings[i]=this.shader.uniformBindCount,n.uniformBlockBinding(r.program,o,this.shader.uniformBindCount),this.shader.uniformBindCount++;let a=this.getSignature(t,this.shader.program.uniformData,"ubo"),c=this._uboCache[a];if(c||(c=this._uboCache[a]=Rc(t,this.shader.program.uniformData)),t.autoManage){let f=new Float32Array(c.size/4);t.buffer.update(f)}return r.uniformGroups[t.id]=c.syncFunc,r.uniformGroups[t.id]}getSignature(t,r,i){let n=t.uniforms,o=[`${i}-`];for(let a in n)o.push(a),r[a]&&o.push(r[a].type);return o.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){let r=this.gl,i=t.program,n=Ic(r,i);return i.glPrograms[this.renderer.CONTEXT_UID]=n,n}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}};Us.extension={type:z.RendererSystem,name:"shader"};Z.add(Us);var Ei=class{constructor(t){this.renderer=t}run(t){let{renderer:r}=this;r.runners.init.emit(r.options),t.hello&&console.log(`PixiJS 7.2.2 - ${r.rendererLogId} - https://pixijs.com`),r.resize(r.screen.width,r.screen.height)}destroy(){}};Ei.defaultOptions={hello:!1};Ei.extension={type:[z.RendererSystem,z.CanvasRendererSystem],name:"startup"};Z.add(Ei);function Wg(e,t=[]){return t[ft.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.ADD]=[e.ONE,e.ONE],t[ft.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.NONE]=[0,0],t[ft.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[ft.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ft.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[ft.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[ft.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[ft.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[ft.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[ft.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[ft.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[ft.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[ft.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}var GS=0,HS=1,VS=2,WS=3,XS=4,zS=5,Pc=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=ft.NONE,this._blendEq=!1,this.map=[],this.map[GS]=this.setBlend,this.map[HS]=this.setOffset,this.map[VS]=this.setCullFace,this.map[WS]=this.setDepthTest,this.map[XS]=this.setFrontFace,this.map[zS]=this.setDepthMask,this.checks=[],this.defaultState=new de,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=Wg(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,r=0;for(;t;)t&1&&this.map[r].call(this,!!(e.data&1<<r)),t=t>>1,r++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(Pc.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(Pc.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;let t=this.blendModes[e],r=this.gl;t.length===2?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){let r=this.checks.indexOf(e);t&&r===-1?this.checks.push(e):!t&&r!==-1&&this.checks.splice(r,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}},Zl=Pc;Zl.extension={type:z.RendererSystem,name:"state"};Z.add(Zl);var ks=class extends Yi.default{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);let r=(t.priority??[]).filter(n=>t.systems[n]),i=[...r,...Object.keys(t.systems).filter(n=>!r.includes(n))];for(let n of i)this.addSystem(t.systems[n],n)}addRunners(...t){t.forEach(r=>{this.runners[r]=new ae(r)})}addSystem(t,r){let i=new t(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=i,this._systemsHash[r]=i;for(let n in this.runners)this.runners[n].add(i);return this}emitWithCustomOptions(t,r){let i=Object.keys(this._systemsHash);t.items.forEach(n=>{let o=i.find(a=>this._systemsHash[a]===n);n[t.name](r[o])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}};var Ql=class{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=Ql.defaultMaxIdle,this.checkCountMax=Ql.defaultCheckCountMax,this.mode=Ql.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==xl.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){let e=this.renderer.texture,t=e.managedTextures,r=!1;for(let i=0;i<t.length;i++){let n=t[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(e.destroyTexture(n,!0),t[i]=null,r=!0)}if(r){let i=0;for(let n=0;n<t.length;n++)t[n]!==null&&(t[i++]=t[n]);t.length=i}}unload(e){let t=this.renderer.texture,r=e._texture;r&&!r.framebuffer&&t.destroyTexture(r);for(let i=e.children.length-1;i>=0;i--)this.unload(e.children[i])}destroy(){this.renderer=null}},er=Ql;er.defaultMode=xl.AUTO;er.defaultMaxIdle=60*60;er.defaultCheckCountMax=60*10;er.extension={type:z.RendererSystem,name:"textureGC"};Z.add(er);var Nn=class{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=at.UNSIGNED_BYTE,this.internalFormat=tt.RGBA,this.samplerType=0}};function Xg(e){let t;return"WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?t={[at.UNSIGNED_BYTE]:{[tt.RGBA]:e.RGBA8,[tt.RGB]:e.RGB8,[tt.RG]:e.RG8,[tt.RED]:e.R8,[tt.RGBA_INTEGER]:e.RGBA8UI,[tt.RGB_INTEGER]:e.RGB8UI,[tt.RG_INTEGER]:e.RG8UI,[tt.RED_INTEGER]:e.R8UI,[tt.ALPHA]:e.ALPHA,[tt.LUMINANCE]:e.LUMINANCE,[tt.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[at.BYTE]:{[tt.RGBA]:e.RGBA8_SNORM,[tt.RGB]:e.RGB8_SNORM,[tt.RG]:e.RG8_SNORM,[tt.RED]:e.R8_SNORM,[tt.RGBA_INTEGER]:e.RGBA8I,[tt.RGB_INTEGER]:e.RGB8I,[tt.RG_INTEGER]:e.RG8I,[tt.RED_INTEGER]:e.R8I},[at.UNSIGNED_SHORT]:{[tt.RGBA_INTEGER]:e.RGBA16UI,[tt.RGB_INTEGER]:e.RGB16UI,[tt.RG_INTEGER]:e.RG16UI,[tt.RED_INTEGER]:e.R16UI,[tt.DEPTH_COMPONENT]:e.DEPTH_COMPONENT16},[at.SHORT]:{[tt.RGBA_INTEGER]:e.RGBA16I,[tt.RGB_INTEGER]:e.RGB16I,[tt.RG_INTEGER]:e.RG16I,[tt.RED_INTEGER]:e.R16I},[at.UNSIGNED_INT]:{[tt.RGBA_INTEGER]:e.RGBA32UI,[tt.RGB_INTEGER]:e.RGB32UI,[tt.RG_INTEGER]:e.RG32UI,[tt.RED_INTEGER]:e.R32UI,[tt.DEPTH_COMPONENT]:e.DEPTH_COMPONENT24},[at.INT]:{[tt.RGBA_INTEGER]:e.RGBA32I,[tt.RGB_INTEGER]:e.RGB32I,[tt.RG_INTEGER]:e.RG32I,[tt.RED_INTEGER]:e.R32I},[at.FLOAT]:{[tt.RGBA]:e.RGBA32F,[tt.RGB]:e.RGB32F,[tt.RG]:e.RG32F,[tt.RED]:e.R32F,[tt.DEPTH_COMPONENT]:e.DEPTH_COMPONENT32F},[at.HALF_FLOAT]:{[tt.RGBA]:e.RGBA16F,[tt.RGB]:e.RGB16F,[tt.RG]:e.RG16F,[tt.RED]:e.R16F},[at.UNSIGNED_SHORT_5_6_5]:{[tt.RGB]:e.RGB565},[at.UNSIGNED_SHORT_4_4_4_4]:{[tt.RGBA]:e.RGBA4},[at.UNSIGNED_SHORT_5_5_5_1]:{[tt.RGBA]:e.RGB5_A1},[at.UNSIGNED_INT_2_10_10_10_REV]:{[tt.RGBA]:e.RGB10_A2,[tt.RGBA_INTEGER]:e.RGB10_A2UI},[at.UNSIGNED_INT_10F_11F_11F_REV]:{[tt.RGB]:e.R11F_G11F_B10F},[at.UNSIGNED_INT_5_9_9_9_REV]:{[tt.RGB]:e.RGB9_E5},[at.UNSIGNED_INT_24_8]:{[tt.DEPTH_STENCIL]:e.DEPTH24_STENCIL8},[at.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[tt.DEPTH_STENCIL]:e.DEPTH32F_STENCIL8}}:t={[at.UNSIGNED_BYTE]:{[tt.RGBA]:e.RGBA,[tt.RGB]:e.RGB,[tt.ALPHA]:e.ALPHA,[tt.LUMINANCE]:e.LUMINANCE,[tt.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[at.UNSIGNED_SHORT_5_6_5]:{[tt.RGB]:e.RGB},[at.UNSIGNED_SHORT_4_4_4_4]:{[tt.RGBA]:e.RGBA},[at.UNSIGNED_SHORT_5_5_5_1]:{[tt.RGBA]:e.RGBA}},t}var Gs=class{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new lt,this.hasIntegerTextures=!1}contextChange(){let t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=Xg(t);let r=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(let n=0;n<r;n++)this.boundTextures[n]=null;this.emptyTextures={};let i=new Nn(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Nn(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let n=0;n<this.boundTextures.length;n++)this.bind(null,n)}bind(t,r=0){let{gl:i}=this;if(t=t?.castToBaseTexture(),t?.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;let n=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[r]!==t&&(this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),i.bindTexture(t.target,n.texture)),n.dirtyId!==t.dirtyId?(this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),this.updateTexture(t)):n.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[r]=t}else this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[r]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){let{gl:r,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let n=0;n<i.length;n++)i[n]===this.unknownTexture&&this.bind(null,n)}for(let n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(r.activeTexture(r.TEXTURE0+n),this.currentLocation=n),r.bindTexture(t.target,this.emptyTextures[t.target].texture),i[n]=null)}ensureSamplerType(t){let{boundTextures:r,hasIntegerTextures:i,CONTEXT_UID:n}=this;if(i)for(let o=t-1;o>=0;--o){let a=r[o];a&&a._glTextures[n].samplerType!==_l.FLOAT&&this.renderer.texture.unbind(a)}}initTexture(t){let r=new Nn(this.gl.createTexture());return r.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),r}initTextureType(t,r){r.internalFormat=this.internalFormats[t.type]?.[t.format]??t.format,this.webGLVersion===2&&t.type===at.HALF_FLOAT?r.type=this.gl.HALF_FLOAT:r.type=t.type}updateTexture(t){let r=t._glTextures[this.CONTEXT_UID];if(!r)return;let i=this.renderer;if(this.initTextureType(t,r),t.resource?.upload(i,t,r))r.samplerType!==_l.FLOAT&&(this.hasIntegerTextures=!0);else{let n=t.realWidth,o=t.realHeight,a=i.gl;(r.width!==n||r.height!==o||r.dirtyId<0)&&(r.width=n,r.height=o,a.texImage2D(t.target,0,r.internalFormat,n,o,0,t.format,r.type,null))}t.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(t),r.dirtyId=t.dirtyId}destroyTexture(t,r){let{gl:i}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!r)){let n=this.managedTextures.indexOf(t);n!==-1&&Rl(this.managedTextures,n,1)}}updateTextureStyle(t){let r=t._glTextures[this.CONTEXT_UID];r&&((t.mipmap===Se.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?r.mipmap=!1:r.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?r.wrapMode=ur.CLAMP:r.wrapMode=t.wrapMode,t.resource?.style(this.renderer,t,r)||this.setStyle(t,r),r.dirtyStyleId=t.dirtyStyleId)}setStyle(t,r){let i=this.gl;if(r.mipmap&&t.mipmap!==Se.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,r.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===br.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);let n=this.renderer.context.extensions.anisotropicFiltering;if(n&&t.anisotropicLevel>0&&t.scaleMode===br.LINEAR){let o=Math.min(t.anisotropicLevel,i.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,n.TEXTURE_MAX_ANISOTROPY_EXT,o)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===br.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===br.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}};Gs.extension={type:z.RendererSystem,name:"texture"};Z.add(Gs);var Hs=class{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){let{gl:r,CONTEXT_UID:i}=this,n=t._glTransformFeedbacks[i]||this.createGLTransformFeedback(t);r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,n)}unbind(){let{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,r){let{gl:i,renderer:n}=this;r&&n.shader.bind(r),i.beginTransformFeedback(t)}endTransformFeedback(){let{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){let{gl:r,renderer:i,CONTEXT_UID:n}=this,o=r.createTransformFeedback();t._glTransformFeedbacks[n]=o,r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,o);for(let a=0;a<t.buffers.length;a++){let c=t.buffers[a];c&&(i.buffer.update(c),c._glBuffers[n].refCount++,r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,a,c._glBuffers[n].buffer||null))}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),o}disposeTransformFeedback(t,r){let i=t._glTransformFeedbacks[this.CONTEXT_UID],n=this.gl;t.disposeRunner.remove(this);let o=this.renderer.buffer;if(o)for(let a=0;a<t.buffers.length;a++){let c=t.buffers[a];if(!c)continue;let f=c._glBuffers[this.CONTEXT_UID];f&&(f.refCount--,f.refCount===0&&!r&&o.dispose(c,r))}i&&(r||n.deleteTransformFeedback(i),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}};Hs.extension={type:z.RendererSystem,name:"transformFeedback"};Z.add(Hs);var Si=class{constructor(t){this.renderer=t}init(t){this.screen=new ut(0,0,t.width,t.height),this.element=t.view||W.ADAPTER.createCanvas(),this.resolution=t.resolution||W.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,r){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(r*this.resolution);let i=this.element.width/this.resolution,n=this.element.height/this.resolution;this.screen.width=i,this.screen.height=n,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${n}px`),this.renderer.emit("resize",i,n),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){t&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}};Si.defaultOptions={width:800,height:600,resolution:W.RESOLUTION,autoDensity:!1};Si.extension={type:[z.RendererSystem,z.CanvasRendererSystem],name:"_view"};Z.add(Si);W.PREFER_ENV=hr.WEBGL2;W.STRICT_TEXTURE_CACHE=!1;W.RENDER_OPTIONS={...wi.defaultOptions,...Ti.defaultOptions,...Si.defaultOptions,...Ei.defaultOptions};Object.defineProperties(W,{WRAP_MODE:{get(){return lt.defaultOptions.wrapMode},set(e){gt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),lt.defaultOptions.wrapMode=e}},SCALE_MODE:{get(){return lt.defaultOptions.scaleMode},set(e){gt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),lt.defaultOptions.scaleMode=e}},MIPMAP_TEXTURES:{get(){return lt.defaultOptions.mipmap},set(e){gt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),lt.defaultOptions.mipmap=e}},ANISOTROPIC_LEVEL:{get(){return lt.defaultOptions.anisotropicLevel},set(e){gt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),lt.defaultOptions.anisotropicLevel=e}},FILTER_RESOLUTION:{get(){return gt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Wt.defaultResolution},set(e){Wt.defaultResolution=e}},FILTER_MULTISAMPLE:{get(){return gt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Wt.defaultMultisample},set(e){Wt.defaultMultisample=e}},SPRITE_MAX_TEXTURES:{get(){return dr.defaultMaxTextures},set(e){gt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),dr.defaultMaxTextures=e}},SPRITE_BATCH_SIZE:{get(){return dr.defaultBatchSize},set(e){gt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),dr.defaultBatchSize=e}},CAN_UPLOAD_SAME_BUFFER:{get(){return dr.canUploadSameBuffer},set(e){gt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),dr.canUploadSameBuffer=e}},GC_MODE:{get(){return er.defaultMode},set(e){gt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),er.defaultMode=e}},GC_MAX_IDLE:{get(){return er.defaultMaxIdle},set(e){gt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),er.defaultMaxIdle=e}},GC_MAX_CHECK_COUNT:{get(){return er.defaultCheckCountMax},set(e){gt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),er.defaultCheckCountMax=e}},PRECISION_VERTEX:{get(){return we.defaultVertexPrecision},set(e){gt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),we.defaultVertexPrecision=e}},PRECISION_FRAGMENT:{get(){return we.defaultFragmentPrecision},set(e){gt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),we.defaultFragmentPrecision=e}}});var pr=(e=>(e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e))(pr||{});var Vs=class{constructor(t,r=null,i=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=r,this.priority=i,this.once=n}match(t,r=null){return this.fn===t&&this.context===r}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));let r=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);let r=this.next;return this.next=t?null:r,this.previous=null,r}};var mr=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Vs(null,null,1/0),this.deltaMS=1/mr.targetFPMS,this.elapsedMS=1/mr.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,r=pr.NORMAL){return this._addListener(new Vs(e,t,r))}addOnce(e,t,r=pr.NORMAL){return this._addListener(new Vs(e,t,r,!0))}_addListener(e){let t=this._head.next,r=this._head;if(!t)e.connect(r);else{for(;t;){if(e.priority>t.priority){e.connect(r);break}r=t,t=t.next}e.previous||e.connect(r)}return this._startIfPossible(),this}remove(e,t){let r=this._head.next;for(;r;)r.match(e,t)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){let n=e-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=e-n%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*mr.targetFPMS;let r=this._head,i=r.next;for(;i;)i=i.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){let t=Math.min(this.maxFPS,e),r=Math.min(Math.max(0,t)/1e3,mr.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{let t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!mr._shared){let e=mr._shared=new mr;e.autoStart=!0,e._protected=!0}return mr._shared}static get system(){if(!mr._system){let e=mr._system=new mr;e.autoStart=!0,e._protected=!0}return mr._system}},ee=mr;ee.targetFPMS=.06;Object.defineProperties(W,{TARGET_FPMS:{get(){return ee.targetFPMS},set(e){gt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),ee.targetFPMS=e}}});var jo=class{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,pr.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?ee.shared:new ee,t.autoStart&&this.start()}static destroy(){if(this._ticker){let t=this._ticker;this.ticker=null,t.destroy()}}};jo.extension=z.Application;Z.add(jo);var zg=[];Z.handleByList(z.Renderer,zg);function Mc(e){for(let t of zg)if(t.test(e))return new t(e);throw new Error("Unable to auto-detect a suitable renderer.")}var $g=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`;var Yg=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;var Bc=$g,Ko=Yg;var qo=class{constructor(t){this.renderer=t}contextChange(t){let r;if(this.renderer.context.webGLVersion===1){let i=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),r=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,i)}else{let i=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),r=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,i)}r>=Lt.HIGH?this.multisample=Lt.HIGH:r>=Lt.MEDIUM?this.multisample=Lt.MEDIUM:r>=Lt.LOW?this.multisample=Lt.LOW:this.multisample=Lt.NONE}destroy(){}};qo.extension={type:z.RendererSystem,name:"_multisample"};Z.add(qo);var Jl=class{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}};var Zo=class{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){let{gl:r,CONTEXT_UID:i}=this,n=t._glBuffers[i]||this.createGLBuffer(t);r.bindBuffer(t.type,n.buffer)}unbind(t){let{gl:r}=this;r.bindBuffer(t,null)}bindBufferBase(t,r){let{gl:i,CONTEXT_UID:n}=this;if(this.boundBufferBases[r]!==t){let o=t._glBuffers[n]||this.createGLBuffer(t);this.boundBufferBases[r]=t,i.bindBufferBase(i.UNIFORM_BUFFER,r,o.buffer)}}bindBufferRange(t,r,i){let{gl:n,CONTEXT_UID:o}=this;i=i||0;let a=t._glBuffers[o]||this.createGLBuffer(t);n.bindBufferRange(n.UNIFORM_BUFFER,r||0,a.buffer,i*256,256)}update(t){let{gl:r,CONTEXT_UID:i}=this,n=t._glBuffers[i]||this.createGLBuffer(t);if(t._updateID!==n.updateID)if(n.updateID=t._updateID,r.bindBuffer(t.type,n.buffer),n.byteLength>=t.data.byteLength)r.bufferSubData(t.type,0,t.data);else{let o=t.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;n.byteLength=t.data.byteLength,r.bufferData(t.type,t.data,o)}}dispose(t,r){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];let i=t._glBuffers[this.CONTEXT_UID],n=this.gl;t.disposeRunner.remove(this),i&&(r||n.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){let r=Object.keys(this.managedBuffers);for(let i=0;i<r.length;i++)this.dispose(this.managedBuffers[r[i]],t)}createGLBuffer(t){let{CONTEXT_UID:r,gl:i}=this;return t._glBuffers[r]=new Jl(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[r]}};Zo.extension={type:z.RendererSystem,name:"buffer"};Z.add(Zo);var Qo=class{constructor(t){this.renderer=t}render(t,r){let i=this.renderer,n,o,a,c;if(r&&(n=r.renderTexture,o=r.clear,a=r.transform,c=r.skipUpdateTransform),this.renderingToScreen=!n,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=a,!i.context.isLost){if(n||(this.lastObjectRendered=t),!c){let f=t.enableTempParent();t.updateTransform(),t.disableTempParent(f)}i.renderTexture.bind(n),i.batch.currentRenderer.start(),(o??i.background.clearBeforeRender)&&i.renderTexture.clear(),t.render(i),i.batch.currentRenderer.flush(),n&&(r.blit&&i.framebuffer.blit(),n.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}};Qo.extension={type:z.RendererSystem,name:"objectRenderer"};Z.add(Qo);var Dc=class extends ks{constructor(e){super(),this.type=Yu.WEBGL,e=Object.assign({},W.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new pe({projectionMatrix:new Et},!0);let t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Dc.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in e&&(gt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=Dc.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e?.forceCanvas?!1:Al()}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return gt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return gt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return gt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return gt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){gt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return gt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){gt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return gt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}},Un=Dc;Un.extension={type:z.Renderer,priority:1};Un.__plugins={};Un.__systems={};Z.handleByMap(z.RendererPlugin,Un.__plugins);Z.handleByMap(z.RendererSystem,Un.__systems);Z.add(Un);var rn=class extends fr{constructor(t,r){let{width:i,height:n}=r||{};super(i,n),this.items=[],this.itemDirtyIds=[];for(let o=0;o<t;o++){let a=new lt;this.items.push(a),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,r){for(let i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof fr?this.addResourceAt(t[i],i):this.addResourceAt(ws(t[i],r),i))}dispose(){for(let t=0,r=this.length;t<r;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,r){if(!this.items[r])throw new Error(`Index ${r} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[r].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=t,this.items[r].on("update",t.update,t)}unbind(t){super.unbind(t);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",t.update,t)}load(){if(this._load)return this._load;let r=this.items.map(i=>i.resource).filter(i=>i).map(i=>i.load());return this._load=Promise.all(r).then(()=>{let{realWidth:i,realHeight:n}=this.items[0];return this.resize(i,n),Promise.resolve(this)}),this._load}};var Ws=class extends rn{constructor(t,r){let{width:i,height:n}=r||{},o,a;Array.isArray(t)?(o=t,a=t.length):a=t,super(a,{width:i,height:n}),o&&this.initFromArray(o,r)}addBaseTextureAt(t,r){if(t.resource)this.addResourceAt(t.resource,r);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=xi.TEXTURE_2D_ARRAY}upload(t,r,i){let{length:n,itemDirtyIds:o,items:a}=this,{gl:c}=t;i.dirtyId<0&&c.texImage3D(c.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,n,0,r.format,i.type,null);for(let f=0;f<n;f++){let p=a[f];o[f]<p.dirtyId&&(o[f]=p.dirtyId,p.valid&&c.texSubImage3D(c.TEXTURE_2D_ARRAY,0,0,0,f,p.resource.width,p.resource.height,1,r.format,i.type,p.resource.source))}return!0}};var Xs=class extends be{constructor(t){super(t)}static test(t){let{OffscreenCanvas:r}=globalThis;return r&&t instanceof r?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}};var Jo=class extends rn{constructor(e,t){let{width:r,height:i,autoLoad:n,linkBaseTexture:o}=t||{};if(e&&e.length!==Jo.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:r,height:i});for(let a=0;a<Jo.SIDES;a++)this.items[a].target=xi.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=o!==!1,e&&this.initFromArray(e,t),n!==!1&&this.load()}bind(e){super.bind(e),e.target=xi.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,r){if(r===void 0&&(r=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=xi.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(e,t,r){let i=this.itemDirtyIds;for(let n=0;n<Jo.SIDES;n++){let o=this.items[n];(i[n]<o.dirtyId||r.dirtyId<t.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(e,o,r),i[n]=o.dirtyId):i[n]<-1&&(e.gl.texImage2D(o.target,0,r.internalFormat,t.realWidth,t.realHeight,0,t.format,r.type,null),i[n]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===Jo.SIDES}},ta=Jo;ta.SIDES=6;var Hr=class extends be{constructor(t,r){r=r||{};let i,n;typeof t=="string"?(i=Hr.EMPTY,n=t):(i=t,n=null),super(i),this.url=n,this.crossOrigin=r.crossOrigin??!0,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,r)=>{if(this.url===null){t(this);return}try{let i=await W.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;let n=await i.blob();if(this.destroyed)return;let o=await createImageBitmap(n,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ue.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=o,this.update(),t(this)}catch(i){if(this.destroyed)return;r(i),this.onError.emit(i)}}),this._load)}upload(t,r,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),super.upload(t,r,i)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return Hr._EMPTY=Hr._EMPTY??W.ADAPTER.createCanvas(0,0),Hr._EMPTY}};var th=class extends be{constructor(e,t){t=t||{},super(W.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),e(this)},th.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){let e=new Image;be.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=t=>{this._resolve&&(e.onerror=null,this.onError.emit(t))},e.onload=()=>{if(!this._resolve)return;let t=e.width,r=e.height;if(!t||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=t*this.scale,n=r*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/r*t,n=this._overrideHeight||this._overrideWidth/t*r),i=Math.round(i),n=Math.round(n);let o=this.source;o.width=i,o.height=n,o._pixiId=`canvas_${ti()}`,o.getContext("2d").drawImage(e,0,0,t,r,0,0,i,n),this._resolve(),this._resolve=null}}static getSize(e){let t=th.SVG_SIZE.exec(e),r={};return t&&(r[t[1]]=Math.round(parseFloat(t[3])),r[t[5]]=Math.round(parseFloat(t[7]))),r}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,t){return t==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&th.SVG_XML.test(e)}},bi=th;bi.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;bi.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var Lc=class extends be{constructor(e,t){if(t=t||{},!(e instanceof HTMLVideoElement)){let r=document.createElement("video");r.setAttribute("preload","auto"),r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline",""),typeof e=="string"&&(e=[e]);let i=e[0].src||e[0];be.crossOrigin(r,i,t.crossorigin);for(let n=0;n<e.length;++n){let o=document.createElement("source"),{src:a,mime:c}=e[n];a=a||e[n];let f=a.split("?").shift().toLowerCase(),p=f.slice(f.lastIndexOf(".")+1);c=c||Lc.MIME_TYPES[p]||`video/${p}`,o.src=a,o.type=c,r.appendChild(o)}e=r}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){let t=ee.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;let e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)}_isSourcePlaying(){let e=this.source;return!e.paused&&!e.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(ee.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(ee.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){let e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);let t=this.valid;this.resize(e.videoWidth,e.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._isConnectedToTicker&&(ee.shared.remove(this.update,this),this._isConnectedToTicker=!1);let e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(ee.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(ee.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e)}static test(e,t){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||Lc.TYPES.includes(t)}},zs=Lc;zs.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];zs.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};Ts.push(Hr,tn,Xs,zs,bi,Je,ta,Ws);var ri=class{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?ut.EMPTY:(t=t||new ut(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,r){let{a:i,b:n,c:o,d:a,tx:c,ty:f}=t,p=i*r.x+o*r.y+c,l=n*r.x+a*r.y+f;this.minX=Math.min(this.minX,p),this.maxX=Math.max(this.maxX,p),this.minY=Math.min(this.minY,l),this.maxY=Math.max(this.maxY,l)}addQuad(t){let r=this.minX,i=this.minY,n=this.maxX,o=this.maxY,a=t[0],c=t[1];r=a<r?a:r,i=c<i?c:i,n=a>n?a:n,o=c>o?c:o,a=t[2],c=t[3],r=a<r?a:r,i=c<i?c:i,n=a>n?a:n,o=c>o?c:o,a=t[4],c=t[5],r=a<r?a:r,i=c<i?c:i,n=a>n?a:n,o=c>o?c:o,a=t[6],c=t[7],r=a<r?a:r,i=c<i?c:i,n=a>n?a:n,o=c>o?c:o,this.minX=r,this.minY=i,this.maxX=n,this.maxY=o}addFrame(t,r,i,n,o){this.addFrameMatrix(t.worldTransform,r,i,n,o)}addFrameMatrix(t,r,i,n,o){let a=t.a,c=t.b,f=t.c,p=t.d,l=t.tx,h=t.ty,d=this.minX,m=this.minY,_=this.maxX,x=this.maxY,T=a*r+f*i+l,S=c*r+p*i+h;d=T<d?T:d,m=S<m?S:m,_=T>_?T:_,x=S>x?S:x,T=a*n+f*i+l,S=c*n+p*i+h,d=T<d?T:d,m=S<m?S:m,_=T>_?T:_,x=S>x?S:x,T=a*r+f*o+l,S=c*r+p*o+h,d=T<d?T:d,m=S<m?S:m,_=T>_?T:_,x=S>x?S:x,T=a*n+f*o+l,S=c*n+p*o+h,d=T<d?T:d,m=S<m?S:m,_=T>_?T:_,x=S>x?S:x,this.minX=d,this.minY=m,this.maxX=_,this.maxY=x}addVertexData(t,r,i){let n=this.minX,o=this.minY,a=this.maxX,c=this.maxY;for(let f=r;f<i;f+=2){let p=t[f],l=t[f+1];n=p<n?p:n,o=l<o?l:o,a=p>a?p:a,c=l>c?l:c}this.minX=n,this.minY=o,this.maxX=a,this.maxY=c}addVertices(t,r,i,n){this.addVerticesMatrix(t.worldTransform,r,i,n)}addVerticesMatrix(t,r,i,n,o=0,a=o){let c=t.a,f=t.b,p=t.c,l=t.d,h=t.tx,d=t.ty,m=this.minX,_=this.minY,x=this.maxX,T=this.maxY;for(let S=i;S<n;S+=2){let b=r[S],y=r[S+1],w=c*b+p*y+h,I=l*y+f*b+d;m=Math.min(m,w-o),x=Math.max(x,w+o),_=Math.min(_,I-a),T=Math.max(T,I+a)}this.minX=m,this.minY=_,this.maxX=x,this.maxY=T}addBounds(t){let r=this.minX,i=this.minY,n=this.maxX,o=this.maxY;this.minX=t.minX<r?t.minX:r,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>n?t.maxX:n,this.maxY=t.maxY>o?t.maxY:o}addBoundsMask(t,r){let i=t.minX>r.minX?t.minX:r.minX,n=t.minY>r.minY?t.minY:r.minY,o=t.maxX<r.maxX?t.maxX:r.maxX,a=t.maxY<r.maxY?t.maxY:r.maxY;if(i<=o&&n<=a){let c=this.minX,f=this.minY,p=this.maxX,l=this.maxY;this.minX=i<c?i:c,this.minY=n<f?n:f,this.maxX=o>p?o:p,this.maxY=a>l?a:l}}addBoundsMatrix(t,r){this.addFrameMatrix(r,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,r){let i=t.minX>r.x?t.minX:r.x,n=t.minY>r.y?t.minY:r.y,o=t.maxX<r.x+r.width?t.maxX:r.x+r.width,a=t.maxY<r.y+r.height?t.maxY:r.y+r.height;if(i<=o&&n<=a){let c=this.minX,f=this.minY,p=this.maxX,l=this.maxY;this.minX=i<c?i:c,this.minY=n<f?n:f,this.maxX=o>p?o:p,this.maxY=a>l?a:l}}pad(t=0,r=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=r,this.maxY+=r)}addFramePad(t,r,i,n,o,a){t-=o,r-=a,i+=o,n+=a,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<r?this.minY:r,this.maxY=this.maxY>n?this.maxY:n}};var Ft=class extends et.EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Dn,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new ri,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){let r=Object.keys(t);for(let i=0;i<r.length;++i){let n=r[i];Object.defineProperty(Ft.prototype,n,Object.getOwnPropertyDescriptor(t,n))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,r){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new ut),r=this._boundsRect),this._bounds.getRectangle(r)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new ut),t=this._localBoundsRect),this._localBounds||(this._localBounds=new ri);let r=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;let n=this._bounds,o=this._boundsID;this._bounds=this._localBounds;let a=this.getBounds(!1,t);return this.parent=i,this.transform=r,this._bounds=n,this._bounds.updateID+=this._boundsID-o,a}toGlobal(t,r,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,r)}toLocal(t,r,i,n){return r&&(t=r.toGlobal(t,i,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){this.parent?.removeChild(this)}setTransform(t=0,r=0,i=1,n=1,o=0,a=0,c=0,f=0,p=0){return this.position.x=t,this.position.y=r,this.scale.x=i||1,this.scale.y=n||1,this.rotation=o,this.skew.x=a,this.skew.y=c,this.pivot.x=f,this.pivot.y=p,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new eh),this.tempDisplayObjectParent}enableTempParent(){let t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*vc}set angle(t){this.transform.rotation=t*yc}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){let r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount--,r._maskRefCount===0&&(r.renderable=!0,r.isMask=!1))}if(this._mask=t,this._mask){let r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount===0&&(r.renderable=!1,r.isMask=!0),r._maskRefCount++)}}}},eh=class extends Ft{constructor(){super(...arguments),this.sortDirty=null}};Ft.prototype.displayObjectUpdateTransform=Ft.prototype.updateTransform;var $S=new Et;function YS(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}var Fc=class extends Ft{constructor(){super(),this.children=[],this.sortableChildren=Fc.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.addChild(e[t]);else{let t=e[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return e[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}swapChildren(e,t){if(e===t)return;let r=this.getChildIndex(e),i=this.getChildIndex(t);this.children[r]=t,this.children[i]=e,this.onChildrenChange(r<i?r:i)}getChildIndex(e){let t=this.children.indexOf(e);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);let r=this.getChildIndex(e);et.removeItems(this.children,r,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.removeChild(e[t]);else{let t=e[0],r=this.children.indexOf(t);if(r===-1)return null;t.parent=null,t.transform._parentID=-1,et.removeItems(this.children,r,1),this._boundsID++,this.onChildrenChange(r),t.emit("removed",this),this.emit("childRemoved",t,this,r)}return e[0]}removeChildAt(e){let t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,et.removeItems(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}removeChildren(e=0,t=this.children.length){let r=e,i=t,n=i-r,o;if(n>0&&n<=i){o=this.children.splice(r,n);for(let a=0;a<o.length;++a)o[a].parent=null,o[a].transform&&(o[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let a=0;a<o.length;++a)o[a].emit("removed",this),this.emit("childRemoved",o[a],this,a);return o}else if(n===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let t=0,r=this.children.length;t<r;++t){let i=this.children[t];i._lastSortedIndex=t,!e&&i.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(YS),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){let r=this.children[e];r.visible&&r.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){let t=this.children[e];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){let r=t._mask.isMaskData?t._mask.maskObject:t._mask;r?(r.calculateBounds(),this._bounds.addBoundsMask(t._bounds,r._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){let r=super.getLocalBounds(e);if(!t)for(let i=0,n=this.children.length;i<n;++i){let o=this.children[i];o.visible&&o.updateTransform()}return r}_calculateBounds(){}_renderWithCulling(e){let t=e.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let r,i;this.cullArea?(r=this.cullArea,i=this.worldTransform):this._render!==Fc.prototype._render&&(r=this.getBounds(!0));let n=e.projection.transform;if(n&&(i?(i=$S.copyFrom(i),i.prepend(n)):i=n),r&&t.intersects(r,i))this._render(e);else if(this.cullArea)return;for(let o=0,a=this.children.length;o<a;++o){let c=this.children[o],f=c.cullable;c.cullable=f||!this.cullArea,c.render(e),c.cullable=f}}render(e){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters?.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let t=0,r=this.children.length;t<r;++t)this.children[t].render(e)}}renderAdvanced(e){let t=this.filters,r=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let n=0;n<t.length;n++)t[n].enabled&&this._enabledFilters.push(t[n])}let i=t&&this._enabledFilters?.length||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==ie.NONE));if(i&&e.batch.flush(),t&&this._enabledFilters?.length&&e.filter.push(this,this._enabledFilters),r&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let n=0,o=this.children.length;n<o;++n)this.children[n].render(e)}i&&e.batch.flush(),r&&e.mask.pop(this),t&&this._enabledFilters?.length&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;let t=typeof e=="boolean"?e:e?.children,r=this.removeChildren(0,this.children.length);if(t)for(let i=0;i<r.length;++i)r[i].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){let t=this.getLocalBounds().width;t!==0?this.scale.x=e/t:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){let t=this.getLocalBounds().height;t!==0?this.scale.y=e/t:this.scale.y=1,this._height=e}},ne=Fc;ne.defaultSortableChildren=!1;ne.prototype.containerUpdateTransform=ne.prototype.updateTransform;Object.defineProperties(W,{SORTABLE_CHILDREN:{get(){return ne.defaultSortableChildren},set(e){et.deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),ne.defaultSortableChildren=e}}});var ea=new dt,jS=new Uint16Array([0,1,2,0,2,3]),Be=class extends ne{constructor(t){super(),this._anchor=new tr(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new pt(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=ft.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||it.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=jS,this.pluginName="batch",this.isSprite=!0,this._roundPixels=W.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=et.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=et.sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){let t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;let r=this.transform.worldTransform,i=r.a,n=r.b,o=r.c,a=r.d,c=r.tx,f=r.ty,p=this.vertexData,l=t.trim,h=t.orig,d=this._anchor,m=0,_=0,x=0,T=0;if(l?(_=l.x-d._x*h.width,m=_+l.width,T=l.y-d._y*h.height,x=T+l.height):(_=-d._x*h.width,m=_+h.width,T=-d._y*h.height,x=T+h.height),p[0]=i*_+o*T+c,p[1]=a*T+n*_+f,p[2]=i*m+o*T+c,p[3]=a*T+n*m+f,p[4]=i*m+o*x+c,p[5]=a*x+n*m+f,p[6]=i*_+o*x+c,p[7]=a*x+n*_+f,this._roundPixels){let S=W.RESOLUTION;for(let b=0;b<p.length;++b)p[b]=Math.round(p[b]*S)/S}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;let t=this._texture,r=this.vertexTrimmedData,i=t.orig,n=this._anchor,o=this.transform.worldTransform,a=o.a,c=o.b,f=o.c,p=o.d,l=o.tx,h=o.ty,d=-n._x*i.width,m=d+i.width,_=-n._y*i.height,x=_+i.height;r[0]=a*d+f*_+l,r[1]=p*_+c*d+h,r[2]=a*m+f*_+l,r[3]=p*_+c*m+h,r[4]=a*m+f*x+l,r[5]=p*x+c*m+h,r[6]=a*d+f*x+l,r[7]=p*x+c*d+h}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){let t=this._texture.trim,r=this._texture.orig;!t||t.width===r.width&&t.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new ri),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new ut),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,ea);let r=this._texture.orig.width,i=this._texture.orig.height,n=-r*this.anchor.x,o=0;return ea.x>=n&&ea.x<n+r&&(o=-i*this.anchor.y,ea.y>=o&&ea.y<o+i)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t?.texture){let i=typeof t=="boolean"?t:t?.baseTexture;this._texture.destroy(!!i)}this._texture=null}static from(t,r){let i=t instanceof it?t:it.from(t,r);return new Be(i)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){let r=et.sign(this.scale.x)||1;this.scale.x=r*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){let r=et.sign(this.scale.y)||1;this.scale.y=r*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||it.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}};var jg=new Et;Ft.prototype._cacheAsBitmap=!1;Ft.prototype._cacheData=null;Ft.prototype._cacheAsBitmapResolution=null;Ft.prototype._cacheAsBitmapMultisample=null;var Oc=class{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}};Object.defineProperties(Ft.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(e){e!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(e){e!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(e){if(this._cacheAsBitmap===e)return;this._cacheAsBitmap=e;let t;e?(this._cacheData||(this._cacheData=new Oc),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});Ft.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};Ft.prototype._initCachedDisplayObject=function(t){if(this._cacheData?.sprite)return;let r=this.alpha;this.alpha=1,t.batch.flush();let i=this.getLocalBounds(null,!0).clone();if(this.filters?.length){let d=this.filters[0].padding;i.pad(d)}i.ceil(W.RESOLUTION);let n=t.renderTexture.current,o=t.renderTexture.sourceFrame.clone(),a=t.renderTexture.destinationFrame.clone(),c=t.projection.transform,f=He.create({width:i.width,height:i.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:this.cacheAsBitmapMultisample??t.multisample}),p=`cacheAsBitmap_${et.uid()}`;this._cacheData.textureCacheId=p,lt.addToCache(f.baseTexture,p),it.addToCache(f,p);let l=this.transform.localTransform.copyTo(jg).invert().translate(-i.x,-i.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:f,clear:!0,transform:l,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=c,t.renderTexture.bind(n,o,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;let h=new Be(f);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(i.x/i.width),h.anchor.y=-(i.y/i.height),h.alpha=r,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=h.containsPoint.bind(h)};Ft.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};Ft.prototype._initCachedDisplayObjectCanvas=function(t){if(this._cacheData?.sprite)return;let r=this.getLocalBounds(null,!0),i=this.alpha;this.alpha=1;let n=t.canvasContext.activeContext,o=t._projTransform;r.ceil(W.RESOLUTION);let a=He.create({width:r.width,height:r.height}),c=`cacheAsBitmap_${et.uid()}`;this._cacheData.textureCacheId=c,lt.addToCache(a.baseTexture,c),it.addToCache(a,c);let f=jg;this.transform.localTransform.copyTo(f),f.invert(),f.tx-=r.x,f.ty-=r.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:a,clear:!0,transform:f,skipUpdateTransform:!1}),t.canvasContext.activeContext=n,t._projTransform=o,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;let p=new Be(a);p.transform.worldTransform=this.transform.worldTransform,p.anchor.x=-(r.x/r.width),p.anchor.y=-(r.y/r.height),p.alpha=i,p._bounds=this._bounds,this._cacheData.sprite=p,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=p.containsPoint.bind(p)};Ft.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Ft.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Ft.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,lt.removeFromCache(this._cacheData.textureCacheId),it.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Ft.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};Ft.prototype.name=null;ne.prototype.getChildByName=function(t,r){for(let i=0,n=this.children.length;i<n;i++)if(this.children[i].name===t)return this.children[i];if(r)for(let i=0,n=this.children.length;i<n;i++){let o=this.children[i];if(!o.getChildByName)continue;let a=o.getChildByName(t,!0);if(a)return a}return null};Ft.prototype.getGlobalPosition=function(t=new dt,r=!1){return this.parent?this.parent.toGlobal(this.position,t,r):(t.x=this.position.x,t.y=this.position.y),t};var Kg=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;var ra=class extends Wt{constructor(t=1){super(Bc,Kg,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}};var KS={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},qS=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function qg(e){let t=KS[e],r=t.length,i=qS,n="",o="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;",a;for(let c=0;c<e;c++){let f=o.replace("%index%",c.toString());a=c,c>=r&&(a=e-c-1),f=f.replace("%value%",t[a].toString()),n+=f,n+=`
`}return i=i.replace("%blur%",n),i=i.replace("%size%",e.toString()),i}var ZS=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function Zg(e,t){let r=Math.ceil(e/2),i=ZS,n="",o;t?o="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":o="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let a=0;a<e;a++){let c=o.replace("%index%",a.toString());c=c.replace("%sampleIndex%",`${a-(r-1)}.0`),n+=c,n+=`
`}return i=i.replace("%blur%",n),i=i.replace("%size%",e.toString()),i}var nn=class extends Wt{constructor(t,r=8,i=4,n=Wt.defaultResolution,o=5){let a=Zg(o,t),c=qg(o);super(a,c),this.horizontal=t,this.resolution=n,this._quality=0,this.quality=i,this.blur=r}apply(t,r,i,n){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/r.width):this.uniforms.strength=1/i.height*(i.height/r.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/r.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,r,i,n);else{let o=t.getFilterTexture(),a=t.renderer,c=r,f=o;this.state.blend=!1,t.applyFilter(this,c,f,cr.CLEAR);for(let p=1;p<this.passes-1;p++){t.bindAndClear(c,cr.BLIT),this.uniforms.uSampler=f;let l=f;f=c,c=l,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,f,i,n),t.returnFilterTexture(o)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}};var ia=class extends Wt{constructor(t=8,r=4,i=Wt.defaultResolution,n=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new nn(!0,t,r,i,n),this.blurYFilter=new nn(!1,t,r,i,n),this.resolution=i,this.quality=r,this.blur=t,this.repeatEdgePixels=!1}apply(t,r,i,n){let o=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(o&&a){let c=t.getFilterTexture();this.blurXFilter.apply(t,r,c,cr.CLEAR),this.blurYFilter.apply(t,c,i,n),t.returnFilterTexture(c)}else a?this.blurYFilter.apply(t,r,i,n):this.blurXFilter.apply(t,r,i,n)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}};var Qg=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;var kn=class extends Wt{constructor(){let t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(Ko,Qg,t),this.alpha=1}_loadMatrix(t,r=!1){let i=t;r&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(t,r,i){return t[0]=r[0]*i[0]+r[1]*i[5]+r[2]*i[10]+r[3]*i[15],t[1]=r[0]*i[1]+r[1]*i[6]+r[2]*i[11]+r[3]*i[16],t[2]=r[0]*i[2]+r[1]*i[7]+r[2]*i[12]+r[3]*i[17],t[3]=r[0]*i[3]+r[1]*i[8]+r[2]*i[13]+r[3]*i[18],t[4]=r[0]*i[4]+r[1]*i[9]+r[2]*i[14]+r[3]*i[19]+r[4],t[5]=r[5]*i[0]+r[6]*i[5]+r[7]*i[10]+r[8]*i[15],t[6]=r[5]*i[1]+r[6]*i[6]+r[7]*i[11]+r[8]*i[16],t[7]=r[5]*i[2]+r[6]*i[7]+r[7]*i[12]+r[8]*i[17],t[8]=r[5]*i[3]+r[6]*i[8]+r[7]*i[13]+r[8]*i[18],t[9]=r[5]*i[4]+r[6]*i[9]+r[7]*i[14]+r[8]*i[19]+r[9],t[10]=r[10]*i[0]+r[11]*i[5]+r[12]*i[10]+r[13]*i[15],t[11]=r[10]*i[1]+r[11]*i[6]+r[12]*i[11]+r[13]*i[16],t[12]=r[10]*i[2]+r[11]*i[7]+r[12]*i[12]+r[13]*i[17],t[13]=r[10]*i[3]+r[11]*i[8]+r[12]*i[13]+r[13]*i[18],t[14]=r[10]*i[4]+r[11]*i[9]+r[12]*i[14]+r[13]*i[19]+r[14],t[15]=r[15]*i[0]+r[16]*i[5]+r[17]*i[10]+r[18]*i[15],t[16]=r[15]*i[1]+r[16]*i[6]+r[17]*i[11]+r[18]*i[16],t[17]=r[15]*i[2]+r[16]*i[7]+r[17]*i[12]+r[18]*i[17],t[18]=r[15]*i[3]+r[16]*i[8]+r[17]*i[13]+r[18]*i[18],t[19]=r[15]*i[4]+r[16]*i[9]+r[17]*i[14]+r[18]*i[19]+r[19],t}_colorMatrix(t){let r=new Float32Array(t);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r}brightness(t,r){let i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,r)}tint(t,r){let[i,n,o]=pt.shared.setValue(t).toArray(),a=[i,0,0,0,0,0,n,0,0,0,0,0,o,0,0,0,0,0,1,0];this._loadMatrix(a,r)}greyscale(t,r){let i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,r)}blackAndWhite(t){let r=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(r,t)}hue(t,r){t=(t||0)/180*Math.PI;let i=Math.cos(t),n=Math.sin(t),o=Math.sqrt,a=1/3,c=o(a),f=i+(1-i)*a,p=a*(1-i)-c*n,l=a*(1-i)+c*n,h=a*(1-i)+c*n,d=i+a*(1-i),m=a*(1-i)-c*n,_=a*(1-i)-c*n,x=a*(1-i)+c*n,T=i+a*(1-i),S=[f,p,l,0,0,h,d,m,0,0,_,x,T,0,0,0,0,0,1,0];this._loadMatrix(S,r)}contrast(t,r){let i=(t||0)+1,n=-.5*(i-1),o=[i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0];this._loadMatrix(o,r)}saturate(t=0,r){let i=t*2/3+1,n=(i-1)*-.5,o=[i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0];this._loadMatrix(o,r)}desaturate(){this.saturate(-1)}negative(t){let r=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(r,t)}sepia(t){let r=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(r,t)}technicolor(t){let r=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(r,t)}polaroid(t){let r=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(r,t)}toBGR(t){let r=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(r,t)}kodachrome(t){let r=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(r,t)}browni(t){let r=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(r,t)}vintage(t){let r=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(r,t)}colorTone(t,r,i,n,o){t=t||.2,r=r||.15,i=i||16770432,n=n||3375104;let a=pt.shared,[c,f,p]=a.setValue(i).toArray(),[l,h,d]=a.setValue(n).toArray(),m=[.3,.59,.11,0,0,c,f,p,t,0,l,h,d,r,0,c-l,f-h,p-d,0,0];this._loadMatrix(m,o)}night(t,r){t=t||.1;let i=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(i,r)}predator(t,r){let i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,r)}lsd(t){let r=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(r,t)}reset(){let t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}};kn.prototype.grayscale=kn.prototype.greyscale;var Jg=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`;var t_=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;var na=class extends Wt{constructor(t,r){let i=new Et;t.renderable=!1,super(t_,Jg,{mapSampler:t._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=i,r==null&&(r=20),this.scale=new dt(r,r)}apply(t,r,i,n){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;let o=this.maskSprite.worldTransform,a=Math.sqrt(o.a*o.a+o.b*o.b),c=Math.sqrt(o.c*o.c+o.d*o.d);a!==0&&c!==0&&(this.uniforms.rotation[0]=o.a/a,this.uniforms.rotation[1]=o.b/a,this.uniforms.rotation[2]=o.c/c,this.uniforms.rotation[3]=o.d/c),t.applyFilter(this,r,i,n)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}};var e_=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`;var r_=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;var sa=class extends Wt{constructor(){super(r_,e_)}};var i_=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;var oa=class extends Wt{constructor(t=.5,r=Math.random()){super(Ko,i_,{uNoise:0,uSeed:0}),this.noise=t,this.seed=r}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}};var Nc={AlphaFilter:ra,BlurFilter:ia,BlurFilterPass:nn,ColorMatrixFilter:kn,DisplacementFilter:na,FXAAFilter:sa,NoiseFilter:oa};Object.entries(Nc).forEach(([e,t])=>{Object.defineProperty(Nc,e,{get(){return et.deprecation("7.1.0",`filters.${e} has moved to ${e}`),t}})});var Uc=class{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(ee.system.add(this.tickerUpdate,this,pr.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(ee.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}let t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}},Ai=new Uc;var Vr=class{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Vr.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new dt,this.page=new dt,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,r,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,r,i,n,o){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}};var ii=class extends Vr{constructor(){super(...arguments),this.client=new dt,this.movement=new dt,this.offset=new dt,this.global=new dt,this.screen=new dt}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,r,i){return t.worldTransform.applyInverse(i||this.global,r)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,r,i,n,o,a,c,f,p,l,h,d,m,_,x){throw new Error("Method not implemented.")}};var De=class extends ii{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}};var Wr=class extends ii{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}};Wr.DOM_DELTA_PIXEL=0;Wr.DOM_DELTA_LINE=1;Wr.DOM_DELTA_PAGE=2;var QS=2048,JS=new dt,kc=new dt,aa=class{constructor(t){this.dispatch=new et.EventEmitter,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._collectInteractiveElements=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,r){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:r,priority:0}),this.mappingTable[t].sort((i,n)=>i.priority-n.priority)}dispatchEvent(t,r){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,r),this.dispatch.emit(r||t.type,t)}mapEvent(t){if(!this.rootTarget)return;let r=this.mappingTable[t.type];if(r)for(let i=0,n=r.length;i<n;i++)r[i].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,r){Ai.pauseUpdate=!0;let i=this.hitTestRecursive(this.rootTarget,this.rootTarget.eventMode,JS.set(t,r),this.hitTestFn,this.hitPruneFn);return i&&i[0]}propagate(t,r){if(!t.target)return;let i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let n=0,o=i.length-1;n<o;n++)if(t.currentTarget=i[n],this.notifyTarget(t,r),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,r),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let n=i.length-2;n>=0;n--)if(t.currentTarget=i[n],this.notifyTarget(t,r),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,r,i=this._allInteractiveElements){if(i.length===0)return;t.eventPhase=t.BUBBLING_PHASE;let n=Array.isArray(r)?r:[r];for(let o=i.length-1;o>=0;o--)n.forEach(a=>{t.currentTarget=i[o],this.notifyTarget(t,a)})}propagationPath(t){let r=[t];for(let i=0;i<QS&&t!==this.rootTarget;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");r.push(t.parent),t=t.parent}return r.reverse(),r}hitTestRecursive(t,r,i,n,o){if(o(t,i))return null;if((t.eventMode==="dynamic"||r==="dynamic")&&(Ai.pauseUpdate=!1),t.interactiveChildren&&t.children){let f=t.children;for(let p=f.length-1;p>=0;p--){let l=f[p],h=this.hitTestRecursive(l,this._isInteractive(r)?r:l.eventMode,i,n,o);if(h){if(h.length>0&&!h[h.length-1].parent)continue;let d=t.isInteractive();if((h.length>0||d)&&(this._collectInteractiveElements&&d&&this._allInteractiveElements.push(t),h.push(t)),this._collectInteractiveElements&&this._hitElements.length===0&&(this._hitElements=h),!this._collectInteractiveElements)return h}}}let a=this._isInteractive(r),c=t.isInteractive();return this._collectInteractiveElements&&(a&&c&&this._allInteractiveElements.push(t),this._hitElements.length>0)?null:a&&n(t,i)?c?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}hitPruneFn(t,r){if(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)return!0;if(this._collectInteractiveElements)return!1;if(t.hitArea&&(t.worldTransform.applyInverse(r,kc),!t.hitArea.contains(kc.x,kc.y)))return!0;if(t._mask){let i=t._mask.isMaskData?t._mask.maskObject:t._mask;if(i&&!i.containsPoint?.(r))return!0}return!1}hitTestFn(t,r){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(r):!1}notifyTarget(t,r){r=r??t.type;let i=`on${r}`;t.currentTarget[i]?.(t);let n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${r}capture`:r;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,r)}mapPointerDown(t){if(!(t instanceof De)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.createPointerEvent(t);if(this.dispatchEvent(r,"pointerdown"),r.pointerType==="touch")this.dispatchEvent(r,"touchstart");else if(r.pointerType==="mouse"||r.pointerType==="pen"){let n=r.button===2;this.dispatchEvent(r,n?"rightdown":"mousedown")}let i=this.trackingData(t.pointerId);i.pressTargetsByButton[t.button]=r.composedPath(),this.freeEvent(r)}mapPointerMove(t){if(!(t instanceof De)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._collectInteractiveElements=!0;let r=this.createPointerEvent(t);this._collectInteractiveElements=!1;let i=r.pointerType==="mouse"||r.pointerType==="pen",n=this.trackingData(t.pointerId),o=this.findMountedTarget(n.overTargets);if(n.overTargets?.length>0&&o!==r.target){let f=t.type==="mousemove"?"mouseout":"pointerout",p=this.createPointerEvent(t,f,o);if(this.dispatchEvent(p,"pointerout"),i&&this.dispatchEvent(p,"mouseout"),!r.composedPath().includes(o)){let l=this.createPointerEvent(t,"pointerleave",o);for(l.eventPhase=l.AT_TARGET;l.target&&!r.composedPath().includes(l.target);)l.currentTarget=l.target,this.notifyTarget(l),i&&this.notifyTarget(l,"mouseleave"),l.target=l.target.parent;this.freeEvent(l)}this.freeEvent(p)}if(o!==r.target){let f=t.type==="mousemove"?"mouseover":"pointerover",p=this.clonePointerEvent(r,f);this.dispatchEvent(p,"pointerover"),i&&this.dispatchEvent(p,"mouseover");let l=o?.parent;for(;l&&l!==this.rootTarget.parent&&l!==r.target;)l=l.parent;if(!l||l===this.rootTarget.parent){let d=this.clonePointerEvent(r,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==o&&d.target!==this.rootTarget.parent;)d.currentTarget=d.target,this.notifyTarget(d),i&&this.notifyTarget(d,"mouseenter"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(p)}let a=[],c=this.enableGlobalMoveEvents??!0;this.moveOnAll?a.push("pointermove"):this.dispatchEvent(r,"pointermove"),c&&a.push("globalpointermove"),r.pointerType==="touch"&&(this.moveOnAll?a.splice(1,0,"touchmove"):this.dispatchEvent(r,"touchmove"),c&&a.push("globaltouchmove")),i&&(this.moveOnAll?a.splice(1,0,"mousemove"):this.dispatchEvent(r,"mousemove"),c&&a.push("globalmousemove"),this.cursor=r.target?.cursor),a.length>0&&this.all(r,a),this._allInteractiveElements.length=0,this._hitElements.length=0,n.overTargets=r.composedPath(),this.freeEvent(r)}mapPointerOver(t){if(!(t instanceof De)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.trackingData(t.pointerId),i=this.createPointerEvent(t),n=i.pointerType==="mouse"||i.pointerType==="pen";this.dispatchEvent(i,"pointerover"),n&&this.dispatchEvent(i,"mouseover"),i.pointerType==="mouse"&&(this.cursor=i.target?.cursor);let o=this.clonePointerEvent(i,"pointerenter");for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),n&&this.notifyTarget(o,"mouseenter"),o.target=o.target.parent;r.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(o)}mapPointerOut(t){if(!(t instanceof De)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.trackingData(t.pointerId);if(r.overTargets){let i=t.pointerType==="mouse"||t.pointerType==="pen",n=this.findMountedTarget(r.overTargets),o=this.createPointerEvent(t,"pointerout",n);this.dispatchEvent(o),i&&this.dispatchEvent(o,"mouseout");let a=this.createPointerEvent(t,"pointerleave",n);for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),i&&this.notifyTarget(a,"mouseleave"),a.target=a.target.parent;r.overTargets=null,this.freeEvent(o),this.freeEvent(a)}this.cursor=null}mapPointerUp(t){if(!(t instanceof De)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=performance.now(),i=this.createPointerEvent(t);if(this.dispatchEvent(i,"pointerup"),i.pointerType==="touch")this.dispatchEvent(i,"touchend");else if(i.pointerType==="mouse"||i.pointerType==="pen"){let c=i.button===2;this.dispatchEvent(i,c?"rightup":"mouseup")}let n=this.trackingData(t.pointerId),o=this.findMountedTarget(n.pressTargetsByButton[t.button]),a=o;if(o&&!i.composedPath().includes(o)){let c=o;for(;c&&!i.composedPath().includes(c);){if(i.currentTarget=c,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch")this.notifyTarget(i,"touchendoutside");else if(i.pointerType==="mouse"||i.pointerType==="pen"){let f=i.button===2;this.notifyTarget(i,f?"rightupoutside":"mouseupoutside")}c=c.parent}delete n.pressTargetsByButton[t.button],a=c}if(a){let c=this.clonePointerEvent(i,"click");c.target=a,c.path=null,n.clicksByButton[t.button]||(n.clicksByButton[t.button]={clickCount:0,target:c.target,timeStamp:r});let f=n.clicksByButton[t.button];if(f.target===c.target&&r-f.timeStamp<200?++f.clickCount:f.clickCount=1,f.target=c.target,f.timeStamp=r,c.detail=f.clickCount,c.pointerType==="mouse"){let p=c.button===2;this.dispatchEvent(c,p?"rightclick":"click")}else c.pointerType==="touch"&&this.dispatchEvent(c,"tap");this.dispatchEvent(c,"pointertap"),this.freeEvent(c)}this.freeEvent(i)}mapPointerUpOutside(t){if(!(t instanceof De)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.trackingData(t.pointerId),i=this.findMountedTarget(r.pressTargetsByButton[t.button]),n=this.createPointerEvent(t);if(i){let o=i;for(;o;)n.currentTarget=o,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch"?this.notifyTarget(n,"touchendoutside"):(n.pointerType==="mouse"||n.pointerType==="pen")&&this.notifyTarget(n,n.button===2?"rightupoutside":"mouseupoutside"),o=o.parent;delete r.pressTargetsByButton[t.button]}this.freeEvent(n)}mapWheel(t){if(!(t instanceof Wr)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}let r=this.createWheelEvent(t);this.dispatchEvent(r),this.freeEvent(r)}findMountedTarget(t){if(!t)return null;let r=t[0];for(let i=1;i<t.length&&t[i].parent===r;i++)r=t[i];return r}createPointerEvent(t,r,i){let n=this.allocateEvent(De);return this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.nativeEvent=t.nativeEvent,n.originalEvent=t,n.target=i??this.hitTest(n.global.x,n.global.y)??this._hitElements[0],typeof r=="string"&&(n.type=r),n}createWheelEvent(t){let r=this.allocateEvent(Wr);return this.copyWheelData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=this.hitTest(r.global.x,r.global.y),r}clonePointerEvent(t,r){let i=this.allocateEvent(De);return i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice(),i.type=r??i.type,i}copyWheelData(t,r){r.deltaMode=t.deltaMode,r.deltaX=t.deltaX,r.deltaY=t.deltaY,r.deltaZ=t.deltaZ}copyPointerData(t,r){t instanceof De&&r instanceof De&&(r.pointerId=t.pointerId,r.width=t.width,r.height=t.height,r.isPrimary=t.isPrimary,r.pointerType=t.pointerType,r.pressure=t.pressure,r.tangentialPressure=t.tangentialPressure,r.tiltX=t.tiltX,r.tiltY=t.tiltY,r.twist=t.twist)}copyMouseData(t,r){t instanceof ii&&r instanceof ii&&(r.altKey=t.altKey,r.button=t.button,r.buttons=t.buttons,r.client.copyFrom(t.client),r.ctrlKey=t.ctrlKey,r.metaKey=t.metaKey,r.movement.copyFrom(t.movement),r.screen.copyFrom(t.screen),r.shiftKey=t.shiftKey,r.global.copyFrom(t.global))}copyData(t,r){r.isTrusted=t.isTrusted,r.srcElement=t.srcElement,r.timeStamp=performance.now(),r.type=t.type,r.detail=t.detail,r.view=t.view,r.which=t.which,r.layer.copyFrom(t.layer),r.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);let r=this.eventPool.get(t).pop()||new t(this);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=null,r.target=null,r}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");let r=t.constructor;this.eventPool.has(r)||this.eventPool.set(r,[]),this.eventPool.get(r).push(t)}notifyListeners(t,r){let i=t.currentTarget._events[r];if(i&&t.currentTarget.isInteractive())if("fn"in i)i.once&&t.currentTarget.removeListener(r,i.fn,void 0,!0),i.fn.call(i.context,t);else for(let n=0,o=i.length;n<o&&!t.propagationImmediatelyStopped;n++)i[n].once&&t.currentTarget.removeListener(r,i[n].fn,void 0,!0),i[n].fn.call(i[n].context,t)}};var tb=1,eb={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Gc=class{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new aa(null),Ai.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new De(null),this.rootWheelEvent=new Wr(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...Gc.defaultEventFeatures},{set:(t,r,i)=>(r==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=i),t[r]=i,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){let{view:t,resolution:r}=this.renderer;this.setTargetElement(t),this.resolution=r,Gc._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===e)return;this.currentCursor=e;let r=this.cursorStyles[e];if(r)switch(typeof r){case"string":t&&(this.domElement.style.cursor=r);break;case"function":r(e);break;case"object":t&&Object.assign(this.domElement.style,r);break}else t&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;let t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let r=0,i=t.length;r<i;r++){let n=t[r],o=this.bootstrapEvent(this.rootPointerEvent,n);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;Ai.pointerMoved();let t=this.normalizeToPointerData(e);for(let r=0,i=t.length;r<i;r++){let n=this.bootstrapEvent(this.rootPointerEvent,t[r]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);let r=t!==this.domElement?"outside":"",i=this.normalizeToPointerData(e);for(let n=0,o=i.length;n<o;n++){let a=this.bootstrapEvent(this.rootPointerEvent,i[n]);a.type+=r,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;let t=this.normalizeToPointerData(e);for(let r=0,i=t.length;r<i;r++){let n=this.bootstrapEvent(this.rootPointerEvent,t[r]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;let t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this.removeEvents(),this.domElement=e,Ai.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Ai.addTickerListener();let e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Ai.removeTickerListener();let e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,t,r){let i;this.domElement.parentElement?i=this.domElement.getBoundingClientRect():i={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};let n=1/this.resolution;e.x=(t-i.left)*(this.domElement.width/i.width)*n,e.y=(r-i.top)*(this.domElement.height/i.height)*n}normalizeToPointerData(e){let t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let r=0,i=e.changedTouches.length;r<i;r++){let n=e.changedTouches[r];typeof n.button>"u"&&(n.button=0),typeof n.buttons>"u"&&(n.buttons=1),typeof n.isPrimary>"u"&&(n.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof n.width>"u"&&(n.width=n.radiusX||1),typeof n.height>"u"&&(n.height=n.radiusY||1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="touch"),typeof n.pointerId>"u"&&(n.pointerId=n.identifier||0),typeof n.pressure>"u"&&(n.pressure=n.force||.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),typeof n.layerX>"u"&&(n.layerX=n.offsetX=n.clientX),typeof n.layerY>"u"&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,n.type=e.type,t.push(n)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){let r=e;typeof r.isPrimary>"u"&&(r.isPrimary=!0),typeof r.width>"u"&&(r.width=1),typeof r.height>"u"&&(r.height=1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="mouse"),typeof r.pointerId>"u"&&(r.pointerId=tb),typeof r.pressure>"u"&&(r.pressure=.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),r.isNormalized=!0,t.push(r)}else t.push(e);return t}normalizeWheelEvent(e){let t=this.rootWheelEvent;return this.transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=eb[e.type]||e.type),e}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}},Gn=Gc;Gn.extension={name:"events",type:[z.RendererSystem,z.CanvasRendererSystem]};Gn.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};Z.add(Gn);function n_(e){return e==="dynamic"||e==="static"}var s_={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??n_(Gn.defaultEventMode)},set interactive(e){gt("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=e,this.eventMode=e?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Gn.defaultEventMode},set eventMode(e){this._internalInteractive=n_(e),this._internalEventMode=e},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(e,t,r){let i=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,n=typeof t=="function"?void 0:t;e=i?`${e}capture`:e,t=typeof t=="function"?t:t.handleEvent,this.on(e,t,n)},removeEventListener(e,t,r){let i=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,n=typeof t=="function"?void 0:t;e=i?`${e}capture`:e,t=typeof t=="function"?t:t.handleEvent,this.off(e,t,n)},dispatchEvent(e){if(!(e instanceof Vr))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return e.defaultPrevented=!1,e.path=null,e.target=this,e.manager.dispatchEvent(e),!e.defaultPrevented}};Ft.mixin(s_);var Hc={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Ft.mixin(Hc);var rb=9,rh=100,ib=0,nb=0,o_=2,a_=1,sb=-1e3,ob=-1e3,ab=2,la=class{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(et.isMobile.tablet||et.isMobile.phone)&&this.createTouchHook();let r=document.createElement("div");r.style.width=`${rh}px`,r.style.height=`${rh}px`,r.style.position="absolute",r.style.top=`${ib}px`,r.style.left=`${nb}px`,r.style.zIndex=o_.toString(),this.div=r,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){let t=document.createElement("button");t.style.width=`${a_}px`,t.style.height=`${a_}px`,t.style.position="absolute",t.style.top=`${sb}px`,t.style.left=`${ob}px`,t.style.zIndex=ab.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);let r=t.children;if(r)for(let i=0;i<r.length;i++)this.updateAccessibleObjects(r[i])}update(){let t=performance.now();if(et.isMobile.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);let{x:r,y:i,width:n,height:o}=this.renderer.view.getBoundingClientRect(),{width:a,height:c,resolution:f}=this.renderer,p=n/a*f,l=o/c*f,h=this.div;h.style.left=`${r}px`,h.style.top=`${i}px`,h.style.width=`${a}px`,h.style.height=`${c}px`;for(let d=0;d<this.children.length;d++){let m=this.children[d];if(m.renderId!==this.renderId)m._accessibleActive=!1,et.removeItems(this.children,d,1),this.div.removeChild(m._accessibleDiv),this.pool.push(m._accessibleDiv),m._accessibleDiv=null,d--;else{h=m._accessibleDiv;let _=m.hitArea,x=m.worldTransform;m.hitArea?(h.style.left=`${(x.tx+_.x*x.a)*p}px`,h.style.top=`${(x.ty+_.y*x.d)*l}px`,h.style.width=`${_.width*x.a*p}px`,h.style.height=`${_.height*x.d*l}px`):(_=m.getBounds(),this.capHitArea(_),h.style.left=`${_.x*p}px`,h.style.top=`${_.y*l}px`,h.style.width=`${_.width*p}px`,h.style.height=`${_.height*l}px`,h.title!==m.accessibleTitle&&m.accessibleTitle!==null&&(h.title=m.accessibleTitle),h.getAttribute("aria-label")!==m.accessibleHint&&m.accessibleHint!==null&&h.setAttribute("aria-label",m.accessibleHint)),(m.accessibleTitle!==h.title||m.tabIndex!==h.tabIndex)&&(h.title=m.accessibleTitle,h.tabIndex=m.tabIndex,this.debug&&this.updateDebugHTML(h))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);let{width:r,height:i}=this.renderer;t.x+t.width>r&&(t.width=r-t.x),t.y+t.height>i&&(t.height=i-t.y)}addChild(t){let r=this.pool.pop();r||(r=document.createElement("button"),r.style.width=`${rh}px`,r.style.height=`${rh}px`,r.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",r.style.position="absolute",r.style.zIndex=o_.toString(),r.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?r.setAttribute("aria-live","off"):r.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?r.setAttribute("aria-relevant","additions"):r.setAttribute("aria-relevant","text"),r.addEventListener("click",this._onClick.bind(this)),r.addEventListener("focus",this._onFocus.bind(this)),r.addEventListener("focusout",this._onFocusOut.bind(this))),r.style.pointerEvents=t.accessiblePointerEvents,r.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?r.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(r.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&r.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(r),t._accessibleActive=!0,t._accessibleDiv=r,r.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,r){let{displayObject:i}=t.target,n=this.renderer.events.rootBoundary,o=Object.assign(new Vr(n),{target:i});n.rootTarget=this.renderer.lastObjectRendered,r.forEach(a=>n.dispatchEvent(o,a))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===rb&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}};la.extension={name:"accessibility",type:[z.RendererPlugin,z.CanvasRendererPlugin]};Z.add(la);var Vc=class{constructor(e){this.stage=new ne,e=Object.assign({forceCanvas:!1},e),this.renderer=Mc(e),Vc._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(e,t){let r=Vc._plugins.slice(0);r.reverse(),r.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}},ha=Vc;ha._plugins=[];Z.handleByList(z.Application,ha._plugins);var ua=class{static init(t){Object.defineProperty(this,"resizeTo",{set(r){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let r,i;if(this._resizeTo===globalThis.window)r=globalThis.innerWidth,i=globalThis.innerHeight;else{let{clientWidth:n,clientHeight:o}=this._resizeTo;r=n,i=o}this.renderer.resize(r,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}};ua.extension=z.Application;Z.add(ua);var l_={loader:z.LoadParser,resolver:z.ResolveParser,cache:z.CacheParser,detection:z.DetectionParser};Z.handle(z.Asset,e=>{let t=e.ref;Object.entries(l_).filter(([r])=>!!t[r]).forEach(([r,i])=>Z.add(Object.assign(t[r],{extension:t[r].extension??i})))},e=>{let t=e.ref;Object.keys(l_).filter(r=>!!t[r]).forEach(r=>Z.remove(t[r]))});var ih=class{constructor(t,r=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(t){t.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;let t=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<r;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}};function Rr(e,t){if(Array.isArray(t)){for(let r of t)if(e.startsWith(`data:${r}`))return!0;return!1}return e.startsWith(`data:${t}`)}function Le(e,t){let r=e.split("?")[0],i=et.path.extname(r).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}var Ve=(e,t)=>(Array.isArray(e)||(e=[e]),t?e.map(r=>typeof r=="string"?t(r):r):e);var Hn=(e,t)=>{let r=t.split("?")[1];return r&&(e+=`?${r}`),e};function h_(e,t,r,i,n){let o=t[r];for(let a=0;a<o.length;a++){let c=o[a];r<t.length-1?h_(e.replace(i[r],c),t,r+1,i,n):n.push(e.replace(i[r],c))}}function nh(e){let t=/\{(.*?)\}/g,r=e.match(t),i=[];if(r){let n=[];r.forEach(o=>{let a=o.substring(1,o.length-1).split(",");n.push(a)}),h_(e,n,0,r,i)}else i.push(e);return i}var Ci=e=>!Array.isArray(e);var Wc=class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){let r=this._cache.get(t);return r||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),r}set(t,r){let i=Ve(t),n;for(let c=0;c<this.parsers.length;c++){let f=this.parsers[c];if(f.test(r)){n=f.getCacheableAssets(i,r);break}}n||(n={},i.forEach(c=>{n[c]=r}));let o=Object.keys(n),a={cacheKeys:o,keys:i};if(i.forEach(c=>{this._cacheMap.set(c,a)}),o.forEach(c=>{this._cache.has(c)&&this._cache.get(c)!==r&&console.warn("[Cache] already has key:",c),this._cache.set(c,n[c])}),r instanceof it){let c=r;i.forEach(f=>{c.baseTexture!==it.EMPTY.baseTexture&&lt.addToCache(c.baseTexture,f),it.addToCache(c,f)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}let r=this._cacheMap.get(t);r.cacheKeys.forEach(n=>{this._cache.delete(n)}),r.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}},sn=new Wc;var sh=class{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,r,i)=>(this._parsersValidated=!1,t[r]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,r){let i={promise:null,parser:null};return i.promise=(async()=>{let n=null,o=null;if(r.loadParser&&(o=this._parserHash[r.loadParser],o||console.warn(`[Assets] specified load parser "${r.loadParser}" not found while loading ${t}`)),!o){for(let a=0;a<this.parsers.length;a++){let c=this.parsers[a];if(c.load&&c.test?.(t,r,this)){o=c;break}}if(!o)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await o.load(t,r,this),i.parser=o;for(let a=0;a<this.parsers.length;a++){let c=this.parsers[a];c.parse&&c.parse&&await c.testParse?.(n,r,this)&&(n=await c.parse(n,r,this)||n,i.parser=c)}return n})(),i}async load(t,r){this._parsersValidated||this._validateParsers();let i=0,n={},o=Ci(t),a=Ve(t,p=>({src:p})),c=a.length,f=a.map(async p=>{let l=et.path.toAbsolute(p.src);if(!n[p.src])try{this.promiseCache[l]||(this.promiseCache[l]=this._getLoadPromiseAndParser(l,p)),n[p.src]=await this.promiseCache[l].promise,r&&r(++i/c)}catch(h){throw delete this.promiseCache[l],delete n[p.src],new Error(`[Loader.load] Failed to load ${l}.
${h}`)}});return await Promise.all(f),o?n[a[0].src]:n}async unload(t){let i=Ve(t,n=>({src:n})).map(async n=>{let o=et.path.toAbsolute(n.src),a=this.promiseCache[o];if(a){let c=await a.promise;a.parser?.unload?.(c,n,this),delete this.promiseCache[o]}});await Promise.all(i)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,r)=>(t[r.name]&&console.warn(`[Assets] loadParser name conflict "${r.name}"`),{...t,[r.name]:r}),{})}};var le=(e=>(e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e))(le||{});var lb=".json",hb="application/json",Xc={extension:{type:z.LoadParser,priority:le.Low},name:"loadJson",test(e){return Rr(e,hb)||Le(e,lb)},async load(e){return await(await W.ADAPTER.fetch(e)).json()}};Z.add(Xc);var ub=".txt",cb="text/plain",zc={name:"loadTxt",extension:{type:z.LoadParser,priority:le.Low},test(e){return Rr(e,cb)||Le(e,ub)},async load(e){return await(await W.ADAPTER.fetch(e)).text()}};Z.add(zc);var fb=["normal","bold","100","200","300","400","500","600","700","800","900"],db=[".ttf",".otf",".woff",".woff2"],pb=["font/ttf","font/otf","font/woff","font/woff2"];function $c(e){let t=et.path.extname(e);return et.path.basename(e,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ")}var Yc={extension:{type:z.LoadParser,priority:le.Low},name:"loadWebFont",test(e){return Rr(e,pb)||Le(e,db)},async load(e,t){let r=W.ADAPTER.getFontFaceSet();if(r){let i=[],n=t.data?.family??$c(e),o=t.data?.weights?.filter(c=>fb.includes(c))??["normal"],a=t.data??{};for(let c=0;c<o.length;c++){let f=o[c],p=new FontFace(n,`url(${encodeURI(e)})`,{...a,weight:f});await p.load(),r.add(p),i.push(p)}return i.length===1?i[0]:i}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(e){(Array.isArray(e)?e:[e]).forEach(t=>W.ADAPTER.getFontFaceSet().delete(t))}};Z.add(Yc);var u_=0,jc,mb="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",gb={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${mb}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},_b={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`},Kc,qc=class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{let r=URL.createObjectURL(new Blob([gb.code],{type:"application/javascript"})),i=new Worker(r);i.addEventListener("message",n=>{i.terminate(),URL.revokeObjectURL(r),t(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){jc===void 0&&(jc=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<jc&&(Kc||(Kc=URL.createObjectURL(new Blob([_b.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(Kc),t.addEventListener("message",r=>{this.complete(r.data),this.returnWorker(r.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,r){await this._initWorkers();let i=new Promise((n,o)=>{this.queue.push({id:t,arguments:r,resolve:n,reject:o})});return this.next(),i}next(){if(!this.queue.length)return;let t=this.getWorker();if(!t)return;let r=this.queue.pop(),i=r.id;this.resolveHash[u_]={resolve:r.resolve,reject:r.reject},t.postMessage({data:r.arguments,uuid:u_++,id:i})}},Zc=new qc;function ni(e,t,r){let i=new it(e);return i.baseTexture.on("dispose",()=>{delete t.promiseCache[r]}),i}var xb=[".jpeg",".jpg",".png",".webp",".avif"],vb=["image/jpeg","image/png","image/webp","image/avif"];async function Qc(e){let t=await W.ADAPTER.fetch(e);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${e}: ${t.status} ${t.statusText}`);let r=await t.blob();return await createImageBitmap(r)}var Ii={name:"loadTextures",extension:{type:z.LoadParser,priority:le.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(e){return Rr(e,vb)||Le(e,xb)},async load(e,t,r){let i=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Zc.isImageBitmapSupported()?i=await Zc.loadImageBitmap(e):i=await Qc(e):i=await new Promise(o=>{i=new Image,i.crossOrigin=this.config.crossOrigin,i.src=e,i.complete?o(i):i.onload=()=>{o(i)}});let n=new lt(i,{resolution:et.getResolutionOfUrl(e),...t.data});return n.resource.src=e,ni(n,r,e)},unload(e){e.destroy(!0)}};Z.add(Ii);var yb=".svg",Tb="image/svg+xml",Jc={extension:{type:z.LoadParser,priority:le.High},name:"loadSVG",test(e){return Rr(e,Tb)||Le(e,yb)},async testParse(e){return bi.test(e)},async parse(e,t,r){let i=new bi(e,t?.data?.resourceOptions),n=new lt(i,{resolution:et.getResolutionOfUrl(e),...t?.data});n.resource.src=e;let o=ni(n,r,e);return t?.data?.resourceOptions?.autoLoad||await i.load(),o},async load(e,t){return(await W.ADAPTER.fetch(e)).text()},unload:Ii.unload};Z.add(Jc);var oh=class{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,r)=>`${t}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(t,r)=>r.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{let r=t;this._defaultSearchParams=Object.keys(r).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(r[i])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(t,r){let i=[];Array.isArray(r)?r.forEach(n=>{if(typeof n.name=="string"){let o=this._createBundleAssetId(t,n.name);i.push(o),this.add([n.name,o],n.srcs,n.data)}else{let o=n.name.map(a=>this._createBundleAssetId(t,a));o.forEach(a=>{i.push(a)}),this.add([...n.name,...o],n.srcs)}}):Object.keys(r).forEach(n=>{i.push(this._createBundleAssetId(t,n)),this.add([n,this._createBundleAssetId(t,n)],r[n])}),this._bundles[t]=i}add(t,r,i){let n=Ve(t);n.forEach(a=>{this.hasKey(a)&&console.warn(`[Resolver] already has key: ${a} overwriting`)}),Array.isArray(r)||(typeof r=="string"?r=nh(r):r=[r]);let o=r.map(a=>{let c=a;if(typeof a=="string"){let f=!1;for(let p=0;p<this._parsers.length;p++){let l=this._parsers[p];if(l.test(a)){c=l.parse(a),f=!0;break}}f||(c={src:a})}return c.format||(c.format=c.src.split(".").pop()),c.alias||(c.alias=n),(this._basePath||this._rootPath)&&(c.src=et.path.toAbsolute(c.src,this._basePath,this._rootPath)),c.src=this._appendDefaultSearchParams(c.src),c.data=c.data??i,c});n.forEach(a=>{this._assetMap[a]=o})}resolveBundle(t){let r=Ci(t);t=Ve(t);let i={};return t.forEach(n=>{let o=this._bundles[n];if(o){let a=this.resolve(o),c={};for(let f in a){let p=a[f];c[this._extractAssetIdFromBundle(n,f)]=p}i[n]=c}}),r?i[t[0]]:i}resolveUrl(t){let r=this.resolve(t);if(typeof t!="string"){let i={};for(let n in r)i[n]=r[n].src;return i}return r.src}resolve(t){let r=Ci(t);t=Ve(t);let i={};return t.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let o=this._assetMap[n],a=this._getPreferredOrder(o),c=o[0];a?.priority.forEach(f=>{a.params[f].forEach(p=>{let l=o.filter(h=>h[f]?h[f]===p:!1);l.length&&(o=l)})}),this._resolverHash[n]=o[0]??c}else{let o=n;(this._basePath||this._rootPath)&&(o=et.path.toAbsolute(o,this._basePath,this._rootPath)),o=this._appendDefaultSearchParams(o),this._resolverHash[n]={src:o}}i[n]=this._resolverHash[n]}),r?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let r=0;r<t.length;r++){let i=t[0],n=this._preferredOrder.find(o=>o.params.format.includes(i.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;let r=/\?/.test(t)?"&":"?";return`${t}${r}${this._defaultSearchParams}`}};var ah=class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new oh,this.loader=new sh,this.cache=sn,this._backgroundLoader=new ih(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let o=t.manifest;typeof o=="string"&&(o=await this.load(o)),this.resolver.addManifest(o)}let r=t.texturePreference?.resolution??1,i=typeof r=="number"?[r]:r,n=[];if(t.texturePreference?.format){let o=t.texturePreference?.format;n=typeof o=="string"?[o]:o;for(let a of this._detections)await a.test()||(n=await a.remove(n))}else for(let o of this._detections)await o.test()&&(n=await o.add(n));this.resolver.prefer({params:{format:n,resolution:i}}),t.preferences&&this.setPreferences(t.preferences)}add(t,r,i){this.resolver.add(t,r,i)}async load(t,r){this._initialized||await this.init();let i=Ci(t),n=Ve(t).map(c=>typeof c!="string"?(this.resolver.add(c.src,c),c.src):(this.resolver.hasKey(c)||this.resolver.add(c,c),c)),o=this.resolver.resolve(n),a=await this._mapLoadToResolve(o,r);return i?a[n[0]]:a}addBundle(t,r){this.resolver.addBundle(t,r)}async loadBundle(t,r){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);let n=this.resolver.resolveBundle(t),o={},a=Object.keys(n),c=0,f=0,p=()=>{r?.(++c/f)},l=a.map(h=>{let d=n[h];return f+=Object.keys(d).length,this._mapLoadToResolve(d,p).then(m=>{o[h]=m})});return await Promise.all(l),i?o[t[0]]:o}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);let r=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);let r=this.resolver.resolveBundle(t);Object.values(r).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return sn.get(t);let r={};for(let i=0;i<t.length;i++)r[i]=sn.get(t[i]);return r}async _mapLoadToResolve(t,r){let i=Object.values(t),n=Object.keys(t);this._backgroundLoader.active=!1;let o=await this.loader.load(i,r);this._backgroundLoader.active=!0;let a={};return i.forEach((c,f)=>{let p=o[c.src],l=[c.src];c.alias&&l.push(...c.alias),a[n[f]]=p,sn.set(l,p)}),a}async unload(t){this._initialized||await this.init();let r=Ve(t).map(n=>typeof n!="string"?n.src:n),i=this.resolver.resolve(r);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=Ve(t);let r=this.resolver.resolveBundle(t),i=Object.keys(r).map(n=>this._unloadFromResolved(r[n]));await Promise.all(i)}async _unloadFromResolved(t){let r=Object.values(t);r.forEach(i=>{sn.remove(i.src)}),await this.loader.unload(r)}get detections(){return this._detections}get preferWorkers(){return Ii.config.preferWorkers}set preferWorkers(t){gt("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(i=>i in t).forEach(i=>{r.config[i]=t[i]})})}},ca=new ah;Z.handleByList(z.LoadParser,ca.loader.parsers).handleByList(z.ResolveParser,ca.resolver.parsers).handleByList(z.CacheParser,ca.cache.parsers).handleByList(z.DetectionParser,ca.detections);var tf={extension:z.CacheParser,test:e=>Array.isArray(e)&&e.every(t=>t instanceof it),getCacheableAssets:(e,t)=>{let r={};return e.forEach(i=>{t.forEach((n,o)=>{r[i+(o===0?"":o+1)]=n})}),r}};Z.add(tf);var ef={extension:{type:z.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;let e="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=await W.ADAPTER.fetch(e).then(r=>r.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async e=>[...e,"avif"],remove:async e=>e.filter(t=>t!=="avif")};Z.add(ef);var rf={extension:{type:z.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;let e="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=await W.ADAPTER.fetch(e).then(r=>r.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async e=>[...e,"webp"],remove:async e=>e.filter(t=>t!=="webp")};Z.add(rf);var c_=["png","jpg","jpeg"],nf={extension:{type:z.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...c_],remove:async e=>e.filter(t=>!c_.includes(t))};Z.add(nf);var sf={extension:z.ResolveParser,test:Ii.test,parse:e=>({resolution:parseFloat(W.RETINA_PREFIX.exec(e)?.[1]??"1"),format:e.split(".").pop(),src:e})};Z.add(sf);var We=(e=>(e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e))(We||{}),on={[33776]:.5,[33777]:.5,[33778]:1,[33779]:1,[35916]:.5,[35917]:.5,[35918]:1,[35919]:1,[37488]:.5,[37489]:.5,[37490]:1,[37491]:1,[37492]:.5,[37496]:1,[37493]:.5,[37497]:1,[37494]:.5,[37495]:.5,[35840]:.5,[35842]:.5,[35841]:.25,[35843]:.25,[36196]:.5,[35986]:.5,[35986]:1,[34798]:1,[37808]:1};var Ri,$s;function f_(){$s={s3tc:Ri.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Ri.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:Ri.getExtension("WEBGL_compressed_texture_etc"),etc1:Ri.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:Ri.getExtension("WEBGL_compressed_texture_pvrtc")||Ri.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:Ri.getExtension("WEBGL_compressed_texture_atc"),astc:Ri.getExtension("WEBGL_compressed_texture_astc")}}var of={extension:{type:z.DetectionParser,priority:2},test:async()=>{let t=W.ADAPTER.createCanvas().getContext("webgl");return t?(Ri=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async e=>{$s||f_();let t=[];for(let r in $s)$s[r]&&t.push(r);return[...t,...e]},remove:async e=>($s||f_(),e.filter(t=>!(t in $s)))};Z.add(of);var Ys=class extends Je{constructor(t,r={width:1,height:1,autoLoad:!0}){let i,n;typeof t=="string"?(i=t,n=new Uint8Array):(i=null,n=t),super(n,r),this.origin=i,this.buffer=n?new ji(n):null,this.origin&&r.autoLoad!==!1&&this.load(),n?.length&&(this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}async load(){let i=await(await(await fetch(this.origin)).blob()).arrayBuffer();return this.data=new Uint32Array(i),this.buffer=new ji(i),this.loaded=!0,this.onBlobLoaded(i),this.update(),this}};var gr=class extends Ys{constructor(t,r){super(t,r),this.format=r.format,this.levels=r.levels||1,this._width=r.width,this._height=r.height,this._extension=gr._formatToExtension(this.format),(r.levelBuffers||this.buffer)&&(this._levelBuffers=r.levelBuffers||gr._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,r,i){let n=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let a=0,c=this.levels;a<c;a++){let{levelID:f,levelWidth:p,levelHeight:l,levelBuffer:h}=this._levelBuffers[a];n.compressedTexImage2D(n.TEXTURE_2D,f,this.format,p,l,0,h)}return!0}onBlobLoaded(){this._levelBuffers=gr._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,r,i,n,o,a,c){let f=new Array(i),p=t.byteOffset,l=a,h=c,d=l+n-1&~(n-1),m=h+o-1&~(o-1),_=d*m*on[r];for(let x=0;x<i;x++)f[x]={levelID:x,levelWidth:i>1?l:d,levelHeight:i>1?h:m,levelBuffer:new Uint8Array(t.buffer,p,_)},p+=_,l=l>>1||1,h=h>>1||1,d=l+n-1&~(n-1),m=h+o-1&~(o-1),_=d*m*on[r];return f}};var af=4,lh=124,wb=32,d_=20,Eb=542327876,hh={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},Sb={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},uh={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4};var bb=1,Ab=2,Cb=4,Ib=64,Rb=512,Pb=131072,Mb=827611204,Bb=861165636,Db=894720068,Lb=808540228,Fb=4,Ob={[Mb]:We.COMPRESSED_RGBA_S3TC_DXT1_EXT,[Bb]:We.COMPRESSED_RGBA_S3TC_DXT3_EXT,[Db]:We.COMPRESSED_RGBA_S3TC_DXT5_EXT},Nb={[70]:We.COMPRESSED_RGBA_S3TC_DXT1_EXT,[71]:We.COMPRESSED_RGBA_S3TC_DXT1_EXT,[73]:We.COMPRESSED_RGBA_S3TC_DXT3_EXT,[74]:We.COMPRESSED_RGBA_S3TC_DXT3_EXT,[76]:We.COMPRESSED_RGBA_S3TC_DXT5_EXT,[77]:We.COMPRESSED_RGBA_S3TC_DXT5_EXT,[72]:We.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,[75]:We.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,[78]:We.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function ch(e){let t=new Uint32Array(e);if(t[0]!==Eb)throw new Error("Invalid DDS file magic word");let i=new Uint32Array(e,0,lh/Uint32Array.BYTES_PER_ELEMENT),n=i[hh.HEIGHT],o=i[hh.WIDTH],a=i[hh.MIPMAP_COUNT],c=new Uint32Array(e,hh.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,wb/Uint32Array.BYTES_PER_ELEMENT),f=c[bb];if(f&Cb){let p=c[Sb.FOURCC];if(p!==Lb){let y=Ob[p],w=af+lh,I=new Uint8Array(e,w);return[new gr(I,{format:y,width:o,height:n,levels:a})]}let l=af+lh,h=new Uint32Array(t.buffer,l,d_/Uint32Array.BYTES_PER_ELEMENT),d=h[uh.DXGI_FORMAT],m=h[uh.RESOURCE_DIMENSION],_=h[uh.MISC_FLAG],x=h[uh.ARRAY_SIZE],T=Nb[d];if(T===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${d}`);if(_===Fb)throw new Error("DDSParser does not support cubemap textures");if(m===6)throw new Error("DDSParser does not supported 3D texture data");let S=new Array,b=af+lh+d_;if(x===1)S.push(new Uint8Array(e,b));else{let y=on[T],w=0,I=o,C=n;for(let M=0;M<a;M++){let B=Math.max(1,I+3&-4),F=Math.max(1,C+3&-4),L=B*F*y;w+=L,I=I>>>1,C=C>>>1}let P=b;for(let M=0;M<x;M++)S.push(new Uint8Array(e,P,w)),P+=w}return S.map(y=>new gr(y,{format:T,width:o,height:n,levels:a}))}throw f&Ib?new Error("DDSParser does not support uncompressed texture data."):f&Rb?new Error("DDSParser does not supported YUV uncompressed texture data."):f&Pb?new Error("DDSParser does not support single-channel (lumninance) texture data!"):f&Ab?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}var p_=[171,75,84,88,32,49,49,187,13,10,26,10],Ub=67305985,Xr={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},lf=64,fh={[at.UNSIGNED_BYTE]:1,[at.UNSIGNED_SHORT]:2,[at.INT]:4,[at.UNSIGNED_INT]:4,[at.FLOAT]:4,[at.HALF_FLOAT]:8},hf={[tt.RGBA]:4,[tt.RGB]:3,[tt.RG]:2,[tt.RED]:1,[tt.LUMINANCE]:1,[tt.LUMINANCE_ALPHA]:2,[tt.ALPHA]:1},uf={[at.UNSIGNED_SHORT_4_4_4_4]:2,[at.UNSIGNED_SHORT_5_5_5_1]:2,[at.UNSIGNED_SHORT_5_6_5]:2};function dh(e,t,r=!1){let i=new DataView(t);if(!kb(e,i))return null;let n=i.getUint32(Xr.ENDIANNESS,!0)===Ub,o=i.getUint32(Xr.GL_TYPE,n),a=i.getUint32(Xr.GL_FORMAT,n),c=i.getUint32(Xr.GL_INTERNAL_FORMAT,n),f=i.getUint32(Xr.PIXEL_WIDTH,n),p=i.getUint32(Xr.PIXEL_HEIGHT,n)||1,l=i.getUint32(Xr.PIXEL_DEPTH,n)||1,h=i.getUint32(Xr.NUMBER_OF_ARRAY_ELEMENTS,n)||1,d=i.getUint32(Xr.NUMBER_OF_FACES,n),m=i.getUint32(Xr.NUMBER_OF_MIPMAP_LEVELS,n),_=i.getUint32(Xr.BYTES_OF_KEY_VALUE_DATA,n);if(p===0||l!==1)throw new Error("Only 2D textures are supported");if(d!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(h!==1)throw new Error("WebGL does not support array textures");let x=4,T=4,S=f+3&-4,b=p+3&-4,y=new Array(h),w=f*p;o===0&&(w=S*b);let I;if(o!==0?fh[o]?I=fh[o]*hf[a]:I=uf[o]:I=on[c],I===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");let C=r?Hb(i,_,n):null,M=w*I,B=f,F=p,L=S,H=b,N=lf+_;for(let G=0;G<m;G++){let q=i.getUint32(N,n),j=N+4;for(let rt=0;rt<h;rt++){let $=y[rt];$||($=y[rt]=new Array(m)),$[G]={levelID:G,levelWidth:m>1||o!==0?B:L,levelHeight:m>1||o!==0?F:H,levelBuffer:new Uint8Array(t,j,M)},j+=M}N+=q+4,N=N%4!==0?N+4-N%4:N,B=B>>1||1,F=F>>1||1,L=B+x-1&~(x-1),H=F+T-1&~(T-1),M=L*H*I}return o!==0?{uncompressed:y.map(G=>{let q=G[0].levelBuffer,j=!1;return o===at.FLOAT?q=new Float32Array(G[0].levelBuffer.buffer,G[0].levelBuffer.byteOffset,G[0].levelBuffer.byteLength/4):o===at.UNSIGNED_INT?(j=!0,q=new Uint32Array(G[0].levelBuffer.buffer,G[0].levelBuffer.byteOffset,G[0].levelBuffer.byteLength/4)):o===at.INT&&(j=!0,q=new Int32Array(G[0].levelBuffer.buffer,G[0].levelBuffer.byteOffset,G[0].levelBuffer.byteLength/4)),{resource:new Je(q,{width:G[0].levelWidth,height:G[0].levelHeight}),type:o,format:j?Gb(a):a}}),kvData:C}:{compressed:y.map(G=>new gr(null,{format:c,width:f,height:p,levels:m,levelBuffers:G})),kvData:C}}function kb(e,t){for(let r=0;r<p_.length;r++)if(t.getUint8(r)!==p_[r])return console.error(`${e} is not a valid *.ktx file!`),!1;return!0}function Gb(e){switch(e){case tt.RGBA:return tt.RGBA_INTEGER;case tt.RGB:return tt.RGB_INTEGER;case tt.RG:return tt.RG_INTEGER;case tt.RED:return tt.RED_INTEGER;default:return e}}function Hb(e,t,r){let i=new Map,n=0;for(;n<t;){let o=e.getUint32(lf+n,r),a=lf+n+4,c=3-(o+3)%4;if(o===0||o>t-n){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let f=0;for(;f<o&&e.getUint8(a+f)!==0;f++);if(f===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}let p=new TextDecoder().decode(new Uint8Array(e.buffer,a,f)),l=new DataView(e.buffer,a+f+1,o-f-1);i.set(p,l),n+=4+o+c}return i}var cf={extension:{type:z.LoadParser,priority:le.High},name:"loadDDS",test(e){return Le(e,".dds")},async load(e,t,r){let n=await(await W.ADAPTER.fetch(e)).arrayBuffer(),a=ch(n).map(c=>{let f=new lt(c,{mipmap:Se.OFF,alphaMode:ue.NO_PREMULTIPLIED_ALPHA,resolution:et.getResolutionOfUrl(e),...t.data});return ni(f,r,e)});return a.length===1?a[0]:a},unload(e){Array.isArray(e)?e.forEach(t=>t.destroy(!0)):e.destroy(!0)}};Z.add(cf);var ff={extension:{type:z.LoadParser,priority:le.High},name:"loadKTX",test(e){return Le(e,".ktx")},async load(e,t,r){let n=await(await W.ADAPTER.fetch(e)).arrayBuffer(),{compressed:o,uncompressed:a,kvData:c}=dh(e,n),f=o??a,p={mipmap:Se.OFF,alphaMode:ue.NO_PREMULTIPLIED_ALPHA,resolution:et.getResolutionOfUrl(e),...t.data},l=f.map(h=>{f===a&&Object.assign(p,{type:h.type,format:h.format});let d=new lt(h,p);return d.ktxKeyValueData=c,ni(d,r,e)});return l.length===1?l[0]:l},unload(e){Array.isArray(e)?e.forEach(t=>t.destroy(!0)):e.destroy(!0)}};Z.add(ff);var df={extension:z.ResolveParser,test:e=>{let r=e.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(r)},parse:e=>{if(e.split("?")[0].split(".").pop()==="ktx"){let i=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(i.some(n=>e.endsWith(n)))return{resolution:parseFloat(W.RETINA_PREFIX.exec(e)?.[1]??"1"),format:i.find(n=>e.endsWith(n)),src:e}}return{resolution:parseFloat(W.RETINA_PREFIX.exec(e)?.[1]??"1"),format:e.split(".").pop(),src:e}}};Z.add(df);var Vb=new ut,Wb=4,pf=class{constructor(e){this.renderer=e}async image(e,t,r){let i=new Image;return i.src=await this.base64(e,t,r),i}async base64(e,t,r){let i=this.canvas(e);if(i.toDataURL!==void 0)return i.toDataURL(t,r);if(i.convertToBlob!==void 0){let n=await i.convertToBlob({type:t,quality:r});return await new Promise(o=>{let a=new FileReader;a.onload=()=>o(a.result),a.readAsDataURL(n)})}throw new Error("Extract.base64() requires ICanvas.toDataURL or ICanvas.convertToBlob to be implemented")}canvas(e,t){let{pixels:r,width:i,height:n,flipY:o}=this._rawPixels(e,t),a=new et.CanvasRenderTarget(i,n,1),c=a.context.getImageData(0,0,i,n);if(pf.arrayPostDivide(r,c.data),a.context.putImageData(c,0,0),o){let f=new et.CanvasRenderTarget(a.width,a.height,1);f.context.scale(1,-1),f.context.drawImage(a.canvas,0,-n),a.destroy(),a=f}return a.canvas}pixels(e,t){let{pixels:r}=this._rawPixels(e,t);return pf.arrayPostDivide(r,r),r}_rawPixels(e,t){let r=this.renderer;if(!r)throw new Error("The Extract has already been destroyed");let i,n=!1,o,a=!1;if(e)if(e instanceof He)o=e;else{let h=r.context.webGLVersion>=2?r.multisample:Lt.NONE;if(o=r.generateTexture(e,{multisample:h}),h!==Lt.NONE){let d=He.create({width:o.width,height:o.height});r.framebuffer.bind(o.framebuffer),r.framebuffer.blit(d.framebuffer),r.framebuffer.bind(),o.destroy(!0),o=d}a=!0}o?(i=o.baseTexture.resolution,t=t??o.frame,n=!1,r.renderTexture.bind(o)):(i=r.resolution,t||(t=Vb,t.width=r.width,t.height=r.height),n=!0,r.renderTexture.bind());let c=Math.round(t.width*i),f=Math.round(t.height*i),p=new Uint8Array(Wb*c*f),l=r.gl;return l.readPixels(Math.round(t.x*i),Math.round(t.y*i),c,f,l.RGBA,l.UNSIGNED_BYTE,p),a&&o?.destroy(!0),{pixels:p,width:c,height:f,flipY:n}}destroy(){this.renderer=null}static arrayPostDivide(e,t){for(let r=0;r<e.length;r+=4){let i=t[r+3]=e[r+3];i!==0?(t[r]=Math.round(Math.min(e[r]*255/i,255)),t[r+1]=Math.round(Math.min(e[r+1]*255/i,255)),t[r+2]=Math.round(Math.min(e[r+2]*255/i,255))):(t[r]=e[r],t[r+1]=e[r+1],t[r+2]=e[r+2])}}},mf=pf;mf.extension={name:"extract",type:z.RendererSystem};Z.add(mf);var an={build(e){let t=e.points,r,i,n,o,a,c;if(e.type===zt.CIRC){let _=e.shape;r=_.x,i=_.y,a=c=_.radius,n=o=0}else if(e.type===zt.ELIP){let _=e.shape;r=_.x,i=_.y,a=_.width,c=_.height,n=o=0}else{let _=e.shape,x=_.width/2,T=_.height/2;r=_.x+x,i=_.y+T,a=c=Math.max(0,Math.min(_.radius,Math.min(x,T))),n=x-a,o=T-c}if(!(a>=0&&c>=0&&n>=0&&o>=0)){t.length=0;return}let f=Math.ceil(2.3*Math.sqrt(a+c)),p=f*8+(n?4:0)+(o?4:0);if(t.length=p,p===0)return;if(f===0){t.length=8,t[0]=t[6]=r+n,t[1]=t[3]=i+o,t[2]=t[4]=r-n,t[5]=t[7]=i-o;return}let l=0,h=f*4+(n?2:0)+2,d=h,m=p;{let _=n+a,x=o,T=r+_,S=r-_,b=i+x;if(t[l++]=T,t[l++]=b,t[--h]=b,t[--h]=S,o){let y=i-x;t[d++]=S,t[d++]=y,t[--m]=y,t[--m]=T}}for(let _=1;_<f;_++){let x=Math.PI/2*(_/f),T=n+Math.cos(x)*a,S=o+Math.sin(x)*c,b=r+T,y=r-T,w=i+S,I=i-S;t[l++]=b,t[l++]=w,t[--h]=w,t[--h]=y,t[d++]=y,t[d++]=I,t[--m]=I,t[--m]=b}{let _=n,x=o+c,T=r+_,S=r-_,b=i+x,y=i-x;t[l++]=T,t[l++]=b,t[--m]=y,t[--m]=T,n&&(t[l++]=S,t[l++]=b,t[--m]=y,t[--m]=S)}},triangulate(e,t){let r=e.points,i=t.points,n=t.indices;if(r.length===0)return;let o=i.length/2,a=o,c,f;if(e.type!==zt.RREC){let l=e.shape;c=l.x,f=l.y}else{let l=e.shape;c=l.x+l.width/2,f=l.y+l.height/2}let p=e.matrix;i.push(e.matrix?p.a*c+p.c*f+p.tx:c,e.matrix?p.b*c+p.d*f+p.ty:f),o++,i.push(r[0],r[1]);for(let l=2;l<r.length;l+=2)i.push(r[l],r[l+1]),n.push(o++,a,o);n.push(a+1,a,o)}};function m_(e,t=!1){let r=e.length;if(r<6)return;let i=0;for(let n=0,o=e[r-2],a=e[r-1];n<r;n+=2){let c=e[n],f=e[n+1];i+=(c-o)*(f+a),o=c,a=f}if(!t&&i>0||t&&i<=0){let n=r/2;for(let o=n+n%2;o<r;o+=2){let a=r-o-2,c=r-o-1,f=o,p=o+1;[e[a],e[f]]=[e[f],e[a]],[e[c],e[p]]=[e[p],e[c]]}}}var js={build(e){e.points=e.shape.points.slice()},triangulate(e,t){let r=e.points,i=e.holes,n=t.points,o=t.indices;if(r.length>=6){m_(r,!1);let a=[];for(let p=0;p<i.length;p++){let l=i[p];m_(l.points,!0),a.push(r.length/2),r=r.concat(l.points)}let c=et.earcut(r,a,2);if(!c)return;let f=n.length/2;for(let p=0;p<c.length;p+=3)o.push(c[p]+f),o.push(c[p+1]+f),o.push(c[p+2]+f);for(let p=0;p<r.length;p++)n.push(r[p])}}};var ph={build(e){let t=e.shape,r=t.x,i=t.y,n=t.width,o=t.height,a=e.points;a.length=0,n>=0&&o>=0&&a.push(r,i,r+n,i,r+n,i+o,r,i+o)},triangulate(e,t){let r=e.points,i=t.points;if(r.length===0)return;let n=i.length/2;i.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),t.indices.push(n,n+1,n+2,n+1,n+2,n+3)}};var mh={build(e){an.build(e)},triangulate(e,t){an.triangulate(e,t)}};var Xe=(e=>(e.MITER="miter",e.BEVEL="bevel",e.ROUND="round",e))(Xe||{}),zr=(e=>(e.BUTT="butt",e.ROUND="round",e.SQUARE="square",e))(zr||{}),Pr={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(e,t=20){if(!this.adaptive||!e||isNaN(e))return t;let r=Math.ceil(e/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}};var Vn=class{static curveTo(t,r,i,n,o,a){let c=a[a.length-2],p=a[a.length-1]-r,l=c-t,h=n-r,d=i-t,m=Math.abs(p*d-l*h);if(m<1e-8||o===0)return(a[a.length-2]!==t||a[a.length-1]!==r)&&a.push(t,r),null;let _=p*p+l*l,x=h*h+d*d,T=p*h+l*d,S=o*Math.sqrt(_)/m,b=o*Math.sqrt(x)/m,y=S*T/_,w=b*T/x,I=S*d+b*l,C=S*h+b*p,P=l*(b+y),M=p*(b+y),B=d*(S+w),F=h*(S+w),L=Math.atan2(M-C,P-I),H=Math.atan2(F-C,B-I);return{cx:I+t,cy:C+r,radius:o,startAngle:L,endAngle:H,anticlockwise:l*h>d*p}}static arc(t,r,i,n,o,a,c,f,p){let l=c-a,h=Pr._segmentsCount(Math.abs(l)*o,Math.ceil(Math.abs(l)/Zi)*40),d=l/(h*2),m=d*2,_=Math.cos(d),x=Math.sin(d),T=h-1,S=T%1/T;for(let b=0;b<=T;++b){let y=b+S*b,w=d+a+m*y,I=Math.cos(w),C=-Math.sin(w);p.push((_*I+x*C)*o+i,(_*-C+x*I)*o+n)}}};var Ks=class{constructor(){this.reset()}begin(t,r,i){this.reset(),this.style=t,this.start=r,this.attribStart=i}end(t,r){this.attribSize=r-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}};var ln=class{static curveLength(t,r,i,n,o,a,c,f){let l=0,h=0,d=0,m=0,_=0,x=0,T=0,S=0,b=0,y=0,w=0,I=t,C=r;for(let P=1;P<=10;++P)h=P/10,d=h*h,m=d*h,_=1-h,x=_*_,T=x*_,S=T*t+3*x*h*i+3*_*d*o+m*c,b=T*r+3*x*h*n+3*_*d*a+m*f,y=I-S,w=C-b,I=S,C=b,l+=Math.sqrt(y*y+w*w);return l}static curveTo(t,r,i,n,o,a,c){let f=c[c.length-2],p=c[c.length-1];c.length-=2;let l=Pr._segmentsCount(ln.curveLength(f,p,t,r,i,n,o,a)),h=0,d=0,m=0,_=0,x=0;c.push(f,p);for(let T=1,S=0;T<=l;++T)S=T/l,h=1-S,d=h*h,m=d*h,_=S*S,x=_*S,c.push(m*f+3*d*S*t+3*h*_*i+x*o,m*p+3*d*S*r+3*h*_*n+x*a)}};function g_(e,t,r,i,n,o,a,c){let f=e-r*n,p=t-i*n,l=e+r*o,h=t+i*o,d,m;a?(d=i,m=-r):(d=-i,m=r);let _=f+d,x=p+m,T=l+d,S=h+m;return c.push(_,x,T,S),2}function Wn(e,t,r,i,n,o,a,c){let f=r-e,p=i-t,l=Math.atan2(f,p),h=Math.atan2(n-e,o-t);c&&l<h?l+=Math.PI*2:!c&&l>h&&(h+=Math.PI*2);let d=l,m=h-l,_=Math.abs(m),x=Math.sqrt(f*f+p*p),T=(15*_*Math.sqrt(x)/Math.PI>>0)+1,S=m/T;if(d+=S,c){a.push(e,t,r,i);for(let b=1,y=d;b<T;b++,y+=S)a.push(e,t,e+Math.sin(y)*x,t+Math.cos(y)*x);a.push(e,t,n,o)}else{a.push(r,i,e,t);for(let b=1,y=d;b<T;b++,y+=S)a.push(e+Math.sin(y)*x,t+Math.cos(y)*x,e,t);a.push(n,o,e,t)}return T*2}function Xb(e,t){let r=e.shape,i=e.points||r.points.slice(),n=t.closePointEps;if(i.length===0)return;let o=e.lineStyle,a=new dt(i[0],i[1]),c=new dt(i[i.length-2],i[i.length-1]),f=r.type!==zt.POLY||r.closeStroke,p=Math.abs(a.x-c.x)<n&&Math.abs(a.y-c.y)<n;if(f){i=i.slice(),p&&(i.pop(),i.pop(),c.set(i[i.length-2],i[i.length-1]));let rt=(a.x+c.x)*.5,$=(c.y+a.y)*.5;i.unshift(rt,$),i.push(rt,$)}let l=t.points,h=i.length/2,d=i.length,m=l.length/2,_=o.width/2,x=_*_,T=o.miterLimit*o.miterLimit,S=i[0],b=i[1],y=i[2],w=i[3],I=0,C=0,P=-(b-w),M=S-y,B=0,F=0,L=Math.sqrt(P*P+M*M);P/=L,M/=L,P*=_,M*=_;let H=o.alignment,N=(1-H)*2,G=H*2;f||(o.cap===zr.ROUND?d+=Wn(S-P*(N-G)*.5,b-M*(N-G)*.5,S-P*N,b-M*N,S+P*G,b+M*G,l,!0)+2:o.cap===zr.SQUARE&&(d+=g_(S,b,P,M,N,G,!0,l))),l.push(S-P*N,b-M*N,S+P*G,b+M*G);for(let rt=1;rt<h-1;++rt){S=i[(rt-1)*2],b=i[(rt-1)*2+1],y=i[rt*2],w=i[rt*2+1],I=i[(rt+1)*2],C=i[(rt+1)*2+1],P=-(b-w),M=S-y,L=Math.sqrt(P*P+M*M),P/=L,M/=L,P*=_,M*=_,B=-(w-C),F=y-I,L=Math.sqrt(B*B+F*F),B/=L,F/=L,B*=_,F*=_;let $=y-S,Q=b-w,st=y-I,_t=C-w,Tt=$*st+Q*_t,Ct=Q*st-_t*$,yt=Ct<0;if(Math.abs(Ct)<.001*Math.abs(Tt)){l.push(y-P*N,w-M*N,y+P*G,w+M*G),Tt>=0&&(o.join===Xe.ROUND?d+=Wn(y,w,y-P*N,w-M*N,y-B*N,w-F*N,l,!1)+4:d+=2,l.push(y-B*G,w-F*G,y+B*N,w+F*N));continue}let Ht=(-P+S)*(-M+w)-(-P+y)*(-M+b),Bt=(-B+I)*(-F+w)-(-B+y)*(-F+C),Qt=($*Bt-st*Ht)/Ct,_e=(_t*Ht-Q*Bt)/Ct,$t=(Qt-y)*(Qt-y)+(_e-w)*(_e-w),Vt=y+(Qt-y)*N,jt=w+(_e-w)*N,Dt=y-(Qt-y)*G,Ot=w-(_e-w)*G,Yr=Math.min($*$+Q*Q,st*st+_t*_t),Ce=yt?N:G,pn=Yr+Ce*Ce*x,Kn=$t<=pn,rr=o.join;if(rr===Xe.MITER&&$t/x>T&&(rr=Xe.BEVEL),Kn)switch(rr){case Xe.MITER:{l.push(Vt,jt,Dt,Ot);break}case Xe.BEVEL:{yt?l.push(Vt,jt,y+P*G,w+M*G,Vt,jt,y+B*G,w+F*G):l.push(y-P*N,w-M*N,Dt,Ot,y-B*N,w-F*N,Dt,Ot),d+=2;break}case Xe.ROUND:{yt?(l.push(Vt,jt,y+P*G,w+M*G),d+=Wn(y,w,y+P*G,w+M*G,y+B*G,w+F*G,l,!0)+4,l.push(Vt,jt,y+B*G,w+F*G)):(l.push(y-P*N,w-M*N,Dt,Ot),d+=Wn(y,w,y-P*N,w-M*N,y-B*N,w-F*N,l,!1)+4,l.push(y-B*N,w-F*N,Dt,Ot));break}}else{switch(l.push(y-P*N,w-M*N,y+P*G,w+M*G),rr){case Xe.MITER:{yt?l.push(Dt,Ot,Dt,Ot):l.push(Vt,jt,Vt,jt),d+=2;break}case Xe.ROUND:{yt?d+=Wn(y,w,y+P*G,w+M*G,y+B*G,w+F*G,l,!0)+2:d+=Wn(y,w,y-P*N,w-M*N,y-B*N,w-F*N,l,!1)+2;break}}l.push(y-B*N,w-F*N,y+B*G,w+F*G),d+=2}}S=i[(h-2)*2],b=i[(h-2)*2+1],y=i[(h-1)*2],w=i[(h-1)*2+1],P=-(b-w),M=S-y,L=Math.sqrt(P*P+M*M),P/=L,M/=L,P*=_,M*=_,l.push(y-P*N,w-M*N,y+P*G,w+M*G),f||(o.cap===zr.ROUND?d+=Wn(y-P*(N-G)*.5,w-M*(N-G)*.5,y-P*N,w-M*N,y+P*G,w+M*G,l,!1)+2:o.cap===zr.SQUARE&&(d+=g_(y,w,P,M,N,G,!1,l)));let q=t.indices,j=Pr.epsilon*Pr.epsilon;for(let rt=m;rt<d+m-2;++rt)S=l[rt*2],b=l[rt*2+1],y=l[(rt+1)*2],w=l[(rt+1)*2+1],I=l[(rt+2)*2],C=l[(rt+2)*2+1],!(Math.abs(S*(w-C)+y*(C-b)+I*(b-w))<j)&&q.push(rt,rt+1,rt+2)}function zb(e,t){let r=0,i=e.shape,n=e.points||i.points,o=i.type!==zt.POLY||i.closeStroke;if(n.length===0)return;let a=t.points,c=t.indices,f=n.length/2,p=a.length/2,l=p;for(a.push(n[0],n[1]),r=1;r<f;r++)a.push(n[r*2],n[r*2+1]),c.push(l,l+1),l++;o&&c.push(l,p)}function fa(e,t){e.lineStyle.native?zb(e,t):Xb(e,t)}var hn=class{static curveLength(t,r,i,n,o,a){let c=t-2*i+o,f=r-2*n+a,p=2*i-2*t,l=2*n-2*r,h=4*(c*c+f*f),d=4*(c*p+f*l),m=p*p+l*l,_=2*Math.sqrt(h+d+m),x=Math.sqrt(h),T=2*h*x,S=2*Math.sqrt(m),b=d/x;return(T*_+x*d*(_-S)+(4*m*h-d*d)*Math.log((2*x+b+_)/(b+S)))/(4*T)}static curveTo(t,r,i,n,o){let a=o[o.length-2],c=o[o.length-1],f=Pr._segmentsCount(hn.curveLength(a,c,t,r,i,n)),p=0,l=0;for(let h=1;h<=f;++h){let d=h/f;p=a+(t-a)*d,l=c+(r-c)*d,o.push(p+(t+(i-t)*d-p)*d,l+(r+(n-r)*d-l)*d)}}};var da={[zt.POLY]:js,[zt.CIRC]:an,[zt.ELIP]:an,[zt.RECT]:ph,[zt.RREC]:mh},gh=[],qs=[];var un=class{constructor(t,r=null,i=null,n=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=i,this.fillStyle=r,this.matrix=n,this.type=t.type}clone(){return new un(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}};var Zs=new dt,__=class extends bn{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new ri,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),qs.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){let t=this.batches[e];t.reset(),gh.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,r=null,i=null){let n=new un(e,t,r,i);return this.graphicsData.push(n),this.dirty++,this}drawHole(e,t=null){if(!this.graphicsData.length)return null;let r=new un(e,null,null,t),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){let t=this.graphicsData;for(let r=0;r<t.length;++r){let i=t[r];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(e,Zs):Zs.copyFrom(e),i.shape.contains(Zs.x,Zs.y))){let n=!1;if(i.holes){for(let o=0;o<i.holes.length;o++)if(i.holes[o].shape.contains(Zs.x,Zs.y)){n=!0;break}}if(!n)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;let e=this.uvs,t=this.graphicsData,r=null,i=null;this.batches.length>0&&(r=this.batches[this.batches.length-1],i=r.style);for(let c=this.shapeIndex;c<t.length;c++){this.shapeIndex++;let f=t[c],p=f.fillStyle,l=f.lineStyle;da[f.type].build(f),f.matrix&&this.transformPoints(f.points,f.matrix),(p.visible||l.visible)&&this.processHoles(f.holes);for(let d=0;d<2;d++){let m=d===0?p:l;if(!m.visible)continue;let _=m.texture.baseTexture,x=this.indices.length,T=this.points.length/2;_.wrapMode=ur.REPEAT,d===0?this.processFill(f):this.processLine(f);let S=this.points.length/2-T;S!==0&&(r&&!this._compareStyles(i,m)&&(r.end(x,T),r=null),r||(r=gh.pop()||new Ks,r.begin(m,x,T),this.batches.push(r),i=m),this.addUvs(this.points,e,m.texture,T,S,m.matrix))}}let n=this.indices.length,o=this.points.length/2;if(r&&r.end(n,o),this.batches.length===0){this.batchable=!0;return}let a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){let r=this.graphicsData[e],i=r.fillStyle,n=r.lineStyle;if(i&&!i.texture.baseTexture.valid||n&&!n.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);let e=this.batches;for(let t=0,r=e.length;t<r;t++){let i=e[t];for(let n=0;n<i.size;n++){let o=i.start+n;this.indicesUint16[o]=this.indicesUint16[o]-i.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;let e=this.batches;for(let t=0;t<e.length;t++)if(e[t].style.native)return!1;return this.points.length<__.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++lt._globalBatch;for(let l=0;l<this.drawCalls.length;l++)this.drawCalls[l].texArray.clear(),qs.push(this.drawCalls[l]);this.drawCalls.length=0;let t=this.colors,r=this.textureIds,i=qs.pop();i||(i=new Ki,i.texArray=new Qi),i.texArray.count=0,i.start=0,i.size=0,i.type=Ze.TRIANGLES;let n=0,o=null,a=0,c=!1,f=Ze.TRIANGLES,p=0;this.drawCalls.push(i);for(let l=0;l<this.batches.length;l++){let h=this.batches[l],d=8,m=h.style,_=m.texture.baseTexture;c!==!!m.native&&(c=!!m.native,f=c?Ze.LINES:Ze.TRIANGLES,o=null,n=d,e++),o!==_&&(o=_,_._batchEnabled!==e&&(n===d&&(e++,n=0,i.size>0&&(i=qs.pop(),i||(i=new Ki,i.texArray=new Qi),this.drawCalls.push(i)),i.start=p,i.size=0,i.texArray.count=0,i.type=f),_.touched=1,_._batchEnabled=e,_._batchLocation=n,_.wrapMode=ur.REPEAT,i.texArray.elements[i.texArray.count++]=_,n++)),i.size+=h.size,p+=h.size,a=_._batchLocation,this.addColors(t,m.color,m.alpha,h.attribSize,h.attribStart),this.addTextureIds(r,a,h.attribSize,h.attribStart)}lt._globalBatch=e,this.packAttributes()}packAttributes(){let e=this.points,t=this.uvs,r=this.colors,i=this.textureIds,n=new ArrayBuffer(e.length*3*4),o=new Float32Array(n),a=new Uint32Array(n),c=0;for(let f=0;f<e.length/2;f++)o[c++]=e[f*2],o[c++]=e[f*2+1],o[c++]=t[f*2],o[c++]=t[f*2+1],a[c++]=r[f],o[c++]=i[f];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?js.triangulate(e,this):da[e.type].triangulate(e,this)}processLine(e){fa(e,this);for(let t=0;t<e.holes.length;t++)fa(e.holes[t],this)}processHoles(e){for(let t=0;t<e.length;t++){let r=e[t];da[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){let e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,t){for(let r=0;r<e.length/2;r++){let i=e[r*2],n=e[r*2+1];e[r*2]=t.a*i+t.c*n+t.tx,e[r*2+1]=t.b*i+t.d*n+t.ty}}addColors(e,t,r,i,n=0){let o=pt.shared.setValue(t).toLittleEndianNumber(),a=pt.shared.setValue(o).toPremultiplied(r);e.length=Math.max(e.length,n+i);for(let c=0;c<i;c++)e[n+c]=a}addTextureIds(e,t,r,i=0){e.length=Math.max(e.length,i+r);for(let n=0;n<r;n++)e[i+n]=t}addUvs(e,t,r,i,n,o=null){let a=0,c=t.length,f=r.frame;for(;a<n;){let l=e[(i+a)*2],h=e[(i+a)*2+1];if(o){let d=o.a*l+o.c*h+o.tx;h=o.b*l+o.d*h+o.ty,l=d}a++,t.push(l/f.width,h/f.height)}let p=r.baseTexture;(f.width<p.width||f.height<p.height)&&this.adjustUvs(t,r,c,n)}adjustUvs(e,t,r,i){let n=t.baseTexture,o=1e-6,a=r+i*2,c=t.frame,f=c.width/n.width,p=c.height/n.height,l=c.x/c.width,h=c.y/c.height,d=Math.floor(e[r]+o),m=Math.floor(e[r+1]+o);for(let _=r+2;_<a;_+=2)d=Math.min(d,Math.floor(e[_]+o)),m=Math.min(m,Math.floor(e[_+1]+o));l-=d,h-=m;for(let _=r;_<a;_+=2)e[_]=(e[_]+l)*f,e[_+1]=(e[_+1]+h)*p}},_h=__;_h.BATCHABLE_SIZE=100;var Pi=class{constructor(){this.color=16777215,this.alpha=1,this.texture=it.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){let t=new Pi;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=it.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}};var Xn=class extends Pi{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=zr.BUTT,this.join=Xe.MITER,this.miterLimit=10}clone(){let t=new Xn;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}};var gf={},xh=class extends ne{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Pi,this._lineStyle=new Xn,this._matrix=null,this._holeMode=!1,this.state=de.for2d(),this._geometry=e||new _h,this._geometry.refCount++,this._transformID=-1,this._tintColor=new pt(16777215),this.blendMode=ft.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new xh(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,r,i=.5,n=!1){return typeof e=="number"&&(e={width:e,color:t,alpha:r,alignment:i,native:n}),this.lineTextureStyle(e)}lineTextureStyle(e){let t={width:0,texture:it.WHITE,color:e?.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:zr.BUTT,join:Xe.MITER,miterLimit:10};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();let r=e.width>0&&e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:r},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){let e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new Ur,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new Ur,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);let r=this.currentPath.points,i=r[r.length-2],n=r[r.length-1];return(i!==e||n!==t)&&r.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,r,i){this._initCurve();let n=this.currentPath.points;return n.length===0&&this.moveTo(0,0),hn.curveTo(e,t,r,i,n),this}bezierCurveTo(e,t,r,i,n,o){return this._initCurve(),ln.curveTo(e,t,r,i,n,o,this.currentPath.points),this}arcTo(e,t,r,i,n){this._initCurve(e,t);let o=this.currentPath.points,a=Vn.curveTo(e,t,r,i,n,o);if(a){let{cx:c,cy:f,radius:p,startAngle:l,endAngle:h,anticlockwise:d}=a;this.arc(c,f,p,l,h,d)}return this}arc(e,t,r,i,n,o=!1){if(i===n)return this;if(!o&&n<=i?n+=Zi:o&&i<=n&&(i+=Zi),n-i===0)return this;let c=e+Math.cos(i)*r,f=t+Math.sin(i)*r,p=this._geometry.closePointEps,l=this.currentPath?this.currentPath.points:null;if(l){let h=Math.abs(l[l.length-2]-c),d=Math.abs(l[l.length-1]-f);h<p&&d<p||l.push(c,f)}else this.moveTo(c,f),l=this.currentPath.points;return Vn.arc(c,f,e,t,r,i,n,o,l),this}beginFill(e=0,t){return this.beginTextureFill({texture:it.WHITE,color:e,alpha:t})}normalizeColor(e){let t=pt.shared.setValue(e.color??0);e.color=t.toNumber(),e.alpha??(e.alpha=t.alpha)}beginTextureFill(e){let t={texture:it.WHITE,color:16777215,matrix:null};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();let r=e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:r},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,r,i){return this.drawShape(new ut(e,t,r,i))}drawRoundedRect(e,t,r,i,n){return this.drawShape(new In(e,t,r,i,n))}drawCircle(e,t,r){return this.drawShape(new An(e,t,r))}drawEllipse(e,t,r,i){return this.drawShape(new Cn(e,t,r,i))}drawPolygon(...e){let t,r=!0,i=e[0];i.points?(r=i.closeStroke,t=i.points):Array.isArray(e[0])?t=e[0]:t=e;let n=new Ur(t);return n.closeStroke=r,this.drawShape(n),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){let e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===zt.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();let t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){let e=this._geometry,t=this.blendMode,r=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(e.points);for(let i=0;i<r;i++){let n=e.batches[i],o=n.style.color,a=new Float32Array(this.vertexData.buffer,n.attribStart*4*2,n.attribSize*2),c=new Float32Array(e.uvsFloat32.buffer,n.attribStart*4*2,n.attribSize*2),f=new Uint16Array(e.indicesUint16.buffer,n.start*2,n.size),p={vertexData:a,blendMode:t,indices:f,uvs:c,_batchRGB:pt.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[i]=p}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,r=this.batches.length;t<r;t++){let i=this.batches[t];i.worldAlpha=this.worldAlpha*i.alpha,e.plugins[this.pluginName].render(i)}}}_renderDirect(e){let t=this._resolveDirectShader(e),r=this._geometry,i=this.worldAlpha,n=t.uniforms,o=r.drawCalls;n.translationMatrix=this.transform.worldTransform,pt.shared.setValue(this._tintColor).multiply([i,i,i]).setAlpha(i).toArray(n.tint),e.shader.bind(t),e.geometry.bind(r,t),e.state.set(this.state);for(let a=0,c=o.length;a<c;a++)this._renderDrawCallDirect(e,r.drawCalls[a])}_renderDrawCallDirect(e,t){let{texArray:r,type:i,size:n,start:o}=t,a=r.count;for(let c=0;c<a;c++)e.texture.bind(r.elements[c],c);e.geometry.draw(i,n,o)}_resolveDirectShader(e){let t=this.shader,r=this.pluginName;if(!t){if(!gf[r]){let{maxTextures:i}=e.plugins[r],n=new Int32Array(i);for(let c=0;c<i;c++)n[c]=c;let o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Et,default:pe.from({uSamplers:n},!0)},a=e.plugins[r]._shader.program;gf[r]=new me(a,o)}t=gf[r]}return t}_calculateBounds(){this.finishPoly();let e=this._geometry;if(!e.graphicsData.length)return;let{minX:t,minY:r,maxX:i,maxY:n}=e.bounds;this._bounds.addFrame(this.transform,t,r,i,n)}containsPoint(e){return this.worldTransform.applyInverse(e,xh._TEMP_POINT),this._geometry.containsPoint(xh._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){let t=this.batches[e];t._tintRGB=pt.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){let e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;let t=this.transform.worldTransform,r=t.a,i=t.b,n=t.c,o=t.d,a=t.tx,c=t.ty,f=this._geometry.points,p=this.vertexData,l=0;for(let h=0;h<f.length;h+=2){let d=f[h],m=f[h+1];p[l++]=r*d+n*m+a,p[l++]=o*m+i*d+c}}closePath(){let e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}},Qs=xh;Qs.curves=Pr;Qs._TEMP_POINT=new dt;var pa=class{constructor(t,r){this.uvBuffer=t,this.uvMatrix=r,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;let r=this.uvBuffer.data;(!this.data||this.data.length!==r.length)&&(this.data=new Float32Array(r.length)),this.uvMatrix.multiplyUvs(r,this.data),this._updateID++}};var _f=new dt,x_=new Ur,v_=class extends ne{constructor(e,t,r,i=Ze.TRIANGLES){super(),this.geometry=e,this.shader=t,this.state=r||de.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=W.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){let t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Ze.TRIANGLES&&t.length<v_.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){let t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){let t=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;let i=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[i]),e.plugins[i].render(this)}calculateVertices(){let t=this.geometry.buffers[0],r=t.data,i=t._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));let n=this.transform.worldTransform,o=n.a,a=n.b,c=n.c,f=n.d,p=n.tx,l=n.ty,h=this.vertexData;for(let d=0;d<h.length/2;d++){let m=r[d*2],_=r[d*2+1];h[d*2]=o*m+c*_+p,h[d*2+1]=a*m+f*_+l}if(this._roundPixels){let d=W.RESOLUTION;for(let m=0;m<h.length;++m)h[m]=Math.round(h[m]*d)/d}this.vertexDirty=i}calculateUvs(){let e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new pa(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,_f);let t=this.geometry.getBuffer("aVertexPosition").data,r=x_.points,i=this.geometry.getIndex().data,n=i.length,o=this.drawMode===4?3:1;for(let a=0;a+2<n;a+=o){let c=i[a]*2,f=i[a+1]*2,p=i[a+2]*2;if(r[0]=t[c],r[1]=t[c+1],r[2]=t[f],r[3]=t[f+1],r[4]=t[p],r[5]=t[p+1],x_.contains(_f.x,_f.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}},cn=v_;cn.BATCHABLE_SIZE=100;var fn=class extends Me{constructor(t,r,i){super();let n=new kt(t),o=new kt(r,!0),a=new kt(i,!0,!0);this.addAttribute("aVertexPosition",n,2,!1,at.FLOAT).addAttribute("aTextureCoord",o,2,!1,at.FLOAT).addIndex(a),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}};var y_=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`;var T_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;var Mi=class extends me{constructor(t,r){let i={uSampler:t,alpha:1,uTextureMatrix:Et.IDENTITY,uColor:new Float32Array([1,1,1,1])};r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r),r.uniforms&&Object.assign(i,r.uniforms),super(r.program||we.from(T_,y_),i),this._colorDirty=!1,this.uvMatrix=new en(t),this.batchable=r.program===void 0,this.pluginName=r.pluginName,this._tintColor=new pt(r.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=r.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;let r=this.texture.baseTexture.alphaMode;pt.shared.setValue(this._tintColor).premultiply(this._alpha,r).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}};var ma=class{constructor(t,r,i){this.geometry=new Me,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let n=0;n<t.length;++n){let o=t[n];o={attributeName:o.attributeName,size:o.size,uploadFunction:o.uploadFunction,type:o.type||at.FLOAT,offset:o.offset},r[n]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){let t=this.geometry,r=0;this.indexBuffer=new kt(et.createIndicesForQuads(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let a=0;a<this.dynamicProperties.length;++a){let c=this.dynamicProperties[a];c.offset=r,r+=c.size,this.dynamicStride+=c.size}let i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new kt(this.dynamicData,!1,!1);let n=0;this.staticStride=0;for(let a=0;a<this.staticProperties.length;++a){let c=this.staticProperties[a];c.offset=n,n+=c.size,this.staticStride+=c.size}let o=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(o),this.staticDataUint32=new Uint32Array(o),this.staticBuffer=new kt(this.staticData,!0,!1);for(let a=0;a<this.dynamicProperties.length;++a){let c=this.dynamicProperties[a];t.addAttribute(c.attributeName,this.dynamicBuffer,0,c.type===at.UNSIGNED_BYTE,c.type,this.dynamicStride*4,c.offset*4)}for(let a=0;a<this.staticProperties.length;++a){let c=this.staticProperties[a];t.addAttribute(c.attributeName,this.staticBuffer,0,c.type===at.UNSIGNED_BYTE,c.type,this.staticStride*4,c.offset*4)}}uploadDynamic(t,r,i){for(let n=0;n<this.dynamicProperties.length;n++){let o=this.dynamicProperties[n];o.uploadFunction(t,r,i,o.type===at.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,o.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,r,i){for(let n=0;n<this.staticProperties.length;n++){let o=this.staticProperties[n];o.uploadFunction(t,r,i,o.type===at.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,o.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}};var w_=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`;var E_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;var ga=class extends kr{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new Et,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:at.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=me.from(E_,w_,{}),this.state=de.for2d()}render(t){let r=t.children,i=t._maxSize,n=t._batchSize,o=this.renderer,a=r.length;if(a===0)return;a>i&&!t.autoResize&&(a=i);let c=t._buffers;c||(c=t._buffers=this.generateBuffers(t));let f=r[0]._texture.baseTexture,p=f.alphaMode>0;this.state.blendMode=et.correctBlendMode(t.blendMode,p),o.state.set(this.state);let l=o.gl,h=t.worldTransform.copyTo(this.tempMatrix);h.prepend(o.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=h.toArray(!0),this.shader.uniforms.uColor=pt.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,p).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=f,this.renderer.shader.bind(this.shader);let d=!1;for(let m=0,_=0;m<a;m+=n,_+=1){let x=a-m;x>n&&(x=n),_>=c.length&&c.push(this._generateOneMoreBuffer(t));let T=c[_];T.uploadDynamic(r,m,x);let S=t._bufferUpdateIDs[_]||0;d=d||T._updateID<S,d&&(T._updateID=t._updateID,T.uploadStatic(r,m,x)),o.geometry.bind(T.geometry),l.drawElements(l.TRIANGLES,x*6,l.UNSIGNED_SHORT,0)}}generateBuffers(t){let r=[],i=t._maxSize,n=t._batchSize,o=t._properties;for(let a=0;a<i;a+=n)r.push(new ma(this.properties,o,n));return r}_generateOneMoreBuffer(t){let r=t._batchSize,i=t._properties;return new ma(this.properties,i,r)}uploadVertices(t,r,i,n,o,a){let c=0,f=0,p=0,l=0;for(let h=0;h<i;++h){let d=t[r+h],m=d._texture,_=d.scale.x,x=d.scale.y,T=m.trim,S=m.orig;T?(f=T.x-d.anchor.x*S.width,c=f+T.width,l=T.y-d.anchor.y*S.height,p=l+T.height):(c=S.width*(1-d.anchor.x),f=S.width*-d.anchor.x,p=S.height*(1-d.anchor.y),l=S.height*-d.anchor.y),n[a]=f*_,n[a+1]=l*x,n[a+o]=c*_,n[a+o+1]=l*x,n[a+o*2]=c*_,n[a+o*2+1]=p*x,n[a+o*3]=f*_,n[a+o*3+1]=p*x,a+=o*4}}uploadPosition(t,r,i,n,o,a){for(let c=0;c<i;c++){let f=t[r+c].position;n[a]=f.x,n[a+1]=f.y,n[a+o]=f.x,n[a+o+1]=f.y,n[a+o*2]=f.x,n[a+o*2+1]=f.y,n[a+o*3]=f.x,n[a+o*3+1]=f.y,a+=o*4}}uploadRotation(t,r,i,n,o,a){for(let c=0;c<i;c++){let f=t[r+c].rotation;n[a]=f,n[a+o]=f,n[a+o*2]=f,n[a+o*3]=f,a+=o*4}}uploadUvs(t,r,i,n,o,a){for(let c=0;c<i;++c){let f=t[r+c]._texture._uvs;f?(n[a]=f.x0,n[a+1]=f.y0,n[a+o]=f.x1,n[a+o+1]=f.y1,n[a+o*2]=f.x2,n[a+o*2+1]=f.y2,n[a+o*3]=f.x3,n[a+o*3+1]=f.y3,a+=o*4):(n[a]=0,n[a+1]=0,n[a+o]=0,n[a+o+1]=0,n[a+o*2]=0,n[a+o*2+1]=0,n[a+o*3]=0,n[a+o*3+1]=0,a+=o*4)}}uploadTint(t,r,i,n,o,a){for(let c=0;c<i;++c){let f=t[r+c],p=pt.shared.setValue(f._tintRGB).toPremultiplied(f.alpha);n[a]=p,n[a+o]=p,n[a+o*2]=p,n[a+o*3]=p,a+=o*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}};ga.extension={name:"particle",type:z.RendererPlugin};Z.add(ga);var dn=(e=>(e[e.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",e[e.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",e))(dn||{});var vh={willReadFrequently:!0},ct=class{static get experimentalLetterSpacingSupported(){let e=ct._experimentalLetterSpacingSupported;if(e!==void 0){let t=W.ADAPTER.getCanvasRenderingContext2D().prototype;e=ct._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,r,i,n,o,a,c,f){this.text=e,this.style=t,this.width=r,this.height=i,this.lines=n,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=c,this.fontProperties=f}static measureText(e,t,r,i=ct._canvas){r=r??t.wordWrap;let n=t.toFontString(),o=ct.measureFont(n);o.fontSize===0&&(o.fontSize=t.fontSize,o.ascent=t.fontSize);let a=i.getContext("2d",vh);a.font=n;let f=(r?ct.wordWrap(e,t,i):e).split(/(?:\r\n|\r|\n)/),p=new Array(f.length),l=0;for(let _=0;_<f.length;_++){let x=ct._measureText(f[_],t.letterSpacing,a);p[_]=x,l=Math.max(l,x)}let h=l+t.strokeThickness;t.dropShadow&&(h+=t.dropShadowDistance);let d=t.lineHeight||o.fontSize+t.strokeThickness,m=Math.max(d,o.fontSize+t.strokeThickness*2)+(f.length-1)*(d+t.leading);return t.dropShadow&&(m+=t.dropShadowDistance),new ct(e,t,h,m,f,p,d+t.leading,l,o)}static _measureText(e,t,r){let i=!1;ct.experimentalLetterSpacingSupported&&(ct.experimentalLetterSpacing?(r.letterSpacing=`${t}px`,r.textLetterSpacing=`${t}px`,i=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));let n=r.measureText(e).width;return n>0&&(i?n-=t:n+=(ct.graphemeSegmenter(e).length-1)*t),n}static wordWrap(e,t,r=ct._canvas){let i=r.getContext("2d",vh),n=0,o="",a="",c=Object.create(null),{letterSpacing:f,whiteSpace:p}=t,l=ct.collapseSpaces(p),h=ct.collapseNewlines(p),d=!l,m=t.wordWrapWidth+f,_=ct.tokenize(e);for(let x=0;x<_.length;x++){let T=_[x];if(ct.isNewline(T)){if(!h){a+=ct.addLine(o),d=!l,o="",n=0;continue}T=" "}if(l){let b=ct.isBreakingSpace(T),y=ct.isBreakingSpace(o[o.length-1]);if(b&&y)continue}let S=ct.getFromCache(T,f,c,i);if(S>m)if(o!==""&&(a+=ct.addLine(o),o="",n=0),ct.canBreakWords(T,t.breakWords)){let b=ct.wordWrapSplit(T);for(let y=0;y<b.length;y++){let w=b[y],I=w,C=1;for(;b[y+C];){let M=b[y+C];if(!ct.canBreakChars(I,M,T,y,t.breakWords))w+=M;else break;I=M,C++}y+=C-1;let P=ct.getFromCache(w,f,c,i);P+n>m&&(a+=ct.addLine(o),d=!1,o="",n=0),o+=w,n+=P}}else{o.length>0&&(a+=ct.addLine(o),o="",n=0);let b=x===_.length-1;a+=ct.addLine(T,!b),d=!1,o="",n=0}else S+n>m&&(d=!1,a+=ct.addLine(o),o="",n=0),(o.length>0||!ct.isBreakingSpace(T)||d)&&(o+=T,n+=S)}return a+=ct.addLine(o,!1),a}static addLine(e,t=!0){return e=ct.trimRight(e),e=t?`${e}
`:e,e}static getFromCache(e,t,r,i){let n=r[e];return typeof n!="number"&&(n=ct._measureText(e,t,i)+t,r[e]=n),n}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){let r=e[t];if(!ct.isBreakingSpace(r))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:ct._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:ct._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){let t=[],r="";if(typeof e!="string")return t;for(let i=0;i<e.length;i++){let n=e[i],o=e[i+1];if(ct.isBreakingSpace(n,o)||ct.isNewline(n)){r!==""&&(t.push(r),r=""),t.push(n);continue}r+=n}return r!==""&&t.push(r),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,r,i,n){return!0}static wordWrapSplit(e){return ct.graphemeSegmenter(e)}static measureFont(e){if(ct._fonts[e])return ct._fonts[e];let t={ascent:0,descent:0,fontSize:0},r=ct._canvas,i=ct._context;i.font=e;let n=ct.METRICS_STRING+ct.BASELINE_SYMBOL,o=Math.ceil(i.measureText(n).width),a=Math.ceil(i.measureText(ct.BASELINE_SYMBOL).width),c=Math.ceil(ct.HEIGHT_MULTIPLIER*a);if(a=a*ct.BASELINE_MULTIPLIER|0,o===0||c===0)return ct._fonts[e]=t,t;r.width=o,r.height=c,i.fillStyle="#f00",i.fillRect(0,0,o,c),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(n,0,a);let f=i.getImageData(0,0,o,c).data,p=f.length,l=o*4,h=0,d=0,m=!1;for(h=0;h<a;++h){for(let _=0;_<l;_+=4)if(f[d+_]!==255){m=!0;break}if(!m)d+=l;else break}for(t.ascent=a-h,d=p-l,m=!1,h=c;h>a;--h){for(let _=0;_<l;_+=4)if(f[d+_]!==255){m=!0;break}if(!m)d-=l;else break}return t.descent=h-a,t.fontSize=t.ascent+t.descent,ct._fonts[e]=t,t}static clearMetrics(e=""){e?delete ct._fonts[e]:ct._fonts={}}static get _canvas(){if(!ct.__canvas){let e;try{let t=new OffscreenCanvas(0,0);if(t.getContext("2d",vh)?.measureText)return ct.__canvas=t,t;e=W.ADAPTER.createCanvas()}catch{e=W.ADAPTER.createCanvas()}e.width=e.height=10,ct.__canvas=e}return ct.__canvas}static get _context(){return ct.__context||(ct.__context=ct._canvas.getContext("2d",vh)),ct.__context}},he=ct;he.METRICS_STRING="|\xC9q\xC5";he.BASELINE_SYMBOL="M";he.BASELINE_MULTIPLIER=1.4;he.HEIGHT_MULTIPLIER=2;he.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){let e=new Intl.Segmenter;return t=>[...e.segment(t)].map(r=>r.segment)}return e=>[...e]})();he.experimentalLetterSpacing=!1;he._fonts={};he._newlines=[10,13];he._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var Kb=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],_a=class{constructor(e){this.styleID=0,this.reset(),vf(this,e,e)}clone(){let e={};return vf(e,this,_a.defaultStyle),new _a(e)}reset(){vf(this,_a.defaultStyle,_a.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){let t=xf(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){let t=xf(e);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){qb(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){let t=xf(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){let e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize,t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let r=t.length-1;r>=0;r--){let i=t[r].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!Kb.includes(i)&&(i=`"${i}"`),t[r]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${t.join(",")}`}},ze=_a;ze.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:dn.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function xf(e){let t=pt.shared;return Array.isArray(e)?e.map(r=>t.setValue(r).toHex()):t.setValue(e).toHex()}function qb(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}function vf(e,t,r){for(let i in r)Array.isArray(t[i])?e[i]=t[i].slice():e[i]=t[i]}var Zb={texture:!0,children:!1,baseTexture:!0},yf=class extends Be{constructor(e,t,r){let i=!1;r||(r=W.ADAPTER.createCanvas(),i=!0),r.width=3,r.height=3;let n=it.from(r);n.orig=new ut,n.trim=new ut,super(n),this._ownCanvas=i,this.canvas=r,this.context=r.getContext("2d",{willReadFrequently:!0}),this._resolution=yf.defaultResolution??W.RESOLUTION,this._autoResolution=yf.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return he.experimentalLetterSpacing}static set experimentalLetterSpacing(e){et.deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),he.experimentalLetterSpacing=e}updateText(e){let t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();let r=this.context,i=he.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),n=i.width,o=i.height,a=i.lines,c=i.lineHeight,f=i.lineWidths,p=i.maxLineWidth,l=i.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,n)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+t.padding*2)*this._resolution),r.scale(this._resolution,this._resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.lineWidth=t.strokeThickness,r.textBaseline=t.textBaseline,r.lineJoin=t.lineJoin,r.miterLimit=t.miterLimit;let h,d,m=t.dropShadow?2:1;for(let _=0;_<m;++_){let x=t.dropShadow&&_===0,T=x?Math.ceil(Math.max(1,o)+t.padding*2):0,S=T*this._resolution;if(x){r.fillStyle="black",r.strokeStyle="black";let y=t.dropShadowColor,w=t.dropShadowBlur*this._resolution,I=t.dropShadowDistance*this._resolution;r.shadowColor=pt.shared.setValue(y).setAlpha(t.dropShadowAlpha).toRgbaString(),r.shadowBlur=w,r.shadowOffsetX=Math.cos(t.dropShadowAngle)*I,r.shadowOffsetY=Math.sin(t.dropShadowAngle)*I+S}else r.fillStyle=this._generateFillStyle(t,a,i),r.strokeStyle=t.stroke,r.shadowColor="black",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0;let b=(c-l.fontSize)/2;c-l.fontSize<0&&(b=0);for(let y=0;y<a.length;y++)h=t.strokeThickness/2,d=t.strokeThickness/2+y*c+l.ascent+b,t.align==="right"?h+=p-f[y]:t.align==="center"&&(h+=(p-f[y])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(a[y],h+t.padding,d+t.padding-T,!0),t.fill&&this.drawLetterSpacing(a[y],h+t.padding,d+t.padding-T)}this.updateTexture()}drawLetterSpacing(e,t,r,i=!1){let o=this._style.letterSpacing,a=!1;if(he.experimentalLetterSpacingSupported&&(he.experimentalLetterSpacing?(this.context.letterSpacing=`${o}px`,this.context.textLetterSpacing=`${o}px`,a=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),o===0||a){i?this.context.strokeText(e,t,r):this.context.fillText(e,t,r);return}let c=t,f=he.graphemeSegmenter(e),p=this.context.measureText(e).width,l=0;for(let h=0;h<f.length;++h){let d=f[h];i?this.context.strokeText(d,c,r):this.context.fillText(d,c,r);let m="";for(let _=h+1;_<f.length;++_)m+=f[_];l=this.context.measureText(m).width,c+=p-l+o,p=l}}updateTexture(){let e=this.canvas;if(this._style.trim){let o=et.trimCanvas(e);o.data&&(e.width=o.width,e.height=o.height,this.context.putImageData(o.data,0,0))}let t=this._texture,r=this._style,i=r.trim?0:r.padding,n=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-i,t.trim.y=-i,t.orig.width=t._frame.width-i*2,t.orig.height=t._frame.height-i*2,this._onTextureUpdate(),n.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,t,r){let i=e.fill;if(Array.isArray(i)){if(i.length===1)return i[0]}else return i;let n,o=e.dropShadow?e.dropShadowDistance:0,a=e.padding||0,c=this.canvas.width/this._resolution-o-a*2,f=this.canvas.height/this._resolution-o-a*2,p=i.slice(),l=e.fillGradientStops.slice();if(!l.length){let h=p.length+1;for(let d=1;d<h;++d)l.push(d/h)}if(p.unshift(i[0]),l.unshift(0),p.push(i[i.length-1]),l.push(1),e.fillGradientType===dn.LINEAR_VERTICAL){n=this.context.createLinearGradient(c/2,a,c/2,f+a);let h=r.fontProperties.fontSize+e.strokeThickness;for(let d=0;d<t.length;d++){let m=r.lineHeight*(d-1)+h,_=r.lineHeight*d,x=_;d>0&&m>_&&(x=(_+m)/2);let T=_+h,S=r.lineHeight*(d+1),b=T;d+1<t.length&&S<T&&(b=(T+S)/2);let y=(b-x)/f;for(let w=0;w<p.length;w++){let I=0;typeof l[w]=="number"?I=l[w]:I=w/p.length;let C=Math.min(1,Math.max(0,x/f+I*y));C=Number(C.toFixed(5)),n.addColorStop(C,p[w])}}}else{n=this.context.createLinearGradient(a,f/2,c+a,f/2);let h=p.length+1,d=1;for(let m=0;m<p.length;m++){let _;typeof l[m]=="number"?_=l[m]:_=d/h,n.addColorStop(_,p[m]),d++}}return n}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},Zb,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);let t=et.sign(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);let t=et.sign(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof ze?this._style=e:this._style=new ze(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}},xa=yf;xa.defaultAutoResolution=!0;var va=class{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}};function Qb(e,t){let r=!1;if(e?._textures?.length){for(let i=0;i<e._textures.length;i++)if(e._textures[i]instanceof it){let n=e._textures[i].baseTexture;t.includes(n)||(t.push(n),r=!0)}}return r}function Jb(e,t){if(e.baseTexture instanceof lt){let r=e.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function tA(e,t){if(e._texture&&e._texture instanceof it){let r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function eA(e,t){return t instanceof xa?(t.updateText(!0),!0):!1}function rA(e,t){if(t instanceof ze){let r=t.toFontString();return he.measureFont(r),!0}return!1}function iA(e,t){if(e instanceof xa){t.includes(e.style)||t.push(e.style),t.includes(e)||t.push(e);let r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function nA(e,t){return e instanceof ze?(t.includes(e)||t.push(e),!0):!1}var S_=class{constructor(e){this.limiter=new va(S_.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(iA),this.registerFindHook(nA),this.registerFindHook(Qb),this.registerFindHook(Jb),this.registerFindHook(tA),this.registerUploadHook(eA),this.registerUploadHook(rA)}upload(e){return new Promise(t=>{e&&this.add(e),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,ee.system.addOnce(this.tick,this,pr.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){let e=this.queue[0],t=!1;if(e&&!e._destroyed){for(let r=0,i=this.uploadHooks.length;r<i;r++)if(this.uploadHooks[r](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)ee.system.addOnce(this.tick,this,pr.UTILITY);else{this.ticking=!1;let e=this.completes.slice(0);this.completes.length=0;for(let t=0,r=e.length;t<r;t++)e[t]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let t=0,r=this.addHooks.length;t<r&&!this.addHooks[t](e,this.queue);t++);if(e instanceof ne)for(let t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this}destroy(){this.ticking&&ee.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}},zn=S_;zn.uploadsPerFrame=4;Object.defineProperties(W,{UPLOADS_PER_FRAME:{get(){return zn.uploadsPerFrame},set(e){et.deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),zn.uploadsPerFrame=e}}});function b_(e,t){return t instanceof lt?(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0):!1}function sA(e,t){if(!(t instanceof Qs))return!1;let{geometry:r}=t;t.finishPoly(),r.updateBatches();let{batches:i}=r;for(let n=0;n<i.length;n++){let{texture:o}=i[n].style;o&&b_(e,o.baseTexture)}return r.batchable||e.geometry.bind(r,t._resolveDirectShader(e)),!0}function oA(e,t){return e instanceof Qs?(t.push(e),!0):!1}var ya=class extends zn{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(oA),this.registerUploadHook(b_),this.registerUploadHook(sA)}};ya.extension={name:"prepare",type:z.RendererSystem};Z.add(ya);var wV=new dt;var A_=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`;var C_=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`;var I_=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`;var Tf=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`;var R_=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;var yh=new Et,Ta=class extends kr{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new Fn,this.state=de.for2d()}contextChange(){let t=this.renderer,r={globals:t.globalUniforms};this.simpleShader=me.from(Tf,R_,r),this.shader=t.context.webGLVersion>1?me.from(C_,A_,r):me.from(Tf,I_,r)}render(t){let r=this.renderer,i=this.quad,n=i.vertices;n[0]=n[6]=t._width*-t.anchor.x,n[1]=n[3]=t._height*-t.anchor.y,n[2]=n[4]=t._width*(1-t.anchor.x),n[5]=n[7]=t._height*(1-t.anchor.y);let o=t.uvRespectAnchor?t.anchor.x:0,a=t.uvRespectAnchor?t.anchor.y:0;n=i.uvs,n[0]=n[6]=-o,n[1]=n[3]=-a,n[2]=n[4]=1-o,n[5]=n[7]=1-a,i.invalidate();let c=t._texture,f=c.baseTexture,p=f.alphaMode>0,l=t.tileTransform.localTransform,h=t.uvMatrix,d=f.isPowerOfTwo&&c.frame.width===f.width&&c.frame.height===f.height;d&&(f._glTextures[r.CONTEXT_UID]?d=f.wrapMode!==ur.CLAMP:f.wrapMode===ur.CLAMP&&(f.wrapMode=ur.REPEAT));let m=d?this.simpleShader:this.shader,_=c.width,x=c.height,T=t._width,S=t._height;yh.set(l.a*_/T,l.b*_/S,l.c*x/T,l.d*x/S,l.tx/T,l.ty/S),yh.invert(),d?yh.prepend(h.mapCoord):(m.uniforms.uMapCoord=h.mapCoord.toArray(!0),m.uniforms.uClampFrame=h.uClampFrame,m.uniforms.uClampOffset=h.uClampOffset),m.uniforms.uTransform=yh.toArray(!0),m.uniforms.uColor=pt.shared.setValue(t.tint).premultiply(t.worldAlpha,p).toArray(m.uniforms.uColor),m.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),m.uniforms.uSampler=c,r.shader.bind(m),r.geometry.bind(i),this.state.blendMode=et.correctBlendMode(t.blendMode,p),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}};Ta.extension={name:"tilingSprite",type:z.RendererPlugin};Z.add(Ta);var wa=class{constructor(e,t,r=null){this.linkedSheets=[],this._texture=e instanceof it?e:null,this.baseTexture=e instanceof lt?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;let i=this.baseTexture.resource;this.resolution=this._updateResolution(r||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){let{scale:t}=this.data.meta,r=et.getResolutionOfUrl(e,null);return r===null&&(r=parseFloat(t??"1")),r!==1&&this.baseTexture.setResolution(r),r}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=wa.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e,r=wa.BATCH_SIZE;for(;t-e<r&&t<this._frameKeys.length;){let i=this._frameKeys[t],n=this._frames[i],o=n.frame;if(o){let a=null,c=null,f=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,p=new ut(0,0,Math.floor(f.w)/this.resolution,Math.floor(f.h)/this.resolution);n.rotated?a=new ut(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new ut(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(c=new ut(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new it(this.baseTexture,a,p,c,n.rotated?2:0,n.anchor,n.borders),it.addToCache(this.textures[i],i)}t++}}_processAnimations(){let e=this.data.animations||{};for(let t in e){this.animations[t]=[];for(let r=0;r<e[t].length;r++){let i=e[t][r];this.animations[t].push(this.textures[i])}}}_parseComplete(){let e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*wa.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*wa.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(let t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}},Ea=wa;Ea.BATCH_SIZE=1e3;var aA=["jpg","png","jpeg","avif","webp"];function P_(e,t,r){let i={};if(e.forEach(n=>{i[n]=t}),Object.keys(t.textures).forEach(n=>{i[n]=t.textures[n]}),!r){let n=et.path.dirname(e[0]);t.linkedSheets.forEach((o,a)=>{let c=P_([`${n}/${t.data.meta.related_multi_packs[a]}`],o,!0);Object.assign(i,c)})}return i}var M_={extension:z.Asset,cache:{test:e=>e instanceof Ea,getCacheableAssets:(e,t)=>P_(e,t,!1)},resolver:{test:e=>{let r=e.split("?")[0].split("."),i=r.pop(),n=r.pop();return i==="json"&&aA.includes(n)},parse:e=>{let t=e.split(".");return{resolution:parseFloat(W.RETINA_PREFIX.exec(e)?.[1]??"1"),format:t[t.length-2],src:e}}},loader:{name:"spritesheetLoader",extension:{type:z.LoadParser,priority:le.Normal},async testParse(e,t){return et.path.extname(t.src).toLowerCase()===".json"&&!!e.frames},async parse(e,t,r){let i=et.path.dirname(t.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");let n=i+e.meta.image;n=Hn(n,t.src);let a=(await r.load([n]))[n],c=new Ea(a.baseTexture,e,t.src);await c.parse();let f=e?.meta?.related_multi_packs;if(Array.isArray(f)){let p=[];for(let h of f){if(typeof h!="string")continue;let d=i+h;t.data?.ignoreMultiPack||(d=Hn(d,t.src),p.push(r.load({src:d,data:{ignoreMultiPack:!0}})))}let l=await Promise.all(p);c.linkedSheets=l,l.forEach(h=>{h.linkedSheets=[c].concat(c.linkedSheets.filter(d=>d!==h))})}return c},unload(e){e.destroy(!0)}}};Z.add(M_);var si=class{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}};var oi=class{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){let r=t.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(let o in r){let a=r[o].match(/^[a-z]+/gm)[0],c=r[o].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),f={};for(let p in c){let l=c[p].split("="),h=l[0],d=l[1].replace(/"/gm,""),m=parseFloat(d),_=isNaN(m)?d:m;f[h]=_}i[a].push(f)}let n=new si;return i.info.forEach(o=>n.info.push({face:o.face,size:parseInt(o.size,10)})),i.common.forEach(o=>n.common.push({lineHeight:parseInt(o.lineHeight,10)})),i.page.forEach(o=>n.page.push({id:parseInt(o.id,10),file:o.file})),i.char.forEach(o=>n.char.push({id:parseInt(o.id,10),page:parseInt(o.page,10),x:parseInt(o.x,10),y:parseInt(o.y,10),width:parseInt(o.width,10),height:parseInt(o.height,10),xoffset:parseInt(o.xoffset,10),yoffset:parseInt(o.yoffset,10),xadvance:parseInt(o.xadvance,10)})),i.kerning.forEach(o=>n.kerning.push({first:parseInt(o.first,10),second:parseInt(o.second,10),amount:parseInt(o.amount,10)})),i.distanceField.forEach(o=>n.distanceField.push({distanceRange:parseInt(o.distanceRange,10),fieldType:o.fieldType})),n}};var Bi=class{static test(t){let r=t;return"getElementsByTagName"in r&&r.getElementsByTagName("page").length&&r.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){let r=new si,i=t.getElementsByTagName("info"),n=t.getElementsByTagName("common"),o=t.getElementsByTagName("page"),a=t.getElementsByTagName("char"),c=t.getElementsByTagName("kerning"),f=t.getElementsByTagName("distanceField");for(let p=0;p<i.length;p++)r.info.push({face:i[p].getAttribute("face"),size:parseInt(i[p].getAttribute("size"),10)});for(let p=0;p<n.length;p++)r.common.push({lineHeight:parseInt(n[p].getAttribute("lineHeight"),10)});for(let p=0;p<o.length;p++)r.page.push({id:parseInt(o[p].getAttribute("id"),10)||0,file:o[p].getAttribute("file")});for(let p=0;p<a.length;p++){let l=a[p];r.char.push({id:parseInt(l.getAttribute("id"),10),page:parseInt(l.getAttribute("page"),10)||0,x:parseInt(l.getAttribute("x"),10),y:parseInt(l.getAttribute("y"),10),width:parseInt(l.getAttribute("width"),10),height:parseInt(l.getAttribute("height"),10),xoffset:parseInt(l.getAttribute("xoffset"),10),yoffset:parseInt(l.getAttribute("yoffset"),10),xadvance:parseInt(l.getAttribute("xadvance"),10)})}for(let p=0;p<c.length;p++)r.kerning.push({first:parseInt(c[p].getAttribute("first"),10),second:parseInt(c[p].getAttribute("second"),10),amount:parseInt(c[p].getAttribute("amount"),10)});for(let p=0;p<f.length;p++)r.distanceField.push({fieldType:f[p].getAttribute("fieldType"),distanceRange:parseInt(f[p].getAttribute("distanceRange"),10)});return r}};var Di=class{static test(t){return typeof t=="string"&&t.includes("<font>")?Bi.test(W.ADAPTER.parseXML(t)):!1}static parse(t){return Bi.parse(W.ADAPTER.parseXML(t))}};var wf=[oi,Bi,Di];function Ef(e){for(let t=0;t<wf.length;t++)if(wf[t].test(e))return wf[t];return null}function Sf(e,t,r,i,n,o){let a=r.fill;if(Array.isArray(a)){if(a.length===1)return a[0]}else return a;let c,f=r.dropShadow?r.dropShadowDistance:0,p=r.padding||0,l=e.width/i-f-p*2,h=e.height/i-f-p*2,d=a.slice(),m=r.fillGradientStops.slice();if(!m.length){let _=d.length+1;for(let x=1;x<_;++x)m.push(x/_)}if(d.unshift(a[0]),m.unshift(0),d.push(a[a.length-1]),m.push(1),r.fillGradientType===dn.LINEAR_VERTICAL){c=t.createLinearGradient(l/2,p,l/2,h+p);let _=0,T=(o.fontProperties.fontSize+r.strokeThickness)/h;for(let S=0;S<n.length;S++){let b=o.lineHeight*S;for(let y=0;y<d.length;y++){let w=0;typeof m[y]=="number"?w=m[y]:w=y/d.length;let I=b/h+w*T,C=Math.max(_,I);C=Math.min(C,1),c.addColorStop(C,d[y]),_=C}}}else{c=t.createLinearGradient(p,h/2,l+p,h/2);let _=d.length+1,x=1;for(let T=0;T<d.length;T++){let S;typeof m[T]=="number"?S=m[T]:S=x/_,c.addColorStop(S,d[T]),x++}}return c}function bf(e,t,r,i,n,o,a){let c=r.text,f=r.fontProperties;t.translate(i,n),t.scale(o,o);let p=a.strokeThickness/2,l=-(a.strokeThickness/2);if(t.font=a.toFontString(),t.lineWidth=a.strokeThickness,t.textBaseline=a.textBaseline,t.lineJoin=a.lineJoin,t.miterLimit=a.miterLimit,t.fillStyle=Sf(e,t,a,o,[c],r),t.strokeStyle=a.stroke,a.dropShadow){let h=a.dropShadowColor,d=a.dropShadowBlur*o,m=a.dropShadowDistance*o;t.shadowColor=pt.shared.setValue(h).setAlpha(a.dropShadowAlpha).toRgbaString(),t.shadowBlur=d,t.shadowOffsetX=Math.cos(a.dropShadowAngle)*m,t.shadowOffsetY=Math.sin(a.dropShadowAngle)*m}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;a.stroke&&a.strokeThickness&&t.strokeText(c,p,l+r.lineHeight-f.descent),a.fill&&t.fillText(c,p,l+r.lineHeight-f.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function $n(e){return e.codePointAt?e.codePointAt(0):e.charCodeAt(0)}function Sa(e){return Array.from?Array.from(e):e.split("")}function Af(e){typeof e=="string"&&(e=[e]);let t=[];for(let r=0,i=e.length;r<i;r++){let n=e[r];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);let o=n[0].charCodeAt(0),a=n[1].charCodeAt(0);if(a<o)throw new Error("[BitmapFont]: Invalid character range.");for(let c=o,f=a;c<=f;c++)t.push(String.fromCharCode(c))}else t.push(...Sa(n))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}var $r=class{constructor(e,t,r){let[i]=e.info,[n]=e.common,[o]=e.page,[a]=e.distanceField,c=et.getResolutionOfUrl(o.file),f={};this._ownsTextures=r,this.font=i.face,this.size=i.size,this.lineHeight=n.lineHeight/c,this.chars={},this.pageTextures=f;for(let p=0;p<e.page.length;p++){let{id:l,file:h}=e.page[p];f[l]=t instanceof Array?t[p]:t[h],a?.fieldType&&a.fieldType!=="none"&&(f[l].baseTexture.alphaMode=ue.NO_PREMULTIPLIED_ALPHA,f[l].baseTexture.mipmap=Se.OFF)}for(let p=0;p<e.char.length;p++){let{id:l,page:h}=e.char[p],{x:d,y:m,width:_,height:x,xoffset:T,yoffset:S,xadvance:b}=e.char[p];d/=c,m/=c,_/=c,x/=c,T/=c,S/=c,b/=c;let y=new ut(d+f[h].frame.x/c,m+f[h].frame.y/c,_,x);this.chars[l]={xOffset:T,yOffset:S,xAdvance:b,kerning:{},texture:new it(f[h].baseTexture,y),page:h}}for(let p=0;p<e.kerning.length;p++){let{first:l,second:h,amount:d}=e.kerning[p];l/=c,h/=c,d/=c,this.chars[h]&&(this.chars[h].kerning[l]=d)}this.distanceFieldRange=a?.distanceRange,this.distanceFieldType=a?.fieldType?.toLowerCase()??"none"}destroy(){for(let e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(let e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,t,r){let i;if(e instanceof si)i=e;else{let o=Ef(e);if(!o)throw new Error("Unrecognized data format for font.");i=o.parse(e)}t instanceof it&&(t=[t]);let n=new $r(i,t,r);return $r.available[n.font]=n,n}static uninstall(e){let t=$r.available[e];if(!t)throw new Error(`No font found named '${e}'`);t.destroy(),delete $r.available[e]}static from(e,t,r){if(!e)throw new Error("[BitmapFont] Property `name` is required.");let{chars:i,padding:n,resolution:o,textureWidth:a,textureHeight:c,...f}=Object.assign({},$r.defaultOptions,r),p=Af(i),l=t instanceof ze?t:new ze(t),h=a,d=new si;d.info[0]={face:l.fontFamily,size:l.fontSize},d.common[0]={lineHeight:l.fontSize};let m=0,_=0,x,T,S,b=0,y=[],w=[];for(let C=0;C<p.length;C++){x||(x=W.ADAPTER.createCanvas(),x.width=a,x.height=c,T=x.getContext("2d"),S=new lt(x,{resolution:o,...f}),y.push(S),w.push(new it(S)),d.page.push({id:w.length-1,file:""}));let P=p[C],M=he.measureText(P,l,!1,x),B=M.width,F=Math.ceil(M.height),L=Math.ceil((l.fontStyle==="italic"?2:1)*B);if(_>=c-F*o){if(_===0)throw new Error(`[BitmapFont] textureHeight ${c}px is too small (fontFamily: '${l.fontFamily}', fontSize: ${l.fontSize}px, char: '${P}')`);--C,x=null,T=null,S=null,_=0,m=0,b=0;continue}if(b=Math.max(F+M.fontProperties.descent,b),L*o+m>=h){if(m===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${l.fontFamily}', fontSize: ${l.fontSize}px, char: '${P}')`);--C,_+=b*o,_=Math.ceil(_),m=0,b=0;continue}bf(x,T,M,m,_,o,l);let H=$n(M.text);d.char.push({id:H,page:w.length-1,x:m/o,y:_/o,width:L,height:F,xoffset:0,yoffset:0,xadvance:B-(l.dropShadow?l.dropShadowDistance:0)-(l.stroke?l.strokeThickness:0)}),m+=(L+2*n)*o,m=Math.ceil(m)}for(let C=0,P=p.length;C<P;C++){let M=p[C];for(let B=0;B<P;B++){let F=p[B],L=T.measureText(M).width,H=T.measureText(F).width,G=T.measureText(M+F).width-(L+H);G&&d.kerning.push({first:$n(M),second:$n(F),amount:G})}}let I=new $r(d,w,!0);return $r.available[e]!==void 0&&$r.uninstall(e),$r.available[e]=I,I}},Ae=$r;Ae.ALPHA=[["a","z"],["A","Z"]," "];Ae.NUMERIC=[["0","9"]];Ae.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];Ae.ASCII=[[" ","~"]];Ae.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:$r.ALPHANUMERIC};Ae.available={};var B_=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`;var D_=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;var L_=[],F_=[],O_=[],N_=class extends ne{constructor(e,t={}){super();let{align:r,tint:i,maxWidth:n,letterSpacing:o,fontName:a,fontSize:c}=Object.assign({},N_.styleDefaults,t);if(!Ae.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=r,this._tintColor=new pt(i),this._font=void 0,this._fontName=a,this._fontSize=c,this.text=e,this._maxWidth=n,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new tr(()=>{this.dirty=!0},this,0,0),this._roundPixels=W.ROUND_PIXELS,this.dirty=!0,this._resolution=W.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){let e=Ae.available[this._fontName],t=this.fontSize,r=t/e.size,i=new dt,n=[],o=[],a=[],c=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",f=Sa(c),p=this._maxWidth*e.size/t,l=e.distanceFieldType==="none"?L_:F_,h=null,d=0,m=0,_=0,x=-1,T=0,S=0,b=0,y=0;for(let F=0;F<f.length;F++){let L=f[F],H=$n(L);if(/(?:\s)/.test(L)&&(x=F,T=d,y++),L==="\r"||L===`
`){o.push(d),a.push(-1),m=Math.max(m,d),++_,++S,i.x=0,i.y+=e.lineHeight,h=null,y=0;continue}let N=e.chars[H];if(!N)continue;h&&N.kerning[h]&&(i.x+=N.kerning[h]);let G=O_.pop()||{texture:it.EMPTY,line:0,charCode:0,prevSpaces:0,position:new dt};G.texture=N.texture,G.line=_,G.charCode=H,G.position.x=Math.round(i.x+N.xOffset+this._letterSpacing/2),G.position.y=Math.round(i.y+N.yOffset),G.prevSpaces=y,n.push(G),d=G.position.x+Math.max(N.xAdvance-N.xOffset,N.texture.orig.width),i.x+=N.xAdvance+this._letterSpacing,b=Math.max(b,N.yOffset+N.texture.height),h=H,x!==-1&&p>0&&i.x>p&&(++S,et.removeItems(n,1+x-S,1+F-x),F=x,x=-1,o.push(T),a.push(n.length>0?n[n.length-1].prevSpaces:0),m=Math.max(m,T),_++,i.x=0,i.y+=e.lineHeight,h=null,y=0)}let w=f[f.length-1];w!=="\r"&&w!==`
`&&(/(?:\s)/.test(w)&&(d=T),o.push(d),m=Math.max(m,d),a.push(-1));let I=[];for(let F=0;F<=_;F++){let L=0;this._align==="right"?L=m-o[F]:this._align==="center"?L=(m-o[F])/2:this._align==="justify"&&(L=a[F]<0?0:(m-o[F])/a[F]),I.push(L)}let C=n.length,P={},M=[],B=this._activePagesMeshData;l.push(...B);for(let F=0;F<C;F++){let L=n[F].texture,H=L.baseTexture.uid;if(!P[H]){let N=l.pop();if(!N){let q=new fn,j,rt;e.distanceFieldType==="none"?(j=new Mi(it.EMPTY),rt=ft.NORMAL):(j=new Mi(it.EMPTY,{program:we.from(D_,B_),uniforms:{uFWidth:0}}),rt=ft.NORMAL_NPM);let $=new cn(q,j);$.blendMode=rt,N={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:$,vertices:null,uvs:null,indices:null}}N.index=0,N.indexCount=0,N.vertexCount=0,N.uvsCount=0,N.total=0;let{_textureCache:G}=this;G[H]=G[H]||new it(L.baseTexture),N.mesh.texture=G[H],N.mesh.tint=this._tintColor.value,M.push(N),P[H]=N}P[H].total++}for(let F=0;F<B.length;F++)M.includes(B[F])||this.removeChild(B[F].mesh);for(let F=0;F<M.length;F++)M[F].mesh.parent!==this&&this.addChild(M[F].mesh);this._activePagesMeshData=M;for(let F in P){let L=P[F],H=L.total;if(!(L.indices?.length>6*H)||L.vertices.length<cn.BATCHABLE_SIZE*2)L.vertices=new Float32Array(4*2*H),L.uvs=new Float32Array(4*2*H),L.indices=new Uint16Array(6*H);else{let N=L.total,G=L.vertices;for(let q=N*4*2;q<G.length;q++)G[q]=0}L.mesh.size=6*H}for(let F=0;F<C;F++){let L=n[F],H=L.position.x+I[L.line]*(this._align==="justify"?L.prevSpaces:1);this._roundPixels&&(H=Math.round(H));let N=H*r,G=L.position.y*r,q=L.texture,j=P[q.baseTexture.uid],rt=q.frame,$=q._uvs,Q=j.index++;j.indices[Q*6+0]=0+Q*4,j.indices[Q*6+1]=1+Q*4,j.indices[Q*6+2]=2+Q*4,j.indices[Q*6+3]=0+Q*4,j.indices[Q*6+4]=2+Q*4,j.indices[Q*6+5]=3+Q*4,j.vertices[Q*8+0]=N,j.vertices[Q*8+1]=G,j.vertices[Q*8+2]=N+rt.width*r,j.vertices[Q*8+3]=G,j.vertices[Q*8+4]=N+rt.width*r,j.vertices[Q*8+5]=G+rt.height*r,j.vertices[Q*8+6]=N,j.vertices[Q*8+7]=G+rt.height*r,j.uvs[Q*8+0]=$.x0,j.uvs[Q*8+1]=$.y0,j.uvs[Q*8+2]=$.x1,j.uvs[Q*8+3]=$.y1,j.uvs[Q*8+4]=$.x2,j.uvs[Q*8+5]=$.y2,j.uvs[Q*8+6]=$.x3,j.uvs[Q*8+7]=$.y3}this._textWidth=m*r,this._textHeight=(i.y+e.lineHeight)*r;for(let F in P){let L=P[F];if(this.anchor.x!==0||this.anchor.y!==0){let q=0,j=this._textWidth*this.anchor.x,rt=this._textHeight*this.anchor.y;for(let $=0;$<L.total;$++)L.vertices[q++]-=j,L.vertices[q++]-=rt,L.vertices[q++]-=j,L.vertices[q++]-=rt,L.vertices[q++]-=j,L.vertices[q++]-=rt,L.vertices[q++]-=j,L.vertices[q++]-=rt}this._maxLineHeight=b*r;let H=L.mesh.geometry.getBuffer("aVertexPosition"),N=L.mesh.geometry.getBuffer("aTextureCoord"),G=L.mesh.geometry.getIndex();H.data=L.vertices,N.data=L.uvs,G.data=L.indices,H.update(),N.update(),G.update()}for(let F=0;F<n.length;F++)O_.push(n[F]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);let{distanceFieldRange:t,distanceFieldType:r,size:i}=Ae.available[this._fontName];if(r!=="none"){let{a:n,b:o,c:a,d:c}=this.worldTransform,f=Math.sqrt(n*n+o*o),p=Math.sqrt(a*a+c*c),l=(Math.abs(f)+Math.abs(p))/2,h=this.fontSize/i,d=e._view.resolution;for(let m of this._activePagesMeshData)m.mesh.shader.uniforms.uFWidth=l*t*h*d}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){let e=Ae.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!Ae.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??Ae.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){let{_textureCache:t}=this,i=Ae.available[this._fontName].distanceFieldType==="none"?L_:F_;i.push(...this._activePagesMeshData);for(let n of this._activePagesMeshData)this.removeChild(n.mesh);this._activePagesMeshData=[],i.filter(n=>t[n.mesh.texture.baseTexture.uid]).forEach(n=>{n.mesh.texture=it.EMPTY});for(let n in t)t[n].destroy(),delete t[n];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}},U_=N_;U_.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};var lA=[".xml",".fnt"],k_={extension:{type:z.LoadParser,priority:le.Normal},name:"loadBitmapFont",test(e){return lA.includes(et.path.extname(e).toLowerCase())},async testParse(e){return oi.test(e)||Di.test(e)},async parse(e,t,r){let i=oi.test(e)?oi.parse(e):Di.parse(e),{src:n}=t,{page:o}=i,a=[];for(let p=0;p<o.length;++p){let l=o[p].file,h=et.path.join(et.path.dirname(n),l);h=Hn(h,n),a.push(h)}let c=await r.load(a),f=a.map(p=>c[p]);return Ae.install(i,f,!0)},async load(e,t){return(await W.ADAPTER.fetch(e)).text()},unload(e){e.destroy()}};Z.add(k_);var Js=class extends ze{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new Js(Object.keys(Js.defaultOptions).reduce((t,r)=>({...t,[r]:e[r]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete Js.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,t={}){let{availableFonts:r}=Js;if(r[e]){let i=r[e];return this._fonts.push(i),i.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return W.ADAPTER.fetch(e).then(i=>i.blob()).then(async i=>new Promise((n,o)=>{let a=URL.createObjectURL(i),c=new FileReader;c.onload=()=>n([a,c.result]),c.onerror=o,c.readAsDataURL(i)})).then(async([i,n])=>{let o=Object.assign({family:et.path.basename(e,et.path.extname(e)),weight:"normal",style:"normal",src:i,dataSrc:n,refs:1,originalUrl:e,fontFace:null},t);r[e]=o,this._fonts.push(o),this.styleID++;let a=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style});o.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){let t=e.filter(r=>!this._overrides.includes(r));t.length>0&&(this._overrides.push(...t),this.styleID++)}removeOverride(...e){let t=e.filter(r=>this._overrides.includes(r));t.length>0&&(this._overrides=this._overrides.filter(r=>!t.includes(r)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,t)=>`${e}
            @font-face {
                font-family: "${t.family}";
                src: url('${t.dataSrc}');
                font-weight: ${t.weight};
                font-style: ${t.style}; 
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=et.rgb2hex(e)),typeof e=="number"?et.hex2string(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor),t=this.dropShadowAlpha,r=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),i=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&t<1&&(e+=(t*255|0).toString(16).padStart(2,"0"));let n=`${r}px ${i}px`;return this.dropShadowBlur>0?`text-shadow: ${n} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${n} ${e}`}reset(){Object.assign(this,Js.defaultOptions)}onBeforeDraw(){let{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(t=>setTimeout(t,100)):Promise.resolve()}get isSafari(){let{userAgent:e}=W.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}},Yn=Js;Yn.availableFonts={};Yn.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};var to=class extends Be{constructor(e="",t={}){super(it.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this._loading=!1,this.localStyleID=-1,this.dirty=!1,this.ownsStyle=!1;let r=new Image,i=it.from(r,{scaleMode:W.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new ut,i.trim=new ut,this.texture=i;let n="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(n,"svg"),c=document.createElementNS(n,"foreignObject"),f=document.createElementNS(o,"div"),p=document.createElementNS(o,"style");c.setAttribute("width","10000"),c.setAttribute("height","10000"),c.style.overflow="hidden",a.appendChild(c),this.maxWidth=to.defaultMaxWidth,this.maxHeight=to.defaultMaxHeight,this._domElement=f,this._styleElement=p,this._svgRoot=a,this._foreignObject=c,this._foreignObject.appendChild(p),this._foreignObject.appendChild(f),this._image=r,this._loadImage=new Image,this._autoResolution=to.defaultAutoResolution,this._resolution=to.defaultResolution??W.RESOLUTION,this.text=e,this.style=t}measureText(e){let{text:t,style:r,resolution:i}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:t,style:r.toCSS(i)}),this._styleElement.textContent=r.toGlobalCSS(),document.body.appendChild(this._svgRoot);let n=this._domElement.getBoundingClientRect();this._svgRoot.remove();let o=Math.min(this.maxWidth,Math.ceil(n.width)),a=Math.min(this.maxHeight,Math.ceil(n.height));return this._svgRoot.setAttribute("width",o.toString()),this._svgRoot.setAttribute("height",a.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),r!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(i)}),this._styleElement.textContent=this._style?.toGlobalCSS()),{width:o+r.padding*2,height:a+r.padding*2}}async updateText(e=!0){let{style:t,_image:r,_loadImage:i}=this;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;let{width:n,height:o}=this.measureText();r.width=i.width=Math.ceil(Math.max(1,n)),r.height=i.height=Math.ceil(Math.max(1,o)),this._loading||(this._loading=!0,await new Promise(a=>{i.onload=async()=>{await t.onBeforeDraw(),this._loading=!1,r.src=i.src,i.onload=null,i.src="",this.updateTexture(),a()};let c=new XMLSerializer().serializeToString(this._svgRoot);i.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(c)}`}))}get source(){return this._image}updateTexture(){let{style:e,texture:t,_image:r,resolution:i}=this,{padding:n}=e,{baseTexture:o}=t;t.trim.width=t._frame.width=r.width/i,t.trim.height=t._frame.height=r.height/i,t.trim.x=-n,t.trim.y=-n,t.orig.width=t._frame.width-n*2,t.orig.height=t._frame.height-n*2,this._onTextureUpdate(),o.setRealSize(r.width,r.height,i),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},to.defaultDestroyOptions,e),super.destroy(e);let t=null;this.ownsStyle&&this._style?.cleanFonts(),this._style=t,this._svgRoot?.remove(),this._svgRoot=t,this._domElement?.remove(),this._domElement=t,this._foreignObject?.remove(),this._foreignObject=t,this._styleElement?.remove(),this._styleElement=t,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=t,this._image.src="",this._image=t}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);let t=et.sign(this.scale.x)||1;this.scale.x=t*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);let t=et.sign(this.scale.y)||1;this.scale.y=t*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof Yn?(this.ownsStyle=!1,this._style=e):e instanceof ze?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Yn.from(e)):(this.ownsStyle=!0,this._style=new Yn(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}},ba=to;ba.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0};ba.defaultMaxWidth=2024;ba.defaultMaxHeight=2024;ba.defaultAutoResolution=!0;var ge=_i(Th(),1);var G_=_i(Th(),1);function H_(e,t){return e.anchor.set(.5),e.width=t.w,e.height=t.h,{sprite:e,body:G_.default.Bodies.rectangle(t.x,t.y,t.w,t.h),update(){this.sprite.x=this.body.position.x,this.sprite.y=this.body.position.y,this.sprite.rotation=this.body.angle}}}var V_=_i(If(),1),ai;(p=>{let e=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"];function t(l){let h=e.find(m=>l.includes(m));if(h===void 0)throw new Error(`${l} does not contain a valid note`);let d=l.substring(h.length,l.length);if(!/(\d+)/g.test(d))throw new Error(`${l} does not contain a valid octave number`);return{chroma:h,octave:V_.default.parseInt(d)}}p.parse=t;function r(...l){return l.map(h=>t(h))}p.parseSeq=r;function i(l,h){return{chroma:l,octave:h}}p.create=i;function n(l,h){return l.chroma===h.chroma&&l.octave===h.octave}p.eq=n;function o(l){let h=c(l.chroma),d=(h+1)%12,m=l.octave+Math.floor((h+1)/12);return{chroma:a(d),octave:m}}p.inc=o;function a(l){if(l>11)throw new Error(`${l} is not a valid chroma index. Must be >=0 and < 12`);return e[l]}p.indexToChroma=a;function c(l){return e.indexOf(l)}p.chromaIndex=c;function f(l){return`${l.chroma}${l.octave}`}p.toString=f})(ai||={});var Li=_i(Th(),1),ro=class{constructor(t){this.entity=t}hasJumped=!1;color=16711680;alpha=1;jumpStrength=1;static forceVector(t,r){let i=Li.default.Vector.create(r.x-t.x,r.y-t.y),n=Math.max(Li.default.Vector.magnitude(i),400),o=Li.default.Vector.div(Li.default.Vector.normalise(i),10);return Li.default.Vector.mult(o,n/400)}slice(t){Li.default.Body.applyForce(this.entity.body,this.entity.body.position,ro.forceVector(this.entity.body.position,t))}jump(){if(!this.hasJumped){let t=Li.default.Vector.create(0,-.1*this.jumpStrength);Li.default.Body.applyForce(this.entity.body,this.entity.body.position,t),this.hasJumped=!0,setTimeout(()=>{this.hasJumped=!1},500)}}update(){this.entity.sprite.x=this.entity.body.position.x,this.entity.sprite.y=this.entity.body.position.y,this.entity.sprite.rotation=this.entity.body.angle,this.entity.body.position.y&&(this.hasJumped?this.entity.sprite.alpha=.5:this.entity.sprite.alpha=1)}};var X_=_i(W_(),1),uA=_i(If(),1);var jn=class{howl;static async load(t,r,i,n){let o=[],a=i,c=ai.inc(n);for(let l=0;!ai.eq(a,c);++l)o.push([ai.toString(a),[l*r,r]]),a=ai.inc(a);let f=Object.fromEntries(o),p=new X_.Howl({src:t,sprite:f});return new Promise((l,h)=>{p.on("load",()=>{l(new jn(p))}),p.on("loaderror",()=>{h("unable to load")}),p.load()})}constructor(t){this.howl=t}playNote(t,r){this.howl.play(`${t}${r}`)}};var Rf=class{constructor(t,r,i,n){this.player=t;this.length=r;this.type=i;this.nextNote=n;switch(i){case 2:case 0:this.idx=0,this.direction=1;break;case 1:this.idx=r-1,this.direction=-1;break}}idx=0;direction=1;playNote(){let t=this.nextNote(this.idx);switch(this.player.playNote(t.chroma,t.octave),this.type){case 0:this.idx++;break;case 1:this.idx--;break;case 2:this.idx=this.idx+this.direction,this.idx>=this.length?(this.idx=this.length-2,this.direction=-1):this.idx<0&&(this.idx=1,this.direction=1);break}this.idx=(this.idx+this.length)%this.length}},Eh=class extends Rf{idx=0;direction=1;constructor(t,r,i){super(t,r.length,i,n=>r[n])}};async function cA(){let e=ge.default.Vector.create(0,.5),t=ai.create("C",2),r=ai.create("C",8),i=ai.parseSeq("C5","E5","F5","A5","C6","G5","B5","D5","B4"),[n,o]=await Promise.all([jn.load("assets/sfx/fonts/glass.wav",2e3,t,r),jn.load("assets/sfx/fonts/pipe.wav",2e3,t,r)]),a={glass:n,pipe:o},c=new Eh(a.pipe,i,2),f=new ha({resizeTo:window,autoDensity:!0,antialias:!0});document.body.appendChild(f.view),f.renderer.events.cursorStyles.default="crosshair";let p=ge.default.World.create({gravity:{x:e.x,y:e.y,scale:1}}),l=ge.default.Engine.create({world:p}),h=["blue","green","orange","pink","purple","red","yellow"].map(w=>[w,Be.from(`assets/gfx/${w}.png`)]),d=Object.fromEntries(h),m=H_(d.pink,{x:window.innerWidth/2,y:window.innerHeight/2,w:40,h:40}),_=new ro(m);f.stage.addChild(m.sprite);function x(w){return ge.default.Composite.create({bodies:[ge.default.Bodies.rectangle(f.view.width/2,-w/2,f.view.width,w,{isStatic:!0}),ge.default.Bodies.rectangle(f.view.width/2,f.view.height+w/2,f.view.width,w,{isStatic:!0}),ge.default.Bodies.rectangle(-w/2,f.view.height/2,w,f.view.height,{isStatic:!0}),ge.default.Bodies.rectangle(f.view.width+w/2,f.view.height/2,w,f.view.height,{isStatic:!0})]})}let T=1e3,S=x(T);ge.default.Composite.add(l.world,[S,m.body]);let b=ge.default.Vector.create();window.addEventListener("resize",w=>{ge.default.Composite.remove(l.world,S),S=x(T),ge.default.Composite.add(l.world,S)}),window.addEventListener("mousemove",w=>{b.x=w.x,b.y=w.y}),window.addEventListener("keydown",w=>{w.key===" "&&_.jump()});let y=(w,I)=>{c.playNote(),_.slice(ge.default.Vector.create(w,I))};window.addEventListener("touchstart",w=>{let I=w.touches[0],C=I.pageX,P=I.pageY;y(C,P)}),window.addEventListener("click",w=>{y(w.x,w.y)}),f.ticker.add(()=>{ge.default.Engine.update(l,Math.floor(f.ticker.deltaMS));let w=_.entity.body.position;(w.x<0||w.x>f.view.width)&&(ge.default.Body.set(_.entity.body,"position",{x:window.innerWidth/2,y:window.innerHeight/2}),ge.default.Body.setVelocity(_.entity.body,{x:0,y:0})),(w.y<0||w.y>f.view.height)&&(ge.default.Body.set(_.entity.body,"position",{x:window.innerWidth/2,y:window.innerHeight/2}),ge.default.Body.setVelocity(_.entity.body,{x:0,y:0})),_.update()})}window.addEventListener("load",()=>{cA()});})();
/*! Bundled license information:

punycode/punycode.js:
  (*! https://mths.be/punycode v1.3.2 by @mathias *)

matter-js/build/matter.js:
  (*!
   * matter-js 0.19.0 by @liabru
   * http://brm.io/matter-js/
   * License MIT
   * 
   * The MIT License (MIT)
   * 
   * Copyright (c) Liam Brummitt and contributors.
   * 
   * Permission is hereby granted, free of charge, to any person obtaining a copy
   * of this software and associated documentation files (the "Software"), to deal
   * in the Software without restriction, including without limitation the rights
   * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
   * copies of the Software, and to permit persons to whom the Software is
   * furnished to do so, subject to the following conditions:
   * 
   * The above copyright notice and this permission notice shall be included in
   * all copies or substantial portions of the Software.
   * 
   * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
   * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
   * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
   * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
   * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
   * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
   * THE SOFTWARE.
   *)

lodash/lodash.js:
  (**
   * @license
   * Lodash <https://lodash.com/>
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)

howler/dist/howler.js:
  (*!
   *  howler.js v2.2.3
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   *)
  (*!
   *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
   *  
   *  howler.js v2.2.3
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   *)
*/
